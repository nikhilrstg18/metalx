{"version":3,"sources":["searchreplace/plugin.js"],"names":["eq","call","id","t","is","name","getOption","Cell","initial","value","get","set","v","global","tinymce","util","Tools","resolve","__assign","Object","assign","s","i","n","arguments","length","p","prototype","hasOwnProperty","apply","this","isType","type","x","Array","isPrototypeOf","constructor","String","isSimpleType","isString","isArray","isBoolean","isNumber","noop","constant","never","always","punctuation","none","NONE","o","isNone","fold","_s","isSome","getOr","getOrThunk","thunk","getOrDie","msg","Error","getOrNull","getOrUndefined","undefined","or","orThunk","map","each","bind","exists","forall","filter","equals","equals_","toArray","toString","some","a","constant_a","self","me","f","elementEq","b","Optional","from","punctuation$1","global$1","nativeSlice","slice","nativePush","push","xs","len","r","eachr","flatten","has","obj","key","isText","window","Function","element","dom","nodeType","console","error","setAttribute","rawSet","fromDom","node","SugarElement","fromHtml","html","scope","div","document","createElement","innerHTML","hasChildNodes","childNodes","fromTag","tag","fromText","text","createTextNode","fromPoint","docElm","y","elementFromPoint","spot","offset","leaf","cs","children","before","marker","parentNode","parent","insertBefore","wrap","wrapper","appendChild","append","api","nodeValue","descendants","selector","base","childElementCount","querySelectorAll","all","global$2","isSimpleBoundary","isBlock","schema","getShortEndedElements","nodeName","isContentEditableFalse","getContentEditable","isHidden","getWhiteSpaceElements","toLeaf","walk","walkerFn","startNode","callbacks","endNode","skipStart","next","isCefNode","cef","boundary","collectTextToBoundary","section","rootNode","forwards","getContentEditableParent","isContentEditableTrueInCef","isBoundary","rootBlock","getParent","walker","prev","fOffset","sOffset","elements","collect","sections","current","finishSection","collectRangeSections","rng","start","startContainer","startOffset","end","endContainer","endOffset","commonAncestorContainer","comparator","copy","e","ceTrueNode","match","compareDocumentPosition","Node","DOCUMENT_POSITION_PRECEDING","documentPositionPreceding","sort","fromRng","collapsed","fromNode","createRng","selectNode","extract","matches","acc","wasType","group","groupBy","content","last","finish","positions","matchIdx","Math","max","min","matchId","results","concat","position","find$1","pattern","join","regex","lastIndex","exec","matchedText","matchIndex","matchStart","index","indexOf","matchFinish","find","mark","replacementNode","idx","pos","cloneNode","textNode","splitText","matchNode","findAndMarkInSelection","selection","bookmark","getBookmark","nodes","select","textSections","fromNodes","getRng","moveToBookmark","getElmIndex","elm","getAttribute","markAllMatches","editor","currentSearchState","inSelection","create","className","getBody","done","findAndMark","unwrap","firstChild","removeChild","findSpansByIndex","spans","getElementsByTagName","nodeIndex","moveSelection","forward","searchState","testIndex","count","removeClass","addClass","scrollIntoView","removeNode","remove","isEmpty","find$2","matchCase","wholeWord","escapedText","wordRegex","replace","escapeSearchText","RegExp","newIndex","isMatchSpan","currentMatchIndex","currentIndex","nextIndex","grep","parseInt","keepEditorSelection","setStart","setEnd","data","setRng","global$3","open","subject","dialogApi","clear","isSet","on","undoManager","add","selectedText","trim","getContent","format","updateButtonStates","hasNext","enable","disable","hasPrev","disableAll","toggle","focusButtonIfRequired","browser","isSafari","deviceType","isTouch","focus","reset","doFind","getData","findtext","matchcase","wholewords","inselection","windowManager","alert","notFoundAlert","initialState","spec","title","size","body","items","placeholder","maximized","inputMode","icon","disabled","borderless","buttons","tooltip","align","primary","initialData","replacetext","onChange","details","onAction","updateSearchState","onSubmit","onClose","inline","showDialog","addCommand","register","ui","registry","addMenuItem","shortcut","addButton","shortcuts","register$1","currentState","get$1"],"mappings":"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","file":"plugin.js","sourcesContent":["/**\n * Copyright (c) Tiny Technologies, Inc. All rights reserved.\n * Licensed under the LGPL or a commercial license.\n * For LGPL see License.txt in the project root for license information.\n * For commercial licenses see https://www.tiny.cloud/\n *\n * Version: 5.8.2 (2021-06-23)\n */\n(function () {\n    'use strict';\n\n    var Cell = function (initial) {\n      var value = initial;\n      var get = function () {\n        return value;\n      };\n      var set = function (v) {\n        value = v;\n      };\n      return {\n        get: get,\n        set: set\n      };\n    };\n\n    var global = tinymce.util.Tools.resolve('tinymce.PluginManager');\n\n    var __assign = function () {\n      __assign = Object.assign || function __assign(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n          s = arguments[i];\n          for (var p in s)\n            if (Object.prototype.hasOwnProperty.call(s, p))\n              t[p] = s[p];\n        }\n        return t;\n      };\n      return __assign.apply(this, arguments);\n    };\n\n    var typeOf = function (x) {\n      var t = typeof x;\n      if (x === null) {\n        return 'null';\n      } else if (t === 'object' && (Array.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'Array')) {\n        return 'array';\n      } else if (t === 'object' && (String.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'String')) {\n        return 'string';\n      } else {\n        return t;\n      }\n    };\n    var isType = function (type) {\n      return function (value) {\n        return typeOf(value) === type;\n      };\n    };\n    var isSimpleType = function (type) {\n      return function (value) {\n        return typeof value === type;\n      };\n    };\n    var isString = isType('string');\n    var isArray = isType('array');\n    var isBoolean = isSimpleType('boolean');\n    var isNumber = isSimpleType('number');\n\n    var noop = function () {\n    };\n    var constant = function (value) {\n      return function () {\n        return value;\n      };\n    };\n    var never = constant(false);\n    var always = constant(true);\n\n    var punctuationStr = '[!-#%-*,-\\\\/:;?@\\\\[-\\\\]_{}\\xA1\\xAB\\xB7\\xBB\\xBF;\\xB7\\u055A-\\u055F\\u0589\\u058A\\u05BE\\u05C0\\u05C3\\u05C6\\u05F3\\u05F4\\u0609\\u060A\\u060C\\u060D\\u061B\\u061E\\u061F\\u066A-\\u066D\\u06D4\\u0700-\\u070D\\u07F7-\\u07F9\\u0830-\\u083E\\u085E\\u0964\\u0965\\u0970\\u0DF4\\u0E4F\\u0E5A\\u0E5B\\u0F04-\\u0F12\\u0F3A-\\u0F3D\\u0F85\\u0FD0-\\u0FD4\\u0FD9\\u0FDA\\u104A-\\u104F\\u10FB\\u1361-\\u1368\\u1400\\u166D\\u166E\\u169B\\u169C\\u16EB-\\u16ED\\u1735\\u1736\\u17D4-\\u17D6\\u17D8-\\u17DA\\u1800-\\u180A\\u1944\\u1945\\u1A1E\\u1A1F\\u1AA0-\\u1AA6\\u1AA8-\\u1AAD\\u1B5A-\\u1B60\\u1BFC-\\u1BFF\\u1C3B-\\u1C3F\\u1C7E\\u1C7F\\u1CD3\\u2010-\\u2027\\u2030-\\u2043\\u2045-\\u2051\\u2053-\\u205E\\u207D\\u207E\\u208D\\u208E\\u3008\\u3009\\u2768-\\u2775\\u27C5\\u27C6\\u27E6-\\u27EF\\u2983-\\u2998\\u29D8-\\u29DB\\u29FC\\u29FD\\u2CF9-\\u2CFC\\u2CFE\\u2CFF\\u2D70\\u2E00-\\u2E2E\\u2E30\\u2E31\\u3001-\\u3003\\u3008-\\u3011\\u3014-\\u301F\\u3030\\u303D\\u30A0\\u30FB\\uA4FE\\uA4FF\\uA60D-\\uA60F\\uA673\\uA67E\\uA6F2-\\uA6F7\\uA874-\\uA877\\uA8CE\\uA8CF\\uA8F8-\\uA8FA\\uA92E\\uA92F\\uA95F\\uA9C1-\\uA9CD\\uA9DE\\uA9DF\\uAA5C-\\uAA5F\\uAADE\\uAADF\\uABEB\\uFD3E\\uFD3F\\uFE10-\\uFE19\\uFE30-\\uFE52\\uFE54-\\uFE61\\uFE63\\uFE68\\uFE6A\\uFE6B\\uFF01-\\uFF03\\uFF05-\\uFF0A\\uFF0C-\\uFF0F\\uFF1A\\uFF1B\\uFF1F\\uFF20\\uFF3B-\\uFF3D\\uff3f\\uFF5B\\uFF5D\\uFF5F-\\uFF65]';\n\n    var punctuation = constant(punctuationStr);\n\n    var none = function () {\n      return NONE;\n    };\n    var NONE = function () {\n      var eq = function (o) {\n        return o.isNone();\n      };\n      var call = function (thunk) {\n        return thunk();\n      };\n      var id = function (n) {\n        return n;\n      };\n      var me = {\n        fold: function (n, _s) {\n          return n();\n        },\n        is: never,\n        isSome: never,\n        isNone: always,\n        getOr: id,\n        getOrThunk: call,\n        getOrDie: function (msg) {\n          throw new Error(msg || 'error: getOrDie called on none.');\n        },\n        getOrNull: constant(null),\n        getOrUndefined: constant(undefined),\n        or: id,\n        orThunk: call,\n        map: none,\n        each: noop,\n        bind: none,\n        exists: never,\n        forall: always,\n        filter: none,\n        equals: eq,\n        equals_: eq,\n        toArray: function () {\n          return [];\n        },\n        toString: constant('none()')\n      };\n      return me;\n    }();\n    var some = function (a) {\n      var constant_a = constant(a);\n      var self = function () {\n        return me;\n      };\n      var bind = function (f) {\n        return f(a);\n      };\n      var me = {\n        fold: function (n, s) {\n          return s(a);\n        },\n        is: function (v) {\n          return a === v;\n        },\n        isSome: always,\n        isNone: never,\n        getOr: constant_a,\n        getOrThunk: constant_a,\n        getOrDie: constant_a,\n        getOrNull: constant_a,\n        getOrUndefined: constant_a,\n        or: self,\n        orThunk: self,\n        map: function (f) {\n          return some(f(a));\n        },\n        each: function (f) {\n          f(a);\n        },\n        bind: bind,\n        exists: bind,\n        forall: bind,\n        filter: function (f) {\n          return f(a) ? me : NONE;\n        },\n        toArray: function () {\n          return [a];\n        },\n        toString: function () {\n          return 'some(' + a + ')';\n        },\n        equals: function (o) {\n          return o.is(a);\n        },\n        equals_: function (o, elementEq) {\n          return o.fold(never, function (b) {\n            return elementEq(a, b);\n          });\n        }\n      };\n      return me;\n    };\n    var from = function (value) {\n      return value === null || value === undefined ? NONE : some(value);\n    };\n    var Optional = {\n      some: some,\n      none: none,\n      from: from\n    };\n\n    var punctuation$1 = punctuation;\n\n    var global$1 = tinymce.util.Tools.resolve('tinymce.util.Tools');\n\n    var nativeSlice = Array.prototype.slice;\n    var nativePush = Array.prototype.push;\n    var map = function (xs, f) {\n      var len = xs.length;\n      var r = new Array(len);\n      for (var i = 0; i < len; i++) {\n        var x = xs[i];\n        r[i] = f(x, i);\n      }\n      return r;\n    };\n    var each = function (xs, f) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        f(x, i);\n      }\n    };\n    var eachr = function (xs, f) {\n      for (var i = xs.length - 1; i >= 0; i--) {\n        var x = xs[i];\n        f(x, i);\n      }\n    };\n    var groupBy = function (xs, f) {\n      if (xs.length === 0) {\n        return [];\n      } else {\n        var wasType = f(xs[0]);\n        var r = [];\n        var group = [];\n        for (var i = 0, len = xs.length; i < len; i++) {\n          var x = xs[i];\n          var type = f(x);\n          if (type !== wasType) {\n            r.push(group);\n            group = [];\n          }\n          wasType = type;\n          group.push(x);\n        }\n        if (group.length !== 0) {\n          r.push(group);\n        }\n        return r;\n      }\n    };\n    var foldl = function (xs, f, acc) {\n      each(xs, function (x) {\n        acc = f(acc, x);\n      });\n      return acc;\n    };\n    var flatten = function (xs) {\n      var r = [];\n      for (var i = 0, len = xs.length; i < len; ++i) {\n        if (!isArray(xs[i])) {\n          throw new Error('Arr.flatten item ' + i + ' was not an array, input: ' + xs);\n        }\n        nativePush.apply(r, xs[i]);\n      }\n      return r;\n    };\n    var bind = function (xs, f) {\n      return flatten(map(xs, f));\n    };\n    var sort = function (xs, comparator) {\n      var copy = nativeSlice.call(xs, 0);\n      copy.sort(comparator);\n      return copy;\n    };\n\n    var hasOwnProperty = Object.hasOwnProperty;\n    var has = function (obj, key) {\n      return hasOwnProperty.call(obj, key);\n    };\n\n    var Global = typeof window !== 'undefined' ? window : Function('return this;')();\n\n    var DOCUMENT = 9;\n    var DOCUMENT_FRAGMENT = 11;\n    var ELEMENT = 1;\n    var TEXT = 3;\n\n    var type = function (element) {\n      return element.dom.nodeType;\n    };\n    var isType$1 = function (t) {\n      return function (element) {\n        return type(element) === t;\n      };\n    };\n    var isText = isType$1(TEXT);\n\n    var rawSet = function (dom, key, value) {\n      if (isString(value) || isBoolean(value) || isNumber(value)) {\n        dom.setAttribute(key, value + '');\n      } else {\n        console.error('Invalid call to Attribute.set. Key ', key, ':: Value ', value, ':: Element ', dom);\n        throw new Error('Attribute value was not simple');\n      }\n    };\n    var set = function (element, key, value) {\n      rawSet(element.dom, key, value);\n    };\n\n    var compareDocumentPosition = function (a, b, match) {\n      return (a.compareDocumentPosition(b) & match) !== 0;\n    };\n    var documentPositionPreceding = function (a, b) {\n      return compareDocumentPosition(a, b, Node.DOCUMENT_POSITION_PRECEDING);\n    };\n\n    var fromHtml = function (html, scope) {\n      var doc = scope || document;\n      var div = doc.createElement('div');\n      div.innerHTML = html;\n      if (!div.hasChildNodes() || div.childNodes.length > 1) {\n        console.error('HTML does not have a single root node', html);\n        throw new Error('HTML must have a single root node');\n      }\n      return fromDom(div.childNodes[0]);\n    };\n    var fromTag = function (tag, scope) {\n      var doc = scope || document;\n      var node = doc.createElement(tag);\n      return fromDom(node);\n    };\n    var fromText = function (text, scope) {\n      var doc = scope || document;\n      var node = doc.createTextNode(text);\n      return fromDom(node);\n    };\n    var fromDom = function (node) {\n      if (node === null || node === undefined) {\n        throw new Error('Node cannot be null or undefined');\n      }\n      return { dom: node };\n    };\n    var fromPoint = function (docElm, x, y) {\n      return Optional.from(docElm.dom.elementFromPoint(x, y)).map(fromDom);\n    };\n    var SugarElement = {\n      fromHtml: fromHtml,\n      fromTag: fromTag,\n      fromText: fromText,\n      fromDom: fromDom,\n      fromPoint: fromPoint\n    };\n\n    var bypassSelector = function (dom) {\n      return dom.nodeType !== ELEMENT && dom.nodeType !== DOCUMENT && dom.nodeType !== DOCUMENT_FRAGMENT || dom.childElementCount === 0;\n    };\n    var all = function (selector, scope) {\n      var base = scope === undefined ? document : scope.dom;\n      return bypassSelector(base) ? [] : map(base.querySelectorAll(selector), SugarElement.fromDom);\n    };\n\n    var parent = function (element) {\n      return Optional.from(element.dom.parentNode).map(SugarElement.fromDom);\n    };\n    var children = function (element) {\n      return map(element.dom.childNodes, SugarElement.fromDom);\n    };\n    var spot = function (element, offset) {\n      return {\n        element: element,\n        offset: offset\n      };\n    };\n    var leaf = function (element, offset) {\n      var cs = children(element);\n      return cs.length > 0 && offset < cs.length ? spot(cs[offset], 0) : spot(element, offset);\n    };\n\n    var before = function (marker, element) {\n      var parent$1 = parent(marker);\n      parent$1.each(function (v) {\n        v.dom.insertBefore(element.dom, marker.dom);\n      });\n    };\n    var append = function (parent, element) {\n      parent.dom.appendChild(element.dom);\n    };\n    var wrap = function (element, wrapper) {\n      before(element, wrapper);\n      append(wrapper, element);\n    };\n\n    var NodeValue = function (is, name) {\n      var get = function (element) {\n        if (!is(element)) {\n          throw new Error('Can only get ' + name + ' value of a ' + name + ' node');\n        }\n        return getOption(element).getOr('');\n      };\n      var getOption = function (element) {\n        return is(element) ? Optional.from(element.dom.nodeValue) : Optional.none();\n      };\n      var set = function (element, value) {\n        if (!is(element)) {\n          throw new Error('Can only set raw ' + name + ' value of a ' + name + ' node');\n        }\n        element.dom.nodeValue = value;\n      };\n      return {\n        get: get,\n        getOption: getOption,\n        set: set\n      };\n    };\n\n    var api = NodeValue(isText, 'text');\n    var get = function (element) {\n      return api.get(element);\n    };\n\n    var descendants = function (scope, selector) {\n      return all(selector, scope);\n    };\n\n    var global$2 = tinymce.util.Tools.resolve('tinymce.dom.TreeWalker');\n\n    var isSimpleBoundary = function (dom, node) {\n      return dom.isBlock(node) || has(dom.schema.getShortEndedElements(), node.nodeName);\n    };\n    var isContentEditableFalse = function (dom, node) {\n      return dom.getContentEditable(node) === 'false';\n    };\n    var isContentEditableTrueInCef = function (dom, node) {\n      return dom.getContentEditable(node) === 'true' && dom.getContentEditableParent(node.parentNode) === 'false';\n    };\n    var isHidden = function (dom, node) {\n      return !dom.isBlock(node) && has(dom.schema.getWhiteSpaceElements(), node.nodeName);\n    };\n    var isBoundary = function (dom, node) {\n      return isSimpleBoundary(dom, node) || isContentEditableFalse(dom, node) || isHidden(dom, node) || isContentEditableTrueInCef(dom, node);\n    };\n    var isText$1 = function (node) {\n      return node.nodeType === 3;\n    };\n    var nuSection = function () {\n      return {\n        sOffset: 0,\n        fOffset: 0,\n        elements: []\n      };\n    };\n    var toLeaf = function (node, offset) {\n      return leaf(SugarElement.fromDom(node), offset);\n    };\n    var walk = function (dom, walkerFn, startNode, callbacks, endNode, skipStart) {\n      if (skipStart === void 0) {\n        skipStart = true;\n      }\n      var next = skipStart ? walkerFn(false) : startNode;\n      while (next) {\n        var isCefNode = isContentEditableFalse(dom, next);\n        if (isCefNode || isHidden(dom, next)) {\n          var stopWalking = isCefNode ? callbacks.cef(next) : callbacks.boundary(next);\n          if (stopWalking) {\n            break;\n          } else {\n            next = walkerFn(true);\n            continue;\n          }\n        } else if (isSimpleBoundary(dom, next)) {\n          if (callbacks.boundary(next)) {\n            break;\n          }\n        } else if (isText$1(next)) {\n          callbacks.text(next);\n        }\n        if (next === endNode) {\n          break;\n        } else {\n          next = walkerFn(false);\n        }\n      }\n    };\n    var collectTextToBoundary = function (dom, section, node, rootNode, forwards) {\n      if (isBoundary(dom, node)) {\n        return;\n      }\n      var rootBlock = dom.getParent(rootNode, dom.isBlock);\n      var walker = new global$2(node, rootBlock);\n      var walkerFn = forwards ? walker.next.bind(walker) : walker.prev.bind(walker);\n      walk(dom, walkerFn, node, {\n        boundary: always,\n        cef: always,\n        text: function (next) {\n          if (forwards) {\n            section.fOffset += next.length;\n          } else {\n            section.sOffset += next.length;\n          }\n          section.elements.push(SugarElement.fromDom(next));\n        }\n      });\n    };\n    var collect = function (dom, rootNode, startNode, endNode, callbacks, skipStart) {\n      if (skipStart === void 0) {\n        skipStart = true;\n      }\n      var walker = new global$2(startNode, rootNode);\n      var sections = [];\n      var current = nuSection();\n      collectTextToBoundary(dom, current, startNode, rootNode, false);\n      var finishSection = function () {\n        if (current.elements.length > 0) {\n          sections.push(current);\n          current = nuSection();\n        }\n        return false;\n      };\n      walk(dom, walker.next.bind(walker), startNode, {\n        boundary: finishSection,\n        cef: function (node) {\n          finishSection();\n          if (callbacks) {\n            sections.push.apply(sections, callbacks.cef(node));\n          }\n          return false;\n        },\n        text: function (next) {\n          current.elements.push(SugarElement.fromDom(next));\n          if (callbacks) {\n            callbacks.text(next, current);\n          }\n        }\n      }, endNode, skipStart);\n      if (endNode) {\n        collectTextToBoundary(dom, current, endNode, rootNode, true);\n      }\n      finishSection();\n      return sections;\n    };\n    var collectRangeSections = function (dom, rng) {\n      var start = toLeaf(rng.startContainer, rng.startOffset);\n      var startNode = start.element.dom;\n      var end = toLeaf(rng.endContainer, rng.endOffset);\n      var endNode = end.element.dom;\n      return collect(dom, rng.commonAncestorContainer, startNode, endNode, {\n        text: function (node, section) {\n          if (node === endNode) {\n            section.fOffset += node.length - end.offset;\n          } else if (node === startNode) {\n            section.sOffset += start.offset;\n          }\n        },\n        cef: function (node) {\n          var sections = bind(descendants(SugarElement.fromDom(node), '*[contenteditable=true]'), function (e) {\n            var ceTrueNode = e.dom;\n            return collect(dom, ceTrueNode, ceTrueNode);\n          });\n          return sort(sections, function (a, b) {\n            return documentPositionPreceding(a.elements[0].dom, b.elements[0].dom) ? 1 : -1;\n          });\n        }\n      }, false);\n    };\n    var fromRng = function (dom, rng) {\n      return rng.collapsed ? [] : collectRangeSections(dom, rng);\n    };\n    var fromNode = function (dom, node) {\n      var rng = dom.createRng();\n      rng.selectNode(node);\n      return fromRng(dom, rng);\n    };\n    var fromNodes = function (dom, nodes) {\n      return bind(nodes, function (node) {\n        return fromNode(dom, node);\n      });\n    };\n\n    var find = function (text, pattern, start, finish) {\n      if (start === void 0) {\n        start = 0;\n      }\n      if (finish === void 0) {\n        finish = text.length;\n      }\n      var regex = pattern.regex;\n      regex.lastIndex = start;\n      var results = [];\n      var match;\n      while (match = regex.exec(text)) {\n        var matchedText = match[pattern.matchIndex];\n        var matchStart = match.index + match[0].indexOf(matchedText);\n        var matchFinish = matchStart + matchedText.length;\n        if (matchFinish > finish) {\n          break;\n        }\n        results.push({\n          start: matchStart,\n          finish: matchFinish\n        });\n        regex.lastIndex = matchFinish;\n      }\n      return results;\n    };\n    var extract = function (elements, matches) {\n      var nodePositions = foldl(elements, function (acc, element) {\n        var content = get(element);\n        var start = acc.last;\n        var finish = start + content.length;\n        var positions = bind(matches, function (match, matchIdx) {\n          if (match.start < finish && match.finish > start) {\n            return [{\n                element: element,\n                start: Math.max(start, match.start) - start,\n                finish: Math.min(finish, match.finish) - start,\n                matchId: matchIdx\n              }];\n          } else {\n            return [];\n          }\n        });\n        return {\n          results: acc.results.concat(positions),\n          last: finish\n        };\n      }, {\n        results: [],\n        last: 0\n      }).results;\n      return groupBy(nodePositions, function (position) {\n        return position.matchId;\n      });\n    };\n\n    var find$1 = function (pattern, sections) {\n      return bind(sections, function (section) {\n        var elements = section.elements;\n        var content = map(elements, get).join('');\n        var positions = find(content, pattern, section.sOffset, content.length - section.fOffset);\n        return extract(elements, positions);\n      });\n    };\n    var mark = function (matches, replacementNode) {\n      eachr(matches, function (match, idx) {\n        eachr(match, function (pos) {\n          var wrapper = SugarElement.fromDom(replacementNode.cloneNode(false));\n          set(wrapper, 'data-mce-index', idx);\n          var textNode = pos.element.dom;\n          if (textNode.length === pos.finish && pos.start === 0) {\n            wrap(pos.element, wrapper);\n          } else {\n            if (textNode.length !== pos.finish) {\n              textNode.splitText(pos.finish);\n            }\n            var matchNode = textNode.splitText(pos.start);\n            wrap(SugarElement.fromDom(matchNode), wrapper);\n          }\n        });\n      });\n    };\n    var findAndMark = function (dom, pattern, node, replacementNode) {\n      var textSections = fromNode(dom, node);\n      var matches = find$1(pattern, textSections);\n      mark(matches, replacementNode);\n      return matches.length;\n    };\n    var findAndMarkInSelection = function (dom, pattern, selection, replacementNode) {\n      var bookmark = selection.getBookmark();\n      var nodes = dom.select('td[data-mce-selected],th[data-mce-selected]');\n      var textSections = nodes.length > 0 ? fromNodes(dom, nodes) : fromRng(dom, selection.getRng());\n      var matches = find$1(pattern, textSections);\n      mark(matches, replacementNode);\n      selection.moveToBookmark(bookmark);\n      return matches.length;\n    };\n\n    var getElmIndex = function (elm) {\n      var value = elm.getAttribute('data-mce-index');\n      if (typeof value === 'number') {\n        return '' + value;\n      }\n      return value;\n    };\n    var markAllMatches = function (editor, currentSearchState, pattern, inSelection) {\n      var marker = editor.dom.create('span', { 'data-mce-bogus': 1 });\n      marker.className = 'mce-match-marker';\n      var node = editor.getBody();\n      done(editor, currentSearchState, false);\n      if (inSelection) {\n        return findAndMarkInSelection(editor.dom, pattern, editor.selection, marker);\n      } else {\n        return findAndMark(editor.dom, pattern, node, marker);\n      }\n    };\n    var unwrap = function (node) {\n      var parentNode = node.parentNode;\n      if (node.firstChild) {\n        parentNode.insertBefore(node.firstChild, node);\n      }\n      node.parentNode.removeChild(node);\n    };\n    var findSpansByIndex = function (editor, index) {\n      var spans = [];\n      var nodes = global$1.toArray(editor.getBody().getElementsByTagName('span'));\n      if (nodes.length) {\n        for (var i = 0; i < nodes.length; i++) {\n          var nodeIndex = getElmIndex(nodes[i]);\n          if (nodeIndex === null || !nodeIndex.length) {\n            continue;\n          }\n          if (nodeIndex === index.toString()) {\n            spans.push(nodes[i]);\n          }\n        }\n      }\n      return spans;\n    };\n    var moveSelection = function (editor, currentSearchState, forward) {\n      var searchState = currentSearchState.get();\n      var testIndex = searchState.index;\n      var dom = editor.dom;\n      forward = forward !== false;\n      if (forward) {\n        if (testIndex + 1 === searchState.count) {\n          testIndex = 0;\n        } else {\n          testIndex++;\n        }\n      } else {\n        if (testIndex - 1 === -1) {\n          testIndex = searchState.count - 1;\n        } else {\n          testIndex--;\n        }\n      }\n      dom.removeClass(findSpansByIndex(editor, searchState.index), 'mce-match-marker-selected');\n      var spans = findSpansByIndex(editor, testIndex);\n      if (spans.length) {\n        dom.addClass(findSpansByIndex(editor, testIndex), 'mce-match-marker-selected');\n        editor.selection.scrollIntoView(spans[0]);\n        return testIndex;\n      }\n      return -1;\n    };\n    var removeNode = function (dom, node) {\n      var parent = node.parentNode;\n      dom.remove(node);\n      if (dom.isEmpty(parent)) {\n        dom.remove(parent);\n      }\n    };\n    var escapeSearchText = function (text, wholeWord) {\n      var escapedText = text.replace(/[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g, '\\\\$&').replace(/\\s/g, '[^\\\\S\\\\r\\\\n\\\\uFEFF]');\n      var wordRegex = '(' + escapedText + ')';\n      return wholeWord ? '(?:^|\\\\s|' + punctuation$1() + ')' + wordRegex + ('(?=$|\\\\s|' + punctuation$1() + ')') : wordRegex;\n    };\n    var find$2 = function (editor, currentSearchState, text, matchCase, wholeWord, inSelection) {\n      var escapedText = escapeSearchText(text, wholeWord);\n      var pattern = {\n        regex: new RegExp(escapedText, matchCase ? 'g' : 'gi'),\n        matchIndex: 1\n      };\n      var count = markAllMatches(editor, currentSearchState, pattern, inSelection);\n      if (count) {\n        var newIndex = moveSelection(editor, currentSearchState, true);\n        currentSearchState.set({\n          index: newIndex,\n          count: count,\n          text: text,\n          matchCase: matchCase,\n          wholeWord: wholeWord,\n          inSelection: inSelection\n        });\n      }\n      return count;\n    };\n    var next = function (editor, currentSearchState) {\n      var index = moveSelection(editor, currentSearchState, true);\n      currentSearchState.set(__assign(__assign({}, currentSearchState.get()), { index: index }));\n    };\n    var prev = function (editor, currentSearchState) {\n      var index = moveSelection(editor, currentSearchState, false);\n      currentSearchState.set(__assign(__assign({}, currentSearchState.get()), { index: index }));\n    };\n    var isMatchSpan = function (node) {\n      var matchIndex = getElmIndex(node);\n      return matchIndex !== null && matchIndex.length > 0;\n    };\n    var replace = function (editor, currentSearchState, text, forward, all) {\n      var searchState = currentSearchState.get();\n      var currentIndex = searchState.index;\n      var currentMatchIndex, nextIndex = currentIndex;\n      forward = forward !== false;\n      var node = editor.getBody();\n      var nodes = global$1.grep(global$1.toArray(node.getElementsByTagName('span')), isMatchSpan);\n      for (var i = 0; i < nodes.length; i++) {\n        var nodeIndex = getElmIndex(nodes[i]);\n        var matchIndex = currentMatchIndex = parseInt(nodeIndex, 10);\n        if (all || matchIndex === searchState.index) {\n          if (text.length) {\n            nodes[i].firstChild.nodeValue = text;\n            unwrap(nodes[i]);\n          } else {\n            removeNode(editor.dom, nodes[i]);\n          }\n          while (nodes[++i]) {\n            matchIndex = parseInt(getElmIndex(nodes[i]), 10);\n            if (matchIndex === currentMatchIndex) {\n              removeNode(editor.dom, nodes[i]);\n            } else {\n              i--;\n              break;\n            }\n          }\n          if (forward) {\n            nextIndex--;\n          }\n        } else if (currentMatchIndex > currentIndex) {\n          nodes[i].setAttribute('data-mce-index', String(currentMatchIndex - 1));\n        }\n      }\n      currentSearchState.set(__assign(__assign({}, searchState), {\n        count: all ? 0 : searchState.count - 1,\n        index: nextIndex\n      }));\n      if (forward) {\n        next(editor, currentSearchState);\n      } else {\n        prev(editor, currentSearchState);\n      }\n      return !all && currentSearchState.get().count > 0;\n    };\n    var done = function (editor, currentSearchState, keepEditorSelection) {\n      var i, startContainer, endContainer;\n      var searchState = currentSearchState.get();\n      var nodes = global$1.toArray(editor.getBody().getElementsByTagName('span'));\n      for (i = 0; i < nodes.length; i++) {\n        var nodeIndex = getElmIndex(nodes[i]);\n        if (nodeIndex !== null && nodeIndex.length) {\n          if (nodeIndex === searchState.index.toString()) {\n            if (!startContainer) {\n              startContainer = nodes[i].firstChild;\n            }\n            endContainer = nodes[i].firstChild;\n          }\n          unwrap(nodes[i]);\n        }\n      }\n      currentSearchState.set(__assign(__assign({}, searchState), {\n        index: -1,\n        count: 0,\n        text: ''\n      }));\n      if (startContainer && endContainer) {\n        var rng = editor.dom.createRng();\n        rng.setStart(startContainer, 0);\n        rng.setEnd(endContainer, endContainer.data.length);\n        if (keepEditorSelection !== false) {\n          editor.selection.setRng(rng);\n        }\n        return rng;\n      }\n    };\n    var hasNext = function (editor, currentSearchState) {\n      return currentSearchState.get().count > 1;\n    };\n    var hasPrev = function (editor, currentSearchState) {\n      return currentSearchState.get().count > 1;\n    };\n\n    var get$1 = function (editor, currentState) {\n      var done$1 = function (keepEditorSelection) {\n        return done(editor, currentState, keepEditorSelection);\n      };\n      var find = function (text, matchCase, wholeWord, inSelection) {\n        if (inSelection === void 0) {\n          inSelection = false;\n        }\n        return find$2(editor, currentState, text, matchCase, wholeWord, inSelection);\n      };\n      var next$1 = function () {\n        return next(editor, currentState);\n      };\n      var prev$1 = function () {\n        return prev(editor, currentState);\n      };\n      var replace$1 = function (text, forward, all) {\n        return replace(editor, currentState, text, forward, all);\n      };\n      return {\n        done: done$1,\n        find: find,\n        next: next$1,\n        prev: prev$1,\n        replace: replace$1\n      };\n    };\n\n    var value = function () {\n      var subject = Cell(Optional.none());\n      var clear = function () {\n        return subject.set(Optional.none());\n      };\n      var set = function (s) {\n        return subject.set(Optional.some(s));\n      };\n      var isSet = function () {\n        return subject.get().isSome();\n      };\n      var on = function (f) {\n        return subject.get().each(f);\n      };\n      return {\n        clear: clear,\n        set: set,\n        isSet: isSet,\n        on: on\n      };\n    };\n\n    var global$3 = tinymce.util.Tools.resolve('tinymce.Env');\n\n    var open = function (editor, currentSearchState) {\n      var dialogApi = value();\n      editor.undoManager.add();\n      var selectedText = global$1.trim(editor.selection.getContent({ format: 'text' }));\n      var updateButtonStates = function (api) {\n        var updateNext = hasNext(editor, currentSearchState) ? api.enable : api.disable;\n        updateNext('next');\n        var updatePrev = hasPrev(editor, currentSearchState) ? api.enable : api.disable;\n        updatePrev('prev');\n      };\n      var updateSearchState = function (api) {\n        var data = api.getData();\n        var current = currentSearchState.get();\n        currentSearchState.set(__assign(__assign({}, current), {\n          matchCase: data.matchcase,\n          wholeWord: data.wholewords,\n          inSelection: data.inselection\n        }));\n      };\n      var disableAll = function (api, disable) {\n        var buttons = [\n          'replace',\n          'replaceall',\n          'prev',\n          'next'\n        ];\n        var toggle = disable ? api.disable : api.enable;\n        each(buttons, toggle);\n      };\n      var notFoundAlert = function (api) {\n        editor.windowManager.alert('Could not find the specified string.', function () {\n          api.focus('findtext');\n        });\n      };\n      var focusButtonIfRequired = function (api, name) {\n        if (global$3.browser.isSafari() && global$3.deviceType.isTouch() && (name === 'find' || name === 'replace' || name === 'replaceall')) {\n          api.focus(name);\n        }\n      };\n      var reset = function (api) {\n        done(editor, currentSearchState, false);\n        disableAll(api, true);\n        updateButtonStates(api);\n      };\n      var doFind = function (api) {\n        var data = api.getData();\n        var last = currentSearchState.get();\n        if (!data.findtext.length) {\n          reset(api);\n          return;\n        }\n        if (last.text === data.findtext && last.matchCase === data.matchcase && last.wholeWord === data.wholewords) {\n          next(editor, currentSearchState);\n        } else {\n          var count = find$2(editor, currentSearchState, data.findtext, data.matchcase, data.wholewords, data.inselection);\n          if (count <= 0) {\n            notFoundAlert(api);\n          }\n          disableAll(api, count === 0);\n        }\n        updateButtonStates(api);\n      };\n      var initialState = currentSearchState.get();\n      var initialData = {\n        findtext: selectedText,\n        replacetext: '',\n        wholewords: initialState.wholeWord,\n        matchcase: initialState.matchCase,\n        inselection: initialState.inSelection\n      };\n      var spec = {\n        title: 'Find and Replace',\n        size: 'normal',\n        body: {\n          type: 'panel',\n          items: [\n            {\n              type: 'bar',\n              items: [\n                {\n                  type: 'input',\n                  name: 'findtext',\n                  placeholder: 'Find',\n                  maximized: true,\n                  inputMode: 'search'\n                },\n                {\n                  type: 'button',\n                  name: 'prev',\n                  text: 'Previous',\n                  icon: 'action-prev',\n                  disabled: true,\n                  borderless: true\n                },\n                {\n                  type: 'button',\n                  name: 'next',\n                  text: 'Next',\n                  icon: 'action-next',\n                  disabled: true,\n                  borderless: true\n                }\n              ]\n            },\n            {\n              type: 'input',\n              name: 'replacetext',\n              placeholder: 'Replace with',\n              inputMode: 'search'\n            }\n          ]\n        },\n        buttons: [\n          {\n            type: 'menu',\n            name: 'options',\n            icon: 'preferences',\n            tooltip: 'Preferences',\n            align: 'start',\n            items: [\n              {\n                type: 'togglemenuitem',\n                name: 'matchcase',\n                text: 'Match case'\n              },\n              {\n                type: 'togglemenuitem',\n                name: 'wholewords',\n                text: 'Find whole words only'\n              },\n              {\n                type: 'togglemenuitem',\n                name: 'inselection',\n                text: 'Find in selection'\n              }\n            ]\n          },\n          {\n            type: 'custom',\n            name: 'find',\n            text: 'Find',\n            primary: true\n          },\n          {\n            type: 'custom',\n            name: 'replace',\n            text: 'Replace',\n            disabled: true\n          },\n          {\n            type: 'custom',\n            name: 'replaceall',\n            text: 'Replace all',\n            disabled: true\n          }\n        ],\n        initialData: initialData,\n        onChange: function (api, details) {\n          if (details.name === 'findtext' && currentSearchState.get().count > 0) {\n            reset(api);\n          }\n        },\n        onAction: function (api, details) {\n          var data = api.getData();\n          switch (details.name) {\n          case 'find':\n            doFind(api);\n            break;\n          case 'replace':\n            if (!replace(editor, currentSearchState, data.replacetext)) {\n              reset(api);\n            } else {\n              updateButtonStates(api);\n            }\n            break;\n          case 'replaceall':\n            replace(editor, currentSearchState, data.replacetext, true, true);\n            reset(api);\n            break;\n          case 'prev':\n            prev(editor, currentSearchState);\n            updateButtonStates(api);\n            break;\n          case 'next':\n            next(editor, currentSearchState);\n            updateButtonStates(api);\n            break;\n          case 'matchcase':\n          case 'wholewords':\n          case 'inselection':\n            updateSearchState(api);\n            reset(api);\n            break;\n          }\n          focusButtonIfRequired(api, details.name);\n        },\n        onSubmit: function (api) {\n          doFind(api);\n          focusButtonIfRequired(api, 'find');\n        },\n        onClose: function () {\n          editor.focus();\n          done(editor, currentSearchState);\n          editor.undoManager.add();\n        }\n      };\n      dialogApi.set(editor.windowManager.open(spec, { inline: 'toolbar' }));\n    };\n\n    var register = function (editor, currentSearchState) {\n      editor.addCommand('SearchReplace', function () {\n        open(editor, currentSearchState);\n      });\n    };\n\n    var showDialog = function (editor, currentSearchState) {\n      return function () {\n        open(editor, currentSearchState);\n      };\n    };\n    var register$1 = function (editor, currentSearchState) {\n      editor.ui.registry.addMenuItem('searchreplace', {\n        text: 'Find and replace...',\n        shortcut: 'Meta+F',\n        onAction: showDialog(editor, currentSearchState),\n        icon: 'search'\n      });\n      editor.ui.registry.addButton('searchreplace', {\n        tooltip: 'Find and replace',\n        onAction: showDialog(editor, currentSearchState),\n        icon: 'search'\n      });\n      editor.shortcuts.add('Meta+F', '', showDialog(editor, currentSearchState));\n    };\n\n    function Plugin () {\n      global.add('searchreplace', function (editor) {\n        var currentSearchState = Cell({\n          index: -1,\n          count: 0,\n          text: '',\n          matchCase: false,\n          wholeWord: false,\n          inSelection: false\n        });\n        register(editor, currentSearchState);\n        register$1(editor, currentSearchState);\n        return get$1(editor, currentSearchState);\n      });\n    }\n\n    Plugin();\n\n}());\n"]}