{"version":3,"sources":["table/plugin.js"],"names":["t","isType","type","value","x","Array","prototype","isPrototypeOf","constructor","name","String","isSimpleType","isString","isObject","isArray","isBoolean","isUndefined","undefined","a","isNonNullable","isNullable","isFunction","isNumber","noop","constant","identity","curry","fn","initialArgs","_i","arguments","length","restArgs","all","concat","apply","not","f","never","always","none","NONE","eq","o","isNone","call","thunk","id","n","fold","_s","is","isSome","getOr","getOrThunk","getOrDie","msg","Error","getOrNull","getOrUndefined","or","orThunk","map","each","bind","exists","forall","filter","equals","equals_","toArray","toString","some","constant_a","self","me","s","v","elementEq","b","Optional","from","nativeSlice","slice","nativeIndexOf","indexOf","nativePush","push","contains","xs","ts","rawIndexOf","pred","i","len","range","num","r","foldr","acc","eachr","foldl","find","until","findUntil","findIndex","flatten","mapToObject","pure","get","head","last","findMap","arr","__assign","Object","assign","p","hasOwnProperty","this","__spreadArrays","il","k","j","jl","cached","called","args","unknown","nu","major","minor","Version","detect","versionRegexes","agent","cleanedAgent","toLowerCase","regexes","test","firstMatch","group","Number","replace","find$1","detect$1","candidates","userAgent","candidate","search","UaString","browsers","browser","version","current","oses","os","checkRange","str","substr","start","contains$1","startsWith","prefix","endsWith","suffix","trim","blank","isNotEmpty","normalVersionRegex","checkContains","target","uastring","PlatformInfo","edge","chrome","opera","firefox","safari","nu$1","info","isBrowser","isEdge","isChrome","isIE","isOpera","isFirefox","isSafari","Browser","ie","windows","android","linux","solaris","freebsd","chromeos","nu$2","isOS","isWindows","isiOS","isAndroid","isOSX","isLinux","isSolaris","isFreeBSD","isChromeOS","OperatingSystem","ios","osx","PlatformDetection","mediaMatch","deviceType","isiPad","isiPhone","isMobile","isTouch","isTablet","isPhone","iOSwebview","isDesktop","isWebView","DeviceType","query","window","matchMedia","matches","platform","navigator","detect$3","fromDom","node","dom","SugarElement","fromHtml","html","scope","div","document","createElement","innerHTML","hasChildNodes","childNodes","console","error","fromTag","tag","fromText","text","createTextNode","fromPoint","docElm","y","elementFromPoint","element","selector","nodeType","elem","msMatchesSelector","webkitMatchesSelector","mozMatchesSelector","bypassSelector","childElementCount","eq$1","e1","e2","ieContains","match","compareDocumentPosition","Node","DOCUMENT_POSITION_CONTAINED_BY","contains$2","d1","d2","regularContains","is$1","keys","each$1","obj","props","map$1","tupleMap","tuple","filter$1","onTrue","onFalse","internalFilter","objAcc","mapToArray","size","get$1","key","has","hasNonNullableKey","validSectionList","detail","rowspan","colspan","rowdata","cells","section","elementnew","isNew","isLocked","rowcells","Function","nodeName","isType$1","isComment","isElement","isText","isDocument","isDocumentFragment","isTag","e","owner","ownerDocument","documentOrOwner","dos","parent","parentNode","parents","isRoot","stop","ret","rawParent","prevSibling","previousSibling","nextSibling","children","child","index","cs","supported","Element","attachShadow","getRootNode","isSupported","getShadowRoot","host","getShadowHost","isOpenShadowHost","shadowRoot","inBody","fbc","fab","doc","body","getBody","descendants","predicate","result","ancestors$1","ancestors","children$2","children$1","descendants$1","base","querySelectorAll","ClosestOrAncestor","ancestor","el","ancestor$1","child$2","child$1","descendant$1","querySelector","one","closest$1","rawSet","setAttribute","set","setAll","attrs","get$2","getAttribute","getOpt","remove","removeAttribute","clone","attributes","attr","isSupported$1","style","getPropertyValue","internalSet","property","setProperty","set$1","setAll$1","css","get$3","getComputedStyle","getUnsafeProperty","getRaw","raw","remove$1","removeProperty","internalRemove","getAttrValue","cell","fallback","parseInt","getSpan","hasColspan","hasRowspan","getCssValue","minWidth","minHeight","firstLayer","filterFirstLayer","tags","join","elm","lookup","columns","columnGroups","columnGroup","table","rows","fromRowsOrColGroups","elems","getSection","row","cells$1","column","getParentSection","parentName","isValidSection","fromTable","rows$1","addCells","gridRow","existingCells","before","after","newCells","setCells","addCell","mutateCell","mapCells","getCell","getCellElement","cellLength","extractGridDetails","grid","pass","fail","partition","cols","LOCKED_COL_ATTR","getLockedColumnsFromTable","lockedColStr","lockedCols","getLockedColumnsFromGrid","locked","idx","comparator","copy","sort","_val","filterItems","warehouse","generate","list","access","lockedColumns","rowData","maxRows","maxColumns","rowCount","columnsGroup","columnIndex","colIndex","columnext","generateColumns","currentRow_1","rowCell","extended","occupiedColumnPosition","occupiedRowPosition","columnPosition","newpos","Math","max","Warehouse","getAt","findItem","item","filtered","justCells","w","justColumns","hasColumns","getColumnAt","inSelection","bounds","leftEdge","rightEdge","topEdge","bottomEdge","finishCol","startCol","finishRow","startRow","isWithin","getAnyBox","startCell","finishCell","startCoords","finishCoords","sc","fc","detailA","detailB","min","getBox","isRect","detailIsWithin","isRectangular","intercepts","finish","inside","parentCell","innerCell","c1","c2","moveBy$1","deltaRow","deltaColumn","d","moveBy","getWarehouse","intercepts$1","first","nestedIntercepts","firstTable","lastTable","optStartCell","optLastCell","lastCell","marker","insertBefore","append","prepend","firstChild","appendChild","wrap","wrapper","after$1","elements","append$1","empty","textContent","rogue","remove$2","removeChild","unwrap","api","getOption","nodeValue","NodeValue","get$4","set$2","TagBoundaries","DomUniverse","up","closest","down","styles","copyTo","source","destination","as","insert","afterAll","appendAll","create","cloneNode","comparePosition","other","isSpecial","getText","setText","isBoundary","isEmptyTag","isNonEditable","decimalDigits","exponentPart","opt","unsignedDecimalLiteral","unsafeOne","universe","look","tail","commonElement","end","sharedOne","all$1","ancestors$3","ps1","ps2","prune","path","ind","pruned1","pruned2","shared","eq$2","firstpath","secondpath","sharedOne$1","_universe","lookupTable","container","identify","getIsRoot","rootTable","boxes","startTable","finishTable","ancestorCells","ancestors$4","lca","lcaTable","finishAncestorCells","startAncestorCells","retrieve","sels","getEdges","firstSelectedSelector","lastSelectedSelector","shiftSelection","box","getLast","identified","expandTo","retrieve$1","retrieveBox","edges","sectionSelector","firstAncestor","lastAncestor","fA","lA","getBox$1","Adt","cases","constructors","adt","acase","count","keys$1","argLength","branches","branchKeys","reqKey","foldArgs","log","label","params","type$1","multiple","single","cata","subject","onNone","onMultiple","onSingle","none$1","global","tinymce","util","Tools","resolve","clone$1","original","isDeep","shallow","deep","copy$1","shallowAs","cloneChildren","cat","someIf","Dimension","getOffset","parseFloat","aggregate","properties","val","isNaN","h","getOuter","cumulativeInclusions","api$1","offsetWidth","get$5","columns$1","isValidCell","rowsArr","col","decide","getBlock","isValid","getFallback","inBlock","c","deduce","rest","reverse","aa","delta","next","extras","abs","onDirection","isLtr","isRtl","getDirection","api$2","getBoundingClientRect","height","offsetHeight","get$6","getOuter$1","left","top","translate","SugarPosition","firstDefinedOrZero","absolute","win","defaultView","documentElement","offsetLeft","offsetTop","scrollTop","pageYOffset","scrollLeft","pageXOffset","clientTop","clientLeft","viewport","boxPosition","rowInfo","colInfo","rtlEdge","ltrEdge","getLeftEdge","getRightEdge","getTop","getTopEdge","getBottomEdge","findPositions","getInnerEdge","getOuterEdge","array","lines","cellOption","lastLine","positions","optElements","ltr","rtl","step","detect$4","width","amount","units","unsupportedLength","fixed","relative","pattern","input","dot","RegExp","parse","accepted","exec","unitRaw","unit","check","isUnit","needManualCalc","getProp","px","toNumber","getHeight","getCalculatedHeight","getWidth","getCalculatedWidth","rPercentageBasedSizeRegex","rPixelBasedSizeRegex","getPercentSize","getter","relativeParent","offsetParent","setPixelWidth","setPercentageWidth","setHeight","normalizePixelSize","setter","number","newSize","total","floor","convert","getTotalHeight","getHeightValue","getRawWidth","normalizePercentageWidth","cellWidth","tableSize","pixelWidth","getPercentageWidth","intWidth","percentMatch","choosePercentageSize","getPixelWidth","pixelMatch","normalizePixelWidth","choosePixelSize","getHeight$1","get$7","setGenericWidth","getPercentTableWidth","percentageBasedSizeRegex","pixelBasedSizeRegex","isCol","getRaw$1","getRawW","getRawH","hasRawStyle","prop","getDimension","cellOpt","backups","getWidthFrom","columnCells","justCols","pos","colFilter","isValidColumn","getDeduced","deduced","getPixelWidths","minCellWidth","getHeightFrom","direction","Cell","initial","noneSize","zero","getWidths","getCellDelta","singleColumnWidth","setElementWidth","adjustTableWidth","isRelative","percentageSize","initialWidth","floatWidth","getPercentageWidths","_delta","currentWidth","newWidth","pixelSize","TableSize","fallbackWidth","chooseSize","makeCell","seenSelected","rowIndex","td","extract","selectedSelector","isSelected","replica","replicaHouse","replicaStats","house","totalColumns","minRow","minCol","maxRow","maxCol","allCells","selectedCells","endRow","endCol","statsStruct","findSelectedStats","unselectedCells","stats","totalRows","fillInGaps","widthDelta","emptyRows","clean","colWidths","allColsWidth","getTableWidthDelta","getEnd","elementsWithCursorPosition","isCursorPosition","descend","child_1","res","last$1","descendantRtl","transferableAttributes","createCell","createCol","createColgroup","pasteReplace","newRow","cellOperations","mutate","formatsToClone","cloneCss","prev","sourceDom","targetDom","cssText","colgroup","docu","formats","lastNode","oldCell","newCell","firstText","formatSelector","clonedFormat","cloneFormats","validAttributes","attributeName","attribute","cloneAppropriateAttributes","gap","paste","fromDom$1","nodes","getNodeName","getBody$1","editor","getPixelWidth$1","getPixelHeight","addPxSuffix","removeDataStyle","removeStyleAttribute","getRawWidth$1","getStyle","getAttrib","isPercentage","getSelectionStart","selection","getStart","selections","unmergable","hasSpan","span","mergable","ephemera","strSelected","strFirstSelected","strLastSelected","selected","firstSelected","lastSelected","forMenu","registerEvents","actions","cellSelection","on","preventDefault","extractSelected","content","format","innerText","getTextContent","serializer","serialize","serializeElements","getParent","domCell","getDoc","generators","targets","clipboard","paste$1","pasteCells","data","setRng","rng","focus","clear","only","middle","right","ColumnContext","determine","resize","context","neighbours","calcLeftEdgeDeltas","calcMiddleDeltas","calcRightEdgeDeltas","measures","recalculateHeightForCells","heights","recalculate","widths","groups","recalculateWidthForColumns","recalculateWidthForCells","recalculateAndApply","newSizes","adjustWidth","resizing","isLastColumn","clampedStep","clampTableDelta","deltas","newWidths","dx","resizeTable","adjustHeight","getPixelHeights","newHeights","dy","newCellSizes","newRowSizes","matchRowHeight","surround","sizes","startIndex","endIndex","results","clampDeltaHelper","minCellSize","diff","clampNegativeDelta","clampDelta","calcRelativeDeltas","ratio","newThis","clampedDelta","calcFixedDeltas","resizer","_prev","calcRedestributedWidths","totalWidth","pixelDelta","ratio_1","preserveTable","maxDelta","_index","_minCellSize","_totalWidth","_pixelDelta","_isRelative","ResizeWire","isResizable","view","origin","editable","adt$1","invalid","pixels","percent","validateFor","rawAmount","substring","Size","redistributeValues","newWidthType","newTotalWidth","scale","pc","redistributeToPx","_pc","redistributeToPercent","redistribute","newType","floats","redistributeEmpty","normalize","sum","values","add","scan","remainder","floored","roundDown","output","round","validate","getUnit","redistribute$1","optWidth","optHeight","widthUnit","oldWidths","getRawWidths","nuWidths","redistributeToColumns","redistributeToW","newHeight","hUnit","totalHeight","oldHeights","getRawHeights","redistributeToH","isPercentSizing$1","isPixelSizing$1","isNoneSizing$1","getPercentTableWidth$1","getGridSize","Event","fields","handlers","handler","unbind","trigger","event","typeDefs","registry","sort$1","baseWith","handleUnsupported","required","sorted","validateStrArr","req","reqMessage","invalidKeys","incorrect","invalidTypeMessage","handleExact","unsupported","unsuppMessage","exactly","DragMode","DragSink","DragApi","InDrag","previous","events","move","onEvent","mode","old","compare","update","reset","Movement","noDragState","inDragState","dragState","off","isOn","setup","mutation","settings","rate","timer","active","movement","drop","sink","throttledDrop","cancel","clearTimeout","throttle","setTimeout","runIfActive","forceDrop","delayDrop","go","destroy","fromRawEvent","rawEvent","fa","fb","composed","composedPath","getOriginalEventTarget","stopPropagation","prevent","kill","mkEvent","clientX","clientY","binder","useCapture","wrapped","handle","addEventListener","removeEventListener","filter$2","bind$2","bind$1","fromRawEvent$1","read","split","supports","classList","add$2","clazz","add$1","add$3","has$1","namespace","dashNamespace","MouseDrag","dragApi","blocker","options","layerClass","position","Blocker","mdown","mup","mmove","mout","isContentEditableTrue","styles$1","resolve$1","BarMutation","drag","delegate","Mutation","xDelta","yDelta","resizeBar","resizeRowBar","resizeColBar","wire","drawBar","cpOption","cp","bar","refreshCol","colPositions","tableHeight","colBar","role","refreshRow","rowPositions","tableWidth","rowBar","refreshGrid","warhouse","resizableRowBars","resizableRows","resizableRowPositions","_pos","barIndex","resizableColBars","resizableCols","resizableColumns","resizableColPositions","refresh","each$2","bars","hide","show","resizeBarDragging","BarManager","transform","hoverTable","getResizer","_dataRow","currentRow","_dataCol","currentCol","getDelta","dir","startAdjust","mousedown","isColBar","findClosestEditableTable","findClosestContentEditable","mouseover","tbl","hideBars","showBars","TableResize","lazySizing","hdirection","vdirection","manager","beforeResize","afterResize","startDrag","_event","fireNewRow","fire","fireNewCell","fireTableModified","styleModified","structure","structureModified","defaultStyles","defaultAttributes","border","defaultColumnResizingBehaviour","getTableSizingMode","getParam","getTableResponseWidth","getDefaultAttributes","getDefaultStyles","isPixelsForced","editorWidth","isResponsiveForced","_value","determineDefaultStyles","hasAdvancedCellTab","hasAdvancedRowTab","hasAdvancedTableTab","shouldStyleWithCss","isPercentagesForced","useColumnGroup","getTableHeaderType","defaultValue","getColumnResizingBehaviour","givenMode","isPreserveTableColumnResizing","isResizeTableColumnResizing","getCloneElements","cloneElements","get$9","cleanupLegacyAttributes","convertToPixelSize","getPixelTableWidth","enforcePercentage","convertToPercentSize","enforcePixels","tableSizing","enforceNone","rowElements","createContainer","padding","margin","barResizerPrefix","getResizeHandler","startW","startRawW","selectionRng","isTable","lazyResize","lazyResizingBehaviour","afterCornerResize","isRightEdgeResize","getNumColumns","percentW","isPixel","computedWidth","syncPixels","rawWire","inline","get$a","objectResizing","hasObjectResizing","hasTableResizeBars","sz","getRng","rawTable","fireObjectResizeStart","fireObjectResized","undoManager","targetElm","select","addClass","origin_1","isReadOnly","lazyWire","remove$6","point","offset","toEnd","freefallRtl","freefallRtl$1","universe$1","halve","main","getGenericWidth","setIfNot","ignore","render","newRows","syncRows","gridSection","tr","syncColGroup","colGroup","renderSection","sectionName","newSection","generateSection","sectionElems","renderOrRemoveSection","removeSection","headSection","bodySection","footSection","columnGroupsSection","findDiff","comp","subgrid","restOfRow","getRow","endColIndex","restOfColumn","getColumn","toDetails","seen","details","rowdetails","updateSeen","toGrid","groupElementNew","rowCells","deriveRows","rendered","findRow","rowdatanew","toDetailList","findInWarehouse","extractCells","cell$1","lc","run","operation","adjustment","postAction","genWrappers","sizing","resizeBehaviour","model","fromWarehouse","cursor","out","newElements","onCell","onPasteByEditor","onCells","onUnlockedCell","onUnlockedCells","allUnlocked","isUnlockedTableCell","onUnlockedMergable","_warehouse","onMergable","mergeable","onUnlockedUnmergable","onUnmergable","unmerge","substitution","currentCell","isToReplace","splitRows","uniqueCells","replacement","_loop_1","sub","isValue","isError","_opt","_f","_","onValue","mapError","toOptional","message","onError","Result","fromOption","err","measureWidth","gridA","gridB","rowDelta","colDelta","measureHeight","generateElements","generator","rowFill","colFill","newChildren","tailor","fillCols","fillRows","gridWidth","isLastColLocked","modifiedCols","newLockedColumns","isSpanning","matching","getLockedColumnsWithinBounds","startAddress","colNum","merge$1","validStartAddress","currentStartAddress","gridColLength","adjustedRowAddress","possibleColAddresses","getValidStartAddress","gridBRows","lockedColumnsWithinBounds","rowRemainder","colRemainder","colRequired","rowRequired","measure","fittedGrid","newLockedColumnsWithinBounds","lockedColumnObj","skippedCol","gridBColIndex","newCellElm","mergeTables","insertCols","prevCell","splitCols","fittedNewGrid","secondDelta","fittedOldGrid","insertRows","_a","oldCols","oldRows","newLocked","secondDiff","fittedGridB","newChild","lockedColFill","insertRowAt","example","between","ex","insertColumnAt","withinSpan","getElementFor","replaceIn","isTarget","notStartRow","notStartColumn","replaceColumn","replaceRow","targetRow","uniqueColumns","currentDetail","elementToData","getScopeAttribute","Generators","toData","nuFrom","recent","getOrInit","makeNew","replaceOrInit","merge","stringAttributes","baseScope_1","scopes_1","getScopeProperty","blockList","universe$2","isBlock$1","tagName","isBlock","isList$1","isList","isEmptyTag$1","merge$2","isBr","markCell","rightSiblingIsBlock","rightSibling","isListItem","contents","advancedBr","outcome","elementFromGrid","findIn","bundle","uniqueRows","gridifyRows","pasteDetails","wh","getCellsType","headerPred","headerCells","_table","_info","adjustAndRedistributeWidths$1","tablePixelWidth","firstColumnIsLocked","lastColumnIsLocked","getColumnsWidth","uniqueCols","insertColumnsExtractor","pasteColumnsExtractor","insertRowsBefore","targetIndex","newGrid","insertRowsAfter","newG","insertColumnsBefore","extractDetail","insertColumnsAfter","eraseColumns","_comparator","_genWrappers","deleteColumnsAt","eraseRows","deleteRowsAt","makeColumnsHeader","initialGrid","currentGrid","unmakeColumnsHeader","mergeCells","unmergeCells","gridify","address","pasteColsBefore","mergedGrid","pasteColsAfter","pasteRowsBefore","pasteRowsAfter","getColumnType","lastSelectedCell","minColRange","maxColRange","selectedColumnCells","detectHeaderRow","isThead","areAllCellsThs","thead","ths","getRowType","_rowConfig","switchRowSection","rowElm","newSectionName","tableElm","oldSectionElm","oldSectionName","sectionElm_1","firstTableChild_1","insertAfter","switchCellType","newCellType","rename","renameCell","setAttrib","switchCellsType","switchSectionType","allTableRows","headerRowTypeSetting","headerRowType","detectedType","getSelectionStartFromSelector","startCellName","getSelectionStartCellFallback","getSelectionStartCell","getSelectionStartCellOrCaption","getCellsFromSelection","_cell","getRowsFromSelection","oa","ob","rowsOpt","TableActions","isTableBody","colMutationOp","execute","guard","effect","des","createRng","setStart","setEnd","deleteRow","deleteColumn","insertRowsBefore$1","insertRowsAfter$1","insertColumnsBefore$1","insertColumnsAfter$1","mergeCells$1","unmergeCells$1","pasteColsBefore$1","pasteColsAfter$1","pasteRowsBefore$1","pasteRowsAfter$1","pasteCells$1","extractType","validTypes","setTableCellType","setTableRowType","getTableRowType","rowTypes","hasHeader","hasFooter","hasBody","getTableCellType","getTableColType","DefaultRenderOptions","colGroups","createGroupRow","createRows","rowHeaders","columnHeaders","createRow","placeCaretInCell","collapse","insert$1","colHeaders","headerType","renderOpts","rowHeadersGoInThead","actualRowHeaders","theadRows","tbody","tbodyRows","render$1","get$b","getOuter$2","insertContent","addVisual","isPercentage$1","fireEvents","selectFirstCellInTable","insertTableWithDataValidation","errorMsg","checkInput","headerRows","headerColumns","getClipboardElements","getClipboard","setClipboardElements","setClipboard","elmsOpt","insertTable","constrainSpan","currentColspan","copyCols","colsToCopy","copiedCols","clonedCol","fakeColgroup","generateColGroup","cellsToCopy","copiedCells","clonedCell","fakeTR","generateRows","copyRows","slicedGrid","filteredGrid","slicedDetails","copy$2","global$1","getTDTHOverallStyle","firstChildStyle","elms","currentStyle","checkChildren","applyAlign","formatter","unApplyAlign","buildListItems","inputList","startItems","title","isListGroup","items","menu","appendItems","rgbToHex","toHex","extractAdvancedStyles","borderwidth","borderstyle","bordercolor","backgroundcolor","getSharedValues","baseData","comparisonData","itemValue","itemKey","comparisonValue","getAdvancedTab","dialogName","advTabItems","getAlignment","formatName","matchNode","getHAlignment","getVAlignment","children$3","getItems","classes","getCellClassList","getClassList","modifiers","testTruthy","setStyle","setFormat","DomModifier","normal","ifTruthy","getSelectedCells","cellA","cellB","applyCellData","oldData","isSingleCell","modifiedData","tableOpt","cellElm","celltype","modifier","colModifier","class","updateSimpleProps","updateAdvancedProps","unApplyVAlign","halign","valign","applyVAlign","styleModified_1","onSubmitCellForm","getData","close","transact","cellsData","colElm","extractDataFromCellElement","open","dialogTabPanel","tabs","dialogPanel","windowManager","buttons","primary","initialData","onSubmit","formChildren","getItems$1","getRowClassList","getClassList$1","applyRowData","isSingleRow","updateSimpleProps$1","updateAdvancedProps$1","align","typeModified_1","onSubmitRowForm","open$1","rowsData","extractDataFromRowElement","global$2","getItems$2","insertNewTable","rowColCountItems","inputMode","appearanceItems","hasAppearanceOptions","classListItem","styleTDTH","onSubmitTableForm","captionElm","removePxSuffix","cellspacing","cellpadding","serializeStyle","setAttribs","applyDataToElement","caption","captionModified","open$2","hasAdvTableTab","spacing","borderWidth","advStyle","extractDataFromSettings","optBorderWidth","getBorder","extractDataFromTableElement","getTableClassList","generalPanel","dialogBody","getSelectionStartCellOrCaption$1","getSelectionStartCell$1","registerCommands","getTableFromCell","postExecute","actOnSelection","copyRowSelection","copyColSelection","pasteOnSelection","getRows","clonedRows","pasteRows","mceTableSplitCells","mceTableMergeCells","mceTableInsertRowBefore","mceTableInsertRowAfter","mceTableInsertColBefore","mceTableInsertColAfter","mceTableDeleteCol","mceTableDeleteRow","mceTableCutCol","_grid","setColumns","mceTableCutRow","setRows","mceTableCopyCol","mceTableCopyRow","mceTablePasteColBefore","getColumns","mceTablePasteColAfter","mceTablePasteRowBefore","mceTablePasteRowAfter","mceTableDelete","cellOrCaption","isEmpty","setContent","setCursorLocation","nodeChanged","mceTableSizingMode","ui","setSizingMode","func","addCommand","fireTableModifiedForSelection","mceTableCellType","_ui","mceTableRowType","mceTableProps","mceTableRowProps","mceTableCellProps","getFormatName","validArgs","registerQueryCommands","mceTableColType","addQueryValueHandler","cellFormats","tablecellbackgroundcolor","backgroundColor","remove_similar","tablecellbordercolor","borderColor","tablecellborderstyle","borderStyle","tablecellborderwidth","adt$2","CellLocation","detect$5","SimRange","soffset","foffset","adt$3","Situ","onBefore","onOn","onAfter","situ","adt$4","domRange","exact","SimSelection","exactFromRange","simRange","getWin","startContainer","startSitu","_finishSitu","_soffset","_finish","_foffset","getStart$1","selectNodeContentsUsing","selectNodeContents","relativeToNative","finishSitu","createRange","setStartBefore","setStartAfter","setEndBefore","setEndAfter","setFinish","exactToNative","toRect","rect","bottom","adt$5","fromRange","startOffset","endContainer","endOffset","diagnose","ranges","collapsed","rev","doDiagnose","getRanges","asLtrRange","inRect","locateOffset","textnode","rangeForOffset","rectForOffset","maxX","curDeltaX","searchForPoint","locateNode","selectNode","rects","getClientRects","locate","searchInChildren","getCollapseDirection","createCollapsedNode","collapseDirection","locateInElement","cursorRange","locateInEmpty","caretPositionFromPoint","offsetNode","caretRangeFromPoint","searchTextNodes","boundedX","boundedY","locate$1","searchFromPoint","availableSearch","beforeSpecial","name$1","preprocessRelative","preprocessExact","after$3","makeRange","same","getNativeSelection","getSelection","doSetNativeRange","removeAllRanges","addRange","doSetRange","setRangeFromRelative","setBaseAndExtent","extend","setLegacyRtlRange","setExact","setRelative","toNative","getDomRange","preprocess","readRange","rangeCount","firstRng","getRangeAt","lastRng","doGetExact","anchorNode","focusNode","anchor","focus_1","anchorOffset","focusOffset","setToElement","get$c","sel","getExact","getFirstRect$1","getFirstRect","getAtPoint","fromPoint$1","global$3","forward","backward","getCellFirstCursorPosition","execCommand","getNewRowCursorPosition","rootElements","Response","Situs","convertToRange","makeSitus","detect$6","selectRange","cellSel","traverse","backtrack","_direction","transition","sidestep","advance","sibling","successors","go$1","rules","succ","rule","Walkers","hone","isLeaf","seekLeft","seekRight","universe$3","before$4","before$3","after$5","after$4","adt$6","success","failedUp","failedDown","isRow","BeforeAfter","verify","bridge","beforeOffset","afterOffset","failure","afterCell","beforeCell","beforeBounds","getRect","afterBounds","isOverlapping","_sharedRow","onSuccess","onFailedUp","onFailedDown","gatherer","cand","gather","handleParent","findBr","br","adjacent","inParent","indexInParent","tryBr","handleBr","tgt","moveDown","caret","moveUp","toCaret","getElemBox","getBoxAt","getRangedRect","getPartialBox","getEntireBox","adt$7","retry","inOutsideBlock","isOutside","downMovement","adjuster","guessBox","lowerCaret","adjustTil","numRetries","isAtTable","adjustForTable","situsFromPoint","guess","newCaret","moved","adjusted","getInnerHeight","checkScroll","scrollBy","Retries","tryUp","higherCaret","tryDown","ieTryUp","ieTryDown","getJumpSize","findSpot","brNeighbour","fromSitus","analysis","_message","process","scan$1","tryCursor","situs","tryAgain","tryAt","otherRetry","ieRetry","inSameTable","simulate","spot","handle$2","navigate","precheck","firstUpCheck","seekLeft$1","lastOffset","lastDownCheck","seekRight$1","findCell","MouseSelection","annotations","isSet","clearstate","applySelection","clearBeforeUpdate","selectContents","mouseup","isKey","keycode","isUp","isDown","isNavigation","ltr$2","isBackward","isForward","rtl$2","WindowBridge","exactAdt","clearSelection","collapseSelection","toStart","setSelection","setRelativeSelection","innerHeight","getScrollY","_DOC","by","rc","keyboard","clearToNavigate","keydown","realEvent","which","shiftKey","update$1","attempts","newSels","keyup","sync","SelectionAnnotation","onSelection","onClear","removeSelectionAttributes","addSelectionAttribute","getOtherCells","upOrLeftCells","upGrid","upDetails","slicedCells","getUpOrLeftCells","downOrRightCells","downGrid","downDetails","getDownOrRightCells","hasInternalTarget","CellSelection","selectionTargets","otherCells","fireTableSelectionChange","fireTableSelectionClear","_e","mouseHandlers","mouse","keyHandlers","external$1","external","lastTarget","lastTimeStamp","handleResponse","response","hasShiftKey","ns","isLeftMouse","button","doubleTap","touchEnd","lT","lTS","timeStamp","wrappedEvent","getSelectionTargets","changeHandlers","selectionDetails","isCaption","isDisabledForSelection","findTargets","noMenu","getExtractedDetails","onAny","onFirst","onLast","unmergeable","resetTargets","onSetup","isDisabled","setDisabled","isDisabledFromLocked","lockedDisable","onSetupTable","onSetupCellOrRow","onSetupColumn","onSetupPasteable","getClipboardData","onSetupPasteableColumn","onSetupMergeable","_targets","onSetupUnmergeable","Plugin","lazyRoot","Selections","resizeHandler","clearClipboard","clearRows","clearColumns","Clipboard","cmd","command","insertTableAction","numRows","numColumns","tableProperties","onAction","deleteTable","icon","addMenuItem","hasTableGrid","addNestedMenuItem","getSubmenuItems","fancytype","addContextMenu","addMenuItems","addMenuButton","tooltip","fetch","callback","addButton","addButtons","toolbar","getToolbar","addContextToolbar","addToolbars","addTempAttr","register","registerFormats","hasTabNavigation","keyCode","TAB","body_1","isRoot_1","handle$1","setClipboardRows","getClipboardRows","setClipboardCols","getClipboardCols","getApi"],"mappings":"CAQC,WACG,aAEA,IAsBmBA,EAVfC,EAAS,SAAUC,GACrB,OAAO,SAAUC,GACf,OAbEH,SADiBI,EAcLD,IAZN,OAANC,EACK,OACQ,WAANJ,IAAmBK,MAAMC,UAAUC,cAAcH,IAAMA,EAAEI,aAAsC,UAAvBJ,EAAEI,YAAYC,MACxF,QACQ,WAANT,IAAmBU,OAAOJ,UAAUC,cAAcH,IAAMA,EAAEI,aAAsC,WAAvBJ,EAAEI,YAAYC,MACzF,SAEAT,KAKkBE,EAdhB,IAAUE,EACjBJ,IAgBFW,EAAe,SAAUT,GAC3B,OAAO,SAAUC,GACf,cAAcA,IAAUD,IAQxBU,EAAWX,EAAO,UAClBY,EAAWZ,EAAO,UAClBa,EAAUb,EAAO,SACjBc,EAAYJ,EAAa,WACzBK,GATehB,OASEiB,EARZ,SAAUC,GACf,OAAOlB,IAAMkB,IAWbC,EAAgB,SAAUD,GAC5B,OAJe,SAAUA,GACzB,OAAOA,MAAAA,EAGCE,CAAWF,IAEjBG,EAAaV,EAAa,YAC1BW,EAAWX,EAAa,UAExBY,EAAO,aAgBPC,EAAW,SAAUrB,GACvB,OAAO,WACL,OAAOA,IAGPsB,EAAW,SAAUrB,GACvB,OAAOA,GAET,SAASsB,EAAMC,GAEb,IADA,IAAIC,EAAc,GACTC,EAAK,EAAGA,EAAKC,UAAUC,OAAQF,IACtCD,EAAYC,EAAK,GAAKC,UAAUD,GAElC,OAAO,WAEL,IADA,IAAIG,EAAW,GACNH,EAAK,EAAGA,EAAKC,UAAUC,OAAQF,IACtCG,EAASH,GAAMC,UAAUD,GAE3B,IAAII,EAAML,EAAYM,OAAOF,GAC7B,OAAOL,EAAGQ,MAAM,KAAMF,IAG1B,IAAIG,EAAM,SAAUC,GAClB,OAAO,SAAUrC,GACf,OAAQqC,EAAErC,KAQVsC,EAAQd,GAAS,GACjBe,EAASf,GAAS,GAElBgB,EAAO,WACT,OAAOC,GAELA,EAAO,WACT,IAAIC,EAAK,SAAUC,GACjB,OAAOA,EAAEC,UAEPC,EAAO,SAAUC,GACnB,OAAOA,KAELC,EAAK,SAAUC,GACjB,OAAOA,GA+BT,MA7BS,CACPC,KAAM,SAAUD,EAAGE,GACjB,OAAOF,KAETG,GAAIb,EACJc,OAAQd,EACRM,OAAQL,EACRc,MAAON,EACPO,WAAYT,EACZU,SAAU,SAAUC,GAClB,MAAM,IAAIC,MAAMD,GAAO,oCAEzBE,UAAWlC,EAAS,MACpBmC,eAAgBnC,OAASP,GACzB2C,GAAIb,EACJc,QAAShB,EACTiB,IAAKtB,EACLuB,KAAMxC,EACNyC,KAAMxB,EACNyB,OAAQ3B,EACR4B,OAAQ3B,EACR4B,OAAQ3B,EACR4B,OAAQ1B,EACR2B,QAAS3B,EACT4B,QAAS,WACP,MAAO,IAETC,SAAU/C,EAAS,WArCZ,GAyCPgD,EAAO,SAAUtD,GACnB,IAAIuD,EAAajD,EAASN,GACtBwD,EAAO,WACT,OAAOC,GAELX,EAAO,SAAU3B,GACnB,OAAOA,EAAEnB,IAEPyD,EAAK,CACP1B,KAAM,SAAUD,EAAG4B,GACjB,OAAOA,EAAE1D,IAEXiC,GAAI,SAAU0B,GACZ,OAAO3D,IAAM2D,GAEfzB,OAAQb,EACRK,OAAQN,EACRe,MAAOoB,EACPnB,WAAYmB,EACZlB,SAAUkB,EACVf,UAAWe,EACXd,eAAgBc,EAChBb,GAAIc,EACJb,QAASa,EACTZ,IAAK,SAAUzB,GACb,OAAOmC,EAAKnC,EAAEnB,KAEhB6C,KAAM,SAAU1B,GACdA,EAAEnB,IAEJ8C,KAAMA,EACNC,OAAQD,EACRE,OAAQF,EACRG,OAAQ,SAAU9B,GAChB,OAAOA,EAAEnB,GAAKyD,EAAKlC,GAErB6B,QAAS,WACP,MAAO,CAACpD,IAEVqD,SAAU,WACR,MAAO,QAAUrD,EAAI,KAEvBkD,OAAQ,SAAUzB,GAChB,OAAOA,EAAEQ,GAAGjC,IAEdmD,QAAS,SAAU1B,EAAGmC,GACpB,OAAOnC,EAAEM,KAAKX,GAAO,SAAUyC,GAC7B,OAAOD,EAAU5D,EAAG6D,QAI1B,OAAOJ,GAKLK,EAAW,CACbR,KAAMA,EACNhC,KAAMA,EACNyC,KANS,SAAU9E,GACnB,OAAOA,MAAAA,EAAwCsC,EAAO+B,EAAKrE,KAQzD+E,EAAc7E,MAAMC,UAAU6E,MAC9BC,EAAgB/E,MAAMC,UAAU+E,QAChCC,EAAajF,MAAMC,UAAUiF,KAI7BC,EAAW,SAAUC,EAAIrF,GAC3B,OAJe,SAAUsF,EAAI1F,GAC7B,OAAOoF,EAAcvC,KAAK6C,EAAI1F,GAGvB2F,CAAWF,EAAIrF,IAAM,GAE1B6D,EAAS,SAAUwB,EAAIG,GACzB,IAAK,IAAIC,EAAI,EAAGC,EAAML,EAAG1D,OAAQ8D,EAAIC,EAAKD,IAAK,CAE7C,GAAID,EADIH,EAAGI,GACCA,GACV,OAAO,EAGX,OAAO,GAELE,EAAQ,SAAUC,EAAK3D,GAEzB,IADA,IAAI4D,EAAI,GACCJ,EAAI,EAAGA,EAAIG,EAAKH,IACvBI,EAAEV,KAAKlD,EAAEwD,IAEX,OAAOI,GAELnC,EAAM,SAAU2B,EAAIpD,GAGtB,IAFA,IAAIyD,EAAML,EAAG1D,OACTkE,EAAI,IAAI5F,MAAMyF,GACTD,EAAI,EAAGA,EAAIC,EAAKD,IAAK,CAC5B,IAAIzF,EAAIqF,EAAGI,GACXI,EAAEJ,GAAKxD,EAAEjC,EAAGyF,GAEd,OAAOI,GAELlC,EAAO,SAAU0B,EAAIpD,GACvB,IAAK,IAAIwD,EAAI,EAAGC,EAAML,EAAG1D,OAAQ8D,EAAIC,EAAKD,IAAK,CAE7CxD,EADQoD,EAAGI,GACNA,KAsBL1B,EAAS,SAAUsB,EAAIG,GAEzB,IADA,IAAIK,EAAI,GACCJ,EAAI,EAAGC,EAAML,EAAG1D,OAAQ8D,EAAIC,EAAKD,IAAK,CAC7C,IAAIzF,EAAIqF,EAAGI,GACPD,EAAKxF,EAAGyF,IACVI,EAAEV,KAAKnF,GAGX,OAAO6F,GAELC,EAAQ,SAAUT,EAAIpD,EAAG8D,GAI3B,OAjCU,SAAUV,EAAIpD,GACxB,IAAK,IAAIwD,EAAIJ,EAAG1D,OAAS,EAAG8D,GAAK,EAAGA,IAElCxD,EADQoD,EAAGI,GACNA,GA2BPO,CAAMX,GAAI,SAAUrF,GAClB+F,EAAM9D,EAAE8D,EAAK/F,MAER+F,GAELE,EAAQ,SAAUZ,EAAIpD,EAAG8D,GAI3B,OAHApC,EAAK0B,GAAI,SAAUrF,GACjB+F,EAAM9D,EAAE8D,EAAK/F,MAER+F,GAaLG,EAAO,SAAUb,EAAIG,GACvB,OAZc,SAAUH,EAAIG,EAAMW,GAClC,IAAK,IAAIV,EAAI,EAAGC,EAAML,EAAG1D,OAAQ8D,EAAIC,EAAKD,IAAK,CAC7C,IAAIzF,EAAIqF,EAAGI,GACX,GAAID,EAAKxF,EAAGyF,GACV,OAAOb,EAASR,KAAKpE,GAChB,GAAImG,EAAMnG,EAAGyF,GAClB,MAGJ,OAAOb,EAASxC,OAGTgE,CAAUf,EAAIG,EAAMtD,IAEzBmE,EAAY,SAAUhB,EAAIG,GAC5B,IAAK,IAAIC,EAAI,EAAGC,EAAML,EAAG1D,OAAQ8D,EAAIC,EAAKD,IAAK,CAE7C,GAAID,EADIH,EAAGI,GACCA,GACV,OAAOb,EAASR,KAAKqB,GAGzB,OAAOb,EAASxC,QAEdkE,EAAU,SAAUjB,GAEtB,IADA,IAAIQ,EAAI,GACCJ,EAAI,EAAGC,EAAML,EAAG1D,OAAQ8D,EAAIC,IAAOD,EAAG,CAC7C,IAAK/E,EAAQ2E,EAAGI,IACd,MAAM,IAAIpC,MAAM,oBAAsBoC,EAAI,6BAA+BJ,GAE3EH,EAAWnD,MAAM8D,EAAGR,EAAGI,IAEzB,OAAOI,GAELjC,EAAO,SAAUyB,EAAIpD,GACvB,OAAOqE,EAAQ5C,EAAI2B,EAAIpD,KAErB6B,EAAS,SAAUuB,EAAIG,GACzB,IAAK,IAAIC,EAAI,EAAGC,EAAML,EAAG1D,OAAQ8D,EAAIC,IAAOD,EAAG,CAE7C,IAAmB,IAAfD,EADIH,EAAGI,GACCA,GACV,OAAO,EAGX,OAAO,GAOLc,EAAc,SAAUlB,EAAIpD,GAE9B,IADA,IAAI4D,EAAI,GACCJ,EAAI,EAAGC,EAAML,EAAG1D,OAAQ8D,EAAIC,EAAKD,IAAK,CAC7C,IAAIzF,EAAIqF,EAAGI,GACXI,EAAEvF,OAAON,IAAMiC,EAAEjC,EAAGyF,GAEtB,OAAOI,GAELW,EAAO,SAAUxG,GACnB,MAAO,CAACA,IAONyG,EAAM,SAAUpB,EAAII,GACtB,OAAOA,GAAK,GAAKA,EAAIJ,EAAG1D,OAASiD,EAASR,KAAKiB,EAAGI,IAAMb,EAASxC,QAE/DsE,EAAO,SAAUrB,GACnB,OAAOoB,EAAIpB,EAAI,IAEbsB,EAAO,SAAUtB,GACnB,OAAOoB,EAAIpB,EAAIA,EAAG1D,OAAS,IAEzBiF,EAAU,SAAUC,EAAK5E,GAC3B,IAAK,IAAIwD,EAAI,EAAGA,EAAIoB,EAAIlF,OAAQ8D,IAAK,CACnC,IAAII,EAAI5D,EAAE4E,EAAIpB,GAAIA,GAClB,GAAII,EAAE7C,SACJ,OAAO6C,EAGX,OAAOjB,EAASxC,QAGd0E,EAAW,WAUb,OATAA,EAAWC,OAAOC,QAAU,SAAkBpH,GAC5C,IAAK,IAAI4E,EAAGiB,EAAI,EAAG7C,EAAIlB,UAAUC,OAAQ8D,EAAI7C,EAAG6C,IAE9C,IAAK,IAAIwB,KADTzC,EAAI9C,UAAU+D,GAERsB,OAAO7G,UAAUgH,eAAezE,KAAK+B,EAAGyC,KAC1CrH,EAAEqH,GAAKzC,EAAEyC,IAEf,OAAOrH,IAEOmC,MAAMoF,KAAMzF,YAE9B,SAAS0F,IACP,IAAK,IAAI5C,EAAI,EAAGiB,EAAI,EAAG4B,EAAK3F,UAAUC,OAAQ8D,EAAI4B,EAAI5B,IACpDjB,GAAK9C,UAAU+D,GAAG9D,OACf,IAAIkE,EAAI5F,MAAMuE,GAAI8C,EAAI,EAA3B,IAA8B7B,EAAI,EAAGA,EAAI4B,EAAI5B,IAC3C,IAAK,IAAI3E,EAAIY,UAAU+D,GAAI8B,EAAI,EAAGC,EAAK1G,EAAEa,OAAQ4F,EAAIC,EAAID,IAAKD,IAC5DzB,EAAEyB,GAAKxG,EAAEyG,GACb,OAAO1B,EAGT,IAAI4B,EAAS,SAAUxF,GACrB,IACI4D,EADA6B,GAAS,EAEb,OAAO,WAEL,IADA,IAAIC,EAAO,GACFlG,EAAK,EAAGA,EAAKC,UAAUC,OAAQF,IACtCkG,EAAKlG,GAAMC,UAAUD,GAMvB,OAJKiG,IACHA,GAAS,EACT7B,EAAI5D,EAAEF,MAAM,KAAM4F,IAEb9B,IAuDP+B,EAAU,WACZ,OAAOC,EAAG,EAAG,IAEXA,EAAK,SAAUC,EAAOC,GACxB,MAAO,CACLD,MAAOA,EACPC,MAAOA,IAGPC,EAAU,CACZH,GAAIA,EACJI,OAlBW,SAAUC,EAAgBC,GACrC,IAAIC,EAAe9H,OAAO6H,GAAOE,cACjC,OAA8B,IAA1BH,EAAevG,OACViG,IAhBE,SAAUU,EAASH,GAC9B,IAAItC,EAVW,SAAUyC,EAAS9D,GAClC,IAAK,IAAIiB,EAAI,EAAGA,EAAI6C,EAAQ3G,OAAQ8D,IAAK,CACvC,IAAIzF,EAAIsI,EAAQ7C,GAChB,GAAIzF,EAAEuI,KAAK/D,GACT,OAAOxE,GAMHwI,CAAWF,EAASH,GAC5B,IAAKtC,EACH,MAAO,CACLiC,MAAO,EACPC,MAAO,GAGX,IAAIU,EAAQ,SAAUhD,GACpB,OAAOiD,OAAOP,EAAMQ,QAAQ9C,EAAG,IAAMJ,KAEvC,OAAOoC,EAAGY,EAAM,GAAIA,EAAM,IAOnBG,CAAOV,EAAgBE,IAc9BR,QAASA,GAGPiB,EAAW,SAAUC,EAAYC,GACnC,IAAIZ,EAAQ7H,OAAOyI,GAAWV,cAC9B,OAAOnC,EAAK4C,GAAY,SAAUE,GAChC,OAAOA,EAAUC,OAAOd,OAqBxBe,EAlBgB,SAAUC,EAAUJ,GACtC,OAAOF,EAASM,EAAUJ,GAAWrF,KAAI,SAAU0F,GACjD,IAAIC,EAAUrB,EAAQC,OAAOmB,EAAQlB,eAAgBa,GACrD,MAAO,CACLO,QAASF,EAAQ/I,KACjBgJ,QAASA,OAaXH,EATW,SAAUK,EAAMR,GAC7B,OAAOF,EAASU,EAAMR,GAAWrF,KAAI,SAAU8F,GAC7C,IAAIH,EAAUrB,EAAQC,OAAOuB,EAAGtB,eAAgBa,GAChD,MAAO,CACLO,QAASE,EAAGnJ,KACZgJ,QAASA,OASXI,EAAa,SAAUC,EAAKC,EAAQC,GACtC,MAAkB,KAAXD,GAAiBD,EAAI/H,QAAUgI,EAAOhI,QAAU+H,EAAIC,OAAOC,EAAOA,EAAQD,EAAOhI,UAAYgI,GAElGE,GAAa,SAAUH,EAAKC,GAC9B,OAAgC,IAAzBD,EAAIzE,QAAQ0E,IAEjBG,GAAa,SAAUJ,EAAKK,GAC9B,OAAON,EAAWC,EAAKK,EAAQ,IAE7BC,GAAW,SAAUN,EAAKO,GAC5B,OAAOR,EAAWC,EAAKO,EAAQP,EAAI/H,OAASsI,EAAOtI,SAOjDuI,GALQ,SAAUrE,GACpB,OAAO,SAAUrB,GACf,OAAOA,EAAEmE,QAAQ9C,EAAG,KAGbsE,CAAM,cACbC,GAAa,SAAU5F,GACzB,OAAOA,EAAE7C,OAAS,GAGhB0I,GAAqB,sCACrBC,GAAgB,SAAUC,GAC5B,OAAO,SAAUC,GACf,OAAOX,GAAWW,EAAUD,KAG5BpB,GAAW,CACb,CACE9I,KAAM,OACN6H,eAAgB,CAAC,kCACjBe,OAAQ,SAAUuB,GAChB,OAAOX,GAAWW,EAAU,UAAYX,GAAWW,EAAU,WAAaX,GAAWW,EAAU,WAAaX,GAAWW,EAAU,iBAGrI,CACEnK,KAAM,SACN6H,eAAgB,CACd,kCACAmC,IAEFpB,OAAQ,SAAUuB,GAChB,OAAOX,GAAWW,EAAU,YAAcX,GAAWW,EAAU,iBAGnE,CACEnK,KAAM,KACN6H,eAAgB,CACd,iCACA,8BAEFe,OAAQ,SAAUuB,GAChB,OAAOX,GAAWW,EAAU,SAAWX,GAAWW,EAAU,aAGhE,CACEnK,KAAM,QACN6H,eAAgB,CACdmC,GACA,kCAEFpB,OAAQqB,GAAc,UAExB,CACEjK,KAAM,UACN6H,eAAgB,CAAC,uCACjBe,OAAQqB,GAAc,YAExB,CACEjK,KAAM,SACN6H,eAAgB,CACdmC,GACA,iCAEFpB,OAAQ,SAAUuB,GAChB,OAAQX,GAAWW,EAAU,WAAaX,GAAWW,EAAU,aAAeX,GAAWW,EAAU,kBAIrGjB,GAAO,CACT,CACElJ,KAAM,UACN4I,OAAQqB,GAAc,OACtBpC,eAAgB,CAAC,0CAEnB,CACE7H,KAAM,MACN4I,OAAQ,SAAUuB,GAChB,OAAOX,GAAWW,EAAU,WAAaX,GAAWW,EAAU,SAEhEtC,eAAgB,CACd,sCACA,+BACA,wCAGJ,CACE7H,KAAM,UACN4I,OAAQqB,GAAc,WACtBpC,eAAgB,CAAC,sCAEnB,CACE7H,KAAM,MACN4I,OAAQqB,GAAc,YACtBpC,eAAgB,CAAC,wCAEnB,CACE7H,KAAM,QACN4I,OAAQqB,GAAc,SACtBpC,eAAgB,IAElB,CACE7H,KAAM,UACN4I,OAAQqB,GAAc,SACtBpC,eAAgB,IAElB,CACE7H,KAAM,UACN4I,OAAQqB,GAAc,WACtBpC,eAAgB,IAElB,CACE7H,KAAM,WACN4I,OAAQqB,GAAc,QACtBpC,eAAgB,CAAC,qCAGjBuC,GAAe,CACjBtB,SAAU/H,EAAS+H,IACnBI,KAAMnI,EAASmI,KAGbmB,GAAO,OACPC,GAAS,SAETC,GAAQ,QACRC,GAAU,UACVC,GAAS,SAOTC,GAAO,SAAUC,GACnB,IAAI1B,EAAU0B,EAAK1B,QACfD,EAAU2B,EAAK3B,QACf4B,EAAY,SAAU5K,GACxB,OAAO,WACL,OAAOiJ,IAAYjJ,IAGvB,MAAO,CACLiJ,QAASA,EACTD,QAASA,EACT6B,OAAQD,EAAUP,IAClBS,SAAUF,EAAUN,IACpBS,KAAMH,EAvBD,MAwBLI,QAASJ,EAAUL,IACnBU,UAAWL,EAAUJ,IACrBU,SAAUN,EAAUH,MAGpBU,GAAU,CACZ5D,QA1Bc,WACd,OAAOmD,GAAK,CACVzB,aAASzI,EACTwI,QAASrB,EAAQJ,aAwBnBC,GAAIkD,GACJL,KAAMtJ,EAASsJ,IACfC,OAAQvJ,EAASuJ,IACjBc,GAAIrK,EAlCG,MAmCPwJ,MAAOxJ,EAASwJ,IAChBC,QAASzJ,EAASyJ,IAClBC,OAAQ1J,EAAS0J,KAGfY,GAAU,UAEVC,GAAU,UACVC,GAAQ,QAERC,GAAU,UACVC,GAAU,UACVC,GAAW,WAOXC,GAAO,SAAUhB,GACnB,IAAI1B,EAAU0B,EAAK1B,QACfD,EAAU2B,EAAK3B,QACf4C,EAAO,SAAU5L,GACnB,OAAO,WACL,OAAOiJ,IAAYjJ,IAGvB,MAAO,CACLiJ,QAASA,EACTD,QAASA,EACT6C,UAAWD,EAAKP,IAChBS,MAAOF,EAzBD,OA0BNG,UAAWH,EAAKN,IAChBU,MAAOJ,EAxBD,OAyBNK,QAASL,EAAKL,IACdW,UAAWN,EAAKJ,IAChBW,UAAWP,EAAKH,IAChBW,WAAYR,EAAKF,MAGjBW,GAAkB,CACpB9E,QA5Bc,WACd,OAAOoE,GAAK,CACV1C,aAASzI,EACTwI,QAASrB,EAAQJ,aA0BnBC,GAAImE,GACJN,QAAStK,EAASsK,IAClBiB,IAAKvL,EAtCG,OAuCRuK,QAASvK,EAASuK,IAClBC,MAAOxK,EAASwK,IAChBgB,IAAKxL,EAtCG,OAuCRyK,QAASzK,EAASyK,IAClBC,QAAS1K,EAAS0K,IAClBC,SAAU3K,EAAS2K,KAejBc,GAZW,SAAU9D,EAAW+D,GAClC,IAAI3D,EAAWsB,GAAatB,WACxBI,EAAOkB,GAAalB,OACpBH,EAAUF,EAAuBC,EAAUJ,GAAWlG,KAAK2I,GAAQ5D,QAAS4D,GAAQ3D,IACpF2B,EAAKN,EAAkBK,EAAMR,GAAWlG,KAAK6J,GAAgB9E,QAAS8E,GAAgB7E,IACtFkF,EAnUW,SAAUvD,EAAIJ,EAASL,EAAW+D,GACjD,IAAIE,EAASxD,EAAG2C,UAAuC,IAA5B,QAAQ5D,KAAKQ,GACpCkE,EAAWzD,EAAG2C,UAAYa,EAC1BE,EAAW1D,EAAG2C,SAAW3C,EAAG4C,YAC5Be,EAAUD,GAAYJ,EAAW,oBACjCM,EAAWJ,IAAWC,GAAYC,GAAYJ,EAAW,4BACzDO,EAAUJ,GAAYC,IAAaE,EACnCE,EAAalE,EAAQmC,YAAc/B,EAAG2C,UAAyC,IAA9B,UAAU5D,KAAKQ,GAChEwE,GAAaF,IAAYD,IAAaE,EAC1C,MAAO,CACLN,OAAQ5L,EAAS4L,GACjBC,SAAU7L,EAAS6L,GACnBG,SAAUhM,EAASgM,GACnBC,QAASjM,EAASiM,GAClBF,QAAS/L,EAAS+L,GAClBf,UAAW5C,EAAG4C,UACdD,MAAO3C,EAAG2C,MACVqB,UAAWpM,EAASkM,GACpBC,UAAWnM,EAASmM,IAiTLE,CAAWjE,EAAIJ,EAASL,EAAW+D,GACpD,MAAO,CACL1D,QAASA,EACTI,GAAIA,EACJuD,WAAYA,IAKZD,GAAa,SAAUY,GACzB,OAAOC,OAAOC,WAAWF,GAAOG,SAE9BC,GAAWrG,GAAO,WACpB,OAAOoF,GAAyBkB,UAAUhF,UAAW+D,OAEnDkB,GAAW,WACb,OAAOF,MAoCLG,GAAU,SAAUC,GACtB,GAAIA,MAAAA,EACF,MAAM,IAAI7K,MAAM,oCAElB,MAAO,CAAE8K,IAAKD,IAKZE,GAAe,CACjBC,SA9Ba,SAAUC,EAAMC,GAC7B,IACIC,GADMD,GAASE,UACLC,cAAc,OAE5B,GADAF,EAAIG,UAAYL,GACXE,EAAII,iBAAmBJ,EAAIK,WAAWlN,OAAS,EAElD,MADAmN,QAAQC,MAAM,wCAAyCT,GACjD,IAAIjL,MAAM,qCAElB,OAAO4K,GAAQO,EAAIK,WAAW,KAuB9BG,QArBY,SAAUC,EAAKV,GAC3B,IACIL,GADMK,GAASE,UACJC,cAAcO,GAC7B,OAAOhB,GAAQC,IAmBfgB,SAjBa,SAAUC,EAAMZ,GAC7B,IACIL,GADMK,GAASE,UACJW,eAAeD,GAC9B,OAAOlB,GAAQC,IAefD,QAASA,GACToB,UARc,SAAUC,EAAQtP,EAAGuP,GACnC,OAAO3K,EAASC,KAAKyK,EAAOnB,IAAIqB,iBAAiBxP,EAAGuP,IAAI7L,IAAIuK,MAU1DlL,GAAK,SAAU0M,EAASC,GAC1B,IAAIvB,EAAMsB,EAAQtB,IAClB,GA1CY,IA0CRA,EAAIwB,SACN,OAAO,EAEP,IAAIC,EAAOzB,EACX,QAAqBtN,IAAjB+O,EAAK/B,QACP,OAAO+B,EAAK/B,QAAQ6B,GACf,QAA+B7O,IAA3B+O,EAAKC,kBACd,OAAOD,EAAKC,kBAAkBH,GACzB,QAAmC7O,IAA/B+O,EAAKE,sBACd,OAAOF,EAAKE,sBAAsBJ,GAC7B,QAAgC7O,IAA5B+O,EAAKG,mBACd,OAAOH,EAAKG,mBAAmBL,GAE/B,MAAM,IAAIrM,MAAM,mCAIlB2M,GAAiB,SAAU7B,GAC7B,OA5DY,IA4DLA,EAAIwB,UA9DE,IA8DsBxB,EAAIwB,UA7DjB,KA6D0CxB,EAAIwB,UAA4D,IAA1BxB,EAAI8B,mBAWxGC,GAAO,SAAUC,EAAIC,GACvB,OAAOD,EAAGhC,MAAQiC,EAAGjC,KAOnBkC,GAAa,SAAUF,EAAIC,GAC7B,OAvF0CtP,EAuFPqP,EAAGhC,IAvFOxJ,EAuFFyL,EAAGjC,IA1FlB,SAAUrN,EAAG6D,EAAG2L,GAC5C,OAAkD,IAA1CxP,EAAEyP,wBAAwB5L,GAAK2L,GAGhCC,CAAwBzP,EAAG6D,EAAG6L,KAAKC,gCADV,IAAU3P,EAAG6D,GAyF3C+L,GAAa,SAAUP,EAAIC,GAC7B,OAAOpC,KAAW5E,QAAQgC,OAASiF,GAAWF,EAAIC,GAT9B,SAAUD,EAAIC,GAClC,IAAIO,EAAKR,EAAGhC,IACRyC,EAAKR,EAAGjC,IACZ,OAAOwC,IAAOC,GAAaD,EAAGvL,SAASwL,GAMiBC,CAAgBV,EAAIC,IAE1EU,GAAO/N,GAEPgO,GAAOhK,OAAOgK,KACd7J,GAAiBH,OAAOG,eACxB8J,GAAS,SAAUC,EAAKhP,GAE1B,IADA,IAAIiP,EAAQH,GAAKE,GACR3J,EAAI,EAAG5B,EAAMwL,EAAMvP,OAAQ2F,EAAI5B,EAAK4B,IAAK,CAChD,IAAI7B,EAAIyL,EAAM5J,GAEdrF,EADQgP,EAAIxL,GACPA,KAGL0L,GAAQ,SAAUF,EAAKhP,GACzB,OAAOmP,GAASH,GAAK,SAAUjR,EAAGyF,GAChC,MAAO,CACL6B,EAAG7B,EACHhB,EAAGxC,EAAEjC,EAAGyF,QAIV2L,GAAW,SAAUH,EAAKhP,GAC5B,IAAI4D,EAAI,GAKR,OAJAmL,GAAOC,GAAK,SAAUjR,EAAGyF,GACvB,IAAI4L,EAAQpP,EAAEjC,EAAGyF,GACjBI,EAAEwL,EAAM/J,GAAK+J,EAAM5M,KAEdoB,GAcLyL,GAAW,SAAUL,EAAKzL,GAC5B,IAAI5F,EAAI,GAER,OAVmB,SAAUqR,EAAKzL,EAAM+L,EAAQC,GAEhDR,GAAOC,GAAK,SAAUjR,EAAGyF,IACtBD,EAAKxF,EAAGyF,GAAK8L,EAASC,GAASxR,EAAGyF,MAMrCgM,CAAeR,EAAKzL,EAdT,SAAUK,GACrB,OAAO,SAAU7F,EAAGyF,GAClBI,EAAEJ,GAAKzF,GAYiB0R,CAAO9R,GAAIuB,GAC9BvB,GAEL+R,GAAa,SAAUV,EAAKhP,GAC9B,IAAI4D,EAAI,GAIR,OAHAmL,GAAOC,GAAK,SAAUlR,EAAOM,GAC3BwF,EAAEV,KAAKlD,EAAElC,EAAOM,OAEXwF,GAOL+L,GAAO,SAAUX,GACnB,OAAOF,GAAKE,GAAKtP,QAEfkQ,GAAQ,SAAUZ,EAAKa,GACzB,OAAOC,GAAId,EAAKa,GAAOlN,EAASC,KAAKoM,EAAIa,IAAQlN,EAASxC,QAExD2P,GAAM,SAAUd,EAAKa,GACvB,OAAO5K,GAAezE,KAAKwO,EAAKa,IAE9BE,GAAoB,SAAUf,EAAKa,GACrC,OAAOC,GAAId,EAAKa,SAAqBjR,IAAboQ,EAAIa,IAAmC,OAAbb,EAAIa,IAWpDG,GAAmB,CACrB,QACA,QACA,QACA,YAiBEC,GAAS,SAAUzC,EAAS0C,EAASC,GACvC,MAAO,CACL3C,QAASA,EACT0C,QAASA,EACTC,QAASA,IAqBTC,GAAU,SAAU5C,EAAS6C,EAAOC,GACtC,MAAO,CACL9C,QAASA,EACT6C,MAAOA,EACPC,QAASA,IAGTC,GAAa,SAAU/C,EAASgD,EAAOC,GACzC,MAAO,CACLjD,QAASA,EACTgD,MAAOA,EACPC,SAAUA,IAWVC,GAAW,SAAUL,EAAOC,GAC9B,MAAO,CACLD,MAAOA,EACPC,QAASA,IA2BTlS,IAF2B,oBAAXsN,OAAyBA,OAASiF,SAAS,eAATA,GAE3C,SAAUnD,GAEnB,OADQA,EAAQtB,IAAI0E,SACXxK,gBAEPvI,GAAO,SAAU2P,GACnB,OAAOA,EAAQtB,IAAIwB,UAEjBmD,GAAW,SAAUlT,GACvB,OAAO,SAAU6P,GACf,OAAO3P,GAAK2P,KAAa7P,IAGzBmT,GAAY,SAAUtD,GACxB,OArRY,IAqRL3P,GAAK2P,IAA0C,aAAlBpP,GAAKoP,IAEvCuD,GAAYF,GApRF,GAqRVG,GAASH,GApRF,GAqRPI,GAAaJ,GAxRF,GAyRXK,GAAqBL,GAxRD,IAyRpBM,GAAQ,SAAUnE,GACpB,OAAO,SAAUoE,GACf,OAAOL,GAAUK,IAAMhT,GAAKgT,KAAOpE,IAInCqE,GAAQ,SAAU7D,GACpB,OAAOrB,GAAaH,QAAQwB,EAAQtB,IAAIoF,gBAEtCC,GAAkB,SAAUC,GAC9B,OAAOP,GAAWO,GAAOA,EAAMH,GAAMG,IAKnCC,GAAS,SAAUjE,GACrB,OAAO7K,EAASC,KAAK4K,EAAQtB,IAAIwF,YAAYjQ,IAAI0K,GAAaH,UAE5D2F,GAAU,SAAUnE,EAASoE,GAI/B,IAHA,IAAIC,EAAO7S,EAAW4S,GAAUA,EAAS3R,EACrCiM,EAAMsB,EAAQtB,IACd4F,EAAM,GACgB,OAAnB5F,EAAIwF,iBAA0C9S,IAAnBsN,EAAIwF,YAA0B,CAC9D,IAAIK,EAAY7F,EAAIwF,WAChB1M,EAAImH,GAAaH,QAAQ+F,GAE7B,GADAD,EAAI5O,KAAK8B,IACO,IAAZ6M,EAAK7M,GACP,MAEAkH,EAAM6F,EAGV,OAAOD,GAKLE,GAAc,SAAUxE,GAC1B,OAAO7K,EAASC,KAAK4K,EAAQtB,IAAI+F,iBAAiBxQ,IAAI0K,GAAaH,UAEjEkG,GAAc,SAAU1E,GAC1B,OAAO7K,EAASC,KAAK4K,EAAQtB,IAAIgG,aAAazQ,IAAI0K,GAAaH,UAE7DmG,GAAW,SAAU3E,GACvB,OAAO/L,EAAI+L,EAAQtB,IAAIU,WAAYT,GAAaH,UAE9CoG,GAAQ,SAAU5E,EAAS6E,GAC7B,IAAIC,EAAK9E,EAAQtB,IAAIU,WACrB,OAAOjK,EAASC,KAAK0P,EAAGD,IAAQ5Q,IAAI0K,GAAaH,UAS/CuG,GAAYvT,EAAWwT,QAAQvU,UAAUwU,eAAiBzT,EAAWuP,KAAKtQ,UAAUyU,aACpFC,GAAcxT,EAASoT,IACvBG,GAAcH,GAAY,SAAUnB,GACtC,OAAOjF,GAAaH,QAAQoF,EAAElF,IAAIwG,gBAChCnB,GACAqB,GAAgB,SAAUxB,GAC5B,IAT2BI,EASvB5N,EAAI8O,GAAYtB,GACpB,OATOF,GADoBM,EAUP5N,IATc9E,EAAc0S,EAAItF,IAAI2G,MAS/BlQ,EAASR,KAAKyB,GAAKjB,EAASxC,QAEnD2S,GAAgB,SAAU1B,GAC5B,OAAOjF,GAAaH,QAAQoF,EAAElF,IAAI2G,OAgBhCE,GAAmB,SAAUvF,GAC/B,OAAO1O,EAAc0O,EAAQtB,IAAI8G,aAG/BC,GAAS,SAAUzF,GACrB,IAAItB,EAAM8E,GAAOxD,GAAWA,EAAQtB,IAAIwF,WAAalE,EAAQtB,IAC7D,GAAIA,MAAAA,GAA2D,OAAtBA,EAAIoF,cAC3C,OAAO,EAET,IAjjCuB4B,EAAKC,EAijCxBC,EAAMlH,EAAIoF,cACd,OAAOsB,GAAczG,GAAaH,QAAQE,IAAMtL,MAAK,WACnD,OAAOwS,EAAIC,KAAKlQ,SAAS+I,MAnjCJgH,EAojCXD,GApjCgBE,EAojCRL,GAnjCb,SAAUjU,GACf,OAAOqU,EAAIC,EAAItU,QAujCfyU,GAAU,SAAUF,GACtB,IAAI1Q,EAAI0Q,EAAIlH,IAAImH,KAChB,GAAI3Q,MAAAA,EACF,MAAM,IAAItB,MAAM,6BAElB,OAAO+K,GAAaH,QAAQtJ,IAS1B6Q,GAAc,SAAUjH,EAAOkH,GACjC,IAAIC,EAAS,GAOb,OANA/R,EAAKyQ,GAAS7F,IAAQ,SAAUvO,GAC1ByV,EAAUzV,KACZ0V,EAASA,EAAO5T,OAAO,CAAC9B,KAE1B0V,EAASA,EAAO5T,OAAO0T,GAAYxV,EAAGyV,OAEjCC,GAGLC,GAAc,SAAUpH,EAAOmB,EAAUmE,GAC3C,OAlBc,SAAUtF,EAAOkH,EAAW5B,GAC1C,OAAO9P,EAAO6P,GAAQrF,EAAOsF,GAAS4B,GAiB/BG,CAAUrH,GAAO,SAAU8E,GAChC,OAAOtQ,GAAGsQ,EAAG3D,KACZmE,IAEDgC,GAAa,SAAUtH,EAAOmB,GAChC,OApBe,SAAUnB,EAAOkH,GAChC,OAAO1R,EAAOqQ,GAAS7F,GAAQkH,GAmBxBK,CAAWvH,GAAO,SAAU8E,GACjC,OAAOtQ,GAAGsQ,EAAG3D,OAGbqG,GAAgB,SAAUxH,EAAOmB,GACnC,OAlWQ,SAAUA,EAAUnB,GAC5B,IAAIyH,OAAiBnV,IAAV0N,EAAsBE,SAAWF,EAAMJ,IAClD,OAAO6B,GAAegG,GAAQ,GAAKtS,EAAIsS,EAAKC,iBAAiBvG,GAAWtB,GAAaH,SAgW9EpM,CAAI6N,EAAUnB,IAGvB,SAAS2H,GAAmBnT,EAAIoT,EAAU5H,EAAOzN,EAAG+S,GAClD,OAAI9Q,EAAGwL,EAAOzN,GACL8D,EAASR,KAAKmK,GACZtN,EAAW4S,IAAWA,EAAOtF,GAC/B3J,EAASxC,OAET+T,EAAS5H,EAAOzN,EAAG+S,GAI9B,IAAIsC,GAAW,SAAU5H,EAAOkH,EAAW5B,GAGzC,IAFA,IAAIpE,EAAUlB,EAAMJ,IAChB2F,EAAO7S,EAAW4S,GAAUA,EAAS3R,EAClCuN,EAAQkE,YAAY,CACzBlE,EAAUA,EAAQkE,WAClB,IAAIyC,EAAKhI,GAAaH,QAAQwB,GAC9B,GAAIgG,EAAUW,GACZ,OAAOxR,EAASR,KAAKgS,GAChB,GAAItC,EAAKsC,GACd,MAGJ,OAAOxR,EAASxC,QAgCdiU,GAAa,SAAU9H,EAAOmB,EAAUmE,GAC1C,OAAOsC,GAAS5H,GAAO,SAAU8E,GAC/B,OAAOtQ,GAAGsQ,EAAG3D,KACZmE,IAEDyC,GAAU,SAAU/H,EAAOmB,GAC7B,OA9BY,SAAUnB,EAAOkH,GAK7B,OADavP,EAAKqI,EAAMJ,IAAIU,YAHjB,SAAUX,GACnB,OAAOuH,EAAUrH,GAAaH,QAAQC,OAG1BxK,IAAI0K,GAAaH,SAyBxBsI,CAAQhI,GAAO,SAAU8E,GAC9B,OAAOtQ,GAAGsQ,EAAG3D,OAGb8G,GAAe,SAAUjI,EAAOmB,GAClC,OAlaQ,SAAUA,EAAUnB,GAC5B,IAAIyH,OAAiBnV,IAAV0N,EAAsBE,SAAWF,EAAMJ,IAClD,OAAO6B,GAAegG,GAAQpR,EAASxC,OAASwC,EAASC,KAAKmR,EAAKS,cAAc/G,IAAWhM,IAAI0K,GAAaH,SAgatGyI,CAAIhH,EAAUnB,IAEnBoI,GAAY,SAAUpI,EAAOmB,EAAUmE,GAIzC,OAAOqC,IAHI,SAAUzG,EAASC,GAC5B,OAAO3M,GAAG0M,EAASC,KAEU2G,GAAY9H,EAAOmB,EAAUmE,IAG1D+C,GAAS,SAAUzI,EAAK2D,EAAK/R,GAC/B,KAAIS,EAAST,IAAUY,EAAUZ,IAAUmB,EAASnB,IAIlD,MADA+O,QAAQC,MAAM,sCAAuC+C,EAAK,YAAa/R,EAAO,cAAeoO,GACvF,IAAI9K,MAAM,kCAHhB8K,EAAI0I,aAAa/E,EAAK/R,EAAQ,KAM9B+W,GAAM,SAAUrH,EAASqC,EAAK/R,GAChC6W,GAAOnH,EAAQtB,IAAK2D,EAAK/R,IAEvBgX,GAAS,SAAUtH,EAASuH,GAC9B,IAAI7I,EAAMsB,EAAQtB,IAClB6C,GAAOgG,GAAO,SAAUvS,EAAG6C,GACzBsP,GAAOzI,EAAK7G,EAAG7C,OAGfwS,GAAQ,SAAUxH,EAASqC,GAC7B,IAAIrN,EAAIgL,EAAQtB,IAAI+I,aAAapF,GACjC,OAAa,OAANrN,OAAa5D,EAAY4D,GAE9B0S,GAAS,SAAU1H,EAASqC,GAC9B,OAAOlN,EAASC,KAAKoS,GAAMxH,EAASqC,KAElCsF,GAAS,SAAU3H,EAASqC,GAC9BrC,EAAQtB,IAAIkJ,gBAAgBvF,IAE1BwF,GAAQ,SAAU7H,GACpB,OAAOxJ,EAAMwJ,EAAQtB,IAAIoJ,YAAY,SAAUxR,EAAKyR,GAElD,OADAzR,EAAIyR,EAAKnX,MAAQmX,EAAKzX,MACfgG,IACN,KAGD0R,GAAgB,SAAUtJ,GAC5B,YAAqBtN,IAAdsN,EAAIuJ,OAAuBzW,EAAWkN,EAAIuJ,MAAMC,mBAGrDC,GAAc,SAAUzJ,EAAK0J,EAAU9X,GACzC,IAAKS,EAAST,GAEZ,MADA+O,QAAQC,MAAM,qCAAsC8I,EAAU,YAAa9X,EAAO,cAAeoO,GAC3F,IAAI9K,MAAM,+BAAiCtD,GAE/C0X,GAActJ,IAChBA,EAAIuJ,MAAMI,YAAYD,EAAU9X,IAQhCgY,GAAQ,SAAUtI,EAASoI,EAAU9X,GACvC,IAAIoO,EAAMsB,EAAQtB,IAClByJ,GAAYzJ,EAAK0J,EAAU9X,IAEzBiY,GAAW,SAAUvI,EAASwI,GAChC,IAAI9J,EAAMsB,EAAQtB,IAClB6C,GAAOiH,GAAK,SAAUxT,EAAG6C,GACvBsQ,GAAYzJ,EAAK7G,EAAG7C,OAGpByT,GAAQ,SAAUzI,EAASoI,GAC7B,IAAI1J,EAAMsB,EAAQtB,IAEdtI,EADS8H,OAAOwK,iBAAiBhK,GACtBwJ,iBAAiBE,GAChC,MAAa,KAANhS,GAAaqP,GAAOzF,GAA8C5J,EAAnCuS,GAAkBjK,EAAK0J,IAE3DO,GAAoB,SAAUjK,EAAK0J,GACrC,OAAOJ,GAActJ,GAAOA,EAAIuJ,MAAMC,iBAAiBE,GAAY,IAEjEQ,GAAS,SAAU5I,EAASoI,GAC9B,IAAI1J,EAAMsB,EAAQtB,IACdmK,EAAMF,GAAkBjK,EAAK0J,GACjC,OAAOjT,EAASC,KAAKyT,GAAKvU,QAAO,SAAU8B,GACzC,OAAOA,EAAElE,OAAS,MAGlB4W,GAAW,SAAU9I,EAASoI,IA/Bb,SAAU1J,EAAK0J,GAC9BJ,GAActJ,IAChBA,EAAIuJ,MAAMc,eAAeX,GA+B3BY,CADUhJ,EAAQtB,IACE0J,GAChBV,GAAO1H,EAAS,SAAS/L,IAAIwG,IAAMnH,GAAG,KACxCqU,GAAO3H,EAAS,UAWhBiJ,GAAe,SAAUC,EAAMtY,EAAMuY,GAIvC,YAHiB,IAAbA,IACFA,EAAW,GAENzB,GAAOwB,EAAMtY,GAAMqD,KAAI,SAAU3D,GACtC,OAAO8Y,SAAS9Y,EAAO,OACtBkD,MAAM2V,IAEPE,GAAU,SAAUH,EAAM7Y,GAC5B,OAAO4Y,GAAaC,EAAM7Y,EAAM,IAE9BiZ,GAAa,SAAUJ,GACzB,OAAOG,GAAQH,EAAM,WAAa,GAEhCK,GAAa,SAAUL,GACzB,OAAOG,GAAQH,EAAM,WAAa,GAEhCM,GAAc,SAAUxJ,EAASoI,GACnC,OAAOgB,SAASX,GAAMzI,EAASoI,GAAW,KAExCqB,GAAW9X,EAAS,IACpB+X,GAAY/X,EAAS,IAErBgY,GAAa,SAAU7K,EAAOmB,GAChC,OAAO2J,GAAiB9K,EAAOmB,EAAUvN,IAEvCkX,GAAmB,SAAU9K,EAAOmB,EAAU+F,GAChD,OAAO7R,EAAKwQ,GAAS7F,IAAQ,SAAUvO,GACrC,OAAI+C,GAAG/C,EAAG0P,GACD+F,EAAUzV,GAAK,CAACA,GAAK,GAErBqZ,GAAiBrZ,EAAG0P,EAAU+F,OAoBvCkD,GAAO,SAAUlJ,EAASoE,GAC5B,OAhBW,SAAUyF,EAAM7J,EAASoE,GAIpC,YAHe,IAAXA,IACFA,EAAS3R,GAEP2R,EAAOpE,GACF7K,EAASxC,OAEdgD,EAASkU,EAAMjZ,GAAKoP,IACf7K,EAASR,KAAKqL,GAKhB4G,GAAW5G,EAAS6J,EAAKC,KAAK,MAHZ,SAAUC,GACjC,OAAOzW,GAAGyW,EAAK,UAAY3F,EAAO2F,MAK7BC,CAAO,CACZ,KACA,MACChK,EAASoE,IAEVvB,GAAQ,SAAU6D,GACpB,OAAOiD,GAAWjD,EAAU,UAE1BuD,GAAU,SAAUvD,GACtB,OAAIpT,GAAGoT,EAAU,YACRN,GAAWM,EAAU,OAErBvS,EAAK+V,GAAaxD,IAAW,SAAUyD,GAC5C,OAAO/D,GAAW+D,EAAa,WAIjCC,GAAQ,SAAUpK,EAASoE,GAC7B,OAAO8C,GAAUlH,EAAS,QAASoE,IAEjCiG,GAAO,SAAU3D,GACnB,OAAOiD,GAAWjD,EAAU,OAE1BwD,GAAe,SAAUxD,GAC3B,OAAO0D,GAAM1D,GAAUtT,KAAKzB,EAAS,KAAK,SAAUyY,GAClD,OAAOhE,GAAWgE,EAAO,gBAIzBE,GAAsB,SAAUC,EAAOC,GACzC,OAAOvW,EAAIsW,GAAO,SAAUE,GAC1B,GAAkB,aAAd7Z,GAAK6Z,GAAqB,CAC5B,IAAIC,EAAUzW,EAAIgW,GAAQQ,IAAM,SAAUE,GACxC,IAAIhI,EAAUsG,GAAa0B,EAAQ,OAAQ,GAC3C,OAAOlI,GAAOkI,EAAQ,EAAGhI,MAE3B,OAAOC,GAAQ6H,EAAKC,EAAS,YAEzBA,EAAUzW,EAAI4O,GAAM4H,IAAM,SAAUvB,GACtC,IAAIxG,EAAUuG,GAAaC,EAAM,UAAW,GACxCvG,EAAUsG,GAAaC,EAAM,UAAW,GAC5C,OAAOzG,GAAOyG,EAAMxG,EAASC,MAE/B,OAAOC,GAAQ6H,EAAKC,EAASF,EAAWC,QAI1CG,GAAmB,SAAU5R,GAC/B,OAAOiL,GAAOjL,GAAO/E,KAAI,SAAUgQ,GACjC,IAAI4G,EAAaja,GAAKqT,GACtB,OAvgBiB,SAAU4G,GAC7B,OAAOlV,EAAS6M,GAAkBqI,GAsgBzBC,CAAeD,GAAcA,EAAa,WAChDrX,MAAM,UAEPuX,GAAY,SAAUX,GACxB,IAAIY,EAASX,GAAKD,GAEdG,EAAQ5S,EADSuS,GAAaE,GACSY,GAC3C,OAAOV,GAAoBC,EAAOK,KAQhCK,GAAW,SAAUC,EAASrG,EAAOhC,GACvC,IAAIsI,EAAgBD,EAAQrI,MACxBuI,EAASD,EAAc7V,MAAM,EAAGuP,GAChCwG,EAAQF,EAAc7V,MAAMuP,GAC5ByG,EAAWF,EAAO/Y,OAAOwQ,GAAOxQ,OAAOgZ,GAC3C,OAAOE,GAASL,EAASI,IAEvBE,GAAU,SAAUN,EAASrG,EAAOqE,GACtC,OAAO+B,GAASC,EAASrG,EAAO,CAACqE,KAE/BuC,GAAa,SAAUP,EAASrG,EAAOqE,GAC7BgC,EAAQrI,MACdgC,GAASqE,GAEbqC,GAAW,SAAUL,EAASrI,GAChC,OAAOK,GAASL,EAAOqI,EAAQpI,UAE7B4I,GAAW,SAAUR,EAAS1Y,GAChC,IAAIqQ,EAAQqI,EAAQrI,MAChBzM,EAAInC,EAAI4O,EAAOrQ,GACnB,OAAO0Q,GAAS9M,EAAG8U,EAAQpI,UAEzB6I,GAAU,SAAUT,EAASrG,GAC/B,OAAOqG,EAAQrI,MAAMgC,IAEnB+G,GAAiB,SAAUV,EAASrG,GACtC,OAAO8G,GAAQT,EAASrG,GAAO7E,SAE7B6L,GAAa,SAAUX,GACzB,OAAOA,EAAQrI,MAAM3Q,QAEnB4Z,GAAqB,SAAUC,GACjC,IAAI9F,EA5tCU,SAAUrQ,EAAIG,GAG5B,IAFA,IAAIiW,EAAO,GACPC,EAAO,GACFjW,EAAI,EAAGC,EAAML,EAAG1D,OAAQ8D,EAAIC,EAAKD,IAAK,CAC7C,IAAIzF,EAAIqF,EAAGI,IACDD,EAAKxF,EAAGyF,GAAKgW,EAAOC,GAC1BvW,KAAKnF,GAEX,MAAO,CACLyb,KAAMA,EACNC,KAAMA,GAktCKC,CAAUH,GAAM,SAAUtB,GACrC,MAAuB,aAAhBA,EAAI3H,WAEb,MAAO,CACLuH,KAAMpE,EAAOgG,KACbE,KAAMlG,EAAO+F,OAIbI,GAAkB,2BAClBC,GAA4B,SAAUjC,GACxC,OAAO1C,GAAO0C,EAAOgC,IAAiBjY,MAAK,SAAUmY,GACnD,OAAOnX,EAASC,KAAKkX,EAAazL,MAAM,YACvC5M,KAAI,SAAUsY,GACf,OAAOzV,EAAYyV,EAAY7Z,OAG/B8Z,GAA2B,SAAUT,GACvC,IAAIU,EAASjW,EAAMsV,GAAmBC,GAAM1B,MAAM,SAAU/T,EAAKmU,GAM/D,OALAvW,EAAKuW,EAAI5H,OAAO,SAAUqG,EAAMwD,GAC1BxD,EAAKjG,WACP3M,EAAIoW,IAAO,MAGRpW,IACN,IAIH,OAzpCS,SAAUV,EAAI+W,GACvB,IAAIC,EAAOvX,EAAYrC,KAAK4C,EAAI,GAEhC,OADAgX,EAAKC,KAAKF,GACHC,EAspCAC,CAHS3K,GAAWuK,GAAQ,SAAUK,EAAMzK,GACjD,OAAO+G,SAAS/G,EAAK,SAKrBA,GAAM,SAAUoI,EAAKE,GACvB,OAAOF,EAAM,IAAME,GAYjBoC,GAAc,SAAUC,EAAWhH,GACrC,IAAI5T,EAAM+B,EAAK6Y,EAAU5a,KAAK,SAAUgE,GACtC,OAAOA,EAAEyM,SAEX,OAAOvO,EAAOlC,EAAK4T,IAejBiH,GAAW,SAAUC,GACvB,IAAIC,EAAS,GACTtK,EAAQ,GACRoH,EAAU,GAIVmD,EAHWnW,EAAKiW,GAAMjZ,KAAI,SAAUoZ,GACtC,OAAOA,EAAQrN,WACd7L,KAAKiW,IACqBjW,KAAKkY,IAA2B7Y,MAAM,IAC/D8Z,EAAU,EACVC,EAAa,EACbC,EAAW,EA8Bf,OA7BAtZ,EAAKgZ,GAAM,SAAUG,GACnB,GAAwB,aAApBA,EAAQvK,QACVmH,EA1BgB,SAAUoD,GAC9B,IAAII,EAAe,GACf5I,EAAQ,EASZ,OARA3Q,EAAKmZ,EAAQxK,OAAO,SAAU8H,GAC5B,IAAIhI,EAAUgI,EAAOhI,QACrBzM,EAAMyM,GAAS,SAAU+K,GACvB,IAAIC,EAAW9I,EAAQ6I,EACvBD,EAAaE,GA9hBH,SAAU3N,EAAS2C,EAASgI,GAC1C,MAAO,CACL3K,QAASA,EACT2C,QAASA,EACTgI,OAAQA,GA0hBmBiD,CAAUjD,EAAO3K,QAAS2C,EAASgL,MAE9D9I,GAASlC,KAEJ8K,EAeOI,CAAgBR,OACrB,CACL,IAAIS,EAAe,GACnB5Z,EAAKmZ,EAAQxK,OAAO,SAAUkL,GAE5B,IADA,IAAI5T,EAAQ,OAC4B/I,IAAjC+b,EAAO9K,GAAImL,EAAUrT,KAC1BA,IAIF,IAFA,IAAI8I,EAAWV,GAAkB6K,EAAejT,EAAMzF,YAClDmF,EA9mBG,SAAUmG,EAAS0C,EAASC,EAAS8H,EAAKE,EAAQ1H,GAC/D,MAAO,CACLjD,QAASA,EACT0C,QAASA,EACTC,QAASA,EACT8H,IAAKA,EACLE,OAAQA,EACR1H,SAAUA,GAumBQ+K,CAASD,EAAQ/N,QAAS+N,EAAQrL,QAASqL,EAAQpL,QAAS6K,EAAUrT,EAAO8I,GAClFgL,EAAyB,EAAGA,EAAyBF,EAAQpL,QAASsL,IAC7E,IAAK,IAAIC,EAAsB,EAAGA,EAAsBH,EAAQrL,QAASwL,IAAuB,CAC9F,IACIC,EAAiBhU,EAAQ8T,EACzBG,EAAS/L,GAFKmL,EAAWU,EAECC,GAC9BhB,EAAOiB,GAAUvU,EACjB0T,EAAac,KAAKC,IAAIf,EAAYY,EAAiB,GAGvDL,EAAapY,KAAKmE,MAEpByT,IACAzK,EAAMnN,KAAKkN,GAAQyK,EAAQrN,QAAS8N,EAAcT,EAAQvK,UAC1D0K,QAIG,CACLzB,KA5pBO,SAAU1B,EAAMJ,GACzB,MAAO,CACLI,KAAMA,EACNJ,QAASA,GAupBE8B,CAAKuB,EAASC,GAGzBJ,OAAQA,EACR/a,IAAKyQ,EACLoH,QAASA,IAqBTsE,GAAY,CACdxD,UAnBgB,SAAUX,GAC1B,IAAI8C,EAAOnC,GAAUX,GACrB,OAAO6C,GAASC,IAkBhBD,SAAUA,GACVuB,MAjGU,SAAUxB,EAAWvC,EAAKE,GACpC,IAAI9B,EAAMmE,EAAUG,OAAO9K,GAAIoI,EAAKE,IACpC,YAAevZ,IAARyX,EAAoB1T,EAASR,KAAKkU,GAAO1T,EAASxC,QAgGzD8b,SA9Fa,SAAUzB,EAAW0B,EAAM/B,GACxC,IAAIgC,EAAW5B,GAAYC,GAAW,SAAUvK,GAC9C,OAAOkK,EAAW+B,EAAMjM,EAAOzC,YAEjC,OAAO2O,EAASzc,OAAS,EAAIiD,EAASR,KAAKga,EAAS,IAAMxZ,EAASxC,QA2FnEoa,YAAaA,GACb6B,UApBc,SAAU5B,GACxB,OAAO7Y,EAAK6Y,EAAU5a,KAAK,SAAUyc,GACnC,OAAOA,EAAEhM,UAmBXiM,YAhBgB,SAAU9B,GAC1B,OA/sBqBxL,EA+sBPwL,EAAU/C,QA9sBjB/H,GAAWV,GAAK,SAAUxM,GAC/B,OAAOA,KAFE,IAAUwM,GA+tBrBuN,WAde,SAAU/B,GACzB,OAAO1L,GAAK0L,EAAU/C,SAAS/X,OAAS,GAcxC8c,YAZgB,SAAUhC,EAAWU,GACrC,OAAOvY,EAASC,KAAK4X,EAAU/C,QAAQyD,MAcrCuB,GAAc,SAAUC,EAAQzM,GAClC,IAAI0M,EAAW1M,EAAOkI,OAClByE,EAAY3M,EAAOkI,OAASlI,EAAOE,QAAU,EAC7C0M,EAAU5M,EAAOgI,IACjB6E,EAAa7M,EAAOgI,IAAMhI,EAAOC,QAAU,EAC/C,OAAOyM,GAAYD,EAAOK,WAAaH,GAAaF,EAAOM,UAAaH,GAAWH,EAAOO,WAAaH,GAAcJ,EAAOQ,UAE1HC,GAAW,SAAUT,EAAQzM,GAC/B,OAAOA,EAAOkI,QAAUuE,EAAOM,UAAY/M,EAAOkI,OAASlI,EAAOE,QAAU,GAAKuM,EAAOK,WAAa9M,EAAOgI,KAAOyE,EAAOQ,UAAYjN,EAAOgI,IAAMhI,EAAOC,QAAU,GAAKwM,EAAOO,WAgB9KG,GAAY,SAAU5C,EAAW6C,EAAWC,GAC9C,IAAIC,EAAcxB,GAAUE,SAASzB,EAAW6C,EAAWpP,IACvDuP,EAAezB,GAAUE,SAASzB,EAAW8C,EAAYrP,IAC7D,OAAOsP,EAAY5b,MAAK,SAAU8b,GAChC,OAAOD,EAAa/b,KAAI,SAAUic,GAChC,OARoBC,EAQHF,EARYG,EAQRF,EAtpBJR,EA+oBPrB,KAAKgC,IAAIF,EAAQ1F,IAAK2F,EAAQ3F,KA/oBb+E,EA+oBmBnB,KAAKgC,IAAIF,EAAQxF,OAAQyF,EAAQzF,QA/oB1C8E,EA+oBmDpB,KAAKC,IAAI6B,EAAQ1F,IAAM0F,EAAQzN,QAAU,EAAG0N,EAAQ3F,IAAM2F,EAAQ1N,QAAU,GA/oBpH6M,EA+oBwHlB,KAAKC,IAAI6B,EAAQxF,OAASwF,EAAQxN,QAAU,EAAGyN,EAAQzF,OAASyF,EAAQzN,QAAU,GA9oBvP,CACL+M,SAAUA,EACVF,SAAUA,EACVC,UAAWA,EACXF,UAAWA,GAyoBC,IAAUY,EAASC,EA9oBZV,EAAUF,EAAUC,EAAWF,SA0pBlDe,GAAS,SAAUtD,EAAW6C,EAAWC,GAC3C,OAAOF,GAAU5C,EAAW6C,EAAWC,GAAY3b,MAAK,SAAU+a,GAChE,OAzBgB,SAAUlC,EAAWkC,GAGvC,IAFA,IAAIqB,GAAS,EACTC,EAAiB3e,EAAM8d,GAAUT,GAC5BlZ,EAAIkZ,EAAOQ,SAAU1Z,GAAKkZ,EAAOO,UAAWzZ,IACnD,IAAK,IAAI8B,EAAIoX,EAAOM,SAAU1X,GAAKoX,EAAOK,UAAWzX,IACnDyY,EAASA,GAAUhC,GAAUC,MAAMxB,EAAWhX,EAAG8B,GAAG1D,OAAOoc,GAG/D,OAAOD,EAASpb,EAASR,KAAKua,GAAU/Z,EAASxC,OAiBxC8d,CAAczD,EAAWkC,OAchCwB,GAAa,SAAU1D,EAAW7S,EAAOwW,GAC3C,OAAOf,GAAU5C,EAAW7S,EAAOwW,GAAQ1c,KAAI,SAAUib,GACvD,IAAI0B,EAASrC,GAAUxB,YAAYC,EAAWnb,EAAMod,GAAaC,IACjE,OAAOjb,EAAI2c,GAAQ,SAAUnO,GAC3B,OAAOA,EAAOzC,eAIhB6Q,GAAa,SAAU7D,EAAW8D,GAIpC,OAAOvC,GAAUE,SAASzB,EAAW8D,GAHjB,SAAUC,EAAIC,GAChC,OAAO/P,GAAW+P,EAAID,MAEuC9c,KAAI,SAAUwO,GAC3E,OAAOA,EAAOzC,YAIdiR,GAAW,SAAU/H,EAAMgI,EAAUC,GACvC,OAAO/G,GAAMlB,GAAM/U,MAAK,SAAUiW,GAEhC,OA9BS,SAAU4C,EAAW9D,EAAMuB,EAAKE,GAC3C,OAAO4D,GAAUE,SAASzB,EAAW9D,EAAMzI,IAAMtM,MAAK,SAAUsO,GAC9D,IAAIiN,EAAWjF,EAAM,EAAIhI,EAAOgI,IAAMhI,EAAOC,QAAU,EAAID,EAAOgI,IAC9D+E,EAAW7E,EAAS,EAAIlI,EAAOkI,OAASlI,EAAOE,QAAU,EAAIF,EAAOkI,OAExE,OADW4D,GAAUC,MAAMxB,EAAW0C,EAAWjF,EAAK+E,EAAW7E,GACrD1W,KAAI,SAAUmd,GACxB,OAAOA,EAAEpR,cAwBJqR,CADSC,GAAalH,GACJlB,EAAMgI,EAAUC,OAGzCI,GAAe,SAAUnH,EAAOoH,EAAOta,GACzC,IAAI8V,EAAYsE,GAAalH,GAC7B,OAAOsG,GAAW1D,EAAWwE,EAAOta,IAElCua,GAAmB,SAAUrH,EAAOoH,EAAOE,EAAYxa,EAAMya,GAC/D,IAAI3E,EAAYsE,GAAalH,GACzBwH,EAAenR,GAAK2J,EAAOsH,GAAcvc,EAASR,KAAK6c,GAASX,GAAW7D,EAAWwE,GACtFK,EAAcpR,GAAK2J,EAAOuH,GAAaxc,EAASR,KAAKuC,GAAQ2Z,GAAW7D,EAAW9V,GACvF,OAAO0a,EAAazd,MAAK,SAAU0b,GACjC,OAAOgC,EAAY1d,MAAK,SAAU2d,GAChC,OAAOpB,GAAW1D,EAAW6C,EAAWiC,UAQ1CR,GAAe/C,GAAUxD,UAEzBK,GAAS,SAAU2G,EAAQ/R,GACdiE,GAAO8N,GACb7d,MAAK,SAAUc,GACtBA,EAAE0J,IAAIsT,aAAahS,EAAQtB,IAAKqT,EAAOrT,SAGvC2M,GAAQ,SAAU0G,EAAQ/R,GACd0E,GAAYqN,GAClB3e,MAAK,WACI6Q,GAAO8N,GACb7d,MAAK,SAAUc,GACtBid,GAAOjd,EAAGgL,SAEX,SAAUhL,GACXoW,GAAOpW,EAAGgL,OAGVkS,GAAU,SAAUjO,EAAQjE,IA/oBf,SAAUA,GACzB,OAAO4E,GAAM5E,EAAS,IA+oBHmS,CAAWlO,GACjB7Q,MAAK,WAChB6e,GAAOhO,EAAQjE,MACd,SAAUhL,GACXiP,EAAOvF,IAAIsT,aAAahS,EAAQtB,IAAK1J,EAAE0J,SAGvCuT,GAAS,SAAUhO,EAAQjE,GAC7BiE,EAAOvF,IAAI0T,YAAYpS,EAAQtB,MAE7B2T,GAAO,SAAUrS,EAASsS,GAC5BlH,GAAOpL,EAASsS,GAChBL,GAAOK,EAAStS,IAQduS,GAAU,SAAUR,EAAQS,GAC9Bte,EAAKse,GAAU,SAAUjiB,EAAGyF,GAC1B,IAAI4N,EAAU,IAAN5N,EAAU+b,EAASS,EAASxc,EAAI,GACxCqV,GAAMzH,EAAGrT,OAGTkiB,GAAW,SAAUxO,EAAQuO,GAC/Bte,EAAKse,GAAU,SAAUjiB,GACvB0hB,GAAOhO,EAAQ1T,OAIfmiB,GAAQ,SAAU1S,GACpBA,EAAQtB,IAAIiU,YAAc,GAC1Bze,EAAKyQ,GAAS3E,IAAU,SAAU4S,GAChCC,GAASD,OAGTC,GAAW,SAAU7S,GACvB,IAAItB,EAAMsB,EAAQtB,IACK,OAAnBA,EAAIwF,YACNxF,EAAIwF,WAAW4O,YAAYpU,IAG3BqU,GAAS,SAAUT,GACrB,IA9BuBP,EA8BnB1L,EAAa1B,GAAS2N,GACtBjM,EAAWnU,OAAS,IA/BD6f,EAgCZO,EA/BXpe,EA+BoBmS,GA/BL,SAAU9V,GACvB6a,GAAO2G,EAAQxhB,OAgCjBsiB,GAASP,IA0BPU,GAvBY,SAAU1f,EAAI1C,GAC5B,IAMIqiB,EAAY,SAAUjT,GACxB,OAAO1M,EAAG0M,GAAW7K,EAASC,KAAK4K,EAAQtB,IAAIwU,WAAa/d,EAASxC,QAQvE,MAAO,CACLqE,IAhBQ,SAAUgJ,GAClB,IAAK1M,EAAG0M,GACN,MAAM,IAAIpM,MAAM,gBAAkBhD,EAAO,eAAiBA,EAAO,SAEnE,OAAOqiB,EAAUjT,GAASxM,MAAM,KAahCyf,UAAWA,EACX5L,IATQ,SAAUrH,EAAS1P,GAC3B,IAAKgD,EAAG0M,GACN,MAAM,IAAIpM,MAAM,oBAAsBhD,EAAO,eAAiBA,EAAO,SAEvEoP,EAAQtB,IAAIwU,UAAY5iB,IASlB6iB,CAAU3P,GAAQ,QACxB4P,GAAQ,SAAUpT,GACpB,OAAOgT,GAAIhc,IAAIgJ,IAEbiT,GAAY,SAAUjT,GACxB,OAAOgT,GAAIC,UAAUjT,IAEnBqT,GAAQ,SAAUrT,EAAS1P,GAC7B,OAAO0iB,GAAI3L,IAAIrH,EAAS1P,IAGtBgjB,GAAgB,CAClB,OACA,IACA,MACA,UACA,QACA,aACA,SACA,SACA,SACA,MACA,UACA,KACA,KACA,KACA,QACA,QACA,QACA,QACA,UACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,aACA,MACA,WAGF,SAASC,KAmDP,MAAO,CACLC,GAAI7hB,EAAS,CACXsO,SAAU2G,GACV6M,QAASvM,GACTlB,UAAWU,GACXtU,IAAK+R,KAEPuP,KAAM/hB,EAAS,CACbsO,SAAUqG,GACVN,UAAWD,KAEb4N,OAAQhiB,EAAS,CACfqF,IAAKyR,GACLG,OAAQA,GACRvB,IAAKiB,GACLX,OAAQmB,KAEVvB,MAAO5V,EAAS,CACdqF,IAAKwQ,GACLH,IAAKA,GACLM,OAAQA,GACRiM,OAvCmB,SAAUC,EAAQC,GACvC,IAAIC,EAAKlM,GAAMgM,GACfvM,GAAOwM,EAAaC,MAuCpBC,OAAQriB,EAAS,CACfyZ,OAAQA,GACRC,MAAOA,GACP4I,SAAU1B,GACVN,OAAQA,GACRiC,UAAWzB,GACXP,QAASA,GACTG,KAAMA,KAER1K,OAAQhW,EAAS,CACfohB,OAAQA,GACRpL,OAAQkL,KAEVsB,OAAQxiB,EAAS,CACfyG,GAAIuG,GAAaY,QACjBsI,MAxFU,SAAU7H,GACtB,OAAOrB,GAAaH,QAAQwB,EAAQtB,IAAI0V,WAAU,KAwFhD1U,KAAMf,GAAac,WAErBxB,MAAOtM,EAAS,CACd0iB,gBA/DkB,SAAUrU,EAASsU,GACvC,OAAOtU,EAAQtB,IAAIoC,wBAAwBwT,EAAM5V,MA+D/C8F,YAAaA,GACbE,YAAaA,KAEf0D,SAAUzW,EAAS,CACjBgT,SAAUA,GACV/T,KAAMA,GACNqT,OAAQA,GACRjF,SAjGW,SAAUgB,GACvB,OAAO+D,GAAgB/D,GAAStB,KAiG9B8E,OAAQA,GACRF,UAAWA,GACXC,UAAWA,GACXgR,UApEY,SAAUvU,GACxB,IAAIR,EAAM5O,GAAKoP,GACf,OAAOrK,EAAS,CACd,SACA,WACA,SACA,WACA,UACA,QACA,QACA,WACA,OACC6J,IAyDDgV,QAASpB,GACTqB,QAASpB,GACTqB,WArGa,SAAU1U,GACzB,QAAKuD,GAAUvD,KAGO,SAAlBpP,GAAKoP,IAGFrK,EAAS2d,GAAe1iB,GAAKoP,MA+FlC2U,WA7Fa,SAAU3U,GACzB,QAAKuD,GAAUvD,IAGRrK,EAAS,CACd,KACA,MACA,KACA,SACC/E,GAAKoP,KAqFN4U,cAnFgB,SAAU5U,GAC5B,OAAOuD,GAAUvD,IAAkD,UAAtCwH,GAAMxH,EAAS,sBAoF5CnN,GAAI4N,GACJnN,GAAI+N,IAIR,IA4pBMwT,GAEAC,GAEAC,GAGAC,GA3pBFC,GAAY,SAAUC,EAAUC,EAAMle,EAAMme,GAC9C,IAAIjb,EAAQgb,EAAKD,EAAUje,GAC3B,OAAOZ,EAAM+e,GAAM,SAAUlgB,EAAG7D,GAC9B,IAAIwI,EAAUsb,EAAKD,EAAU7jB,GAC7B,OAAOgkB,GAAcH,EAAUhgB,EAAG2E,KACjCM,IAEDkb,GAAgB,SAAUH,EAAU/a,EAAOmb,GAC7C,OAAOnb,EAAMhG,MAAK,SAAUY,GAC1B,OAAOugB,EAAIhhB,OAAOzC,EAAMqjB,EAASriB,GAAIkC,QAiCrCwgB,GA7CS,SAAUL,EAAUC,EAAM3C,GACrC,OAAOA,EAAStgB,OAAS,EANf,SAAUgjB,EAAUC,EAAM3C,EAAUhgB,GAG9C,OAAOA,EAAE0iB,EAAUC,EAFR3C,EAAS,GACTA,EAASld,MAAM,IAIGkgB,CAAMN,EAAUC,EAAM3C,EAAUyC,IAAa9f,EAASxC,QA6CjF8iB,GA3Bc,SAAUP,EAAU/a,EAAOmb,EAAKlR,QACjC,IAAXA,IACFA,EAAS3R,GAEX,IAAIijB,EAAM,CAACvb,GAAO9H,OAAO6iB,EAAS1B,KAAKphB,IAAI+H,IACvCwb,EAAM,CAACL,GAAKjjB,OAAO6iB,EAAS1B,KAAKphB,IAAIkjB,IACrCM,EAAQ,SAAUC,GAEpB,OADYjf,EAAUif,EAAMzR,GACfhR,MAAK,WAChB,OAAOyiB,KACN,SAAUC,GACX,OAAOD,EAAKvgB,MAAM,EAAGwgB,EAAM,OAG3BC,EAAUH,EAAMF,GAChBM,EAAUJ,EAAMD,GAChBM,EAASxf,EAAKsf,GAAS,SAAUxlB,GACnC,OAAO6D,EAAO4hB,EApBP,SAAUd,EAAUxG,GAC7B,OAAO7c,EAAMqjB,EAASriB,GAAI6b,GAmBDwH,CAAKhB,EAAU3kB,OAExC,MAAO,CACL4lB,UAAWJ,EACXK,WAAYJ,EACZC,OAAQA,IAORf,GAAW3B,KACX8C,GAAc,SAAUlB,EAAM3C,GAChC,OAAO+C,GAAUL,IAAU,SAAUoB,EAAWtW,GAC9C,OAAOmV,EAAKnV,KACXwS,IAMD+D,GAAc,SAAUC,GAC1B,OAAO5P,GAAW4P,EAAW,UAE3BC,GAAW,SAAUtc,EAAOwW,EAAQvM,GACtC,IAAIsS,EAAY,SAAUC,GACxB,OAAO,SAAU3W,GACf,YAAkB5O,IAAXgT,GAAwBA,EAAOpE,IAAYS,GAAKT,EAAS2W,KAGpE,OAAIlW,GAAKtG,EAAOwW,GACPxb,EAASR,KAAK,CACnBiiB,MAAOzhB,EAASR,KAAK,CAACwF,IACtBA,MAAOA,EACPwW,OAAQA,IAGH4F,GAAYpc,GAAOhG,MAAK,SAAU0iB,GACvC,OAAON,GAAY5F,GAAQxc,MAAK,SAAU2iB,GACxC,GAAIrW,GAAKoW,EAAYC,GACnB,OAAO3hB,EAASR,KAAK,CACnBiiB,MAAOrF,GAAasF,EAAY1c,EAAOwW,GACvCxW,MAAOA,EACPwW,OAAQA,IAEL,GAAI1P,GAAW4V,EAAYC,GAAc,CAC9C,IACIhH,GADAiH,EAAgB7Q,GAAYyK,EAAQ,QAAS+F,EAAUG,KAC5B3kB,OAAS,EAAI6kB,EAAcA,EAAc7kB,OAAS,GAAKye,EACtF,OAAOxb,EAASR,KAAK,CACnBiiB,MAAOnF,GAAiBoF,EAAY1c,EAAO0c,EAAYlG,EAAQmG,GAC/D3c,MAAOA,EACPwW,OAAQb,IAEL,GAAI7O,GAAW6V,EAAaD,GAAa,CAC9C,IAAIE,EACAlH,GADAkH,EAAgB7Q,GAAY/L,EAAO,QAASuc,EAAUI,KAC5B5kB,OAAS,EAAI6kB,EAAcA,EAAc7kB,OAAS,GAAKiI,EACrF,OAAOhF,EAASR,KAAK,CACnBiiB,MAAOnF,GAAiBqF,EAAa3c,EAAO0c,EAAYlG,EAAQmG,GAChE3c,MAAOA,EACPwW,OAAQd,IAGV,OA7CQ,SAAU1V,EAAOwW,EAAQvM,GACzC,OAAOqR,GAAYP,GAAU/a,EAAOwW,EAAQvM,GA4C7B4S,CAAY7c,EAAOwW,GAAQsF,OAAO9hB,MAAK,SAAU8iB,GACtD,OAAO/P,GAAU+P,EAAK,QAAS7S,GAAQjQ,MAAK,SAAU+iB,GACpD,IAAIC,EAAsBjR,GAAYyK,EAAQ,QAAS+F,EAAUQ,IAC7DpH,EAAaqH,EAAoBjlB,OAAS,EAAIilB,EAAoBA,EAAoBjlB,OAAS,GAAKye,EACpGyG,EAAqBlR,GAAY/L,EAAO,QAASuc,EAAUQ,IAC3DrH,EAAYuH,EAAmBllB,OAAS,EAAIklB,EAAmBA,EAAmBllB,OAAS,GAAKiI,EACpG,OAAOhF,EAASR,KAAK,CACnBiiB,MAAOnF,GAAiByF,EAAU/c,EAAO0c,EAAYlG,EAAQmG,GAC7D3c,MAAO0V,EACPc,OAAQb,iBASpBuH,GAAW,SAAUb,EAAWvW,GAClC,IAAIqX,EAAOhR,GAAckQ,EAAWvW,GACpC,OAAOqX,EAAKplB,OAAS,EAAIiD,EAASR,KAAK2iB,GAAQniB,EAASxC,QAOtD4kB,GAAW,SAAUf,EAAWgB,EAAuBC,GACzD,OAAO1Q,GAAayP,EAAWgB,GAAuBrjB,MAAK,SAAUqd,GACnE,OAAOzK,GAAayP,EAAWiB,GAAsBtjB,MAAK,SAAU+C,GAClE,OAAOmf,GAAYE,GAAa,CAC9B/E,EACAta,IACCjD,KAAI,SAAUmW,GACf,MAAO,CACLoH,MAAOA,EACPta,KAAMA,EACNkT,MAAOA,aAqBbsN,GAAiB,SAAUd,EAAO1F,EAAUC,EAAaqG,EAAuBC,GAClF,OArCY,SAAUb,EAAOa,GAC7B,OAAOhhB,EAAKmgB,GAAO,SAAUe,GAC3B,OAAOrkB,GAAGqkB,EAAKF,MAmCVG,CAAQhB,EAAOa,GAAsBtjB,MAAK,SAAU+C,GACzD,OAAO+Z,GAAS/Z,EAAMga,EAAUC,GAAahd,MAAK,SAAUwc,GAC1D,OAlBS,SAAUA,EAAQ6G,GAC/B,OAAO5Q,GAAW+J,EAAQ,SAASxc,MAAK,SAAUiW,GAChD,OAAOrD,GAAaqD,EAAOoN,GAAuBrjB,MAAK,SAAUgG,GAC/D,OAAOsc,GAAStc,EAAOwW,GAAQxc,MAAK,SAAU0jB,GAC5C,OAAOA,EAAWjB,MAAM3iB,KAAI,SAAU2iB,GACpC,MAAO,CACLA,MAAOA,EACPzc,MAAO0d,EAAW1d,MAClBwW,OAAQkH,EAAWlH,oBAUlBmH,CAASnH,EAAQ6G,UAK1BO,GAAa,SAAUvB,EAAWvW,GACpC,OAAOoX,GAASb,EAAWvW,IAEzB+X,GAAc,SAAUxB,EAAWgB,EAAuBC,GAC5D,OAAOF,GAASf,EAAWgB,EAAuBC,GAAsBtjB,MAAK,SAAU8jB,GACrF,IAAI7T,EAAS,SAAUsC,GACrB,OAAOjG,GAAK+V,EAAW9P,IAErBwR,EAAkB,0BAClBC,EAAgBvR,GAAWqR,EAAMzG,MAAO0G,EAAiB9T,GACzDgU,EAAexR,GAAWqR,EAAM/gB,KAAMghB,EAAiB9T,GAC3D,OAAO+T,EAAchkB,MAAK,SAAUkkB,GAClC,OAAOD,EAAajkB,MAAK,SAAUmkB,GACjC,OAAO7X,GAAK4X,EAAIC,GA5bT,SAAUlO,EAAOoH,EAAOta,GACrC,IAAI8V,EAAYsE,GAAalH,GAC7B,OAAOkG,GAAOtD,EAAWwE,EAAOta,GA0bJqhB,CAASN,EAAM7N,MAAO6N,EAAMzG,MAAOyG,EAAM/gB,MAAQ/B,EAASxC,iBA6EpF6lB,GAvEa,SAAUC,GACzB,IAAKxnB,EAAQwnB,GACX,MAAM,IAAI7kB,MAAM,0BAElB,GAAqB,IAAjB6kB,EAAMvmB,OACR,MAAM,IAAI0B,MAAM,mCAElB,IAAI8kB,EAAe,GACfC,EAAM,GA6DV,OA5DAzkB,EAAKukB,GAAO,SAAUG,EAAOC,GAC3B,IAAIC,EAASxX,GAAKsX,GAClB,GAAsB,IAAlBE,EAAO5mB,OACT,MAAM,IAAI0B,MAAM,kCAElB,IAAIyO,EAAMyW,EAAO,GACbxoB,EAAQsoB,EAAMvW,GAClB,QAAiBjR,IAAbunB,EAAItW,GACN,MAAM,IAAIzO,MAAM,0BAA4ByO,GACvC,GAAY,SAARA,EACT,MAAM,IAAIzO,MAAM,yCACX,IAAK3C,EAAQX,GAClB,MAAM,IAAIsD,MAAM,mCAElB8kB,EAAahjB,KAAK2M,GAClBsW,EAAItW,GAAO,WAET,IADA,IAAInK,EAAO,GACFlG,EAAK,EAAGA,EAAKC,UAAUC,OAAQF,IACtCkG,EAAKlG,GAAMC,UAAUD,GAEvB,IAAI+mB,EAAY7gB,EAAKhG,OACrB,GAAI6mB,IAAczoB,EAAM4B,OACtB,MAAM,IAAI0B,MAAM,qCAAuCyO,EAAM,cAAgB/R,EAAM4B,OAAS,KAAO5B,EAAQ,UAAYyoB,GAEzH,IAAIlY,EAAQ,SAAUmY,GACpB,IAAIC,EAAa3X,GAAK0X,GACtB,GAAIN,EAAaxmB,SAAW+mB,EAAW/mB,OACrC,MAAM,IAAI0B,MAAM,iDAAmD8kB,EAAa5O,KAAK,KAAO,aAAemP,EAAWnP,KAAK,MAK7H,IAHczV,EAAOqkB,GAAc,SAAUQ,GAC3C,OAAOvjB,EAASsjB,EAAYC,MAG5B,MAAM,IAAItlB,MAAM,gEAAkEqlB,EAAWnP,KAAK,MAAQ,eAAiB4O,EAAa5O,KAAK,OAE/I,OAAOkP,EAAS3W,GAAK/P,MAAM,KAAM4F,IAEnC,MAAO,CACL9E,KAAM,WAEJ,IADA,IAAI+lB,EAAW,GACNnnB,EAAK,EAAGA,EAAKC,UAAUC,OAAQF,IACtCmnB,EAASnnB,GAAMC,UAAUD,GAE3B,GAAImnB,EAASjnB,SAAWumB,EAAMvmB,OAC5B,MAAM,IAAI0B,MAAM,+CAAiD6kB,EAAMvmB,OAAS,SAAWinB,EAASjnB,QAEtG,IAAI4I,EAASqe,EAASN,GACtB,OAAO/d,EAAOxI,MAAM,KAAM4F,IAE5B2I,MAAOA,EACPuY,IAAK,SAAUC,GACbha,QAAQ+Z,IAAIC,EAAO,CACjBX,aAAcA,EACd/nB,YAAa0R,EACbiX,OAAQphB,UAMXygB,GAILY,GAASf,GAAa,CACxB,CAAE7lB,KAAM,IACR,CAAE6mB,SAAU,CAAC,aACb,CAAEC,OAAQ,CAAC,cAETC,GAAO,SAAUC,EAASC,EAAQC,EAAYC,GAChD,OAAOH,EAAQvmB,KAAKwmB,EAAQC,EAAYC,IAEtCC,GAASR,GAAO5mB,KAChB6mB,GAAWD,GAAOC,SAClBC,GAASF,GAAOE,OAahBO,GAASC,QAAQC,KAAKC,MAAMC,QAAQ,yBAEpCC,GAAU,SAAUC,EAAUC,GAChC,OAAO5b,GAAaH,QAAQ8b,EAAS5b,IAAI0V,UAAUmG,KAEjDC,GAAU,SAAUF,GACtB,OAAOD,GAAQC,GAAU,IAEvBG,GAAO,SAAUH,GACnB,OAAOD,GAAQC,GAAU,IAQvBI,GAAS,SAAUJ,EAAU9a,GAC/B,IAAIpH,EAPU,SAAUkiB,EAAU9a,GAClC,IAAIpH,EAAKuG,GAAaY,QAAQC,GAC1BsI,EAAaD,GAAMyS,GAEvB,OADAhT,GAAOlP,EAAI0P,GACJ1P,EAGEuiB,CAAUL,EAAU9a,GACzBob,EAAgBjW,GAAS8V,GAAKH,IAElC,OADA7H,GAASra,EAAIwiB,GACNxiB,GAGLyiB,GAAM,SAAUzjB,GAKlB,IAJA,IAAIhB,EAAI,GACJV,EAAO,SAAUnF,GACnB6F,EAAEV,KAAKnF,IAEAyF,EAAI,EAAGA,EAAIoB,EAAIlF,OAAQ8D,IAC9BoB,EAAIpB,GAAG9B,KAAKwB,GAEd,OAAOU,GAQL0kB,GAAS,SAAU5lB,EAAG7D,GACxB,OAAO6D,EAAIC,EAASR,KAAKtD,GAAK8D,EAASxC,QAGrCooB,GAAY,SAAUnqB,EAAMoqB,GAC9B,IASIhkB,EAAM,SAAUgJ,GAClB,IAAI5J,EAAI4kB,EAAUhb,GAClB,GAAI5J,GAAK,GAAW,OAANA,EAAY,CACxB,IAAIoS,EAAMC,GAAMzI,EAASpP,GACzB,OAAOqqB,WAAWzS,IAAQ,EAE5B,OAAOpS,GAGL8kB,EAAY,SAAUlb,EAASmb,GACjC,OAAO3kB,EAAM2kB,GAAY,SAAU7kB,EAAK8R,GACtC,IAAIgT,EAAM3S,GAAMzI,EAASoI,GACrB9X,OAAgBc,IAARgqB,EAAoB,EAAIhS,SAASgS,EAAK,IAClD,OAAOC,MAAM/qB,GAASgG,EAAMA,EAAMhG,IACjC,IAOL,MAAO,CACL+W,IA/BQ,SAAUrH,EAASsb,GAC3B,IAAK7pB,EAAS6pB,KAAOA,EAAEza,MAAM,YAC3B,MAAM,IAAIjN,MAAMhD,EAAO,wDAA0D0qB,GAEnF,IAAI5c,EAAMsB,EAAQtB,IACdsJ,GAActJ,KAChBA,EAAIuJ,MAAMrX,GAAQ0qB,EAAI,OA0BxBtkB,IAAKA,EACLukB,SAhBavkB,EAiBbkkB,UAAWA,EACX5M,IAVQ,SAAUtO,EAAS1P,EAAO6qB,GAClC,IAAIK,EAAuBN,EAAUlb,EAASmb,GAE9C,OADkB7qB,EAAQkrB,EAAuBlrB,EAAQkrB,EAAuB,KAYhFC,GAAQV,GAAU,SAAS,SAAU/a,GACvC,OAAOA,EAAQtB,IAAIgd,eAEjBC,GAAQ,SAAU3b,GACpB,OAAOyb,GAAMzkB,IAAIgJ,IAEfub,GAAW,SAAUvb,GACvB,OAAOyb,GAAMF,SAASvb,IAGpB4b,GAAY,SAAU5O,EAAW6O,QACf,IAAhBA,IACFA,EAAcnpB,GAEhB,IAAIqZ,EAAOiB,EAAUjB,KACjBI,EAAOjW,EAAM6V,EAAK9B,QAASrY,GAC3BkqB,EAAU5lB,EAAM6V,EAAK1B,KAAMzY,GAC/B,OAAOqC,EAAIkY,GAAM,SAAU4P,GAczB,OAAOC,IAbQ,WACb,OAAO7nB,EAAK2nB,GAAS,SAAU1lB,GAC7B,OAAOmY,GAAUC,MAAMxB,EAAW5W,EAAG2lB,GAAKznB,QAAO,SAAUmO,GACzD,OAAOA,EAAOkI,SAAWoR,KACxBtnB,gBAGO,SAAUgO,GACtB,OAA0B,IAAnBA,EAAOE,SAAiBkZ,EAAYpZ,EAAOzC,YAElC,WAChB,OAAOuO,GAAUC,MAAMxB,EAAW,EAAG+O,UAKvCC,GAAS,SAAUC,EAAUC,EAASC,GACxC,IAAIC,EAAUH,IAKd,OAJmBxlB,EAAK2lB,EAASF,GACDloB,SAAQ,WACtC,OAAOmB,EAASC,KAAKgnB,EAAQ,IAAIpoB,QAAQmoB,MAEvBloB,KAAI,SAAUwO,GAChC,OAAOA,EAAOzC,YAGdgL,GAAS,SAAUgC,GACrB,IAAIjB,EAAOiB,EAAUjB,KACjB+P,EAAU5lB,EAAM6V,EAAK1B,KAAMzY,GAC3Bua,EAAOjW,EAAM6V,EAAK9B,QAASrY,GAC/B,OAAOqC,EAAI6nB,GAAS,SAAUrR,GAgB5B,OAAOuR,IAfQ,WACb,OAAO7nB,EAAKgY,GAAM,SAAUkQ,GAC1B,OAAO9N,GAAUC,MAAMxB,EAAWvC,EAAK4R,GAAG/nB,QAAO,SAAUmO,GACzD,OAAOA,EAAOgI,MAAQA,KACrBrX,KAAKzB,EAAS,KAAK,SAAU8Q,GAC9B,MAAO,CAACA,YAIC,SAAUA,GACvB,OAA0B,IAAnBA,EAAOC,WAEE,WAChB,OAAO6L,GAAUC,MAAMxB,EAAWvC,EAAK,UAMzC6R,GAAS,SAAU1mB,EAAIiP,GACzB,GAAIA,EAAQ,GAAKA,GAASjP,EAAG1D,OAAS,EACpC,OAAOiD,EAASxC,OAElB,IAAIkH,EAAUjE,EAAGiP,GAAOzR,MAAK,WAC3B,IAAImpB,EA9iEM,SAAU3mB,GACtB,IAAIQ,EAAIf,EAAYrC,KAAK4C,EAAI,GAE7B,OADAQ,EAAEomB,UACKpmB,EA2iEMomB,CAAQ5mB,EAAGN,MAAM,EAAGuP,IAC/B,OAAO1N,EAAQolB,GAAM,SAAUlrB,EAAG2E,GAChC,OAAO3E,EAAE4C,KAAI,SAAUwoB,GACrB,MAAO,CACLnsB,MAAOmsB,EACPC,MAAO1mB,EAAI,YAIhB,SAAUqmB,GACX,OAAOlnB,EAASR,KAAK,CACnBrE,MAAO+rB,EACPK,MAAO,OAGPC,EAAO/mB,EAAGiP,EAAQ,GAAGzR,MAAK,WAC5B,IAAImpB,EAAO3mB,EAAGN,MAAMuP,EAAQ,GAC5B,OAAO1N,EAAQolB,GAAM,SAAUlrB,EAAG2E,GAChC,OAAO3E,EAAE4C,KAAI,SAAUwoB,GACrB,MAAO,CACLnsB,MAAOmsB,EACPC,MAAO1mB,EAAI,YAIhB,SAAU7C,GACX,OAAOgC,EAASR,KAAK,CACnBrE,MAAO6C,EACPupB,MAAO,OAGX,OAAO7iB,EAAQ1F,MAAK,SAAUkoB,GAC5B,OAAOM,EAAK1oB,KAAI,SAAUd,GACxB,IAAIypB,EAASzpB,EAAEupB,MAAQL,EAAEK,MACzB,OAAOrO,KAAKwO,IAAI1pB,EAAE7C,MAAQ+rB,EAAE/rB,OAASssB,SAKvCE,GAAc,SAAUC,EAAOC,GACjC,OAAO,SAAUhd,GACf,MAAiC,QAA1Bid,GAAajd,GAAqBgd,EAAQD,IAGjDE,GAAe,SAAUjd,GAC3B,MAAuC,QAAhCyI,GAAMzI,EAAS,aAAyB,MAAQ,OAGrDkd,GAAQnC,GAAU,UAAU,SAAU/a,GACxC,IAAItB,EAAMsB,EAAQtB,IAClB,OAAO+G,GAAOzF,GAAWtB,EAAIye,wBAAwBC,OAAS1e,EAAI2e,gBAEhEC,GAAQ,SAAUtd,GACpB,OAAOkd,GAAMlmB,IAAIgJ,IAEfud,GAAa,SAAUvd,GACzB,OAAOkd,GAAM3B,SAASvb,IAGpB5J,GAAI,SAAUonB,EAAMC,GAItB,MAAO,CACLD,KAAMA,EACNC,IAAKA,EACLC,UANc,SAAUntB,EAAGuP,GAC3B,OAAO1J,GAAEonB,EAAOjtB,EAAGktB,EAAM3d,MAQzB6d,GAAgBvnB,GAMhBwnB,GAAqB,SAAUvsB,EAAG6D,GACpC,YAAU9D,IAANC,EACKA,OAEMD,IAAN8D,EAAkBA,EAAI,GAG7B2oB,GAAW,SAAU7d,GACvB,IAAI4F,EAAM5F,EAAQtB,IAAIoF,cAClB+B,EAAOD,EAAIC,KACXiY,EAAMlY,EAAImY,YACVlf,EAAO+G,EAAIoY,gBACf,GAAInY,IAAS7F,EAAQtB,IACnB,OAAOif,GAAc9X,EAAKoY,WAAYpY,EAAKqY,WAE7C,IAAIC,EAAYP,GAAmBE,MAAAA,OAAiC,EAASA,EAAIM,YAAavf,EAAKsf,WAC/FE,EAAaT,GAAmBE,MAAAA,OAAiC,EAASA,EAAIQ,YAAazf,EAAKwf,YAChGE,EAAYX,GAAmB/e,EAAK0f,UAAW1Y,EAAK0Y,WACpDC,EAAaZ,GAAmB/e,EAAK2f,WAAY3Y,EAAK2Y,YAC1D,OAAOC,GAASze,GAAS0d,UAAUW,EAAaG,EAAYL,EAAYI,IAEtEE,GAAW,SAAUze,GACvB,IAAItB,EAAMsB,EAAQtB,IAEdmH,EADMnH,EAAIoF,cACC+B,KACf,OAAIA,IAASnH,EACJif,GAAc9X,EAAKoY,WAAYpY,EAAKqY,WAExCzY,GAAOzF,GAhCI,SAAUtB,GAC1B,IAAIiZ,EAAMjZ,EAAIye,wBACd,OAAOQ,GAAchG,EAAI6F,KAAM7F,EAAI8F,KAiC5BiB,CAAYhgB,GAFVif,GAAc,EAAG,IAKxBgB,GAAU,SAAUlU,EAAK3K,GAC3B,MAAO,CACL2K,IAAKA,EACL3K,EAAGA,IAGH8e,GAAU,SAAU7C,EAAKxrB,GAC3B,MAAO,CACLwrB,IAAKA,EACLxrB,EAAGA,IAGHsuB,GAAU,SAAU3V,GAEtB,OADU2U,GAAS3U,GACRsU,KAAOjC,GAASrS,IAEzB4V,GAAU,SAAU5V,GACtB,OAAO2U,GAAS3U,GAAMsU,MAEpBuB,GAAc,SAAUla,EAAOqE,GACjC,OAAO0V,GAAQ/Z,EAAOia,GAAQ5V,KAE5B8V,GAAe,SAAUna,EAAOqE,GAClC,OAAO0V,GAAQ/Z,EAAOga,GAAQ3V,KAE5B+V,GAAS,SAAU/V,GACrB,OAAO2U,GAAS3U,GAAMuU,KAEpByB,GAAa,SAAUra,EAAOqE,GAChC,OAAOyV,GAAQ9Z,EAAOoa,GAAO/V,KAE3BiW,GAAgB,SAAUta,EAAOqE,GACnC,OAAOyV,GAAQ9Z,EAAOoa,GAAO/V,GAAQqU,GAAWrU,KAE9CkW,GAAgB,SAAUC,EAAcC,EAAcC,GACxD,GAAqB,IAAjBA,EAAMrtB,OACR,MAAO,GAET,IAAIstB,EAAQvrB,EAAIsrB,EAAMjqB,MAAM,IAAI,SAAUmqB,EAAY5a,GACpD,OAAO4a,EAAWxrB,KAAI,SAAUiV,GAC9B,OAAOmW,EAAaxa,EAAOqE,SAG3BwW,EAAWH,EAAMA,EAAMrtB,OAAS,GAAG+B,KAAI,SAAUiV,GACnD,OAAOoW,EAAaC,EAAMrtB,OAAS,EAAGgX,MAExC,OAAOsW,EAAMntB,OAAO,CAACqtB,KAKnBtC,GAAS,CACXV,MAAO9qB,EACP+tB,UAAW,SAAUC,GACnB,OAAOR,GAAcF,GAAYC,GAAeS,IAElD3kB,KAAMgkB,IAEJY,GAAM,CACRnD,MAAO9qB,EACPqJ,KAAM6jB,GACNa,UAAW,SAAUC,GACnB,OAAOR,GAAcL,GAAaC,GAAcY,KAGhDE,GAAM,CACRpD,MAlBW,SAAUqD,GACrB,OAAQA,GAkBR9kB,KAAM4jB,GACNc,UAAW,SAAUC,GACnB,OAAOR,GAAcJ,GAAcD,GAAaa,KAGhDI,GAAWlD,GAAY+C,GAAKC,IAC5BG,GAAQ,CACVvD,MAAO,SAAUwD,EAAQ9V,GACvB,OAAO4V,GAAS5V,GAAOsS,MAAMwD,EAAQ9V,IAEvCuV,UAAW,SAAUxT,EAAM/B,GACzB,OAAO4V,GAAS5V,GAAOuV,UAAUxT,EAAM/B,IAEzCnP,KAAM,SAAUiO,GACd,OAAO8W,GAAS9W,GAAMjO,KAAKiO,KAI3BiX,GAAQ,CACVC,kBAAmB,CACjB,KACA,KACA,MACA,KACA,KACA,MACA,KACA,MACA,KACA,KACA,KACA,KACA,OACA,OACA,KACA,KACA,IACA,KACA,KACA,KACA,MAEFC,MAAO,CACL,KACA,MAEFC,SAAU,CAAC,KACX5N,MAAO,CAAC,KAEN6N,IACE1L,GAAgB,SAEhBC,GAAe,kBAEfC,GAAM,SAAUyL,GAClB,MAAO,MAAQA,EAAQ,MAErBxL,GAAyB,CAC3B,WACAH,YAAsBE,GAAIF,IAAiBE,GAAID,IAC/C2L,YAAsB1L,GAAID,IAC1BD,GAAgBE,GAAID,KACpBhL,KAAK,KAEA,IAAI4W,OAAO,aADO1L,GACP,YAShB2L,GAAQ,SAAUH,EAAOI,GAE3B,OADYzrB,EAASC,KAAKmrB,GAAQM,KAAKL,IAC1BrsB,MAAK,SAAUorB,GAC1B,IAAIjvB,EAAQ2I,OAAOsmB,EAAM,IACrBuB,EAAUvB,EAAM,GACpB,OAZS,SAAUwB,EAAMH,GAC3B,OAAOxsB,EAAOwsB,GAAU,SAAUtqB,GAChC,OAAOlC,EAAO+rB,GAAM7pB,IAAM,SAAU0qB,GAClC,OAAOD,IAASC,QASdC,CAAOH,EAASF,GACXzrB,EAASR,KAAK,CACnBrE,MAAOA,EACPywB,KAAMD,IAGD3rB,EAASxC,WAKlBuuB,GAAiB,WACnB,IAAIvnB,EAAU4E,KAAW5E,QACzB,OAAOA,EAAQgC,QAAUhC,EAAQ8B,UAM/B0lB,GAAU,SAAUpX,EAAKnZ,EAAMuY,GACjC,OALa,SAAUiY,EAAIjY,GAC3B,IAAIhT,EAAM8kB,WAAWmG,GACrB,OAAO/F,MAAMllB,GAAOgT,EAAWhT,EAGxBkrB,CAAS5Y,GAAMsB,EAAKnZ,GAAOuY,IA8BhCmY,GAAY,SAAUpY,GACxB,OAAOgY,KA7BiB,SAAUhY,GAClC,IAAIkU,EAASlU,EAAKxK,IAAIye,wBAAwBC,OAE9C,MAAkB,eADF3U,GAAMS,EAAM,cAEnBkU,EAOAA,EALU+D,GAAQjY,EAAM,cAAe,GAC1BiY,GAAQjY,EAAM,iBAAkB,IACpCiY,GAAQjY,EAAM,mBAAoB,GAC/BiY,GAAQjY,EAAM,sBAAuB,IAoBhCqY,CAAoBrY,GAAQiY,GAAQjY,EAAM,SAAUoU,GAAMpU,KAElFsY,GAAW,SAAUtY,GACvB,OAAOgY,KAlBgB,SAAUhY,GACjC,IAAI+W,EAAQ/W,EAAKxK,IAAIye,wBAAwB8C,MAE7C,MAAkB,eADFxX,GAAMS,EAAM,cAEnB+W,EAOAA,EALWkB,GAAQjY,EAAM,eAAgB,GAC7BiY,GAAQjY,EAAM,gBAAiB,IACjCiY,GAAQjY,EAAM,oBAAqB,GAClCiY,GAAQjY,EAAM,qBAAsB,IAS9BuY,CAAmBvY,GAAQiY,GAAQjY,EAAM,QAASyS,GAAMzS,KAGhFwY,GAA4B,iBAC5BC,GAAuB,qBACvBC,GAAiB,SAAU7X,EAAK8X,GAClC,IAjoD2B7hB,EAioDvB8hB,GAjoDuB9hB,EAioDO+J,EAhoD3B5U,EAASC,KAAK4K,EAAQtB,IAAIqjB,cAAc9tB,IAAI0K,GAAaH,UAgoDzBhL,MAAMsS,GAAQjC,GAAMkG,KAC3D,OAAO8X,EAAO9X,GAAO8X,EAAOC,GAAkB,KAE5CE,GAAgB,SAAU9Y,EAAMgX,GAClC5X,GAAMY,EAAM,QAASgX,EAAS,OAE5B+B,GAAqB,SAAU/Y,EAAMgX,GACvC5X,GAAMY,EAAM,QAASgX,EAAS,MAE5BgC,GAAY,SAAUhZ,EAAMgX,GAC9B5X,GAAMY,EAAM,SAAUgX,EAAS,OAe7BiC,GAAqB,SAAU7xB,EAAO4Y,EAAM2Y,EAAQO,GACtD,IAAIC,EAASjZ,SAAS9Y,EAAO,IAC7B,OAAOiK,GAASjK,EAAO,MAAuB,UAAfM,GAAKsY,GAVxB,SAAUA,EAAMmZ,EAAQR,EAAQO,GAC5C,IAAIE,EAAUlY,GAAMlB,GAAMjV,KAAI,SAAUmW,GACtC,IAAImY,EAAQV,EAAOzX,GACnB,OAAOiE,KAAKmU,MAAMH,EAAS,IAAME,MAChC/uB,MAAM6uB,GAET,OADAD,EAAOlZ,EAAMoZ,GACNA,EAIiDG,CAAQvZ,EAAMmZ,EAAQR,EAAQO,GAAUC,GAE9FK,GAAiB,SAAUxZ,GAC7B,IAAI5Y,EAlBe,SAAU4Y,GAC7B,OAAON,GAAOM,EAAM,UAAUzV,YAAW,WACvC,OAAO6tB,GAAUpY,GAAQ,QAgBfyZ,CAAezZ,GAC3B,OAAK5Y,EAGE6xB,GAAmB7xB,EAAO4Y,EAAMoU,GAAO4E,IAFrC5E,GAAMpU,IASb0Z,GAAc,SAAU5iB,GAE1B,OADe4I,GAAO5I,EAAS,SACf5M,MAAK,WACnB,OAAO+B,EAASC,KAAKoS,GAAMxH,EAAS,aACnC,SAAUigB,GACX,OAAO9qB,EAASR,KAAKsrB,OAGrB4C,GAA2B,SAAUC,EAAWC,GAClD,OAAOD,EAAYC,EAAUC,aAAe,KAW1CC,GAAqB,SAAU/Z,EAAM6Z,GAEvC,OADYH,GAAY1Z,GACX9V,MAAK,WAChB,IAAI8vB,EAAWvH,GAAMzS,GACrB,OAAO2Z,GAAyBK,EAAUH,MACzC,SAAUlU,GACX,OAfuB,SAAU7O,EAASigB,EAAO8C,GACnD,IAAII,EAAezB,GAA0Bb,KAAKZ,GAClD,GAAqB,OAAjBkD,EACF,OAAOlI,WAAWkI,EAAa,IAE/B,IAAID,EAAW1B,GAASxhB,GACxB,OAAO6iB,GAAyBK,EAAUH,GASnCK,CAAqBla,EAAM2F,EAAGkU,OAkBrCM,GAAgB,SAAUna,EAAM6Z,GAElC,OADYH,GAAY1Z,GACX9V,MAAK,WAChB,OAAOouB,GAAStY,MACf,SAAU2F,GACX,OAjBkB,SAAU7O,EAASigB,EAAO8C,GAC9C,IAAIO,EAAa3B,GAAqBd,KAAKZ,GAC3C,GAAmB,OAAfqD,EACF,OAAOla,SAASka,EAAW,GAAI,IAEjC,IAAIH,EAAezB,GAA0Bb,KAAKZ,GAClD,OAAqB,OAAjBkD,EAToB,SAAUL,EAAWC,GAC7C,OAAOD,EAAY,IAAMC,EAAUC,aAU1BO,CADUtI,WAAWkI,EAAa,IACFJ,GAElCvB,GAASxhB,GAOPwjB,CAAgBta,EAAM2F,EAAGkU,OAGhCU,GAAc,SAAUva,GAC1B,OA1DU,SAAUA,EAAM7Y,EAAMmC,GAGhC,OAFQA,EAAE0W,GACCG,GAAQH,EAAM7Y,GAwDlBqzB,CAAMxa,EAAM,UAAWwZ,KAY5BiB,GAAkB,SAAUza,EAAMgX,EAAQa,GAC5CzY,GAAMY,EAAM,QAASgX,EAASa,IAK5B6C,GAAuB,SAAUxZ,GACnC,OAAOwX,GAAexX,EAAOuR,IAAS,KAepCkI,GAA2BlyB,EAAS+vB,IACpCoC,GAAsBnyB,EAASgwB,IAE/BoC,GAAQpgB,GAAM,OACdqgB,GAAW,SAAU9a,EAAMd,EAAUyZ,GACvC,OAAOjZ,GAAOM,EAAMd,GAAUhV,MAAK,WACjC,OAAOyuB,EAAO3Y,GAAQ,QACrB,SAAUL,GACX,OAAOA,MAGPob,GAAU,SAAU/a,EAAM6Z,GAI5B,OAAOiB,GAAS9a,EAAM,SAHP,SAAUtF,GACvB,OAAOmgB,GAAMngB,GAAK+X,GAAM/X,GAAKyf,GAAczf,EAAGmf,OAI9CmB,GAAU,SAAUhb,GACtB,OAAO8a,GAAS9a,EAAM,SAAUua,KAO9BU,GAAc,SAAUjb,EAAMkb,GAChC,OAAOxb,GAAOM,EAAMkb,GAAM7wB,UAKxB8wB,GAAe,SAAUC,EAASzf,EAAO0f,EAASjwB,EAAQutB,EAAQ1Y,GACpE,OAAOmb,EAAQhwB,OAAOA,GAAQlB,MAAK,WACjC,OAAO+V,EAASmT,GAAOiI,EAAS1f,OAC/B,SAAUqE,GACX,OAAO2Y,EAAO3Y,OAGdsb,GAAe,SAAUxX,EAAW5C,EAAOoX,EAAUrY,EAAU4Z,GACjE,IAAI0B,EAAc7I,GAAU5O,GAAW,SAAU9D,GAC/C,OAAOib,GAAYjb,EAAM,YAEvBe,EAAUsE,GAAUQ,WAAW/B,GAtBtB,SAAUA,GACvB,OAAO/Y,EAAIsa,GAAUO,YAAY9B,IAAY,SAAUrC,GACrD,OAAOxV,EAASC,KAAKuV,EAAO3K,YAoBkB0kB,CAAS1X,GAAayX,EAClEF,EAAU,CAACpvB,EAASR,KAAKsrB,GAAMhlB,KAAKmP,KAAS/X,OAAO4B,EAAIgsB,GAAMN,UAAU8E,EAAara,IAAQ,SAAUua,GACzG,OAAOA,EAAI1wB,KAAI,SAAUuD,GACvB,OAAOA,EAAEjH,SAGTq0B,EAAYryB,EAAI+W,IACpB,OAAOrV,EAAIgW,GAAS,SAAUwV,EAAYpD,GACxC,OAAOgI,GAAa5E,EAAYpD,EAAGkI,EAASK,GAAW,SAAUja,GAC/D,GAvBc,SAAUzB,GAC5B,OAAQ6a,GAAM7a,IAASib,GAAYjb,EAAM,SAsBjC2b,CAAcla,GAChB,OAAO6W,EAAS7W,EAAQoY,GAExB,IAxmBiB1xB,EAAGmB,EAwmBhB0W,GAxmBa7X,EAwmBGozB,EAAYpI,GAxmBZ7pB,EAwmBgBZ,EAvmBnCP,MAAAA,EAAgCmB,EAAEnB,GAAK8D,EAASxC,QAwmBjD,OAAO0xB,GAAanb,EAAMmT,EAAGkI,EAASK,GAAW,SAAU1b,GACzD,OAAOC,EAAShU,EAASR,KAAKgnB,GAAMzS,OACnCC,KAEJA,OAGH2b,GAAa,SAAUC,GACzB,OAAOA,EAAQ9wB,KAAI,SAAUmd,GAC3B,OAAOA,EAAI,QACV5d,MAAM,KAcPwxB,GAAiB,SAAUhY,EAAW5C,EAAO2Y,GAC/C,OAAOyB,GAAaxX,EAAW5C,EAAOiZ,IAAe,SAAU0B,GAC7D,OAAOA,EAAQtxB,WAAWsvB,EAAUkC,gBACnClC,IAEDmC,GAAgB,SAAUlY,EAAW5C,EAAO+a,EAAW7D,EAAWnY,GACpE,IAAIkB,EAAOW,GAAOgC,GACduX,EAAU,CAACpvB,EAASR,KAAKwwB,EAAUlqB,KAAKmP,KAAS/X,OAAO4B,EAAIkxB,EAAUxF,UAAUtV,EAAMD,IAAQ,SAAUua,GAC1G,OAAOA,EAAI1wB,KAAI,SAAUuD,GACvB,OAAOA,EAAEsI,SAGb,OAAO7L,EAAIoW,GAAM,SAAUoV,EAAYpD,GACrC,OAAOgI,GAAa5E,EAAYpD,EAAGkI,EAAShyB,EAAIgX,IAAa+X,EAAWnY,OAYxEic,GAAO,SAAUC,GACnB,IAAI/0B,EAAQ+0B,EAOZ,MAAO,CACLruB,IAPQ,WACR,OAAO1G,GAOP+W,IALQ,SAAUrS,GAClB1E,EAAQ0E,KAQRswB,GAAW,SAAUlb,GACvB,IAAIoX,EAAW,WACb,OAAO7F,GAAMvR,IAEXmb,EAAO5zB,EAAS,GAIpB,MAAO,CACLsuB,MAAOuB,EACPwB,WAAYxB,EACZgE,UANc,SAAUxY,EAAW+V,GACnC,OAAOiC,GAAehY,EAAW5C,EAAO2Y,IAMxC0C,aAAcF,EACdG,kBAAmB/zB,EAAS,CAAC,IAC7BszB,aAAcM,EACdI,gBAAiBj0B,EACjBk0B,iBAAkBl0B,EAClBm0B,YAAY,EACZxM,MAAO,SAGPyM,GAAiB,SAAUC,EAAc3b,GAC3C,IAAI4b,EAAaZ,GAAKnK,WAAW8K,IAC7B/C,EAAaoC,GAAKzJ,GAAMvR,IAqB5B,MAAO,CACL6V,MAAO+F,EAAWhvB,IAClBgsB,WAAYA,EAAWhsB,IACvBwuB,UANc,SAAUxY,EAAW+V,GACnC,OA1FsB,SAAU/V,EAAW5C,EAAO2Y,GACpD,OAAOyB,GAAaxX,EAAW5C,EAAO6Y,IAAoB,SAAU8B,GAClE,OAAOA,EAAQ3xB,MAAK,WAClB,OAAO2vB,EAAUkC,kBAChB,SAAUnC,GACX,OAAOA,EAAYC,EAAUC,aAAe,SAE7CD,GAmFMkD,CAAoBjZ,EAAW5C,EAAO2Y,IAM7C0C,aAxBiB,SAAU/I,GAC3B,OAAOA,EAAQsG,EAAWhsB,MAAQ,KAwBlC0uB,kBAtBsB,SAAU7W,EAAGqX,GACnC,MAAO,CAAC,IAAMrX,IAsBdoW,aApBiB,WACjB,OAAOxb,KAAauZ,EAAWhsB,MAAQ,KAoBvC2uB,gBAAiB1D,GACjB2D,iBAnBqB,SAAUlJ,GAC/B,IAAIyJ,EAAeH,EAAWhvB,MAE1BovB,EAAWD,EADFzJ,EAAQ,IAAMyJ,EAE3BlE,GAAmB7X,EAAOgc,GAC1BJ,EAAW3e,IAAI+e,GACfpD,EAAW3b,IAAIsU,GAAMvR,KAcrByb,YAAY,EACZxM,MAAO,YAGPgN,GAAY,SAAUN,EAAc3b,GACtC,IAAI6V,EAAQmF,GAAKW,GACbvE,EAAWvB,EAAMjpB,IAcrB,MAAO,CACLipB,MAAOuB,EACPwB,WAAYxB,EACZgE,UANc,SAAUxY,EAAW+V,GACnC,OAAOiC,GAAehY,EAAW5C,EAAO2Y,IAMxC0C,aAjBiB7zB,EAkBjB8zB,kBAjBsB,SAAU7W,EAAG6N,GAEnC,MAAO,CADOrO,KAAKC,IAAI7E,KAAYoF,EAAI6N,GACrB7N,IAgBlBoW,aAAcxb,GACdkc,gBAAiB3D,GACjB4D,iBAhBqB,SAAUlJ,GAC/B,IAAI0J,EAAW5E,IAAa9E,EAC5BsF,GAAc5X,EAAOgc,GACrBnG,EAAM5Y,IAAI+e,IAcVP,YAAY,EACZxM,MAAO,UAwBPiN,GARe,SAAUlc,GAE3B,OADYwY,GAAYxY,GACXhX,MAAK,WAChB,OAAOkyB,GAASlb,MACf,SAAUyE,GACX,OAlBa,SAAU7O,EAASigB,GAClC,IAAIkD,EAAeU,KAA2BhD,KAAKZ,GACnD,GAAqB,OAAjBkD,EACF,OAAO2C,GAAe3C,EAAa,GAAInjB,GAEzC,IAAIsjB,EAAaQ,KAAsBjD,KAAKZ,GAC5C,GAAmB,OAAfqD,EAAqB,CACvB,IAAIJ,EAAW9Z,SAASka,EAAW,GAAI,IACvC,OAAO+C,GAAUnD,EAAUljB,GAE7B,IAAIumB,EAAgB5K,GAAM3b,GAC1B,OAAOqmB,GAAUE,EAAevmB,GAOvBwmB,CAAWpc,EAAOyE,OAGzByX,GAESD,GAFTC,GAGcR,GA6CdW,GAAW,SAAUvZ,EAAMwZ,EAAcC,GAC3C,IAAIlc,EAAMyC,EAAKyZ,GAAU3mB,QACrB4mB,EAAKjoB,GAAaY,QAAQ,MAC9B0S,GAAO2U,EAAIjoB,GAAaY,QAAQ,QACxBmnB,EAAezU,GAASC,IAC9BzH,EAAKmc,IAuDLC,GAAU,SAAUzc,EAAO0c,GAC7B,IAAIC,EAAa,SAAUtkB,GACzB,OAAOnP,GAAGmP,EAAOzC,QAAS8mB,IAExBE,EAAUvM,GAAKrQ,GACf8C,EAAOnC,GAAUic,GACjBjE,EAAYuD,GAAuBlc,GACnC6c,EAAe1Y,GAAUtB,SAASC,GAClCga,EAnGkB,SAAUC,EAAOJ,GACvC,IAAIK,EAAeD,EAAMpb,KAAK9B,QAE1Bod,EADYF,EAAMpb,KAAK1B,KAEvBid,EAASF,EACTG,EAAS,EACTC,EAAS,EACTC,EAAW,GACXC,EAAgB,GAqBpB,OApBAnmB,GAAO4lB,EAAMha,QAAQ,SAAU1K,GAE7B,GADAglB,EAAS/xB,KAAK+M,GACVskB,EAAWtkB,GAAS,CACtBilB,EAAchyB,KAAK+M,GACnB,IAAIiN,EAAWjN,EAAOgI,IAClBkd,EAASjY,EAAWjN,EAAOC,QAAU,EACrC8M,EAAW/M,EAAOkI,OAClBid,EAASpY,EAAW/M,EAAOE,QAAU,EACrC+M,EAAW2X,EACbA,EAAS3X,EACAiY,EAASJ,IAClBA,EAASI,GAEPnY,EAAW8X,EACbA,EAAS9X,EACAoY,EAASJ,IAClBA,EAASI,OAnCC,SAAUP,EAAQC,EAAQC,EAAQC,EAAQC,EAAUC,GACpE,MAAO,CACLL,OAAQA,EACRC,OAAQA,EACRC,OAAQA,EACRC,OAAQA,EACRC,SAAUA,EACVC,cAAeA,GAgCVG,CAAYR,EAAQC,EAAQC,EAAQC,EAAQC,EAAUC,GAsE1CI,CAAkBb,EAAcF,GAC/C9mB,EAAW,UAAY6mB,EAAZ,YAAkDA,EAAmB,IAChFiB,EAAkBne,GAAiBod,EAAS,SAAS,SAAU9d,GACjE,OAAO5V,GAAG4V,EAAMjJ,MAOlB,OALA/L,EAAK6zB,EAAiBlV,IAlEP,SAAU3F,EAAMia,EAAOa,EAAOjB,GAG7C,IAFA,IAAIK,EAAeD,EAAMpb,KAAK9B,QAC1Bge,EAAYd,EAAMpb,KAAK1B,KAClBrU,EAAI,EAAGA,EAAIiyB,EAAWjyB,IAE7B,IADA,IAAI0wB,GAAe,EACV5uB,EAAI,EAAGA,EAAIsvB,EAActvB,IAC1B9B,EAAIgyB,EAAMX,QAAUrxB,EAAIgyB,EAAMT,QAAUzvB,EAAIkwB,EAAMV,QAAUxvB,EAAIkwB,EAAMR,SAC3DjZ,GAAUC,MAAM2Y,EAAOnxB,EAAG8B,GAAGxD,OAAOyyB,GAAYh0B,SAE7D0zB,GAASvZ,EAAMwZ,EAAc1wB,GAE7B0wB,GAAe,GAwDvBwB,CAAWhb,EAAM+Z,EAAcC,EAAcH,GAlDnC,SAAUC,EAASgB,EAAOb,EAAOgB,GAC3C5mB,GAAO4lB,EAAMld,SAAS,SAAU8R,IAC1BA,EAAIpR,OAASqd,EAAMV,QAAUvL,EAAIpR,OAASqd,EAAMR,SAClD3U,GAASkJ,EAAI/b,YAGjB,IAAIooB,EAAY9zB,EAAOqV,GAAWqd,EAAS,OAAO,SAAUvc,GAC1D,OAAqC,IAA9BA,EAAI/L,IAAI8B,qBAEjBtM,EAAKk0B,EAAWvV,IACZmV,EAAMV,SAAWU,EAAMR,QAAUQ,EAAMX,SAAWW,EAAMT,QAC1DrzB,EAAKyV,GAAWqd,EAAS,UAAU,SAAU9d,GAC3CvB,GAAOuB,EAAM,WACbvB,GAAOuB,EAAM,cAGjBvB,GAAOqf,EAAS5a,IAChBzE,GAAOqf,EAAS,2BACAV,GAAuBU,GAC7BpB,iBAAiBuC,GAkC3BE,CAAMrB,EAASE,EAAcD,EAhCN,SAAU7c,EAAO4C,EAAW+V,EAAWiF,GAC9D,GAAqB,IAAjBA,EAAMV,QAAgBta,EAAUjB,KAAK9B,UAAY+d,EAAMR,OAAS,EAClE,OAAO,EAET,IAAIc,EAAYtD,GAAehY,EAAW5C,EAAO2Y,GAC7CwF,EAAe/xB,EAAM8xB,GAAW,SAAUhyB,EAAK2pB,GACjD,OAAO3pB,EAAM2pB,IACZ,GAKCvD,EAJoBlmB,EAAM8xB,EAAUhzB,MAAM0yB,EAAMV,OAAQU,EAAMR,OAAS,IAAI,SAAUlxB,EAAK2pB,GAC5F,OAAO3pB,EAAM2pB,IACZ,GACgCsI,EAAexF,EAAUC,aACrCD,EAAUC,aACjC,OAAOD,EAAU0C,aAAa/I,GAkBb8L,CAAmBpe,EADxBmE,GAAUxD,UAAUX,GACkB2Y,EAAWmE,IAEtDF,GAKLyB,GAAS,SAAUzoB,GACrB,MAAyB,QAAlBpP,GAAKoP,GAAqB,EAAIiT,GAAUjT,GAAS5M,MAAK,WAC3D,OAAOuR,GAAS3E,GAAS9N,UACxB,SAAU8C,GACX,OAAOA,EAAE9C,WAQTw2B,GAA6B,CAC/B,MACA,MAEEC,GAAmB,SAAUxoB,GAE/B,OAVO8S,GAS8C9S,GAThC7L,QAAO,SAAUoL,GACpC,OAA8B,IAAvBA,EAAKjF,OAAOvI,QAAgBwN,EAAKlK,QAXjC,MAWkD,KACxDjC,UAQyBoC,EAAS+yB,GAA4B93B,GAAKuP,KAGpEqR,GAAQ,SAAUxR,GACpB,OA7+DgCgG,EA6+DL2iB,IA5+DvBC,EAAU,SAAUnqB,GACtB,IAAK,IAAIzI,EAAI,EAAGA,EAAIyI,EAAKW,WAAWlN,OAAQ8D,IAAK,CAC/C,IAAI6yB,EAAUlqB,GAAaH,QAAQC,EAAKW,WAAWpJ,IACnD,GAAIgQ,EAAU6iB,GACZ,OAAO1zB,EAASR,KAAKk0B,GAEvB,IAAIC,EAAMF,EAAQnqB,EAAKW,WAAWpJ,IAClC,GAAI8yB,EAAIv1B,SACN,OAAOu1B,EAGX,OAAO3zB,EAASxC,SAi+DAqN,EA/9DGtB,KAdN,IAAiBsH,EAC5B4iB,GA8+DFG,GAAS,SAAU/oB,GACrB,OAAOgpB,GAAchpB,EAAS2oB,KAE5BK,GAAgB,SAAUlqB,EAAOkH,GACnC,IAAI4iB,EAAU,SAAU5oB,GAEtB,IADA,IAAIqG,EAAa1B,GAAS3E,GACjBhK,EAAIqQ,EAAWnU,OAAS,EAAG8D,GAAK,EAAGA,IAAK,CAC/C,IAAI4O,EAAQyB,EAAWrQ,GACvB,GAAIgQ,EAAUpB,GACZ,OAAOzP,EAASR,KAAKiQ,GAEvB,IAAIkkB,EAAMF,EAAQhkB,GAClB,GAAIkkB,EAAIv1B,SACN,OAAOu1B,EAGX,OAAO3zB,EAASxC,QAElB,OAAOi2B,EAAQ9pB,IAGbmqB,GAAyB,CAC3BnqB,MAAO,CACL,MACA,QAGAoqB,GAAa,WACf,IAAItC,EAAKjoB,GAAaY,QAAQ,MAE9B,OADA0S,GAAO2U,EAAIjoB,GAAaY,QAAQ,OACzBqnB,GAELuC,GAAY,WACd,OAAOxqB,GAAaY,QAAQ,QAE1B6pB,GAAiB,WACnB,OAAOzqB,GAAaY,QAAQ,aAE1BrG,GAAU,SAAUgQ,EAAM1J,EAAK+H,GACjC,IAAIyf,EAAUtM,GAAOxR,EAAM1J,GAQ3B,OAPA+B,GAAOgG,GAAO,SAAUvS,EAAG6C,GACf,OAAN7C,EACF2S,GAAOqf,EAASnvB,GAEhBwP,GAAI2f,EAASnvB,EAAG7C,MAGbgyB,GAELqC,GAAe,SAAUngB,GAC3B,OAAOA,GAELogB,GAAS,SAAU1jB,GACrB,OAAO,WACL,OAAOjH,GAAaY,QAAQ,KAAMqG,EAAIlH,OA2BtC6qB,GAAiB,SAAUC,EAAQ5jB,EAAK6jB,GAC1C,IAAIC,EAAW,SAAUC,EAAM9hB,GAv8DtB,IAAUgM,EAAQ/Y,EACvB8uB,EACAC,EAFehW,EAw8DZ8V,EAAK3pB,QAx8DelF,EAw8DN+M,EAv8DjB+hB,EAAY/V,EAAOnV,IACnBmrB,EAAY/uB,EAAO4D,IACnBsJ,GAAc4hB,IAAc5hB,GAAc6hB,KAC5CA,EAAU5hB,MAAM6hB,QAAUF,EAAU3hB,MAAM6hB,SAq8D1ChhB,GAASjB,EAAO,UACK,IAAjB8hB,EAAKhnB,SACPmG,GAASjB,EAAO,UAoCpB,MAAO,CACLkU,IARW,SAAU4N,GACrB,IAAI/jB,EAAM/B,GAAM8lB,EAAK3pB,SACjB+b,EAAMpd,GAAaY,QAAQ3O,GAAK+4B,EAAK3pB,SAAU4F,EAAIlH,KAGvD,OAFAgrB,EAASC,EAAM5N,GACfyN,EAAOG,EAAK3pB,QAAS+b,GACdA,GAIPgO,SAAUX,GACV3e,IAAK6e,GAAO1jB,GACZsD,KArCY,SAAUygB,GACtB,IAAIK,EAAOnmB,GAAM8lB,EAAK3pB,SAClB4mB,EAAKjoB,GAAaY,QAAQ3O,GAAK+4B,EAAK3pB,SAAUgqB,EAAKtrB,KACnDurB,EAAUR,EAAej2B,MAAM,CACjC,SACA,KACA,IACA,IACA,OACA,OACA,KACA,KACA,KACA,KACA,KACA,KACA,IACA,QAEE02B,EAAWD,EAAQ/3B,OAAS,EAnDjB,SAAUi4B,EAASC,EAASH,GAE7C,OADczY,GAAM2Y,GACLl2B,KAAI,SAAUo2B,GAC3B,IAAIC,EAAiBL,EAAQngB,KAAK,KAC9B3F,EAAU+B,GAAYmkB,EAAWC,GAAgB,SAAUtqB,GAC7D,OAAOS,GAAKT,EAASmqB,MAEvB,OAAO9zB,EAAM8N,GAAS,SAAUjN,EAAM+M,GACpC,IAAIsmB,EAAe/P,GAAQvW,GAG3B,OAFA0D,GAAO4iB,EAAc,mBACrBtY,GAAO/a,EAAMqzB,GACNA,IACNH,MACF52B,MAAM42B,GAsC6BI,CAAab,EAAK3pB,QAAS4mB,EAAIqD,GAAWrD,EAK9E,OAJA3U,GAAOiY,EAAUvrB,GAAaY,QAAQ,OACtCmqB,EAASC,EAAM/C,GAtCc,SAAUtM,EAAUzS,GACnDtG,GAAO0nB,IAAwB,SAAUwB,EAAiBC,GACxD,OAAOhjB,GAAO4S,EAAUoQ,GAAep2B,QAAO,SAAUq2B,GACtD,OAAOh1B,EAAS80B,EAAiBE,MAChCz2B,MAAK,SAAUy2B,GAChB,OAAOtjB,GAAIQ,EAAO6iB,EAAeC,SAkCnCC,CAA2BjB,EAAK3pB,QAAS4mB,GACzC4C,EAAOG,EAAK3pB,QAAS4mB,GACdA,GAcP1tB,QAASA,GACT2xB,IAAK3B,KAGL4B,GAAQ,SAAUllB,GACpB,MAAO,CACLmW,IAAKoN,GACLY,SAAUX,GACV3e,IAAK6e,GAAO1jB,GACZsD,KAAMggB,GACNhwB,QAASmwB,GACTwB,IAAK3B,KAUL6B,GAAY,SAAUC,GACxB,OAAO/2B,EAAI+2B,EAAOrsB,GAAaH,UAG7BysB,GAAc,SAAUlhB,GAC1B,OAAOA,EAAI3G,SAASxK,eAElBsyB,GAAY,SAAUC,GACxB,OAAOxsB,GAAaH,QAAQ2sB,EAAOrlB,YAEjCslB,GAAkB,SAAUrhB,GAC9B,OAAOA,EAAIoT,wBAAwB8C,OAEjCoL,GAAiB,SAAUthB,GAC7B,OAAOA,EAAIoT,wBAAwBC,QAEjC1G,GAAY,SAAUyU,GACxB,OAAO,SAAUnrB,GACf,OAAOS,GAAKT,EAASkrB,GAAUC,MAM/BG,GAAc,SAAUnpB,GAC1B,MAAO,gBAAgBrJ,KAAKqJ,GAAQA,EAAO,KAAOA,GAEhDopB,GAAkB,SAAUnhB,GAC9BzC,GAAOyC,EAAO,kBACd,IAAIohB,EAAuB,SAAUxrB,GACnC,OAAO2H,GAAO3H,EAAS,mBAEzB9L,EAAK2O,GAAMuH,GAAQohB,GACnBt3B,EAAK+V,GAAQG,GAAQohB,IAEnBC,GAAgB,SAAUN,EAAQphB,GACpC,IAAIlB,EAAMsiB,EAAOzsB,IAAIgtB,SAAS3hB,EAAK,UAAYohB,EAAOzsB,IAAIitB,UAAU5hB,EAAK,SACzE,OAAO5U,EAASC,KAAKyT,GAAKvU,OAAOqG,KAE/BixB,GAAe,SAAUt7B,GAC3B,MAAO,mBAAmBwI,KAAKxI,IAK7Bu7B,GAAoB,SAAUV,GAChC,OAAOxsB,GAAaH,QAAQ2sB,EAAOW,UAAUC,aAG3CD,GAAY,SAAUE,GACxB,OAAOtS,GAAKsS,EAAWh1B,MAAOrF,EAAS,IAAKC,EAAUmF,IAEpDk1B,GAAa,SAAUD,GACzB,IAAIE,EAAU,SAAU/rB,EAAM9P,GAC5B,OAAOqX,GAAOvH,EAAM9P,GAAM+D,QAAO,SAAU+3B,GACzC,OAAO/iB,SAAS+iB,EAAM,IAAM,MAM5B9yB,EAAayyB,GAAUE,GAC3B,OAAO3yB,EAAWnH,OAAS,GAAKmC,EAAOgF,GAJjB,SAAU8G,GAC9B,OAAO+rB,EAAQ/rB,EAAM,YAAc+rB,EAAQ/rB,EAAM,cAGmBhL,EAASR,KAAK0E,GAAclE,EAASxC,QAEzGy5B,GAAW,SAAUhiB,EAAO4hB,EAAYK,GAC1C,OAAO3S,GAAKsS,EAAWh1B,MAAO7B,EAASxC,MAAM,SAAUkQ,GACrD,OAAIA,EAAM3Q,QAAU,EACXiD,EAASxC,OAETqlB,GAAY5N,EAAOiiB,EAAS7U,sBAAuB6U,EAAS5U,sBAAsBxjB,KAAI,SAAUib,GACrG,MAAO,CACLA,OAAQA,EACRrM,MAAOA,QAIZ1N,EAASxC,OAGV25B,GAAc,oBAGdC,GAAmB,0BAEnBC,GAAkB,yBAGlBH,GAAW,CACbI,SAAUH,GACVxF,iBATwB,8CAUxB4F,cAAeH,GACf/U,sBAR6B,0DAS7BmV,aAAcH,GACd/U,qBAR4B,yDAmB1BmV,GAAU,SAAUZ,EAAY5hB,EAAOlB,GACzC,MAAO,CACLlJ,QAASkJ,EACTkjB,SAAUA,GAAShiB,EAAO4hB,EAAYK,IACtCJ,WAAYA,GAAWD,GACvBF,UAAWA,GAAUE,KAmCrBa,GAAiB,SAAU1B,EAAQa,EAAYc,EAASC,GAC1D5B,EAAO6B,GAAG,oBAAoB,SAAUppB,IAOlB,IAAhBA,EAAEkoB,WACJpS,GAAKsS,EAAWh1B,MAAOtF,GAPF,SAAUmR,GAC/Be,EAAEqpB,iBApBc,SAAUpqB,GAC9B,OAAOuH,GAAMvH,EAAM,IAAI5O,KAAI,SAAUmW,GACnC,IAAI4c,EAAUH,GAAQzc,EAhDC,uBAkDvB,OADAmhB,GAAgBvE,GACT,CAACA,MAiBNkG,CAAgBrqB,GAAO3O,MAAK,SAAUse,GACpC5O,EAAEupB,QAAuB,SAAbvpB,EAAEwpB,OAVD,SAAU5a,GAC7B,OAAOve,EAAIue,GAAU,SAAUxS,GAC7B,OAAOA,EAAQtB,IAAI2uB,aAClBvjB,KAAK,IAOgCwjB,CAAe9a,GAfjC,SAAU2Y,EAAQ3Y,GACxC,OAAOve,EAAIue,GAAU,SAAUzI,GAC7B,OAAOohB,EAAOW,UAAUyB,WAAWC,UAAUzjB,EAAIrL,IAAK,OACrDoL,KAAK,IAY2D2jB,CAAkBtC,EAAQ3Y,QAI1C9gB,MAGnDy5B,EAAO6B,GAAG,oBAAoB,SAAUppB,IAClB,IAAhBA,EAAEkoB,YAAkC,IAAZloB,EAAEknB,OACd31B,EAASC,KAAK+1B,EAAOzsB,IAAIgvB,UAAUvC,EAAOW,UAAUC,WAAY,UACtE73B,MAAK,SAAUy5B,GACrB,IAAIzkB,EAAOvK,GAAaH,QAAQmvB,GAChCvjB,GAAMlB,GAAMhV,MAAK,SAAUkW,GACzB,IAxKiBvL,EAAMC,EAE3BC,EAyK4BgL,EAHpByI,EAAWle,GAxKEuK,EAwKgB+E,EAAEupB,SAtKvCpuB,GADMD,GAASE,UACLC,cAAc,QACxBC,UAAYL,EACT8F,GAAShG,GAAaH,QAAQO,MAoKgB,SAAUouB,GACrD,MAAyB,SAAlBv8B,GAAKu8B,MAKd,GAAwB,IAApB3a,EAAStgB,SAHW6X,EAGayI,EAAS,GAFvB,UAAd5hB,GAAKmZ,IAEqC,CACjDnG,EAAEqpB,iBACF,IAAIrnB,EAAMjH,GAAaH,QAAQ2sB,EAAOyC,UAClCC,EAAa/C,GAAMllB,GACnBkoB,EA5DF,SAAU9tB,EAAS+tB,EAAWF,GAC1C,MAAO,CACL7tB,QAASA,EACT+tB,UAAWA,EACXF,WAAYA,GAwDUG,CAAQ9kB,EAAMsJ,EAAS,GAAIqb,GACzCf,EAAQmB,WAAW7jB,EAAO0jB,GAAS55B,MAAK,SAAUg6B,GAChD/C,EAAOW,UAAUqC,OAAOD,EAAKE,KAC7BjD,EAAOkD,QACPtB,EAAcuB,MAAMlkB,iBAS9BuO,GAAMH,GAAa,CACrB,CAAE7lB,KAAM,IACR,CAAE47B,KAAM,CAAC,UACT,CACE/Q,KAAM,CACJ,QACA,SAGJ,CACEgR,OAAQ,CACN,OACA,QACA,SAGJ,CACEC,MAAO,CACL,OACA,YAIFC,GAAgBr3B,EAAS,GAAIshB,IAoB7BgW,GAAY,SAAUnO,EAAO7V,EAAQoV,EAAMgD,EAAW6L,GACxD,IAAI3oB,EAASua,EAAMlrB,MAAM,GACrBu5B,EApBW,SAAUrO,EAAO3b,GAChC,OAAqB,IAAjB2b,EAAMtuB,OACDw8B,GAAc/7B,OAEF,IAAjB6tB,EAAMtuB,OACDw8B,GAAcH,KAAK,GAEd,IAAV1pB,EACK6pB,GAAclR,KAAK,EAAG,GAE3B3Y,IAAU2b,EAAMtuB,OAAS,EACpBw8B,GAAcD,MAAM5pB,EAAQ,EAAGA,GAEpCA,EAAQ,GAAKA,EAAQ2b,EAAMtuB,OAAS,EAC/Bw8B,GAAcF,OAAO3pB,EAAQ,EAAGA,EAAOA,EAAQ,GAEjD6pB,GAAc/7B,OAIPm8B,CAAWtO,EAAO7V,GAC5BiP,EAASjoB,EAASsC,EAAIgS,EAAQtU,EAAS,KAa3C,OAAOk9B,EAAQz7B,KAAKwmB,GAZP,SAAU/U,GACrB,OAAOke,EAAU2C,kBAAkBzf,EAAOpB,GAAQkb,MAEvC,SAAUlb,EAAO8X,GAC5B,OAAOiS,EAAOG,mBAAmB9oB,EAAQpB,EAAO8X,EAAMoD,EAAMgD,EAAUkC,eAAgBlC,EAAU8C,eAEnF,SAAU8D,EAAM9kB,EAAO8X,GACpC,OAAOiS,EAAOI,iBAAiB/oB,EAAQ0jB,EAAM9kB,EAAO8X,EAAMoD,EAAMgD,EAAUkC,eAAgBlC,EAAU8C,eAExF,SAAU8D,EAAM9kB,GAC5B,OAAO+pB,EAAOK,oBAAoBhpB,EAAQ0jB,EAAM9kB,EAAOkb,EAAMgD,EAAUkC,eAAgBlC,EAAU8C,gBAKjGtD,GAAQ,SAAUpoB,EAAOmb,EAAK4Z,GAEhC,IADA,IAAI94B,EAAI,EACCJ,EAAImE,EAAOnE,EAAIsf,EAAKtf,IAC3BI,QAAqBhF,IAAhB89B,EAASl5B,GAAmBk5B,EAASl5B,GAAK,EAEjD,OAAOI,GAuBL+4B,GAA4B,SAAUniB,EAAWoiB,GACnD,IAAIh9B,EAAMmc,GAAUK,UAAU5B,GAC9B,OAAO/Y,EAAI7B,GAAK,SAAU8W,GACxB,IAAIkU,EAASmF,GAAMrZ,EAAKuB,IAAKvB,EAAKuB,IAAMvB,EAAKxG,QAAS0sB,GACtD,MAAO,CACLpvB,QAASkJ,EAAKlJ,QACdod,OAAQA,EACR1a,QAASwG,EAAKxG,aAkBhB2sB,GAAc,SAAUriB,EAAWsiB,GACrC,OAAI/gB,GAAUQ,WAAW/B,GApCM,SAAUA,EAAWsiB,GACpD,IAAIC,EAAShhB,GAAUO,YAAY9B,GACnC,OAAO/Y,EAAIs7B,GAAQ,SAAU5kB,EAAQ9F,GACnC,MAAO,CACL7E,QAAS2K,EAAO3K,QAChBigB,MAAOqP,EAAOzqB,GACdlC,QAASgI,EAAOhI,YA+BX6sB,CAA2BxiB,EAAWsiB,GAhDlB,SAAUtiB,EAAWsiB,GAClD,IAAIl9B,EAAMmc,GAAUK,UAAU5B,GAC9B,OAAO/Y,EAAI7B,GAAK,SAAU8W,GACxB,IAAI+W,EAAQsC,GAAMrZ,EAAKyB,OAAQzB,EAAKyB,OAASzB,EAAKvG,QAAS2sB,GAC3D,MAAO,CACLtvB,QAASkJ,EAAKlJ,QACdigB,MAAOA,EACPtd,QAASuG,EAAKvG,YA2CT8sB,CAAyBziB,EAAWsiB,IAG3CI,GAAsB,SAAU1iB,EAAWsiB,EAAQvM,GACrD,IAAI4M,EAAWN,GAAYriB,EAAWsiB,GACtCp7B,EAAKy7B,GAAU,SAAUzmB,GACvB6Z,EAAU4C,gBAAgBzc,EAAKlJ,QAASkJ,EAAK+W,WAG7C2P,GAAc,SAAUxlB,EAAOsS,EAAO7X,EAAOgrB,EAAU9M,GACzD,IAAI/V,EAAYuB,GAAUxD,UAAUX,GAChC2V,EAAOgD,EAAU0C,aAAa/I,GAC9B4S,EAASvM,EAAUyC,UAAUxY,EAAW+V,GACxC+M,EAAejrB,IAAUmI,EAAUjB,KAAK9B,QAAU,EAClD8lB,EAAcF,EAASG,gBAAgBV,EAAQzqB,EAAOkb,EAAMgD,EAAUkC,eAAgB6K,GACtFG,EAAStB,GAAUW,EAAQzqB,EAAOkrB,EAAahN,EAAW8M,GAC1DK,EAAYj8B,EAAIg8B,GAAQ,SAAUE,EAAIn6B,GACxC,OAAOm6B,EAAKb,EAAOt5B,MAErB05B,GAAoB1iB,EAAWkjB,EAAWnN,GAC1C8M,EAASO,YAAYrN,EAAU6C,iBAAkBmK,EAAaD,IAE5DO,GAAe,SAAUjmB,EAAOsS,EAAO7X,EAAOsgB,GAChD,IAAInY,EAAYuB,GAAUxD,UAAUX,GAChCglB,EAzvBgB,SAAUpiB,EAAW5C,EAAO+a,GAChD,OAAOD,GAAclY,EAAW5C,EAAO+a,EAAW1B,IAAa,SAAUsB,GACvE,OAAOA,EAAQtxB,WAAWiW,OAuvBd4mB,CAAgBtjB,EAAW5C,EAAO+a,GAC5CoL,EAAat8B,EAAIm7B,GAAS,SAAUoB,EAAIx6B,GAC1C,OAAO6O,IAAU7O,EAAIqY,KAAKC,IAAIoO,EAAQ8T,EAAI9mB,MAAe8mB,KAEvDC,EAAetB,GAA0BniB,EAAWujB,GACpDG,EA/Ce,SAAU1jB,EAAWoiB,GACxC,OAAOn7B,EAAI+Y,EAAU5a,KAAK,SAAUqY,EAAKzU,GACvC,MAAO,CACLgK,QAASyK,EAAIzK,QACbod,OAAQgS,EAAQp5B,OA2CF26B,CAAe3jB,EAAWujB,GAC5Cr8B,EAAKw8B,GAAa,SAAUjmB,GAC1ByX,GAAUzX,EAAIzK,QAASyK,EAAI2S,WAE7BlpB,EAAKu8B,GAAc,SAAUvnB,GAC3BgZ,GAAUhZ,EAAKlJ,QAASkJ,EAAKkU,WAE/B,IAAImF,EA5CGlsB,EA4CWk6B,GA5CI,SAAUr7B,EAAG7D,GACjC,OAAO6D,EAAI7D,IACV,GA2CH6wB,GAAU9X,EAAOmY,IAgBfgD,GAAO,SAAUhG,GACnB,OAAOtrB,EAAIsrB,EAAO5tB,EAAS,KAEzBi/B,GAAW,SAAUC,EAAOC,EAAYC,EAAUC,EAASx+B,GAC7D,OAAOA,EAAEq+B,EAAMv7B,MAAM,EAAGw7B,IAAaz+B,OAAO2+B,GAAS3+B,OAAOG,EAAEq+B,EAAMv7B,MAAMy7B,MAExEE,GAAmB,SAAUjrB,GAC/B,OAAO,SAAU6qB,EAAOhsB,EAAO6X,EAAOwU,GACpC,GAAKlrB,EAAU0W,GAER,CACL,IAAI4F,EAAUjU,KAAKC,IAAI4iB,EAAaL,EAAMhsB,GAASwJ,KAAKwO,IAAIH,IACxDyU,EAAO9iB,KAAKwO,IAAIyF,EAAUuO,EAAMhsB,IACpC,OAAO6X,GAAS,EAAIyU,GAAQA,EAJ5B,OAAOzU,IAQT0U,GAAqBH,IAAiB,SAAUvU,GAClD,OAAOA,EAAQ,KAEb2U,GAAaJ,GAAiBv+B,GAC9B09B,GAAc,WAChB,IAOIkB,EAAqB,SAAUT,EAAOhsB,EAAO6X,EAAOwU,GACtD,IAAIK,GAAS,IAAM7U,GAAS,IACxB8U,EAAUnjB,KAAKC,IAAI4iB,GAAcL,EAAMhsB,GAAS6X,GAAS6U,GAC7D,OAAOt9B,EAAI48B,GAAO,SAAU1uB,EAAMuK,GAEhC,OADcA,IAAQ7H,EAAQ2sB,EAAUrvB,EAAOovB,GAC9BpvB,MAGjB4sB,EAAqB,SAAU8B,EAAOhsB,EAAO8X,EAAMD,EAAOwU,EAAarL,GACzE,OAAIA,EACKyL,EAAmBT,EAAOhsB,EAAO6X,EAAOwU,GAjB7B,SAAUL,EAAOhsB,EAAO8X,EAAMD,EAAOwU,GACzD,IAAIO,EAAeL,GAAmBP,EAAOhsB,EAAO6X,EAAOwU,GAC3D,OAAON,GAASC,EAAOhsB,EAAO8X,EAAO,EAAG,CACtC8U,EACA,GACClM,IAcMmM,CAAgBb,EAAOhsB,EAAO8X,EAAMD,EAAOwU,IAmCtD,MAAO,CACLd,YA9BgB,SAAUuB,EAASjV,GACnC,OAAOiV,EAAQjV,IA8BfsT,gBAAiBoB,GACjBrC,mBAAoBA,EACpBC,iBApCqB,SAAU6B,EAAOe,EAAO/sB,EAAO8X,EAAMD,EAAOwU,EAAarL,GAC9E,OAAOkJ,EAAmB8B,EAAOhsB,EAAO8X,EAAMD,EAAOwU,EAAarL,IAoClEoJ,oBA/BwB,SAAU4B,EAAOe,EAAO/sB,EAAO6X,EAAOwU,EAAarL,GAC3E,GAAIA,EACF,OAAOyL,EAAmBT,EAAOhsB,EAAO6X,EAAOwU,GAE/C,IAAIO,EAAeL,GAAmBP,EAAOhsB,EAAO6X,EAAOwU,GAC3D,OAAO3L,GAAKsL,EAAMv7B,MAAM,EAAGuP,IAAQxS,OAAO,CAACo/B,KA2B7CI,wBAxB4B,SAAUhB,EAAOiB,EAAYC,EAAYlM,GACrE,GAAIA,EAAY,CACd,IACImM,GADaF,EAAaC,GACHD,EACvBnC,EAAW17B,EAAI48B,GAAO,SAAU1uB,GAClC,OAAOA,EAAO6vB,KAEhB,MAAO,CACLtV,MAAiB,IAAVsV,EAAgB,IACvBrC,SAAUA,GAGZ,MAAO,CACLjT,MAAOqV,EACPpC,SAAUkB,MAadoB,GAAgB,WAClB,IAAIlD,EAAqB,SAAU8B,EAAOhsB,EAAO8X,EAAMD,EAAOwU,GAC5D,IACIO,EAAeJ,GAAWR,EADpBnU,GAAS,EAAIC,EAAO9X,EACY6X,EAAOwU,GACjD,OAAON,GAASC,EAAOhsB,EAAO8X,EAAO,EAAG,CACtC8U,GACCA,GACAlM,KAsCL,MAAO,CACL6K,YAlCgB,SAAUuB,EAASjV,EAAOoT,GACtCA,GACF6B,EAAQjV,IAiCVsT,gBAtBoB,SAAUa,EAAOhsB,EAAO6X,EAAOwU,EAAapB,GAChE,GAAIA,EAAc,CAChB,GAAIpT,GAAS,EACX,OAAOA,EAEP,IAAIwV,EAAW17B,EAAMq6B,GAAO,SAAUx/B,EAAG6D,GACvC,OAAO7D,EAAI6D,EAAIg8B,IACd,GACH,OAAO7iB,KAAKC,KAAK4jB,EAAUxV,GAG7B,OAAO0U,GAAmBP,EAAOhsB,EAAO6X,EAAOwU,IAYjDnC,mBAAoBA,EACpBC,iBAxCqB,SAAU6B,EAAOe,EAAO/sB,EAAO8X,EAAMD,EAAOwU,GACjE,OAAOnC,EAAmB8B,EAAOhsB,EAAO8X,EAAMD,EAAOwU,IAwCrDjC,oBAjCwB,SAAU4B,EAAOe,EAAOO,EAAQzV,EAAO0V,EAAcvM,GAC7E,GAAIA,EACF,OAAON,GAAKsL,GAEZ,IAAIM,EAAOzU,EAAQmU,EAAM3+B,OACzB,OAAO+B,EAAI48B,EAAOl/B,EAASw/B,KA6B7BU,wBAZ4B,SAAUhB,EAAOwB,EAAaC,EAAaC,GACvE,MAAO,CACL7V,MAAO,EACPiT,SAAUkB,MAyCZ2B,GA5BO,SAAUxyB,EAASyyB,GAC5B,IAAIxuB,EAAS9O,EAASC,KAAK4K,EAAQtB,IAAIsf,iBAAiB/pB,IAAI0K,GAAaH,SAAShL,MAAMwM,GACxF,MAAO,CACLiE,OAAQtS,EAASsS,GACjByuB,KAAM/gC,EAASqO,GACf2yB,OAAQhhC,EAASgsB,GAAc,EAAG,IAClC8U,YAAaA,IAsBbD,GARS,SAAUI,EAAU13B,EAAQu3B,GACvC,MAAO,CACLxuB,OAAQtS,EAASuJ,GACjBw3B,KAAM/gC,EAASihC,GACfD,OAAQhhC,EAASgsB,GAAc,EAAG,IAClC8U,YAAaA,IASbI,GAAQra,GAAa,CACvB,CAAEsa,QAAS,CAAC,QACZ,CAAEC,OAAQ,CAAC,UACX,CAAEC,QAAS,CAAC,YAEVC,GAAc,SAAUz4B,EAAQnK,EAAMC,GACxC,IAAI4iC,EAAY5iC,EAAM6iC,UAAU,EAAG7iC,EAAM4B,OAASsI,EAAOtI,QACrDguB,EAASjF,WAAWiY,GACxB,OAAOA,IAAchT,EAAOxrB,WAAarE,EAAK6vB,GAAU2S,GAAMC,QAAQxiC,IAWpE8iC,GAAO/7B,EAASA,EAAS,GAAIw7B,IAAQ,CAAEz9B,KAT9B,SAAU9E,GACrB,OAAIiK,GAASjK,EAAO,KACX2iC,GAAY,IAAKJ,GAAMG,QAAS1iC,GAErCiK,GAASjK,EAAO,MACX2iC,GAAY,KAAMJ,GAAME,OAAQziC,GAElCuiC,GAAMC,QAAQxiC,MA0CnB+iC,GAAqB,SAAUC,EAAchE,EAAQwC,GACvD,OAAOwB,EAAalgC,MAAK,WACvB,OAAOk8B,KACN,SAAUlO,GACX,OA7BmB,SAAUkO,EAAQwC,EAAYyB,GACnD,IAAIC,EAAQD,EAAgBzB,EAC5B,OAAO79B,EAAIq7B,GAAQ,SAAUzgB,GAE3B,OADcukB,GAAKh+B,KAAKyZ,GACTzb,MAAK,WAClB,OAAOyb,KACN,SAAUuS,GACX,OAAOA,EAAKoS,EAAQ,QACnB,SAAUC,GACX,OAAOA,EAAK,IAAMF,EAAgB,WAoB7BG,CAAiBpE,EAAQwC,EAAY1Q,MAC3C,SAAUuS,GACX,OA5CwB,SAAUrE,EAAQwC,GAC5C,OAAO79B,EAAIq7B,GAAQ,SAAUzgB,GAE3B,OADcukB,GAAKh+B,KAAKyZ,GACTzb,MAAK,WAClB,OAAOyb,KACN,SAAUuS,GAEX,OADYA,EAAK0Q,EAAa,IACf,OACd,SAAU2B,GACX,OAAOA,EAAK,UAmCPG,CAAsBtE,EAAQwC,OAGrC+B,GAAe,SAAUvE,EAAQwC,EAAY1L,GAC/C,IAAI0N,EAAUV,GAAKh+B,KAAKgxB,GACpB2N,EAAS1/B,EAAOi7B,GAAQ,SAAUv6B,GACpC,MAAa,QAANA,KAxBa,SAAUu+B,EAAcrpB,GAC9C,IAAIzX,EAAI8gC,EAAalgC,MAAK,WACxB,OAAOzB,EAAS,OACf,SAAUohC,GAEX,OAAOphC,EADGohC,EAAS9oB,EACG,SACrB,WAED,OAAOtY,EADG,IAAMsY,EACM,QAExB,OAAO/T,EAAM+T,EAASzX,GAejBwhC,CAAkBF,EAASxE,EAAOp9B,QAAUmhC,GAAmBS,EAASxE,EAAQwC,GACrF,OAAOmC,GAAUF,IAEfG,GAAM,SAAUC,EAAQhrB,GAC1B,OAAsB,IAAlBgrB,EAAOjiC,OACFiX,EAEF9S,EAAM89B,GAAQ,SAAU5X,EAAMvnB,GACnC,OAAOo+B,GAAKh+B,KAAKJ,GAAG5B,KAAKzB,EAAS,GAAIC,EAAUA,GAAY2qB,IAC3D,IASD6X,GAAM,SAAU9jC,EAAO4vB,GACzB,OAAOkT,GAAKh+B,KAAK9E,GAAO8C,KAAKzB,EAASrB,IAAQ,SAAU8wB,GACtD,OAAOA,EAAKlB,EAAS,QACpB,SAAUuT,GACX,OAAOA,EAAKvT,EAAS,QAGrB+T,GAAY,SAAUE,GACxB,GAAsB,IAAlBA,EAAOjiC,OACT,OAAOiiC,EAET,IAAIE,EAAOh+B,EAAM89B,GAAQ,SAAU5X,EAAMjsB,GACvC,IAAIiL,EAAO63B,GAAKh+B,KAAK9E,GAAO8C,MAAK,WAC/B,MAAO,CACL9C,MAAOA,EACPgkC,UAAW,MAEZ,SAAUn+B,GACX,OAzBU,SAAUA,EAAK4qB,GAC7B,IAAIwT,EAAUlmB,KAAKmU,MAAMrsB,GACzB,MAAO,CACL7F,MAAOikC,EAAUxT,EACjBuT,UAAWn+B,EAAMo+B,GAqBRC,CAAUr+B,EAAK,SACrB,SAAUA,GACX,MAAO,CACL7F,MAAO6F,EAAM,IACbm+B,UAAW,MAGf,MAAO,CACLG,OAAQ,CAACl5B,EAAKjL,OAAO+B,OAAOkqB,EAAKkY,QACjCH,UAAW/X,EAAK+X,UAAY/4B,EAAK+4B,aAElC,CACDG,OAAQ,GACRH,UAAW,IAETl+B,EAAIi+B,EAAKI,OACb,OAAOr+B,EAAEd,MAAM,EAAGc,EAAElE,OAAS,GAAGG,OAAO,CAAC+hC,GAAIh+B,EAAEA,EAAElE,OAAS,GAAImc,KAAKqmB,MAAML,EAAKC,eAE3EK,GAAWvB,GAAKh+B,KAyBhBw/B,GAAU,SAAUtS,GACtB,OAAOqS,GAASrS,GAASlvB,KAAKzB,EAAS,MAAOA,EAAS,MAAOA,EAAS,OAErEkjC,GAAiB,SAAUzqB,EAAO0qB,EAAUC,EAAWhS,GACzD,IAAI/V,EAAYuB,GAAUxD,UAAUX,GAChCC,EAAO2C,EAAU5a,IACjByQ,EAAQ0L,GAAUK,UAAU5B,GAC5B/C,EAAUsE,GAAUO,YAAY9B,GACpC8nB,EAAS5gC,MAAK,SAAUkyB,GACtB,IAAI4O,EAAYJ,GAAQxO,GACpB0L,EAAanW,GAAMvR,GACnB6qB,EAloCW,SAAUjoB,EAAW5C,EAAO2Y,GAC7C,OAAOyB,GAAaxX,EAAW5C,EAAO6Z,GAASa,GAAY/B,GAioCzCmS,CAAaloB,EAAW5C,EAAO2Y,GAC3CoS,EAAWtB,GAAaoB,EAAWnD,EAAY1L,GAC/C7X,GAAUQ,WAAW/B,GA7BD,SAAUkjB,EAAWjmB,EAAS8W,GACxD7sB,EAAK+V,GAAS,SAAUU,EAAQ9F,GAC9B,IAAIob,EAAQiU,GAAI,CAAChE,EAAUrrB,IAAS4E,MACpCnB,GAAMqC,EAAO3K,QAAS,QAASigB,EAAQc,MA2BrCqU,CAAsBD,EAAUlrB,EAAS+qB,GArCzB,SAAU9E,EAAWrtB,EAAOke,GAChD7sB,EAAK2O,GAAO,SAAUqG,GACpB,IAAIomB,EAASY,EAAU56B,MAAM4T,EAAKyB,OAAQzB,EAAKvG,QAAUuG,EAAKyB,QAC1DkE,EAAIqlB,GAAI5E,EAAQ7lB,MACpBnB,GAAMY,EAAKlJ,QAAS,QAAS6O,EAAIkS,MAmC/BsU,CAAgBF,EAAUtyB,EAAOmyB,GAEnC1sB,GAAM8B,EAAO,QAASgc,MAExB2O,EAAU7gC,MAAK,SAAUohC,GACvB,IAAIC,EAAQX,GAAQU,GAChBE,EAAclY,GAAMlT,GACpBqrB,EA7mCY,SAAUzoB,EAAW5C,EAAO+a,GAC9C,OAAOD,GAAclY,EAAW5C,EAAO+a,EAAWjB,GAASY,IA4mCxC4Q,CAAc1oB,EAAW5C,EAAOgT,KAjC/B,SAAUmT,EAAYlmB,EAAMxH,EAAOke,GACvD7sB,EAAK2O,GAAO,SAAUqG,GACpB,IAAIkmB,EAAUmB,EAAWj7B,MAAM4T,EAAKuB,IAAKvB,EAAKxG,QAAUwG,EAAKuB,KACzD6Q,EAAI4Y,GAAI9E,EAAS1lB,MACrBpB,GAAMY,EAAKlJ,QAAS,SAAUsb,EAAIyF,MAEpC7sB,EAAKmW,GAAM,SAAUI,EAAKzU,GACxBsS,GAAMmC,EAAIzK,QAAS,SAAUuwB,EAAWv6B,OA4BxC2/B,CADgB9B,GAAa4B,EAAYD,EAAaF,GAC3BjrB,EAAMxH,EAAO0yB,GACxCjtB,GAAM8B,EAAO,SAAUkrB,OAGvBM,GApuCkB,SAAUxrB,GAC9B,OAAOwY,GAAYxY,GAAOhW,QAAO,SAAU+N,GACzC,OAAOuf,GAA0B5oB,KAAKqJ,OAmuCtC0zB,GAhuCgB,SAAUzrB,GAC5B,OAAOwY,GAAYxY,GAAOhW,QAAO,SAAU+N,GACzC,OAAOwf,GAAqB7oB,KAAKqJ,OA+tCjC2zB,GA5tCe,SAAU1rB,GAC3B,OAAOwY,GAAYxY,GAAOrX,UA4tCxBgjC,GAAyBnS,GAEzBoS,GAAc,SAAU5rB,GAE1B,OADgBmE,GAAUxD,UAAUX,GACnB2B,MAGfkqB,GAAQ,SAAUC,GACpB,IAAIC,EAAW,GAyBf,MAAO,CACLhiC,KAzBS,SAAUiiC,GACnB,QAAgBhlC,IAAZglC,EACF,MAAM,IAAIxiC,MAAM,uCAElBuiC,EAASzgC,KAAK0gC,IAsBdC,OApBW,SAAUD,GACrBD,EAAW7hC,EAAO6hC,GAAU,SAAU7a,GACpC,OAAOA,IAAM8a,MAmBfE,QAhBY,WAEZ,IADA,IAAIp+B,EAAO,GACFlG,EAAK,EAAGA,EAAKC,UAAUC,OAAQF,IACtCkG,EAAKlG,GAAMC,UAAUD,GAEvB,IAAIukC,EAAQ,GACZriC,EAAKgiC,GAAQ,SAAUtlC,EAAMoF,GAC3BugC,EAAM3lC,GAAQsH,EAAKlC,MAErB9B,EAAKiiC,GAAU,SAAUC,GACvBA,EAAQG,SAUVpiB,GAAS,SAAUqiB,GAUrB,MAAO,CACLC,SAVa/0B,GAAM80B,GAAU,SAAUD,GACvC,MAAO,CACLpiC,KAAMoiC,EAAMpiC,KACZkiC,OAAQE,EAAMF,WAQhBC,QALY50B,GAAM80B,GAAU,SAAUD,GACtC,OAAOA,EAAMD,aAmCbI,GAAS,SAAUt/B,GACrB,OAAOA,EAAI9B,MAAM,GAAGuX,QAqClB8pB,GAAW,SAAUC,EAAmBC,EAAU9gC,GACpD,GAAwB,IAApB8gC,EAAS3kC,OACX,MAAM,IAAI0B,MAAM,iDAlBH,IACXkjC,EAqBJ,OAnCmB,SAAUzd,EAAOkG,GACpC,IAAKtuB,EAAQsuB,GACX,MAAM,IAAI3rB,MAAM,OAASylB,EAAQ,kCAAoCkG,EAAQ,KAE/ErrB,EAAKqrB,GAAO,SAAUluB,GACpB,IAAKN,EAASM,GACZ,MAAM,IAAIuC,MAAM,aAAevC,EAAI,WAAagoB,EAAQ,gCA2B5D0d,CAAe,WAAYF,GAnBvBC,EAASJ,GAoBFG,GAnBApgC,EAAKqgC,GAAQ,SAAU/hC,EAAGiB,GACnC,OAAOA,EAAI8gC,EAAO5kC,OAAS,GAAK6C,IAAM+hC,EAAO9gC,EAAI,MAE9C9B,MAAK,SAAUkd,GAClB,MAAM,IAAIxd,MAAM,cAAgBwd,EAAI,mDAAqD0lB,EAAOhtB,KAAK,MAAQ,SAgBxG,SAAUtI,GACf,IAAIsX,EAASxX,GAAKE,GACJnN,EAAOwiC,GAAU,SAAUG,GACvC,OAAOrhC,EAASmjB,EAAQke,OA5Cb,SAAUH,EAAUv1B,GACnC,MAAM,IAAI1N,MAAM,sBAAwB8iC,GAAOG,GAAU/sB,KAAK,MAAQ,8CAAgD4sB,GAAOp1B,GAAMwI,KAAK,MAAQ,KA8C5ImtB,CAAWJ,EAAU/d,GAEvB8d,EAAkBC,EAAU/d,GAC5B,IAAIoe,EAAc5iC,EAAOuiC,GAAU,SAAUx0B,GAC3C,OAAQtM,EAAK4+B,SAASnzB,EAAIa,GAAMA,MAKlC,OAHI60B,EAAYhlC,OAAS,GArCJ,SAAUilC,EAAW9mC,GAC5C,MAAM,IAAIuD,MAAM,kCAAoCvD,EAAO,WAAaqmC,GAAOS,GAAWrtB,KAAK,MAAQ,eAqCnGstB,CAAmBF,EAAanhC,EAAKsjB,OAEhC7X,IAGP61B,GAAc,SAAUR,EAAUv1B,GACpC,IAAIg2B,EAAchjC,EAAOgN,GAAM,SAAUe,GACvC,OAAQ1M,EAASkhC,EAAUx0B,MAEzBi1B,EAAYplC,OAAS,GA5DP,SAAUolC,GAC5B,MAAM,IAAI1jC,MAAM,gCAAkC8iC,GAAOY,GAAaxtB,KAAK,OA4DzEytB,CAAcD,IAGdE,GAAU,SAAUX,GACtB,OAvCS,SAAUD,EAAmBC,GACtC,OAAOF,GAASC,EAAmBC,EAAU,CAC3ClC,SAAUnjC,EACV6nB,MAAO,aAoCF9S,CAAK8wB,GAAaR,IAGvBY,GAAWD,GAAQ,CACrB,UACA,UACA,SACA,SAEEE,GAAWF,GAAQ,CACrB,UACA,QACA,OACA,YAEEG,GAAUH,GAAQ,CACpB,YACA,OACA,OACA,cAGEI,GAAS,WACX,IAAIC,EAAW1iC,EAASxC,OAoBpBmlC,EAAS3jB,GAAO,CAAE4jB,KAAM9B,GAAM,CAAC,WACnC,MAAO,CACL+B,QAXY,SAAUzB,EAAO0B,GACZA,EAAKpR,QAAQ0P,GACnBriC,MAAK,SAAUg6B,IATf,SAAU+J,EAAM7/B,GAC3B,IAAI6N,EAAS4xB,EAAS5jC,KAAI,SAAUikC,GAClC,OAAOD,EAAKE,QAAQD,EAAK9/B,MAG3B,OADAy/B,EAAW1iC,EAASR,KAAKyD,GAClB6N,GAKQmyB,CAAOH,EAAM/J,GACnBh6B,MAAK,SAAUkd,GACpB0mB,EAAOxB,QAAQyB,KAAK3mB,UAOxBinB,MAtBU,WACVR,EAAW1iC,EAASxC,QAsBpBmlC,OAAQA,EAAOrB,WAaf6B,GAAW,WACb,IATIR,EASAS,GATAT,EAAS3jB,GAAO,CAAE4jB,KAAM9B,GAAM,CAAC,WAC5B,CACL+B,QAAStmC,EACT2mC,MAAO3mC,EACPomC,OAAQA,EAAOrB,WAMb+B,EAAcZ,KACda,EAAYF,EAehB,MAAO,CACLvL,GAfO,WACPyL,EAAUJ,QACVI,EAAYD,GAcZE,IAZQ,WACRD,EAAUJ,QACVI,EAAYF,GAWZI,KANS,WACT,OAAOF,IAAcD,GAMrBR,QAVY,SAAUzB,EAAO0B,GAC7BQ,EAAUT,QAAQzB,EAAO0B,IAUzBH,OAAQU,EAAYV,SAIpBc,GAAQ,SAAUC,EAAUZ,EAAMa,GACpC,IA1LqBhnC,EAAIinC,EACrBC,EAyLAC,GAAS,EACTnB,EAAS3jB,GAAO,CAClBha,MAAO87B,GAAM,IACb5xB,KAAM4xB,GAAM,MAEViD,EAAWZ,KACXa,EAAO,WACTC,EAAK/0B,OACD60B,EAASP,SACXO,EAASR,MACTZ,EAAOxB,QAAQjyB,SAGfg1B,GAvMiBvnC,EAuMMqnC,EAvMFJ,EAuMQ,IAtM7BC,EAAQ,KAoBL,CACLM,OApBW,WACG,OAAVN,IACFO,aAAaP,GACbA,EAAQ,OAkBVQ,SAfa,WAEb,IADA,IAAIthC,EAAO,GACFlG,EAAK,EAAGA,EAAKC,UAAUC,OAAQF,IACtCkG,EAAKlG,GAAMC,UAAUD,GAET,OAAVgnC,GACFO,aAAaP,GAEfA,EAAQS,YAAW,WACjB3nC,EAAGQ,MAAM,KAAM4F,GACf8gC,EAAQ,OACPD,MA8LLG,EAASpB,OAAOC,KAAK5jC,MAAK,SAAUoiC,GAClC0B,EAAKzO,OAAOqP,EAAUtC,EAAMh7B,SAE9B,IAMIm+B,EAAc,SAAUlnC,GAC1B,OAAO,WAEL,IADA,IAAI0F,EAAO,GACFlG,EAAK,EAAGA,EAAKC,UAAUC,OAAQF,IACtCkG,EAAKlG,GAAMC,UAAUD,GAEnBinC,GACFzmC,EAAEF,MAAM,KAAM4F,KAIhBkhC,EAAOnB,EAAKmB,KAAKzB,GAAQ,CAC3BgC,UAAWR,EACXA,KAAMO,EAAYP,GAClBpB,KAAM2B,GA3BQ,SAAUnD,GACxB8C,EAAcC,SACdJ,EAASlB,QAAQzB,EAAO0B,MA0BxB2B,UAAWF,EAAYL,EAAcG,YACnCV,GAIJ,MAAO,CACL94B,QAASo5B,EAAKp5B,QACd65B,GAxCO,SAAU51B,GACjBm1B,EAAKj/B,MAAM8J,GACXi1B,EAASlM,KACT8K,EAAOxB,QAAQn8B,SAsCf6yB,GA7BO,WACPiM,GAAS,GA6BTP,IA3BQ,WACRO,GAAS,GA2BTa,QARY,WACZV,EAAKU,WAQLhC,OAAQA,EAAOrB,WAefsD,GAAe,SAAUC,GAC3B,IAvxIsBC,EAAIC,EAuxItBp/B,EAAS6D,GAAaH,QApvGC,SAAU+3B,GACrC,GAAIpxB,MAAiB7T,EAAcilC,EAAMz7B,QAAS,CAChD,IAAI6L,EAAKhI,GAAaH,QAAQ+3B,EAAMz7B,QACpC,GAAIyI,GAAUoD,IAAOpB,GAAiBoB,IAChC4vB,EAAM4D,UAAY5D,EAAM6D,aAAc,CACxC,IAAIA,EAAe7D,EAAM6D,eACzB,GAAIA,EACF,OAAOnjC,EAAKmjC,IAKpB,OAAOjlC,EAASC,KAAKmhC,EAAMz7B,QAwuGOu/B,CAAuBL,GAAUxmC,MAAMwmC,EAASl/B,SAC9EuJ,EAAO,WACT,OAAO21B,EAASM,mBAEdC,EAAU,WACZ,OAAOP,EAAS/M,kBAEduN,GA9xIkBP,EA8xIHM,EA9xIOL,EA8xIE71B,EA7xIrB,WAEL,IADA,IAAInM,EAAO,GACFlG,EAAK,EAAGA,EAAKC,UAAUC,OAAQF,IACtCkG,EAAKlG,GAAMC,UAAUD,GAEvB,OAAOioC,EAAGC,EAAG5nC,MAAM,KAAM4F,MAyxI3B,OApBY,SAAU4C,EAAQvK,EAAGuP,EAAGuE,EAAMk2B,EAASC,EAAM3xB,GACzD,MAAO,CACL/N,OAAQA,EACRvK,EAAGA,EACHuP,EAAGA,EACHuE,KAAMA,EACNk2B,QAASA,EACTC,KAAMA,EACN3xB,IAAKA,GAYA4xB,CAAQ3/B,EAAQk/B,EAASU,QAASV,EAASW,QAASt2B,EAAMk2B,EAASC,EAAMR,IAS9EY,GAAS,SAAU56B,EAASu2B,EAAOjiC,EAAQ8hC,EAASyE,GACtD,IAAIC,EARO,SAAUxmC,EAAQ8hC,GAC7B,OAAO,SAAU4D,GACX1lC,EAAO0lC,IACT5D,EAAQ2D,GAAaC,KAKXe,CAAOzmC,EAAQ8hC,GAE7B,OADAp2B,EAAQtB,IAAIs8B,iBAAiBzE,EAAOuE,EAASD,GACtC,CAAExE,OAAQxkC,EAAMwkC,GAAQr2B,EAASu2B,EAAOuE,EAASD,KAKtDxE,GAAS,SAAUr2B,EAASu2B,EAAOH,EAASyE,GAC9C76B,EAAQtB,IAAIu8B,oBAAoB1E,EAAOH,EAASyE,IAG9CK,GAAWxoC,EACXyoC,GAAS,SAAUn7B,EAASu2B,EAAOH,GACrC,OATW,SAAUp2B,EAASu2B,EAAOjiC,EAAQ8hC,GAC7C,OAAOwE,GAAO56B,EAASu2B,EAAOjiC,EAAQ8hC,GAAS,GAQxCgF,CAAOp7B,EAASu2B,EAAO2E,GAAU9E,IAEtCiF,GAAiBtB,GAEjBuB,GAAO,SAAUt7B,EAAS+H,GAC5B,IAAIzX,EAAQkX,GAAMxH,EAAS+H,GAC3B,YAAiB3W,IAAVd,GAAiC,KAAVA,EAAe,GAAKA,EAAMirC,MAAM,MAoB5DC,GAAW,SAAUx7B,GACvB,YAAiC5O,IAA1B4O,EAAQtB,IAAI+8B,WAKjBC,GAAQ,SAAU17B,EAAS27B,GAC7B,OAzBU,SAAU37B,EAAS+H,EAAM7U,GACnC,IACIkF,EADMkjC,GAAKt7B,EAAS+H,GACX1V,OAAO,CAACa,IAErB,OADAmU,GAAIrH,EAAS+H,EAAM3P,EAAG0R,KAAK,OACpB,EAqBA8xB,CAAM57B,EAAS,QAAS27B,IAM7BE,GAAQ,SAAU77B,EAAS27B,GACzBH,GAASx7B,GACXA,EAAQtB,IAAI+8B,UAAUrH,IAAIuH,GAE1BD,GAAM17B,EAAS27B,IAkBfG,GAAQ,SAAU97B,EAAS27B,GAC7B,OAAOH,GAASx7B,IAAYA,EAAQtB,IAAI+8B,UAAU9lC,SAASgmC,IAGzDnzB,GAAM,SAAUuzB,GAClB,IAAIC,EAAgBD,EAAU7iC,QAAQ,MAAO,KAI7C,MAAO,CAAEkhB,QAHK,SAAUngB,GACtB,OAAO+hC,EAAgB,IAAM/hC,KAK7B0Z,GAASnL,GAAI,kBACb4R,GAAUzG,GAAOyG,QA8DjB6hB,GAAYxE,GAAS,CACvBU,QApCY,SAAUD,EAAK9/B,GAC3B,OAAOulB,GAAcvlB,EAAGolB,KAAO0a,EAAI1a,KAAMplB,EAAGqlB,IAAMya,EAAIza,MAoCtDoJ,QAlCc,SAAU0P,GACxB,OAAOphC,EAASR,KAAKgpB,GAAc4Y,EAAMhmC,EAAGgmC,EAAMz2B,KAkClDs5B,KA7BS,SAAU8C,EAASpD,GAC5B,IAAIqD,EAnCQ,SAAUC,GACtB,IAAItD,EAAWzhC,EAAS,CAAEglC,WAAYjiB,GAAQ,YAAcgiB,GACxDr9B,EAAMJ,GAAaY,QAAQ,OAiB/B,OAhBA8H,GAAItI,EAAK,OAAQ,gBACjBwJ,GAASxJ,EAAK,CACZu9B,SAAU,QACV9e,KAAM,MACNC,IAAK,MACLwC,MAAO,OACP7C,OAAQ,SAEVye,GAAM98B,EAAKqb,GAAQ,YACnByhB,GAAM98B,EAAK+5B,EAASuD,YAOb,CACLr8B,QAPY,WACZ,OAAOjB,GAOP+6B,QALY,WACZjnB,GAAS9T,KAkBGw9B,CAAQzD,GAClB0D,EAAQrB,GAAOgB,EAAQn8B,UAAW,YAAak8B,EAAQvC,WACvD8C,EAAMtB,GAAOgB,EAAQn8B,UAAW,UAAWk8B,EAAQ/C,MACnDuD,EAAQvB,GAAOgB,EAAQn8B,UAAW,YAAak8B,EAAQnE,MACvD4E,EAAOxB,GAAOgB,EAAQn8B,UAAW,WAAYk8B,EAAQtC,WAczD,OAAOlC,GAAS,CACd13B,QAASm8B,EAAQn8B,QACjB7F,MARU,SAAU8J,GACpBgO,GAAOhO,EAAQk4B,EAAQn8B,YAQvBqE,KANS,WACTwO,GAASspB,EAAQn8B,YAMjB85B,QAjBY,WACZqC,EAAQrC,UACR2C,EAAIpG,SACJqG,EAAMrG,SACNsG,EAAKtG,SACLmG,EAAMnG,aAmBR7M,OAjCW,SAAUqP,EAAUt9B,GAC/Bs9B,EAASrP,OAAOjuB,EAAKiiB,KAAMjiB,EAAKkiB,QA2C9Bmf,GAAwB,SAAU7yB,GACpC,MAAyC,SAAlCvC,GAAMuC,EAAK,oBAMhB8yB,GAAWr0B,GAAI,iBACfs0B,GAAYD,GAASziB,QAkBrB2iB,GAAc,WAChB,IAAIjF,EAAS3jB,GAAO,CAClB6oB,KAAM/G,GAAM,CACV,SACA,SACA,aAGAn7B,EAAS3F,EAASxC,OAClBsqC,EAzBS,WACb,IAAInF,EAAS3jB,GAAO,CAClB6oB,KAAM/G,GAAM,CACV,SACA,aAMJ,MAAO,CACLzM,OAJW,SAAUj5B,EAAGuP,GACxBg4B,EAAOxB,QAAQ0G,KAAKzsC,EAAGuP,IAIvBg4B,OAAQA,EAAOrB,UAaFyG,GACfD,EAASnF,OAAOkF,KAAK7oC,MAAK,SAAUoiC,GAClCz7B,EAAO5G,MAAK,SAAU/D,GACpB2nC,EAAOxB,QAAQ0G,KAAKzG,EAAM4G,OAAQ5G,EAAM6G,OAAQjtC,SASpD,MAAO,CACLoH,OAPW,SAAUpH,GACrB2K,EAAS3F,EAASR,KAAKxE,IAOvB6G,IALQ,WACR,OAAO8D,GAKP0uB,OAAQyT,EAASzT,OACjBsO,OAAQA,EAAOrB,WAmCf4G,GAAYP,GAAU,eACtBQ,GAAeR,GAAU,gBACzBS,GAAeT,GAAU,gBA0BzBhD,GAAU,SAAU0D,GACtB,IAAI3F,EAAWvxB,GAAck3B,EAAKv5B,SAAU,IAAMo5B,IAClDnpC,EAAK2jC,EAAUhlB,KAEb4qB,GAAU,SAAUD,EAAM7d,EAAWxL,GACvC,IAAIwe,EAAS6K,EAAK7K,SAClBz+B,EAAKyrB,GAAW,SAAU+d,GACxBA,EAASxpC,MAAK,SAAUypC,GACtB,IAAIC,EAAMzpB,EAAOwe,EAAQgL,GACzB9B,GAAM+B,EAAKP,IACXprB,GAAOurB,EAAKv5B,SAAU25B,UAIxBC,GAAa,SAAUL,EAAMM,EAAcxB,EAAUyB,GACvDN,GAAQD,EAAMM,GAAc,SAAUnL,EAAQgL,GAC5C,IA3EgBhzB,EAAQpa,EAAGuP,EAAG+O,EAAGyM,EAC/BsiB,EA0EEI,GA3EYrzB,EA2ECgzB,EAAG5hB,IA3EIxrB,EA2ECotC,EAAGptC,EAAIoiC,EAAOnV,KA3EZ1d,EA2EkBw8B,EAAS7e,IAAMkV,EAAOlV,IA3ErC5O,EAkCd,EAlCiByM,EA2EsDyiB,EA1ErFH,EAAMj/B,GAAaY,QAAQ,OAC/BgJ,GAASq1B,EAAK,CACZtB,SAAU,WACV9e,KAAMjtB,EAAIse,EAAI,EAAI,KAClB4O,IAAK3d,EAAI,KACTsd,OAAQ9B,EAAI,KACZ2E,MAAOpR,EAAI,OAEbvH,GAAOs2B,EAAK,CACV,cAAejzB,EACfszB,KAAQ,iBAEHL,GAgEL,OADA/B,GAAMmC,EAAQT,IACPS,MAGPE,GAAa,SAAUV,EAAMW,EAAc7B,EAAU8B,GACvDX,GAAQD,EAAMW,GAAc,SAAUxL,EAAQgL,GAC5C,IAAIU,EAnEE,SAAUjoC,EAAG7F,EAAGuP,EAAG+O,EAAGyM,GAC9B,IAAIsiB,EAAMj/B,GAAaY,QAAQ,OAY/B,OAXAgJ,GAASq1B,EAAK,CACZtB,SAAU,WACV9e,KAAMjtB,EAAI,KACVktB,IAAK3d,EAAIwb,EAAI,EAAI,KACjB8B,OAAQ9B,EAAI,KACZ2E,MAAOpR,EAAI,OAEbvH,GAAOs2B,EAAK,CACV,WAAYxnC,EACZ6nC,KAAQ,iBAEHL,EAsDQnzB,CAAIkzB,EAAGlzB,IAAK6xB,EAAS9e,KAAOmV,EAAOnV,KAAMmgB,EAAG79B,EAAI6yB,EAAOlV,IAAK2gB,EAhDzD,GAkDhB,OADAvC,GAAMwC,EAAQf,IACPe,MAGPC,GAAc,SAAUC,EAAUf,EAAMpzB,EAAOC,EAAM8B,GACvD,IAAImwB,EAAWze,GAASzT,GACpBqoB,EAAc+K,EAAK/K,YACnB0L,EAAe9zB,EAAKnY,OAAS,EAAIkrB,GAAOuC,UAAUtV,EAAMD,GAAS,GACjEo0B,EAAmBL,EAAajsC,OAAS,EAxD3B,SAAU8a,EAAWylB,GACvC,OAAOt+B,EAAK6Y,EAAU5a,KAAK,SAAUqY,EAAKzU,GACxC,OAAOy8B,EAAYhoB,EAAIzK,SAAW,CAAChK,GAAK,MAsDOyoC,CAAcF,EAAU9L,GAAe,GACpFiM,EAAwBpqC,EAAO6pC,GAAc,SAAUQ,EAAM3oC,GAC/D,OAAO5B,EAAOoqC,GAAkB,SAAUI,GACxC,OAAO5oC,IAAM4oC,QAGjBV,GAAWV,EAAMkB,EAAuBpC,EAAU/gB,GAASnR,IAC3D,IAAI0zB,EAAe3xB,EAAKja,OAAS,EAAI+tB,GAAMN,UAAUxT,EAAM/B,GAAS,GAChEy0B,EAAmBf,EAAa5rC,OAAS,EA3DxB,SAAU8a,EAAWylB,GAC1C,IAAIqM,EAAgB,GASpB,OARA5oC,EAAM8W,EAAUjB,KAAK9B,SAAS,SAAUpF,GACtB0J,GAAUS,YAAYhC,EAAWnI,GAAO5Q,KAAI,SAAU8nB,GACpE,OAAOA,EAAI/b,WAEC3L,OAAOo+B,IACnBqM,EAAcppC,KAAKmP,MAGhBvQ,EAAOwqC,GAAe,SAAUnxB,GACrC,IAAI8W,EAAclW,GAAUxB,YAAYC,GAAW,SAAU9D,GAC3D,OAAOA,EAAKyB,SAAWgD,KAEzB,OAAOtZ,EAAOowB,GAAa,SAAUvb,GACnC,OAAOupB,EAAYvpB,EAAKlJ,eA4CqB++B,CAAiBR,EAAU9L,GAAe,GACvFuM,EAAwB1qC,EAAOwpC,GAAc,SAAUa,EAAM3oC,GAC/D,OAAO5B,EAAOyqC,GAAkB,SAAUD,GACxC,OAAO5oC,IAAM4oC,QAGjBf,GAAWL,EAAMwB,EAAuB1C,EAAU/e,GAAWnT,KAE3D60B,GAAU,SAAUzB,EAAMpzB,GAE5B,GADA0vB,GAAQ0D,GACJA,EAAK/K,YAAYroB,GAAQ,CAC3B,IAAI4C,EAAYuB,GAAUxD,UAAUX,GAChCC,EAAOW,GAAOgC,GACdb,EAAOyP,GAAU5O,GACrBsxB,GAAYtxB,EAAWwwB,EAAMpzB,EAAOC,EAAM8B,KAG1C+yB,GAAS,SAAU1B,EAAMhrC,GAC3B,IAAI2sC,EAAO74B,GAAck3B,EAAKv5B,SAAU,IAAMo5B,IAC9CnpC,EAAKirC,EAAM3sC,IAET4sC,GAAO,SAAU5B,GACnB0B,GAAO1B,GAAM,SAAUI,GACrBt1B,GAAMs1B,EAAK,UAAW,YAGtByB,GAAO,SAAU7B,GACnB0B,GAAO1B,GAAM,SAAUI,GACrBt1B,GAAMs1B,EAAK,UAAW,aAUtB0B,GAAoBxC,GAAU,wBAC9ByC,GAAa,SAAU/B,GACzB,IAAI3E,EAAWkE,KACXlN,EA3MU,SAAUgJ,EAAUC,QACjB,IAAbA,IACFA,EAAW,IAEb,IAAIb,OAAyB7mC,IAAlB0nC,EAASb,KAAqBa,EAASb,KAAOgE,GACzD,OAAOrD,GAAMC,EAAUZ,EAAMa,GAsMd0G,CAAU3G,EAAU,IAC/B4G,EAAatqC,EAASxC,OACtB+sC,EAAa,SAAU1/B,EAAS3P,GAClC,OAAO8E,EAASC,KAAKoS,GAAMxH,EAAS3P,KAEtCwoC,EAASf,OAAOkF,KAAK7oC,MAAK,SAAUoiC,GAClCmJ,EAAWnJ,EAAMz7B,OAAQ,YAAY5G,MAAK,SAAUyrC,GAClD,IAAIC,EAAap2B,GAAY+sB,EAAMz7B,OAAQ,OAC3CwN,GAAMiuB,EAAMz7B,OAAQ,MAAO8kC,EAAarJ,EAAM6G,OAAS,SAEzDsC,EAAWnJ,EAAMz7B,OAAQ,eAAe5G,MAAK,SAAU2rC,GACrD,IAAIC,EAAat2B,GAAY+sB,EAAMz7B,OAAQ,QAC3CwN,GAAMiuB,EAAMz7B,OAAQ,OAAQglC,EAAavJ,EAAM4G,OAAS,YAG5D,IAAI4C,EAAW,SAAUjlC,EAAQklC,GAG/B,OAFWx2B,GAAY1O,EAAQklC,GACpB/2B,GAAanO,EAAQ,gBAAkBklC,EAAK,IAGzDnQ,EAASiI,OAAOzzB,KAAKlQ,MAAK,WACxB0kC,EAAS7hC,MAAM9C,MAAK,SAAU4G,GAC5B2kC,EAAWvrC,MAAK,SAAUkW,GACxBs1B,EAAW5kC,EAAQ,YAAY5G,MAAK,SAAUuW,GAC5C,IAAIiS,EAAQqjB,EAASjlC,EAAQ,OAC7B6M,GAAO7M,EAAQ,oBACfg9B,EAAOxB,QAAQjG,aAAajmB,EAAOsS,EAAOtT,SAASqB,EAAK,QAE1Di1B,EAAW5kC,EAAQ,eAAe5G,MAAK,SAAUyW,GAC/C,IAAI+R,EAAQqjB,EAASjlC,EAAQ,QAC7B6M,GAAO7M,EAAQ,qBACfg9B,EAAOxB,QAAQ1G,YAAYxlB,EAAOsS,EAAOtT,SAASuB,EAAQ,QAE5Ds0B,GAAQzB,EAAMpzB,YAIpB,IAAIgsB,EAAU,SAAUt7B,EAAQklC,GAC9BlI,EAAOxB,QAAQ2J,cACfpH,EAASthC,OAAOuD,GAChBuM,GAAIvM,EAAQ,gBAAkBklC,EAAKx2B,GAAY1O,EAAQklC,IACvDnE,GAAM/gC,EAAQwkC,IACdh3B,GAAMxN,EAAQ,UAAW,OACzB+0B,EAASgK,GAAG2D,EAAKv5B,WAEfi8B,EAAY/E,GAAOqC,EAAKv5B,SAAU,aAAa,SAAUsyB,GAvDhD,IAAUv2B,EAAAA,EAwDRu2B,EAAMz7B,OAvDdghC,GAAM97B,EAASs9B,KAwDlBlH,EAAQG,EAAMz7B,OAAQ,OAtDb,SAAUkF,GACvB,OAAO87B,GAAM97B,EAASu9B,IAuDhB4C,CAAS5J,EAAMz7B,SACjBs7B,EAAQG,EAAMz7B,OAAQ,WAGtBsJ,EAAS,SAAUR,GACrB,OAAOnD,GAAKmD,EAAG45B,EAAK9K,SAElB0N,EAA2B,SAAUtlC,GACvC,OAAOoM,GAAUpM,EAAQ,QAASsJ,GAAQ9P,QAAO,SAAU8V,GACzD,OA1P2B,SAAUtP,EAAQsJ,GACjD,OAAO8C,GAAUpM,EAAQ,oBAAqBsJ,GAyPnCi8B,CAA2Bj2B,EAAOhG,GAAQhQ,OAAOwoC,QAGxD0D,EAAYnF,GAAOqC,EAAK9K,OAAQ,aAAa,SAAU6D,GACzD6J,EAAyB7J,EAAMz7B,QAAQ1H,MAAK,WACtCqS,GAAO8wB,EAAMz7B,SACfg/B,GAAQ0D,MAET,SAAUpzB,GACXq1B,EAAatqC,EAASR,KAAKyV,GAC3B60B,GAAQzB,EAAMpzB,SAYd0tB,EAAS3jB,GAAO,CAClBkc,aAAc4F,GAAM,CAClB,QACA,QACA,QAEFrG,YAAaqG,GAAM,CACjB,QACA,QACA,WAEFgK,YAAahK,GAAM,MAErB,MAAO,CACL6D,QAvBc,WACdoG,EAAU7J,SACViK,EAAUjK,SACVxG,EAASiK,UACTA,GAAQ0D,IAoBRyB,QAlBc,SAAUsB,GACxBtB,GAAQzB,EAAM+C,IAkBdvT,GAAI6C,EAAS7C,GACb0L,IAAK7I,EAAS6I,IACd8H,SAAU3uC,EAAMutC,GAAM5B,GACtBiD,SAAU5uC,EAAMwtC,GAAM7B,GACtB1F,OAAQA,EAAOrB,WA8CfiK,GA1CW,SAAUlD,EAAM3N,EAAU8Q,GACvC,IAAIC,EAAaxjB,GACbyjB,EAAa5gB,GACb6gB,EAAUvB,GAAW/B,GACrB1F,EAAS3jB,GAAO,CAClB4sB,aAAc9K,GAAM,CAClB,QACA,SAEF+K,YAAa/K,GAAM,CACjB,QACA,SAEFgL,UAAWhL,GAAM,MAoBnB,OAlBA6K,EAAQhJ,OAAOzH,aAAal8B,MAAK,SAAUoiC,GACzC,IAAInsB,EAAQmsB,EAAMnsB,MAClB0tB,EAAOxB,QAAQyK,aAAa32B,EAAO,OACnC,IAAIsS,EAAQkkB,EAAWlkB,MAAM6Z,EAAM7Z,MAAOtS,GAC1CimB,GAAajmB,EAAOsS,EAAO6Z,EAAM9rB,IAAKm2B,GACtC9I,EAAOxB,QAAQ0K,YAAY52B,EAAO,UAEpC02B,EAAQhJ,OAAOmI,YAAY9rC,MAAK,SAAU+sC,GACxCpJ,EAAOxB,QAAQ2K,eAEjBH,EAAQhJ,OAAOlI,YAAYz7B,MAAK,SAAUoiC,GACxC,IAAInsB,EAAQmsB,EAAMnsB,MAClB0tB,EAAOxB,QAAQyK,aAAa32B,EAAO,OACnC,IAAIsS,EAAQmkB,EAAWnkB,MAAM6Z,EAAM7Z,MAAOtS,GACtC2Y,EAAY4d,EAAWv2B,GAC3BwlB,GAAYxlB,EAAOsS,EAAO6Z,EAAM5rB,OAAQklB,EAAU9M,GAClD+U,EAAOxB,QAAQ0K,YAAY52B,EAAO,UAE7B,CACL4iB,GAAI8T,EAAQ9T,GACZ0L,IAAKoI,EAAQpI,IACb8H,SAAUM,EAAQN,SAClBC,SAAUK,EAAQL,SAClB3G,QAASgH,EAAQhH,QACjBhC,OAAQA,EAAOrB,WAKf0K,GAAa,SAAUhW,EAAQ1gB,GACjC,OAAO0gB,EAAOiW,KAAK,SAAU,CAAE3iC,KAAMgM,KAEnC42B,GAAc,SAAUlW,EAAQjiB,GAClC,OAAOiiB,EAAOiW,KAAK,UAAW,CAAE3iC,KAAMyK,KA6BpCo4B,GAAoB,SAAUnW,EAAQ/gB,EAAO8jB,GAC/C/C,EAAOiW,KAAK,gBAAiB/pC,EAASA,EAAS,GAAI62B,GAAO,CAAE9jB,MAAOA,MAEjEm3B,GAAgB,CAClBC,WAAW,EACXv5B,OAAO,GAELw5B,GAAoB,CACtBD,WAAW,EACXv5B,OAAO,GAILy5B,GAAgB,CAClB,kBAAmB,WACnBzhB,MAAS,QAcP0hB,GAAoB,CAAEC,OAAQ,KAC9BC,GAAiC,gBACjCC,GAAqB,SAAU3W,GACjC,OAAOA,EAAO4W,SAAS,oBAAqB,SAE1CC,GAAwB,SAAU7W,GACpC,OAAOA,EAAO4W,SAAS,2BAErBE,GAAuB,SAAU9W,GACnC,OAAOA,EAAO4W,SAAS,2BAA4BJ,GAAmB,WAEpEO,GAAmB,SAAU/W,GAC/B,OAAOA,EAAO4W,SAAS,uBAxBI,SAAU5W,GACrC,GAAIgX,GAAehX,GAAS,CAC1B,IAAIiX,EAAcjX,EAAOrlB,UAAU4V,YACnC,OAAOrkB,EAASA,EAAS,GAAIqqC,IAAgB,CAAEzhB,MAAOmiB,EAAc,OAC/D,OAAIC,GAAmBlX,GACrBtpB,GAAS6/B,IAAe,SAAUY,EAAQjgC,GAC/C,MAAe,UAARA,KAGFq/B,GAesCa,CAAuBpX,GAAS,WAQ7EqX,GAAqB,SAAUrX,GACjC,OAAOA,EAAO4W,SAAS,qBAAqB,EAAM,YAEhDU,GAAoB,SAAUtX,GAChC,OAAOA,EAAO4W,SAAS,oBAAoB,EAAM,YAE/CW,GAAsB,SAAUvX,GAClC,OAAOA,EAAO4W,SAAS,gBAAgB,EAAM,YAQ3CY,GAAqB,SAAUxX,GACjC,OAAOA,EAAO4W,SAAS,sBAAsB,EAAO,YAWlDa,GAAsB,SAAUzX,GAClC,MAAsC,aAA/B2W,GAAmB3W,KAA4D,IAAlC6W,GAAsB7W,IAExEgX,GAAiB,SAAUhX,GAC7B,MAAsC,UAA/B2W,GAAmB3W,KAAyD,IAAlC6W,GAAsB7W,IAErEkX,GAAqB,SAAUlX,GACjC,MAAsC,eAA/B2W,GAAmB3W,IAKxB0X,GAAiB,SAAU1X,GAC7B,OAAOA,EAAO4W,SAAS,uBAAuB,EAAO,YAEnDe,GAAqB,SAAU3X,GACjC,IAAI4X,EAAe,UACfzyC,EAAQ66B,EAAO4W,SAAS,oBAAqBgB,EAAc,UAO/D,OAAKptC,EANa,CAChB,UACA,QACA,eACA,QAEyBrF,GAGlBA,EAFAyyC,GAKPC,GAA6B,SAAU7X,GACzC,IAII8X,EAAY9X,EAAO4W,SAAS,wBAAyBF,GAAgC,UACzF,OAAOprC,EALU,CACf,gBACA,gBAGsB,SAAUwhC,GAChC,OAAOA,IAASgL,KACfzvC,MAAMquC,KAEPqB,GAAgC,SAAU/X,GAC5C,MAA8C,kBAAvC6X,GAA2B7X,IAEhCgY,GAA8B,SAAUhY,GAC1C,MAA8C,gBAAvC6X,GAA2B7X,IAEhCiY,GAAmB,SAAUjY,GAC/B,IAAIkY,EAAgBlY,EAAO4W,SAAS,wBACpC,OAAIhxC,EAASsyC,GACJluC,EAASR,KAAK0uC,EAAc9H,MAAM,SAChC/qC,MAAMS,QAAQoyC,GAChBluC,EAASR,KAAK0uC,GAEdluC,EAASxC,QAQhB2wC,GAAQ,SAAUnY,EAAQ/gB,GAC5B,GAAIw4B,GAAoBzX,GAAS,CAC/B,IAAIlL,EAAQwL,GAAcN,EAAQ/gB,EAAM1L,KAAKpK,OAAOs3B,IAAcn4B,YAAW,WAC3E,OAAOsiC,GAAuB3rB,MAEhC,OAAOkc,GAAyBrG,EAAO7V,GAClC,OAAI+3B,GAAehX,GACjB7E,GAAoB3K,GAAMvR,GAAQA,GAElCkc,GAAuBlc,IAI9Bm5B,GAA0B,SAAUvjC,GACtC2H,GAAO3H,EAAS,UAOdwjC,GAAqB,SAAUp5B,EAAO2Y,GACxC,IAAIqD,EAtvEmB,SAAUhc,GACjC,OAAOuR,GAAMvR,GAAS,KAqvEPq5B,CAAmBr5B,GAClCyqB,GAAezqB,EAAOjV,EAASR,KAAKyxB,GAAWjxB,EAASxC,OAAQowB,GAChEwgB,GAAwBn5B,IAatBs5B,GAAoB,SAAUvY,EAAQ/gB,IArBf,SAAUA,EAAO2Y,GAC1C,IAAIqD,EAAWxC,GAAqBxZ,GACpCyqB,GAAezqB,EAAOjV,EAASR,KAAKyxB,GAAWjxB,EAASxC,OAAQowB,GAChEwgB,GAAwBn5B,GAoBxBu5B,CAAqBv5B,EADHk5B,GAAMnY,EAAQ/gB,KAG9Bw5B,GAAgB,SAAUzY,EAAQ/gB,GACpC,IAAIy5B,EAAcP,GAAMnY,EAAQ/gB,GAChCo5B,GAAmBp5B,EAAOy5B,IAExBC,GAnBoB,SAAU15B,GAChCtB,GAASsB,EAAO,SAChB,IAAIwR,EAAY3R,GAAQG,GACpB25B,EAAcnoB,EAAU1pB,OAAS,EAAI0pB,EAAY/Y,GAAMuH,GAC3DlW,EAAK6vC,GAAa,SAAU76B,GAC1BJ,GAASI,EAAM,SACfq6B,GAAwBr6B,MAE1Bq6B,GAAwBn5B,IAuBtB45B,GAAkB,WACpB,IAAIxtB,EAAY7X,GAAaY,QAAQ,OAUrC,OATAgJ,GAASiO,EAAW,CAClB8lB,SAAU,SACVlf,OAAQ,IACR6C,MAAO,IACPgkB,QAAS,IACTC,OAAQ,IACRtC,OAAQ,MAEV3vB,GAj9HOnM,GAAQnH,GAAaH,QAAQQ,WAi9HrBwX,GACRA,GAWL2tB,GAAmB,OACnB1R,GAAc,SAAU1oB,GAC1B,MAAyC,UAAlCvC,GAAMuC,EAAK,oBAEhBq6B,GAAmB,SAAUjZ,GAC/B,IAGIkZ,EACAC,EAJAC,EAAepvC,EAASxC,OACxBi8B,EAASz5B,EAASxC,OAClB6qC,EAAOroC,EAASxC,OAGhB6xC,EAAU,SAAUz6B,GACtB,MAAwB,UAAjBA,EAAI3G,UAETqhC,EAAa,WACf,OAAO7V,GAKL+R,EAAa,SAAUv2B,GACzB,OAAOk5B,GAAMnY,EAAQ/gB,IAEnBs6B,EAAwB,WAC1B,OAAOxB,GAA8B/X,GAAU8G,KAAkB7B,MAK/DuU,EAAoB,SAAUv6B,EAAOuoB,EAAQ1S,GAC/C,IAAI2kB,EAAoBrqC,GAASo4B,EAAQ,KAIzC,GAHkB,KAAd2R,GACFZ,GAAkBvY,EAAQ/gB,GAExB6V,IAAUokB,GAAwB,KAAdC,EAAkB,CACxCh8B,GAAM8B,EAAO,QAASk6B,GACtB,IAAIzU,EAAW6U,IACX3hB,EAAY4d,EAAWv2B,GACvB2R,EAAMmnB,GAA8B/X,IAAWyZ,EAZnC,SAAUx6B,GAC5B,OAAO4rB,GAAY5rB,GAAOH,QAW+C46B,CAAcz6B,GAAS,EAAI,EAClGwlB,GAAYxlB,EAAO6V,EAAQokB,EAAQtoB,EAAK8T,EAAU9M,QAC7C,GAAI6I,GAAa0Y,GAAY,CAClC,IAAIQ,EAAW7pB,WAAWqpB,EAAUprC,QAAQ,IAAK,KAEjDoP,GAAM8B,EAAO,QADQ6V,EAAQ6kB,EAAWT,EACD,MA5wD/B,SAAU/zC,GACtB,MAAO,oBAAoBwI,KAAKxI,IA6wD1By0C,CAAQT,IA7EC,SAAUl6B,GACzB,IAAI4C,EAAYuB,GAAUxD,UAAUX,GAC/BmE,GAAUQ,WAAW/B,IACxB9Y,EAAK2O,GAAMuH,IAAQ,SAAUlB,GAC3B,IAAI87B,EAAgBv8B,GAAMS,EAAM,SAChCZ,GAAMY,EAAM,QAAS87B,GACrBr9B,GAAOuB,EAAM,YAwEb+7B,CAAW76B,IA+Ef,OApEA+gB,EAAO6B,GAAG,QAAQ,WAChB,IAAIkY,EAlEI,SAAU/Z,EAAQsH,GAC5B,OAAOtH,EAAOga,OAAS3S,GAAgBtH,GAAUC,GAAS6Y,KAAmBvR,GAAeD,GAAgB7zB,GAAaH,QAAQ2sB,EAAOyC,UAAW6E,GAiEnI2S,CAAMja,EAAQsH,IAE5B,GADA+K,EAAOroC,EAASR,KAAKuwC,GA9ID,SAAU/Z,GAChC,IAAIka,EAAiBla,EAAO4W,SAAS,mBAAmB,GACxD,OAAOhxC,EAASs0C,GAAqC,UAAnBA,EAA6BA,EA6IzDC,CAAkBna,IAxOD,SAAUA,GACjC,OAAOA,EAAO4W,SAAS,qBAAqB,EAAM,WAuOfwD,CAAmBpa,GAAS,CAC3D,IAAI0E,EAAW6U,IACXc,EAAK9E,GAAmBwE,EAASrV,EAAU8Q,GAC/C6E,EAAGxY,KACHwY,EAAG1N,OAAOmJ,UAAU9sC,MAAK,SAAU+sC,GACjCqD,EAAepvC,EAASR,KAAKw2B,EAAOW,UAAU2Z,aAEhDD,EAAG1N,OAAOiJ,aAAa5sC,MAAK,SAAUoiC,GACpC,IAAImP,EAAWnP,EAAMnsB,MAAM1L,KAtTP,SAAUysB,EAAQrwB,EAAQmlB,EAAO7C,EAAQuV,GACnExH,EAAOiW,KAAK,oBAAqB,CAC/BtmC,OAAQA,EACRmlB,MAAOA,EACP7C,OAAQA,EACRuV,OAAQA,IAkTJgT,CAAsBxa,EAAQua,EAAUta,GAAgBsa,GAAWra,GAAeqa,GAAWvB,GAAmB5N,EAAMlmC,SAExHm1C,EAAG1N,OAAOkJ,YAAY7sC,MAAK,SAAUoiC,GACnC,IAAInsB,EAAQmsB,EAAMnsB,MACds7B,EAAWt7B,EAAM1L,IACrB6sB,GAAgBnhB,GAChBm6B,EAAarwC,MAAK,SAAUk6B,GAC1BjD,EAAOW,UAAUqC,OAAOC,GACxBjD,EAAOkD,WAvTO,SAAUlD,EAAQrwB,EAAQmlB,EAAO7C,EAAQuV,GAC/DxH,EAAOiW,KAAK,gBAAiB,CAC3BtmC,OAAQA,EACRmlB,MAAOA,EACP7C,OAAQA,EACRuV,OAAQA,IAoTJiT,CAAkBza,EAAQua,EAAUta,GAAgBsa,GAAWra,GAAeqa,GAAWvB,GAAmB5N,EAAMlmC,MAClH86B,EAAO0a,YAAYzR,SAErBxF,EAASz5B,EAASR,KAAK6wC,OAG3Bra,EAAO6B,GAAG,qBAAqB,SAAUppB,GACvC,IAAIkiC,EAAYliC,EAAE9I,OAClB,GAAI0pC,EAAQsB,GAAY,CACtB,IAAI17B,EAAQzL,GAAaH,QAAQsnC,GACjC5xC,EAAKi3B,EAAOzsB,IAAIqnC,OAAO,yBAAyB,SAAUl+B,GACxDsjB,EAAOzsB,IAAIsnC,SAASn+B,EAAO,OAASm7B,GAA2B7X,GAAU,gBAEtE0K,GAAgBzrB,IAAU+3B,GAAehX,GAC5CyY,GAAczY,EAAQ/gB,IACZwrB,GAAkBxrB,IAAUw4B,GAAoBzX,IAC1DuY,GAAkBvY,EAAQ/gB,GAExB0rB,GAAe1rB,IAAU/P,GAAWuJ,EAAE+uB,OAAQwR,KAChDT,GAAkBvY,EAAQ/gB,GAE5Bi6B,EAASzgC,EAAEqc,MACXqkB,EAAYjC,GAAmBlX,GAAU,GAAKM,GAAcN,EAAQ2a,GAAWtyC,MAAM,QAGzF23B,EAAO6B,GAAG,iBAAiB,SAAUppB,GACnC,IAAIkiC,EAAYliC,EAAE9I,OAClB,GAAI0pC,EAAQsB,GAAY,CACtB,IAAI17B,EAAQzL,GAAaH,QAAQsnC,GAC7BG,EAAWriC,EAAE+uB,OACbt4B,GAAW4rC,EAAU,YACvBtB,EAAkBv6B,EAAO67B,EAAUriC,EAAEqc,OAEvCsL,GAAgBnhB,GAChBk3B,GAAkBnW,EAAQ/gB,EAAM1L,IAAK6iC,QAGzCpW,EAAO6B,GAAG,cAAc,WACtByX,IAAavwC,MAAK,SAAU06B,GACtBzD,EAAO8M,KAAKiO,aACdtX,EAAO4R,WAEP5R,EAAO6R,iBAIN,CACLgE,WAAYA,EACZ0B,SA9Ga,WACb,OAAO3I,EAAKhqC,MAAMg/B,GAAgB7zB,GAAaH,QAAQ2sB,EAAOrlB,WAAY2sB,MA8G1EqH,QA/EY,WACZlL,EAAO16B,MAAK,SAAUsxC,GACpBA,EAAG1L,aAEL0D,EAAKtpC,MAAK,SAAU2a,IA1DT,SAAUsc,EAAQqS,GAC3BrS,EAAOga,QACTtyB,GAAS2qB,EAAKv5B,UAyDZmiC,CAASjb,EAAQtc,SA8EnBw3B,GAAQ,SAAUrmC,EAASsmC,GAC7B,MAAO,CACLtmC,QAASA,EACTsmC,OAAQA,IAIRjS,GAAO,SAAUnf,EAAUlV,EAASmlB,GACtC,OAAIjQ,EAAS9M,WAAW5E,OAAOxD,IAAmE,IAAvDkV,EAAS9M,WAAWoM,QAAQxU,GAASvF,OAAOvI,QAAgBgjB,EAAS9M,WAAW9E,UAAUtD,GAC5HmlB,EAAUnlB,GAAS7L,MAAK,SAAUgM,GACvC,OAAOk0B,GAAKnf,EAAU/U,EAAMglB,GAAWnxB,SAAQ,WAC7C,OAAOmB,EAASR,KAAKwL,SAIlBhL,EAASxC,QAGhB4zC,GAAQ,SAAUrxB,EAAUlV,GAC9B,OAAIkV,EAAS9M,WAAW5E,OAAOxD,GACtBkV,EAAS9M,WAAWoM,QAAQxU,GAAS9N,OAE/BgjB,EAAS9M,WAAWzD,SAAS3E,GAC5B9N,QAEds0C,GAAc,SAAUtxB,EAAUlV,GACpC,IAAIzG,EAAY86B,GAAKnf,EAAUlV,EAASkV,EAASjX,QAAQuG,aAAahR,MAAMwM,GAC5E,GAAIkV,EAAS9M,WAAW5E,OAAOjK,GAC7B,OAAO8sC,GAAM9sC,EAAWgtC,GAAMrxB,EAAU3b,IAE1C,IAAIoL,EAAWuQ,EAAS9M,WAAWzD,SAASpL,GAC5C,OAAOoL,EAASzS,OAAS,EAAIs0C,GAAYtxB,EAAUvQ,EAASA,EAASzS,OAAS,IAAMm0C,GAAM9sC,EAAWgtC,GAAMrxB,EAAU3b,KAGnHktC,GAAgBD,GAEhBE,GAAanzB,KAKbozB,GAAQ,SAAUC,EAAMtyB,GAEV,IADFjL,GAAQu9B,EAAM,YAz+ER,SAAU19B,GAE9B,OADY0Z,GAAY1Z,GACX/U,MAAK,SAAU0a,GAC1B,OAAO8R,GAAM9R,EAAG,CACd,QACA,WACA,aAq+EUg4B,CAAgBD,GACtB1yC,MAAK,SAAU2a,GACnB,IAAIuX,EAAWvX,EAAEve,MAAQ,EACzBqzB,GAAgBijB,EAAMxgB,EAAUvX,EAAEkS,MAClC4C,GAAgBrP,EAAO8R,EAAUvX,EAAEkS,UAKrC+lB,GAAW,SAAU9mC,EAASoI,EAAU9X,EAAOy2C,GAC7Cz2C,IAAUy2C,EACZp/B,GAAO3H,EAASoI,GAEhBf,GAAIrH,EAASoI,EAAU9X,IAGvB0jB,GAAS,SAAU5J,EAAOnK,EAAUD,GACtC9I,EAAKkP,GAAWgE,EAAOnK,IAAW7M,MAAK,WACrC,OAAO8e,GAAQ9H,EAAOpK,MACrB,SAAU4E,GACX,OAAOyG,GAAMzG,EAAO5E,OAkBpBgnC,GAAS,SAAU58B,EAAO2B,GAC5B,IAAIk7B,EAAU,GACV37B,EAAW,GACX47B,EAAW,SAAUC,GACvB,OAAOlzC,EAAIkzC,GAAa,SAAU18B,GAC5BA,EAAIzH,OACNikC,EAAQvxC,KAAK+U,EAAIzK,SAEnB,IAAIonC,EAAK38B,EAAIzK,QAUb,OATA0S,GAAM00B,GACNlzC,EAAKuW,EAAI5H,OAAO,SAAUqG,GACpBA,EAAKlG,OACPsI,EAAS5V,KAAKwT,EAAKlJ,SAErB8mC,GAAS59B,EAAKlJ,QAAS,UAAWkJ,EAAKvG,QAAS,GAChDmkC,GAAS59B,EAAKlJ,QAAS,UAAWkJ,EAAKxG,QAAS,GAChDuP,GAAOm1B,EAAIl+B,EAAKlJ,YAEXonC,MAGPC,EAAe,SAAUF,GAC3B,OAAOhzC,EAAKgzC,GAAa,SAAUG,GACjC,OAAOrzC,EAAIqzC,EAASzkC,OAAO,SAAUkZ,GAEnC,OADA+qB,GAAS/qB,EAAI/b,QAAS,OAAQ+b,EAAIpZ,QAAS,GACpCoZ,EAAI/b,eAIbunC,EAAgB,SAAUJ,EAAaK,GACzC,IAAI1kC,EA7Cc,SAAUsH,EAAOo9B,GACrC,IAAI1kC,EAAU+D,GAAQuD,EAAOo9B,GAAa/zC,YAAW,WACnD,IAAIg0C,EAAa9oC,GAAaY,QAAQioC,EAAa3jC,GAAMuG,GAAO1L,KAQhE,MAPoB,UAAhB8oC,EACFxzB,GAAO5J,EAAO,mBAAoBq9B,GACT,aAAhBD,EACTxzB,GAAO5J,EAAO,UAAWq9B,GAEzBx1B,GAAO7H,EAAOq9B,GAETA,KAGT,OADA/0B,GAAM5P,GACCA,EAgCS4kC,CAAgBt9B,EAAOo9B,GAEjCG,GADuB,aAAhBH,EAA6BH,EAAeH,GAC/BC,GACxB10B,GAAS3P,EAAS6kC,IAKhBC,EAAwB,SAAUT,EAAaK,GAC7CL,EAAYj1C,OAAS,EACvBq1C,EAAcJ,EAAaK,GALX,SAAUA,GAC5B3gC,GAAQuD,EAAOo9B,GAAatzC,KAAK2e,IAM/Bg1B,CAAcL,IAGdM,EAAc,GACdC,EAAc,GACdC,EAAc,GACdC,EAAsB,GAqB1B,OApBA/zC,EAAK6X,GAAM,SAAUtB,GACnB,OAAQA,EAAI3H,SACZ,IAAK,QACHglC,EAAYpyC,KAAK+U,GACjB,MACF,IAAK,QACHs9B,EAAYryC,KAAK+U,GACjB,MACF,IAAK,QACHu9B,EAAYtyC,KAAK+U,GACjB,MACF,IAAK,WACHw9B,EAAoBvyC,KAAK+U,OAI7Bm9B,EAAsBK,EAAqB,YAC3CL,EAAsBE,EAAa,SACnCF,EAAsBG,EAAa,SACnCH,EAAsBI,EAAa,SAC5B,CACLf,QAASA,EACT37B,SAAUA,IAwBV48B,GAAW,SAAUtyC,EAAIuyC,GAC3B,GAAkB,IAAdvyC,EAAG1D,OACL,OAAO,EAET,IAAIsf,EAAQ5b,EAAG,GAIf,OAHYgB,EAAUhB,GAAI,SAAUrF,GAClC,OAAQ43C,EAAK32B,EAAMxR,QAASzP,EAAEyP,YAEnB5M,MAAK,WAChB,OAAOwC,EAAG1D,UACT,SAAU4jB,GACX,OAAOA,MAGPsyB,GAAU,SAAUr8B,EAAMtB,EAAKE,EAAQgC,GACzC,IAAI07B,EAlBO,SAAUt8B,EAAMlH,GAC3B,OAAOkH,EAAKlH,GAiBIyjC,CAAOv8B,EAAMtB,GAAK5H,MAAMvN,MAAMqV,GAC1C49B,EAAcL,GAASG,EAAW17B,GAClC67B,EAzBU,SAAUz8B,EAAMlH,GAC9B,OAAO5Q,EAAI8X,GAAM,SAAUtB,GACzB,OAAOkB,GAAQlB,EAAK5F,MAuBH4jC,CAAU18B,EAAMpB,GAAQrV,MAAMmV,GAEjD,MAAO,CACL9H,QAAS4lC,EACT7lC,QAHgBwlC,GAASM,EAAc77B,KAOvC+7B,GAAY,SAAU38B,EAAMY,GAC9B,IAAIg8B,EAAO10C,EAAI8X,GAAM,SAAUtB,GAC7B,OAAOxW,EAAIwW,EAAI5H,MAAOpQ,MASxB,OAAOwB,EAAI8X,GAAM,SAAUtB,EAAKkc,GAU9B,OA58Ia,SAAUiiB,EAAS9lC,GAClC,MAAO,CACL8lC,QAASA,EACT9lC,QAASA,GAy8IF+lC,CATO10C,EAAKsW,EAAI5H,OAAO,SAAUqG,EAAMwE,GAC5C,IAAoC,IAAhCi7B,EAAKhiB,GAAUjZ,GAAwB,CACzC,IAAIzH,EAASmiC,GAAQr8B,EAAM4a,EAAUjZ,EAAaf,GAElD,OAZW,SAAUga,EAAUjZ,EAAahL,EAASC,GACzD,IAAK,IAAI8H,EAAMkc,EAAUlc,EAAMkc,EAAWjkB,EAAS+H,IACjD,IAAK,IAAIE,EAAS+C,EAAa/C,EAAS+C,EAAc/K,EAASgI,IAC7Dg+B,EAAKl+B,GAAKE,IAAU,EAQpBm+B,CAAWniB,EAAUjZ,EAAazH,EAAOvD,QAASuD,EAAOtD,SAClD,EAr/IW3C,EAq/IAkJ,EAAKlJ,QAr/II0C,EAq/IKuD,EAAOvD,QAr/IHC,EAq/IYsD,EAAOtD,QAr/IVK,EAq/ImBkG,EAAKlG,MAp/IpE,CACLhD,QAASA,EACT0C,QAASA,EACTC,QAASA,EACTK,MAAOA,KAk/IH,MAAO,GAv/IC,IAAUhD,EAAS0C,EAASC,EAASK,KA0/ItByH,EAAI3H,aAG/BimC,GAAS,SAAU/7B,EAAW6gB,EAAY7qB,GAC5C,IAAI+I,EAAO,GACX,GAAIwC,GAAUQ,WAAW/B,GAAY,CACnC,IAAIg8B,EAAkB/0C,EAAIsa,GAAUO,YAAY9B,IAAY,SAAUrC,GACpE,OAAO5H,GAAW4H,EAAO3K,QAASgD,GAAO,MAE3C+I,EAAKrW,KAAKwN,GAAS8lC,EAAiB,aAEtC,IAAK,IAAIriB,EAAW,EAAGA,EAAW3Z,EAAUjB,KAAK1B,KAAMsc,IAAY,CAEjE,IADA,IAAIsiB,EAAW,GACNv7B,EAAc,EAAGA,EAAcV,EAAUjB,KAAK9B,QAASyD,IAAe,CAC7E,IAAI1N,EAAUuO,GAAUC,MAAMxB,EAAW2Z,EAAUjZ,GAAazZ,KAAI,SAAUya,GAC5E,OAAO3L,GAAW2L,EAAK1O,QAASgD,EAAO0L,EAAKzL,aAC3CxP,YAAW,WACZ,OAAOsP,GAAW8qB,EAAWhD,OAAO,GAAM,MAE5Coe,EAASvzC,KAAKsK,GAEhB,IAAIyK,EAAMvH,GAAS+lC,EAAUj8B,EAAU5a,IAAIu0B,GAAU7jB,SACrDiJ,EAAKrW,KAAK+U,GAEZ,OAAOsB,GAMLm9B,GAAa,SAAUC,EAAUtb,GAYnC,OAAO55B,EAAIk1C,GAAU,SAAUP,GAC7B,IAAIn+B,EAZQ,SAAUm+B,GAOtB,OANiBzxC,EAAQyxC,GAAS,SAAUnmC,GAC1C,OAAOwB,GAAOxB,EAAOzC,SAAS/L,KAAI,SAAUwW,GAC1C,IAAIzH,EAAQiB,GAAOwG,GAAK1X,SACxB,OAAOgQ,GAAW0H,EAAKzH,GAAO,SAGhBvP,YAAW,WAC3B,OAAOsP,GAAW8qB,EAAWpjB,OAAO,GAAM,MAIlC2+B,CAAQR,EAAQA,SAC1B,OAtgJa,SAAU5oC,EAAS6C,EAAOC,EAASE,GAClD,MAAO,CACLhD,QAASA,EACT6C,MAAOA,EACPC,QAASA,EACTE,MAAOA,GAigJAqmC,CAAW5+B,EAAIzK,QAAS4oC,EAAQA,QAASA,EAAQ9lC,QAAS2H,EAAIzH,WAGrEsmC,GAAe,SAAUv9B,EAAM8hB,GACjC,IAAIsb,EAAWT,GAAU38B,EAAMtL,IAC/B,OAAOyoC,GAAWC,EAAUtb,IAE1B0b,GAAkB,SAAUv8B,EAAWhN,GACzC,OAAO7I,EAAQ6V,EAAU5a,KAAK,SAAUgE,GACtC,OAAOK,EAAKL,EAAEyM,OAAO,SAAUe,GAC7B,OAAOnD,GAAKT,EAAS4D,EAAE5D,gBAIzBwpC,GAAe,SAAUx8B,EAAWlS,EAAQkL,GAC9C,IAAI4iC,EAAU30C,EAAI6G,EAAOgxB,WAAW,SAAU2d,GAC5C,OAAOvgC,GAAKugC,GAAQt1C,MAAK,SAAUu1C,GACjC,OAAOH,GAAgBv8B,EAAW08B,MACjCp1C,OAAO0R,MAERnD,EAAQgY,GAAI+tB,GAChB,OAAO9tB,GAAOjY,EAAM3Q,OAAS,EAAG2Q,IAE9B8mC,GAAM,SAAUC,EAAW/iB,EAASgjB,EAAYC,EAAYC,GAC9D,OAAO,SAAUvM,EAAMpzB,EAAOtP,EAAQ+yB,EAAYmc,EAAQC,GACxD,IAAIj9B,EAAYuB,GAAUxD,UAAUX,GAapC,OAZayc,EAAQ7Z,EAAWlS,GAAQ7G,KAAI,SAAUsH,GACpD,IAAI2uC,EA5CU,SAAUl9B,EAAW6gB,GACvC,OAAOkb,GAAO/7B,EAAW6gB,GAAY,GA2CrBsc,CAAcn9B,EAAW6gB,GACjC5nB,EAAS2jC,EAAUM,EAAO3uC,EAAMkF,GAAMspC,EAAYlc,IAClDzgB,EAAgBZ,GAAyBvG,EAAO8F,MAEpD,MAAO,CACLxQ,KAAMA,EACNwQ,KAHSu9B,GAAarjC,EAAO8F,KAAM8hB,GAInCuc,OAAQnkC,EAAOmkC,OACfh9B,cAAeA,MAGLjZ,MAAK,SAAUk2C,GAC3B,IAAIC,EAActD,GAAO58B,EAAOigC,EAAIt+B,MAChC83B,EAAc1uC,EAASC,KAAK40C,GAAQv2C,YAAW,WACjD,OAAO6yB,GAAuBlc,MAE5BylB,EAAW16B,EAASC,KAAK60C,GAAiBx2C,WAAWw+B,IAQzD,OAPA4X,EAAWz/B,EAAOigC,EAAIt+B,KAAMs+B,EAAI9uC,KAAMsoC,EAAahU,GACnDia,EAAW1/B,GACX60B,GAAQzB,EAAMpzB,GACdzC,GAAOyC,EAAOgC,IACVi+B,EAAIj9B,cAAclb,OAAS,GAC7BmV,GAAI+C,EAAOgC,GAAiBi+B,EAAIj9B,cAActD,KAAK,MAE9C3U,EAASR,KAAK,CACnBy1C,OAAQC,EAAID,OACZnD,QAASqD,EAAYrD,QACrB37B,SAAUg/B,EAAYh/B,gBAK1Bi/B,GAAS,SAAUv9B,EAAWlS,GAChC,OAAOoO,GAAKpO,EAAOkF,SAAS7L,MAAK,SAAU+U,GACzC,OAAOqgC,GAAgBv8B,EAAW9D,OAclCshC,GAAkB,SAAUx9B,EAAWlS,GACzC,OAAO0uC,GAAax8B,EAAWlS,EAAQpI,GAAQuB,KAAI,SAAU4O,GAC3D,MAAO,CACLA,MAAOA,EACPgrB,WAAY/yB,EAAO+yB,WACnBE,UAAWjzB,EAAOizB,eAUpB0c,GAAU,SAAUz9B,EAAWlS,GACjC,OAAO0uC,GAAax8B,EAAWlS,EAAQpI,IAErCg4C,GAAiB,SAAU19B,EAAWlS,GACxC,OAAOyvC,GAAOv9B,EAAWlS,GAAQxG,QAAO,SAAUmO,GAChD,OAAQA,EAAOQ,aAGf0nC,GAAkB,SAAU39B,EAAWlS,GACzC,OAAO0uC,GAAax8B,EAAWlS,GAAQ,SAAU2H,GAC/C,OAAQA,EAAOQ,aAQf2nC,GAAc,SAAU59B,EAAWnK,GACrC,OAAOxO,EAAOwO,GAAO,SAAUqG,GAC7B,OAPsB,SAAU8D,EAAW9D,GAC7C,OAAOqgC,GAAgBv8B,EAAW9D,GAAM9U,QAAO,SAAUqO,GACvD,OAAQA,EAAOQ,YAKR4nC,CAAoB79B,EAAW9D,OAGtC4hC,GAAqB,SAAU99B,EAAWlS,GAC5C,OA9Be,SAAUiwC,EAAYjwC,GACrC,OAAOA,EAAOsxB,SA6BP4e,CAAWh+B,EAAWlS,GAAQxG,QAAO,SAAU22C,GACpD,OAAOL,GAAY59B,EAAWi+B,EAAUpoC,WAGxCqoC,GAAuB,SAAUl+B,EAAWlS,GAC9C,OAhCiB,SAAUiwC,EAAYjwC,GACvC,OAAOA,EAAOmxB,WA+BPkf,CAAan+B,EAAWlS,GAAQxG,QAAO,SAAUuO,GACtD,OAAO+nC,GAAY59B,EAAWnK,OAkB9BuoC,GAAU,SAAUr/B,EAAMjR,EAAQ6R,EAAY0+B,GAGhD,IAFA,IAAIhhC,EAAOyB,GAAmBC,GAAM1B,KAChCmH,GAAQ,EACHxb,EAAI,EAAGA,EAAIqU,EAAKnY,OAAQ8D,IAC/B,IAAK,IAAI8B,EAAI,EAAGA,EAAI+T,GAAWxB,EAAK,IAAKvS,IAAK,CAC5C,IAAI2S,EAAMJ,EAAKrU,GACXs1C,EAAc3/B,GAAQlB,EAAK3S,GAE3ByzC,EAAc5+B,EADG2+B,EAAYtrC,QACYlF,IACzB,IAAhBywC,IAAkC,IAAV/5B,EAC1B/F,GAAWhB,EAAK3S,EAAGiL,GAAWsoC,KAAgB,EAAMC,EAAYroC,YACvC,IAAhBsoC,IACT/5B,GAAQ,GAId,OAAOzF,GAsBLy/B,GAAY,SAAUz/B,EAAMlH,EAAO8H,EAAY0+B,GACjD,IAAIhhC,EAAOyB,GAAmBC,GAAM1B,KACpC,GAAIxF,EAAQ,GAAKA,EAAQwF,EAAKnY,OAAQ,CACpC,IACI2Q,EAxBU,SAAU4H,EAAKkC,GAC/B,OAAOnW,EAAMiU,GAAK,SAAU8R,EAAMrT,GAChC,OAAO9U,EAAOmoB,GAAM,SAAU+uB,GAC5B,OAAO3+B,EAAW2+B,EAAYtrC,QAASkJ,EAAKlJ,YACzCuc,EAAOA,EAAKlqB,OAAO,CAAC6W,MACxB,IAmBWuiC,CADOphC,EAAKxF,EAAQ,GAAGhC,MACG8J,GACtCzY,EAAK2O,GAAO,SAAUqG,GAEpB,IADA,IAAIwiC,EAAcv2C,EAASxC,OAClBqD,EAAI6O,EAAO7O,EAAIqU,EAAKnY,OAAQ8D,IAcnC,IAbA,IAAI21C,EAAU,SAAU7zC,GACtB,IAAI2S,EAAMJ,EAAKrU,GACX6D,EAAU8R,GAAQlB,EAAK3S,GACT6U,EAAW9S,EAAQmG,QAASkJ,EAAKlJ,WAE7C0rC,EAAY34C,WACd24C,EAAcv2C,EAASR,KAAK02C,MAE9BK,EAAYx3C,MAAK,SAAU03C,GACzBngC,GAAWhB,EAAK3S,EAAGiL,GAAW6oC,GAAK,EAAM/xC,EAAQoJ,gBAI9CnL,EAAI,EAAGA,EAAI+T,GAAWxB,EAAK,IAAKvS,IACvC6zC,EAAQ7zC,MAKhB,OAAOiU,GAGLzb,GAAQ,SAAUwC,GAkCpB,MAAO,CACLQ,GAlCO,SAAU0B,GACjB,OAAOlC,IAAMkC,GAkCb62C,QAASn5C,EACTo5C,QAASr5C,EACTe,MAAO7B,EAASmB,GAChBW,WAAY9B,EAASmB,GACrBY,SAAU/B,EAASmB,GACnBiB,GArCO,SAAUg4C,GACjB,OAAOz7C,GAAMwC,IAqCbkB,QAnCY,SAAUg4C,GACtB,OAAO17C,GAAMwC,IAmCbM,KArBS,SAAU64C,EAAGC,GACtB,OAAOA,EAAQp5C,IAqBfmB,IAlCQ,SAAUzB,GAClB,OAAOlC,GAAMkC,EAAEM,KAkCfq5C,SAhCa,SAAUH,GACvB,OAAO17C,GAAMwC,IAgCboB,KA9BS,SAAU1B,GACnBA,EAAEM,IA8BFqB,KA5BS,SAAU3B,GACnB,OAAOA,EAAEM,IA4BTsB,OAvBW,SAAU5B,GACrB,OAAOA,EAAEM,IAuBTuB,OArBW,SAAU7B,GACrB,OAAOA,EAAEM,IAqBTs5C,WAnBe,WACf,OAAOj3C,EAASR,KAAK7B,MAqBrBwM,GAAQ,SAAU+sC,GAyBpB,MAAO,CACL/4C,GAAIb,EACJo5C,QAASp5C,EACTq5C,QAASp5C,EACTc,MAAO5B,EACP6B,WA7Be,SAAUjB,GACzB,OAAOA,KA6BPkB,SA3Ba,WACb,OA1oLgBC,EA0oLL9C,OAAOw7C,GAzoLb,WACL,MAAM,IAAIz4C,MAAMD,OAFV,IAAUA,GAqqLhBI,GAzBO,SAAUghB,GACjB,OAAOA,GAyBP/gB,QAvBY,SAAUxB,GACtB,OAAOA,KAuBPY,KAZS,SAAUk5C,EAASL,GAC5B,OAAOK,EAAQD,IAYfp4C,IAtBQ,SAAU+3C,GAClB,OAAO1sC,GAAM+sC,IAsBbF,SApBa,SAAU35C,GACvB,OAAO8M,GAAM9M,EAAE65C,KAoBfn4C,KAAMxC,EACNyC,KAnBS,SAAU63C,GACnB,OAAO1sC,GAAM+sC,IAmBbj4C,OAAQ3B,EACR4B,OAAQ3B,EACR05C,WAAYj3C,EAASxC,OAQrB45C,GAAS,CACXj8C,MAAOA,GACPgP,MAAOA,GACPktC,WARe,SAAUz3B,EAAK03B,GAC9B,OAAO13B,EAAI3hB,MAAK,WACd,OAAOkM,GAAMmtC,KACZn8C,MAqBDo8C,GAAe,SAAUC,EAAOC,GAGlC,MAAO,CACLC,SAAU,EACVC,SAJejhC,GAAW8gC,EAAM,IACjB9gC,GAAW+gC,EAAM,MAMhCG,GAAgB,SAAUJ,EAAOC,GAGnC,MAAO,CACLC,SAHeF,EAAMz6C,OACN06C,EAAM16C,OAGrB46C,SAAU,IAGVE,GAAmB,SAAU9sB,EAAQzV,EAAKojB,EAAY5qB,GACxD,IAAIgqC,EAA4B,aAAhBxiC,EAAI3H,QAAyB+qB,EAAW9R,IAAM8R,EAAW3kB,KACzE,OAAOhT,EAAMgqB,GAAQ,SAAUxT,GAC7B,OAAO3J,GAAWkqC,KAAa,EAAMhqC,EAASyJ,QAG9CwgC,GAAU,SAAUnhC,EAAMmU,EAAQ2N,EAAYzgB,GAChD,OAAOrB,EAAK1Z,OAAO6D,EAAMgqB,GAAQ,WAC/B,IAAIzV,EAAMsB,EAAKA,EAAK7Z,OAAS,GACzBsgB,EAAWw6B,GAAiBviC,EAAI5H,MAAM3Q,OAAQuY,EAAKojB,GAAY,SAAUnhB,GAC3E,OAAOpK,GAAI8K,EAAeV,EAAIhY,eAEhC,OAAO6W,GAASd,EAAK+H,QAGrB26B,GAAU,SAAUphC,EAAMmU,EAAQ2N,EAAYiD,GAChD,OAAO78B,EAAI8X,GAAM,SAAUtB,GACzB,IAAI2iC,EAAcJ,GAAiB9sB,EAAQzV,EAAKojB,EAAYp7B,GAC5D,OAAOwY,GAASR,EAAKqmB,EAAYsc,OAWjCC,GAAS,SAAUV,EAAOjwB,EAAOmR,GACnC,IAAIyf,EAAW5wB,EAAMowB,SAAW,EAAIK,GAAUv7C,EAC1C27C,EAAW7wB,EAAMmwB,SAAW,EAAIK,GAAUt7C,EAC1Cwb,EAAgBZ,GAAyBmgC,GACzCa,EAAY3hC,GAAW8gC,EAAM,IAC7Bc,EAAkBr5C,EAAOgZ,GAAe,SAAUX,GACpD,OAAOA,IAAW+gC,EAAY,KAE5BE,EAAeJ,EAASX,EAAOt+B,KAAKwO,IAAIH,EAAMowB,UAAWjf,EAAY4f,EAAkBD,EAAY,EAAIA,GACvGG,EAAmBnhC,GAAyBkhC,GAChD,OAAOH,EAASG,EAAcr/B,KAAKwO,IAAIH,EAAMmwB,UAAWhf,EAAY/2B,EAAY62C,EAAkBj7C,KAGhGk7C,GAAa,SAAU7hC,EAAMtB,EAAKsR,EAAKpP,GACzC,IACIkhC,EAAWh8C,EAAM8a,EADLhB,GAAQI,EAAKtB,GAAMsR,GACQ/b,SACvC4/B,EAAa7zB,EAAKtB,GACtB,OAAOsB,EAAK7Z,OAAS,GAAK2Z,GAAW+zB,GAAc,IAAM7jB,EAAM,GAAK8xB,EAASjiC,GAAeg0B,EAAY7jB,EAAM,KAAOA,EAAM6jB,EAAW/8B,MAAM3Q,OAAS,GAAK27C,EAASjiC,GAAeg0B,EAAY7jB,EAAM,KAAOtR,EAAM,GAAKojC,EAASjiC,GAAeG,EAAKtB,EAAM,GAAIsR,KAAStR,EAAMsB,EAAK7Z,OAAS,GAAK27C,EAASjiC,GAAeG,EAAKtB,EAAM,GAAIsR,MA6CpU+xB,GAA+B,SAAUC,EAAchiC,EAAMqB,GAC/D,OAAO9Y,EAAO8Y,GAAe,SAAU4gC,GACrC,OAAOA,GAAUD,EAAapjC,QAAUqjC,GAAUniC,GAAWE,EAAK,IAAMgiC,EAAapjC,WAGrFsjC,GAAU,SAAUF,EAAcpB,EAAOC,EAAOK,EAAWtgC,GAC7D,IAAIS,EAAgBZ,GAAyBmgC,GACzCuB,EAvBqB,SAAUC,EAAqBpiC,EAAMqB,GAC9D,IAAIghC,EAAgBviC,GAAWE,EAAK,IAChCsiC,EAAqBviC,GAAmBC,GAAMI,KAAKja,OAASi8C,EAAoB1jC,IAChF6jC,EAAuBp4C,EAAMk4C,EAAgBD,EAAoBxjC,QAAQ,SAAUxU,GACrF,OAAOA,EAAMg4C,EAAoBxjC,UAOnC,MAAO,CACLF,IAAK4jC,EACL1jC,OAPoBlU,EAAK63C,GAAsB,SAAUn4C,GACzD,OAAO9B,EAAO+Y,GAAe,SAAU2O,GACrC,OAAOA,IAAQ5lB,QAEhB3C,MAAM46C,EAAgB,IAaDG,CAAqBR,EAAcpB,EAAOv/B,GAC9DohC,EAAY1iC,GAAmB8gC,GAAOviC,KACtCokC,EAA4BX,GAA6BI,EAAmBM,EAAWphC,GAE3F,OAnIY,SAAU2gC,EAAcpB,EAAOC,GAC3C,GAAImB,EAAatjC,KAAOkiC,EAAMz6C,QAAU67C,EAAapjC,OAASkB,GAAW8gC,EAAM,IAC7E,OAAOJ,GAAOjtC,MAAM,mDAAqDyuC,EAAatjC,IAAM,aAAesjC,EAAapjC,QAE1H,IAAI+jC,EAAe/B,EAAMr3C,MAAMy4C,EAAatjC,KACxCkkC,EAAeD,EAAa,GAAG7rC,MAAMvN,MAAMy4C,EAAapjC,QACxDikC,EAAc/iC,GAAW+gC,EAAM,IAC/BiC,EAAcjC,EAAM16C,OACxB,OAAOq6C,GAAOj8C,MAAM,CAClBu8C,SAAU6B,EAAax8C,OAAS28C,EAChC/B,SAAU6B,EAAaz8C,OAAS08C,IAwHrBE,CAAQZ,EAAmBvB,EAAO6B,GACjCv6C,KAAI,SAAUk9B,GAC1B,IAAIzU,EAAQrlB,EAASA,EAAS,GAAI85B,GAAO,CAAE2b,SAAU3b,EAAK2b,SAAW2B,EAA0Bv8C,SAC3F68C,EAAa1B,GAAOV,EAAOjwB,EAAOuwB,GAClCU,EAAmBnhC,GAAyBuiC,GAC5CC,EAA+BlB,GAA6BI,EAAmBM,EAAWb,GAC9F,OA3Dc,SAAUI,EAAcpB,EAAOC,EAAOK,EAAWtgC,EAAYS,GAQ7E,IAPA,IAAIsC,EAAWq+B,EAAatjC,IACxB+E,EAAWu+B,EAAapjC,OAGxBgd,EAASjY,EAFKk9B,EAAM16C,OAGpB01B,EAASpY,EAFI3D,GAAW+gC,EAAM,IAEGx/B,EAAclb,OAC/C+8C,EAAkBn4C,EAAYsW,EAAe1a,GACxC0D,EAAIsZ,EAAUtZ,EAAIuxB,EAAQvxB,IAEjC,IADA,IAAI84C,EAAa,EACR7yB,EAAI7M,EAAU6M,EAAIuL,EAAQvL,IACjC,GAAI4yB,EAAgB5yB,GAClB6yB,QADF,CAIItB,GAAWjB,EAAOv2C,EAAGimB,EAAG1P,IAC1By+B,GAAQuB,EAAO/gC,GAAe+gC,EAAMv2C,GAAIimB,GAAI1P,EAAYsgC,EAAU/jC,MAEpE,IAAIimC,EAAgB9yB,EAAI7M,EAAW0/B,EAC/B9kB,EAAUze,GAAQihC,EAAMx2C,EAAIsZ,GAAWy/B,GACvCC,EAAahlB,EAAQpqB,QACrB0rC,EAAcuB,EAAU/zC,QAAQk2C,GACpC3jC,GAAWkhC,EAAMv2C,GAAIimB,EAAGtZ,GAAW2oC,GAAa,EAAMthB,EAAQnnB,WAGlE,OAAO0pC,EAkCE0C,CAAYnB,EAAmBa,EAAYP,EAAWvB,EAAWtgC,EAAYqiC,OAGpFM,GAAa,SAAUzqC,EAAO8nC,EAAOC,EAAOK,EAAWtgC,IAlS3C,SAAUZ,EAAMlH,EAAO8H,EAAY0+B,GAC7CxmC,EAAQ,GAAKA,EAAQkH,EAAK,GAAGlJ,MAAM3Q,QACrCgC,EAAK6X,GAAM,SAAUtB,GACnB,IAAI8kC,EAAW9kC,EAAI5H,MAAMgC,EAAQ,GAC7BhL,EAAU4Q,EAAI5H,MAAMgC,GACN8H,EAAW9S,EAAQmG,QAASuvC,EAASvvC,UAErDyL,GAAWhB,EAAK5F,EAAO9B,GAAWsoC,KAAgB,EAAMxxC,EAAQoJ,cA4RtEusC,CAAU7C,EAAO9nC,EAAO8H,EAAYsgC,EAAU/jC,MAC9C,IAAIwT,EAAQqwB,GAAcH,EAAOD,GAC7B8C,EAAgBpC,GAAOT,EAAOlwB,EAAOuwB,GACrCyC,EAAc3C,GAAcJ,EAAO8C,GACnCE,EAAgBtC,GAAOV,EAAO+C,EAAazC,GAC/C,OAAOh5C,EAAI07C,GAAe,SAAUzkC,EAASlV,GAC3C,OAAOiV,GAASC,EAASrG,EAAO4qC,EAAcz5C,GAAG6M,WAGjD+sC,GAAa,SAAU/qC,EAAO8nC,EAAOC,EAAOK,EAAWtgC,GACzD6+B,GAAUmB,EAAO9nC,EAAO8H,EAAYsgC,EAAU/jC,MAC9C,IAAIuD,EAASD,GAAyBmgC,GAClCxb,EAAOub,GAAaC,EAAOC,GAC3BlwB,EAAQrlB,EAASA,EAAS,GAAI85B,GAAO,CAAE2b,SAAU3b,EAAK2b,SAAWrgC,EAAOva,SACxEy9C,EAAgBtC,GAAOV,EAAOjwB,EAAOuwB,GACrC4C,EAAK/jC,GAAmB6jC,GAAgBG,EAAUD,EAAG1jC,KAAM4jC,EAAUF,EAAGxlC,KACxE2lC,EAAYxjC,GAAyBmjC,GACrCM,EAAavD,GAAaE,EAAOD,GACjC+C,EAAcr4C,EAASA,EAAS,GAAI44C,GAAa,CAAEnD,SAAUmD,EAAWnD,SAAWkD,EAAU99C,SAC7Fg+C,EA7Gc,SAAUnkC,EAAM8hB,EAAYzgB,GAC9C,OAAOnZ,EAAI8X,GAAM,SAAUtB,GACzB,OAAOjU,EAAM4W,GAAe,SAAU9W,EAAK03C,GACzC,IAAImC,EAAWnD,GAAiB,EAAGviC,EAAKojB,EAAYn7B,GAAQ,GAC5D,OAAO8Y,GAAQlV,EAAK03C,EAAQmC,KAC3B1lC,MAwGa2lC,CAAcxD,EAAOK,EAAW+C,GAC9CP,EAAgBpC,GAAO6C,EAAaR,EAAazC,GACrD,OAAO6C,EAAQz9C,OAAO09C,EAAQz6C,MAAM,EAAGuP,IAAQxS,OAAOo9C,GAAep9C,OAAO09C,EAAQz6C,MAAMuP,EAAOkrC,EAAQ79C,UAGvGm+C,GAAc,SAAUtkC,EAAMlH,EAAOyrC,EAAS3jC,EAAY0+B,GAC5D,IAAIwE,EAAK/jC,GAAmBC,GAAO1B,EAAOwlC,EAAGxlC,KAAM8B,EAAO0jC,EAAG1jC,KACzDf,EAASf,EAAK/U,MAAM,EAAGuP,GACvBwG,EAAQhB,EAAK/U,MAAMuP,GACnB0rC,EAAU7kC,GAASrB,EAAKimC,IAAU,SAAUE,EAAIn0B,GAGlD,OAFiBxX,EAAQ,GAAKA,EAAQwF,EAAKnY,QAAUya,EAAWf,GAAevB,EAAKxF,EAAQ,GAAIwX,GAAIzQ,GAAevB,EAAKxF,GAAQwX,IACzG1Q,GAAQtB,EAAKxF,GAAQwX,GAAKtZ,GAAWsoC,EAAamF,EAAGxwC,QAAS2M,IAAa,EAAM6jC,EAAGvtC,aAG7G,OAAOkJ,EAAK9Z,OAAO+Y,GAAQ/Y,OAAO,CAACk+C,IAAUl+C,OAAOgZ,IAUlDolC,GAAiB,SAAU1kC,EAAMlH,EAAOyrC,EAAS3jC,EAAY0+B,GAC/D,OAAOp3C,EAAI8X,GAAM,SAAUtB,GACzB,IAAIimC,EAAa7rC,EAAQ,GAAKA,EAAQgH,GAAWpB,IAAQkC,EAAWf,GAAenB,EAAK5F,EAAQ,GAAI+G,GAAenB,EAAK5F,IACpH+mC,EAXY,SAAUnhC,EAAKE,EAAQ7H,EAAS4tC,EAAYJ,EAAS3jC,EAAY0+B,GACnF,GAAgB,aAAZvoC,GAA2B4tC,EAI7B,OAAO/kC,GAAQlB,EAAKE,GAHpB,IAAIzB,EAAOyC,GAAQlB,EAAK6lC,GACxB,OAAOvtC,GAAWsoC,EAAaniC,EAAKlJ,QAAS2M,IAAa,GAAM,GAQtDgkC,CAAclmC,EAAK5F,EAAO4F,EAAI3H,QAAS4tC,EAAYJ,EAAS3jC,EAAY0+B,GAClF,OAAO7/B,GAAQf,EAAK5F,EAAO+mC,OAiB3BgF,GAAY,SAAU7kC,EAAM+hB,EAASnhB,EAAY0+B,GAMnD,OAAOp3C,EAAI8X,GAAM,SAAUtB,GACzB,OAAOiB,GAASjB,GAAK,SAAUvB,GAC7B,OAPW,SAAUA,GACvB,OAAO9U,EAAO05B,GAAS,SAAUhzB,GAC/B,OAAO6R,EAAWzD,EAAKlJ,QAASlF,EAAOkF,YAKhC6wC,CAAS3nC,GAAQnG,GAAWsoC,EAAaniC,EAAKlJ,QAAS2M,IAAa,EAAMzD,EAAKjG,UAAYiG,SAIpG4nC,GAAc,SAAU/kC,EAAM4a,EAAUhZ,EAAUhB,GACpD,YAAoDvb,IAA7Cwa,GAAeG,EAAK4a,GAAWhZ,IAA4BgZ,EAAW,GAAKha,EAAWf,GAAeG,EAAK4a,EAAW,GAAIhZ,GAAW/B,GAAeG,EAAK4a,GAAWhZ,KAExKojC,GAAiB,SAAUtmC,EAAK5F,EAAO8H,GACzC,OAAO9H,EAAQ,GAAK8H,EAAWf,GAAenB,EAAK5F,EAAQ,GAAI+G,GAAenB,EAAK5F,KAEjFmsC,GAAgB,SAAUjlC,EAAMlH,EAAO8H,EAAY0+B,GACrD,IAAIhhC,EAAOyB,GAAmBC,GAAM1B,KAChCyjB,EAAU35B,EAAKkW,GAAM,SAAUI,EAAKzU,GAEtC,OADmB86C,GAAY/kC,EAAM/V,EAAG6O,EAAO8H,IAAeokC,GAAetmC,EAAK5F,EAAO8H,GACnE,GAAK,CAAChB,GAAQlB,EAAK5F,OAE3C,OAAO+rC,GAAU7kC,EAAM+hB,EAASnhB,EAAY0+B,IAE1C4F,GAAa,SAAUllC,EAAMlH,EAAO8H,EAAY0+B,GAClD,IAAIhhC,EAAOyB,GAAmBC,GAAM1B,KAChC6mC,EAAY7mC,EAAKxF,GACjBipB,EAAU35B,EAAK+8C,EAAUruC,OAAO,SAAU6L,EAAM1Y,GAElD,OADmB86C,GAAYzmC,EAAMxF,EAAO7O,EAAG2W,IAAeokC,GAAeG,EAAWl7C,EAAG2W,GACrE,GAAK,CAAC+B,MAE9B,OAAOkiC,GAAU7kC,EAAM+hB,EAASnhB,EAAY0+B,IAG1C8F,GAAgB,SAAUvI,GAO5B,OAAOpyC,EAAMoyC,GANK,SAAUrsB,EAAM9Z,GAIhC,OAHmBrO,EAAOmoB,GAAM,SAAU60B,GACxC,OAAOA,EAAczmC,SAAWlI,EAAOkI,UAEnB4R,EAAOA,EAAKlqB,OAAO,CAACoQ,MAET,IAAIoK,MAAK,SAAUsD,EAASC,GAC7D,OAAOD,EAAQxF,OAASyF,EAAQzF,WAIhC0mC,GAAgB,SAAUrxC,GAG5B,MAAO,CACLA,QAASA,EACT2C,QAJYsG,GAAajJ,EAAS,UAAW,GAK7C0C,QAJYuG,GAAajJ,EAAS,UAAW,KAsF7CsxC,GAAoB,SAAUpoC,GAChC,OAAOxB,GAAOwB,EAAM,SAASjV,KAAI,SAAU02B,GACzC,OAAOA,EAAUzwB,OAAO,EAAG,OA0D3Bq3C,GA3Ie,SAAU1jB,EAAY2jB,QACxB,IAAXA,IACFA,EAASH,IAEX,IAAI/U,EAAWlX,GAAKjwB,EAASxC,QASzB8+C,EAAS,SAAUzxC,GAErB,OAVO,SAAUkuB,GACjB,OAAQt9B,GAAKs9B,EAAKluB,UAClB,IAAK,MACH,OAAO6tB,EAAW9R,IAAImS,GACxB,QACE,OAAOL,EAAW3kB,KAAKglB,IAKlB91B,CADIo5C,EAAOxxC,KAGhBo0B,EAAM,SAAUp0B,GAClB,IAAI0rC,EAAc+F,EAAOzxC,GAQzB,OAPIs8B,EAAStlC,MAAMjE,UACjBupC,EAASj1B,IAAIlS,EAASR,KAAK+2C,IAE7BgG,EAASv8C,EAASR,KAAK,CACrB+Z,KAAM1O,EACN0rC,YAAaA,IAERA,GAELgG,EAASv8C,EAASxC,OAQtB,MAAO,CACLg/C,UARc,SAAU3xC,EAAS2M,GACjC,OAAO+kC,EAAOt+C,MAAK,WACjB,OAAOghC,EAAIp0B,MACV,SAAUxI,GACX,OAAOmV,EAAW3M,EAASxI,EAAEkX,MAAQlX,EAAEk0C,YAActX,EAAIp0B,OAK3DoqC,OAAQ9N,EAAStlC,MAqGjBu6C,GAlGc,SAAUzyC,EAAOU,GACjC,OAAO,SAAUquB,GACf,IAAIyO,EAAWlX,GAAKjwB,EAASxC,QACzBua,EAAO,GAMP0kC,EAAU,SAAU5xC,GACtB,IAAIuH,EAAQ,CAAEzI,MAAOA,GACjBoK,EAAO2kB,EAAW30B,QAAQ8G,EAASR,EAAK+H,GAQ5C,OAPA2F,EAAKxX,KAAK,CACRgZ,KAAM1O,EACN4rC,IAAK1iC,IAEHozB,EAAStlC,MAAMjE,UACjBupC,EAASj1B,IAAIlS,EAASR,KAAKuU,IAEtBA,GAaT,MAAO,CACL2oC,cAZkB,SAAU7xC,EAAS2M,GACrC,MAAsB,QAAlB/b,GAAKoP,GACAA,EAnBE,SAAUA,EAAS2M,GAC9B,OAAOlW,EAAKyW,GAAM,SAAU3c,GAC1B,OAAOoc,EAAWpc,EAAEme,KAAM1O,MAmBnB7G,CAAO6G,EAAS2M,GAAYvZ,MAAK,WACtC,OAAOw+C,EAAQ5xC,MACd,SAAUxI,GACX,OAAOmV,EAAW3M,EAASxI,EAAEkX,MAAQlX,EAAEo0C,IAAMgG,EAAQ5xC,OAMzDoqC,OAAQ9N,EAAStlC,OAgEnBu6C,GAvDU,SAAU1jB,GACtB,IAAIyO,EAAWlX,GAAKjwB,EAASxC,QAgD7B,MAAO,CACLy4C,QAhDY,SAAUliC,GAClBozB,EAAStlC,MAAMjE,UACjBupC,EAASj1B,IAAIlS,EAASR,KAAKuU,IAE7B,IAAIpK,EAAQwyC,GAAkBpoC,GAI9B,OAHApK,EAAM5K,MAAK,SAAUy2B,GACnB,OAAOtjB,GAAI6B,EAAM,QAASyhB,MAErB,WACL,IAAI9hB,EAAMglB,EAAW3kB,KAAK,CACxBlJ,QAASkJ,EACTvG,QAAS,EACTD,QAAS,IAOX,OALAoG,GAASD,EAAK,SACdC,GAASI,EAAM,SACfpK,EAAM5K,MAAK,SAAUy2B,GACnB,OAAOtjB,GAAIwB,EAAK,QAAS8hB,MAEpB9hB,IA8BTipC,MA3BU,SAAUjvC,GAuBpB,OANAiG,GAASjG,EAAM,GAAI,SAhBI,WACrB,IAAIkvC,EAAmBl3B,GAAI5mB,EAAI4O,EAAOyuC,KACtC,GAAgC,IAA5BS,EAAiB7/C,OACnB,OAAOiD,EAASxC,OAEhB,IAAIq/C,EAAcD,EAAiB,GAC/BE,EAAW,CACb,MACA,OAKF,OAHc79C,EAAO29C,GAAkB,SAAUpnB,GAC/C,OAAOA,IAAcqnB,GAAer8C,EAASs8C,EAAUtnB,MAExCx1B,EAASxC,OAASwC,EAASC,KAAK48C,GAIrDE,GAAmB9+C,MAAK,WACtB,OAAOuU,GAAO9E,EAAM,GAAI,YACvB,SAAU8nB,GACX,OAAOtjB,GAAIxE,EAAM,GAAI,QAAS8nB,EAAY,YAErCh5B,EAASkR,EAAM,KAKtBunC,OAAQ9N,EAAStlC,MASjBm7C,GAAY,CACd,OACA,IACA,MACA,UACA,QACA,aACA,SACA,SACA,SACA,MACA,UACA,KACA,KACA,QACA,QACA,QACA,QACA,UACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,aACA,MACA,WAsBEC,GAAa7+B,KACb8+B,GAAY,SAAUryC,GACxB,OAfY,SAAUkV,EAAUxG,GAChC,IAAI4jC,EAAUp9B,EAAS9M,WAAWxX,KAAK8d,GACvC,OAAO/Y,EAASw8C,GAAWG,GAapBC,CAAQH,GAAYpyC,IAEzBwyC,GAAW,SAAUxyC,GACvB,OAzBW,SAAUkV,EAAUxG,GAC/B,IAAI4jC,EAAUp9B,EAAS9M,WAAWxX,KAAK8d,GACvC,OAAO/Y,EAAS,CACd,KACA,MACC28C,GAoBIG,CAAOL,GAAYpyC,IAExB0yC,GAAe,SAAU1yC,GAC3B,OAjBe,SAAUkV,EAAUxG,GACnC,OAAO/Y,EAAS,CACd,KACA,MACA,KACA,SACCuf,EAAS9M,WAAWxX,KAAK8d,IAWrBiG,CAAWy9B,GAAYpyC,IAG5B2yC,GAAU,SAAU9vC,GACtB,IA+BMsqB,EA/BFylB,EAAO,SAAUjsC,GACnB,MAAoB,OAAb/V,GAAK+V,IAqBVksC,EAAW,SAAU3pC,GACvB,OAAO6f,GAAO7f,GAAM/U,MAAK,SAAUib,GACjC,IAAI0jC,EAZCpuC,GAYoC0K,GAZpBnb,KAAI,SAAU8+C,GACnC,QAAIV,GAAUU,MAGVL,GAAaK,IACe,QAAvBniD,GAAKmiD,MAGbv/C,OAAM,GAKP,OAAOyQ,GAAOmL,GAAWnb,KAAI,SAAUgQ,GACrC,OAA+B,IAAxB6uC,GAlBI,SAAUnsC,GACzB,MAAoB,OAAb/V,GAAK+V,IAAgBD,GAASC,EAAI6rC,IAAUj/C,SAiBRy/C,CAAW/uC,IAAW2uC,EAAKxjC,IAAcijC,GAAUpuC,KAAYxD,GAAKyI,EAAMjF,GAAU,GAAK,CAACtF,GAAaY,QAAQ,aAEvJ/L,MAAM,KASPy/C,EAFwB,KAJtB9lB,EAAUh5B,EAAK0O,GAAO,SAAUqG,GAClC,IAAI7C,EAAa1B,GAASuE,GAC1B,OA9Ba,SAAUvE,GACzB,OAAOtQ,EAAOsQ,GAAU,SAAU0X,GAChC,OAAOu2B,EAAKv2B,IAAM7Y,GAAO6Y,IAAiC,IAA3BjJ,GAAMiJ,GAAG5hB,OAAOvI,UA4BxCghD,CAAW7sC,GAAc,GAAKA,EAAWhU,OAAOwgD,EAAS3pC,QAEnDhX,OAAe,CAACyM,GAAaY,QAAQ,OAAS4tB,EAG/Dza,GAAM7P,EAAM,IACZ4P,GAAS5P,EAAM,GAAIowC,IAGjBr9B,GAAQ,SAAUxL,GAEG,IADTvH,GAAMuH,GACRlY,QACV2gB,GAASzI,IAGT+oC,GAAU,SAAUpnC,EAAMq+B,GAC5B,MAAO,CACLr+B,KAAMA,EACNq+B,OAAQA,IAGRgJ,GAAkB,SAAUrnC,EAAMtB,EAAKE,GACzC,IAAIN,EAAOyB,GAAmBC,GAAM1B,KACpC,OAAOgpC,GAAOhpC,EAAMI,EAAKE,GAAQ3W,SAAQ,WACvC,OAAOq/C,GAAOhpC,EAAM,EAAG,OAGvBgpC,GAAS,SAAUtnC,EAAMtB,EAAKE,GAChC,OAAOxV,EAASC,KAAK2W,EAAKtB,IAAMtW,MAAK,SAAUiC,GAC7C,OAAOjB,EAASC,KAAKgB,EAAEyM,MAAM8H,IAASxW,MAAK,SAAUkoB,GACnD,OAAOlnB,EAASC,KAAKinB,EAAErc,gBAIzBszC,GAAS,SAAUvnC,EAAMtB,EAAKE,GAChC,IAAIN,EAAOyB,GAAmBC,GAAM1B,KACpC,OAAO8oC,GAAQpnC,EAAMsnC,GAAOhpC,EAAMI,EAAKE,KAErC4oC,GAAa,SAAU3K,GAOzB,OAAOpyC,EAAMoyC,GANQ,SAAUrsB,EAAM9Z,GAInC,OAHgBrO,EAAOmoB,GAAM,SAAU60B,GACrC,OAAOA,EAAc3mC,MAAQhI,EAAOgI,OAEnB8R,EAAOA,EAAKlqB,OAAO,CAACoQ,MAEH,IAAIoK,MAAK,SAAUsD,EAASC,GAChE,OAAOD,EAAQ1F,IAAM2F,EAAQ3F,QA+I7B+oC,GAAc,SAAUnpC,EAAMwjB,EAAYgB,GAC5C,IA3hK6BtkB,EAAOzH,EA2hKhC2wC,GA3hKyBlpC,EA2hKKF,EA3hKEvH,EA2hKI+rB,EAAQ/rB,QA1hKzCwH,GAAoBC,GAAO,WAChC,OAAOzH,MA0hKL4wC,EAAKnlC,GAAUtB,SAASwmC,GAC5B,OAAO1K,GAAO2K,EAAI7lB,GAAY,IAuD5B8lB,GAAe,SAAU9wC,EAAO+wC,GAClC,IAAIC,EAAcv/C,EAAOuO,EAAO+wC,GAChC,OAA2B,IAAvBC,EAAY3hD,OACPiD,EAASR,KAAK,MACZk/C,EAAY3hD,SAAW2Q,EAAM3Q,OAC/BiD,EAASR,KAAK,MAEdQ,EAASxC,QAGhBi8B,GA72FgB,SAAUklB,EAAQ5mC,EAAM6mC,EAAOhxB,GACjD,IAAI/V,EAAYuB,GAAUtB,SAASC,GAC/BoiB,EAASvM,EAAUyC,UAAUxY,EAAW+V,GAC5C2M,GAAoB1iB,EAAWsiB,EAAQvM,IA22FrCixB,GAt3F8B,SAAUF,EAAQ5mC,EAAM07B,EAAS7lB,EAAWknB,GAC5E,IAAIj9B,EAAYuB,GAAUtB,SAASC,GAC/B2jB,EAAQ9N,EAAUyC,UAAUxY,EAAW+V,GACvCkxB,EAAkBlxB,EAAUC,aAC5B6sB,EAAK5F,EAAgBpY,wBAAwBhB,EAAOojB,EAAiBrL,EAAQ7W,WAAYhP,EAAU8C,YAAa8J,EAAWkgB,EAAGlgB,SAAUjT,EAAQmzB,EAAGnzB,MACvJgT,GAAoB1iB,EAAW2iB,EAAU5M,GACzCA,EAAU6C,iBAAiBlJ,IAi3FzBw3B,GAAsB,SAAUnJ,EAAYnC,GAC9C,OAAOx0C,EAAOw0C,GAAS,SAAUnmC,GAC/B,OAAyB,IAAlBA,EAAOkI,QAAgBlI,EAAOQ,aAGrCkxC,GAAqB,SAAUnnC,EAAW47B,GAC5C,OAAOx0C,EAAOw0C,GAAS,SAAUnmC,GAC/B,OAAOA,EAAOkI,OAASlI,EAAOE,SAAWqK,EAAUjB,KAAK9B,SAAWxH,EAAOQ,aAG1EmxC,GAAkB,SAAUpnC,EAAW47B,GACzC,IAAI3+B,EAAU2R,GAAU5O,GACpBqnC,EAAalD,GAAcvI,GAC/B,OAAOpyC,EAAM69C,GAAY,SAAU/9C,EAAKmM,GAGtC,OAAOnM,EAFM2T,EAAQxH,EAAOkI,QACN1W,IAAIsnB,IAAU/nB,MAAM,KAEzC,IAED8gD,GAAyB,SAAUlpC,GACrC,OAAO,SAAU4B,EAAWlS,GAC1B,OAAO2vC,GAAQz9B,EAAWlS,GAAQxG,QAAO,SAAUs0C,GAEjD,QADkBx9B,EAAS8oC,GAAsBC,IAC7BnnC,EAAW47B,MAC9B30C,KAAI,SAAU20C,GACf,MAAO,CACLA,QAASA,EACT7W,WAAYqiB,GAAgBpnC,EAAW47B,SAa3C2L,GAAwB,SAAUnpC,GACpC,OAAO,SAAU4B,EAAWlS,GAC1B,OAAO0vC,GAAgBx9B,EAAWlS,GAAQxG,QAAO,SAAUs0C,GAEzD,QADkBx9B,EAAS8oC,GAAsBC,IAC7BnnC,EAAW47B,EAAQ/lC,YAIzC2xC,GAAmB7K,IAlQE,SAAU59B,EAAM68B,EAASj8B,EAAYo9B,GAC5D,IAAI0K,EAAc7L,EAAQ,GAAGn+B,IACzBJ,EAAOkpC,GAAW3K,GAClB8L,EAAUr+C,EAAMgU,GAAM,SAAU/T,EAAKmU,GAEvC,MAAO,CACLsB,KAFSskC,GAAY/5C,EAAIyV,KAAM0oC,EAAahqC,EAAIA,IAAMnU,EAAIomB,MAAO/P,EAAYo9B,EAAY4H,WAGzFj1B,MAAOpmB,EAAIomB,MAAQ,KAEpB,CACD3Q,KAAMA,EACN2Q,MAAO,IACN3Q,KACH,OAAOunC,GAAOoB,EAASD,EAAa7L,EAAQ,GAAGj+B,UAqPF8/B,GAAS/4C,EAAMA,EAAM6/C,IAChEoD,GAAkBhL,IApPE,SAAU59B,EAAM68B,EAASj8B,EAAYo9B,GAC3D,IAAI1/B,EAAOkpC,GAAW3K,GAClB9tC,EAASuP,EAAKA,EAAKnY,OAAS,GAC5BuiD,EAAc35C,EAAO2P,IAAM3P,EAAO4H,QAClCgyC,EAAUr+C,EAAMgU,GAAM,SAAUuqC,EAAMnqC,GACxC,OAAO4lC,GAAYuE,EAAMH,EAAahqC,EAAIA,IAAKkC,EAAYo9B,EAAY4H,aACtE5lC,GACH,OAAOunC,GAAOoB,EAASD,EAAa7L,EAAQ,GAAGj+B,UA6OJ8/B,GAAS/4C,EAAMA,EAAM6/C,IAC9DsD,GAAsBlL,IA5OE,SAAU59B,EAAM+oC,EAAenoC,EAAYo9B,GACrE,IAAInB,EAAUkM,EAAclM,QACxB3+B,EAAUknC,GAAcvI,GACxB6L,EAAcxqC,EAAQ,GAAGU,OACzB+pC,EAAUr+C,EAAM4T,GAAS,SAAU3T,EAAKylB,GAE1C,MAAO,CACLhQ,KAFS0kC,GAAen6C,EAAIyV,KAAM0oC,EAAa14B,EAAIpR,OAASrU,EAAIomB,MAAO/P,EAAYo9B,EAAY4H,WAG/Fj1B,MAAOpmB,EAAIomB,MAAQ,KAEpB,CACD3Q,KAAMA,EACN2Q,MAAO,IACN3Q,KACH,OAAOunC,GAAOoB,EAAS9L,EAAQ,GAAGn+B,IAAKgqC,KA8NYH,IAAuB,GAAON,GAA+BtiD,EAAM6/C,IACpHwD,GAAqBpL,IA7NE,SAAU59B,EAAM+oC,EAAenoC,EAAYo9B,GACpE,IAAInB,EAAUkM,EAAclM,QACxB9tC,EAAS8tC,EAAQA,EAAQ12C,OAAS,GAClCuiD,EAAc35C,EAAO6P,OAAS7P,EAAO6H,QACrCsH,EAAUknC,GAAcvI,GACxB8L,EAAUr+C,EAAM4T,GAAS,SAAU2qC,EAAM74B,GAC3C,OAAO00B,GAAemE,EAAMH,EAAa14B,EAAIpR,OAAQgC,EAAYo9B,EAAY4H,aAC5E5lC,GACH,OAAOunC,GAAOoB,EAAS9L,EAAQ,GAAGn+B,IAAKgqC,KAqNUH,IAAuB,GAAQN,GAA+BtiD,EAAM6/C,IACnHyD,GAAerL,IApKE,SAAU59B,EAAM+oC,EAAeG,EAAaC,GAC/D,IAAIjrC,EAAUknC,GAAc2D,EAAclM,SACtC8L,EA9cgB,SAAU3oC,EAAM9B,GACpC,OAAO9V,EAAK4X,GAAM,SAAUtB,GAC1B,IAAIU,EAAgBV,EAAI5H,MACpBA,EAAQxM,EAAM4T,GAAS,SAAU3T,EAAKqU,GACxC,OAAOA,GAAU,GAAKA,EAASrU,EAAIpE,OAASoE,EAAIhB,MAAM,EAAGqV,GAAQtY,OAAOiE,EAAIhB,MAAMqV,EAAS,IAAMrU,IAChG6U,GACH,OAAOtI,EAAM3Q,OAAS,EAAI,CAACgR,GAASL,EAAO4H,EAAI3H,UAAY,MAwc/CqyC,CAAgBppC,EAAM9X,EAAIgW,GAAS,SAAUU,GACzD,OAAOA,EAAOA,WAEZy/B,EAASgJ,GAAgBsB,EAASzqC,EAAQ,GAAGQ,IAAKR,EAAQ,GAAGU,QACjE,OAAOwoC,GAAQuB,EAAStK,MA0IE,SAAUp9B,EAAWlS,GAC/C,OAAO6vC,GAAgB39B,EAAWlS,GAAQ7G,KAAI,SAAU20C,GACtD,MAAO,CACLA,QAASA,EACT7W,YAAaqiB,GAAgBpnC,EAAW47B,SAgBgBoL,GAA+Bp+B,GAAO27B,IAChG6D,GAAYzL,IA7JE,SAAU59B,EAAM68B,EAASqM,EAAaC,GACtD,IAAI7qC,EAAOkpC,GAAW3K,GAClB8L,EA7ca,SAAU3oC,EAAM5R,EAAOwW,GACxC,IAAIk/B,EAAK/jC,GAAmBC,GAAO1B,EAAOwlC,EAAGxlC,KAC7C,OAD0DwlC,EAAG1jC,KACjD9Z,OAAOgY,EAAK/U,MAAM,EAAG6E,IAAQ9H,OAAOgY,EAAK/U,MAAMqb,EAAS,IA2ctD0kC,CAAatpC,EAAM1B,EAAK,GAAGI,IAAKJ,EAAKA,EAAKnY,OAAS,GAAGuY,KAChE2/B,EAASgJ,GAAgBsB,EAAS9L,EAAQ,GAAGn+B,IAAKm+B,EAAQ,GAAGj+B,QACjE,OAAOwoC,GAAQuB,EAAStK,KAyJOK,GAAS/4C,EAAMkkB,GAAO27B,IAEnD+D,IADmB3L,IA1ME,SAAU4L,EAAa9yC,EAAQkK,EAAYo9B,GAClE,IAAI2K,EAAU1D,GAAcuE,EAAa9yC,EAAOkI,OAAQgC,EAAYo9B,EAAY8H,eAChF,OAAOyB,GAAOoB,EAASjyC,EAAOgI,IAAKhI,EAAOkI,UAwMG+/B,GAAgBh5C,EAAMA,EAAM6/C,GAAqB,MAAO,OAC/E5H,IAvME,SAAU4L,EAAa3M,EAASj8B,EAAYo9B,GACpE,IAAI9/B,EAAUknC,GAAcvI,GAIxB8L,EAAUl+C,EAAMyT,GAHL,SAAUurC,EAAa7qC,GACpC,OAAOqmC,GAAcwE,EAAa7qC,EAAOA,OAAQgC,EAAYo9B,EAAY8H,iBAEpC0D,GACvC,OAAOjC,GAAOoB,EAAS9L,EAAQ,GAAGn+B,IAAKm+B,EAAQ,GAAGj+B,UAiMHggC,GAAiBj5C,EAAMA,EAAM6/C,GAAqB,MAAO,QAEtGkE,IADqB9L,IApLE,SAAU4L,EAAa9yC,EAAQkK,EAAYo9B,GACpE,IAAI2K,EAAU1D,GAAcuE,EAAa9yC,EAAOkI,OAAQgC,EAAYo9B,EAAY8H,eAChF,OAAOyB,GAAOoB,EAASjyC,EAAOgI,IAAKhI,EAAOkI,UAkLO+/B,GAAgBh5C,EAAMA,EAAM6/C,GAAqB,KAAM,OAChF5H,IAjLE,SAAU4L,EAAa3M,EAASj8B,EAAYo9B,GACtE,IAAI9/B,EAAUknC,GAAcvI,GAIxB8L,EAAUl+C,EAAMyT,GAHL,SAAUurC,EAAa7qC,GACpC,OAAOqmC,GAAcwE,EAAa7qC,EAAOA,OAAQgC,EAAYo9B,EAAY8H,iBAEpC0D,GACvC,OAAOjC,GAAOoB,EAAS9L,EAAQ,GAAGn+B,IAAKm+B,EAAQ,GAAGj+B,UA2KCggC,GAAiBj5C,EAAMA,EAAM6/C,GAAqB,KAAM,QAKzGmE,IAJgB/L,IA1NE,SAAU59B,EAAMtJ,EAAQkK,EAAYo9B,GACxD,IAAI2K,EAAUzD,GAAWllC,EAAMtJ,EAAOgI,IAAKkC,EAAYo9B,EAAY8H,eACnE,OAAOyB,GAAOoB,EAASjyC,EAAOgI,IAAKhI,EAAOkI,UAwNH4/B,GAAQ74C,EAAMA,EAAM6/C,GAAqB,MAAO,OACpE5H,IAvNE,SAAU4L,EAAa3M,EAASj8B,EAAYo9B,GACjE,IAAI1/B,EAAOkpC,GAAW3K,GAIlB8L,EAAUl+C,EAAM6T,GAHL,SAAUmrC,EAAa/qC,GACpC,OAAOwmC,GAAWuE,EAAa/qC,EAAIA,IAAKkC,EAAYo9B,EAAY8H,iBAE9B0D,GACpC,OAAOjC,GAAOoB,EAAS9L,EAAQ,GAAGn+B,IAAKm+B,EAAQ,GAAGj+B,UAiNT8/B,GAAS/4C,EAAMA,EAAM6/C,GAAqB,MAAO,OACtE5H,IApME,SAAU59B,EAAMtJ,EAAQkK,EAAYo9B,GAC1D,IAAI2K,EAAUzD,GAAWllC,EAAMtJ,EAAOgI,IAAKkC,EAAYo9B,EAAY8H,eACnE,OAAOyB,GAAOoB,EAASjyC,EAAOgI,IAAKhI,EAAOkI,UAkMC4/B,GAAQ74C,EAAMA,EAAM6/C,GAAqB,KAAM,OACrE5H,IAjME,SAAU4L,EAAa3M,EAASj8B,EAAYo9B,GACnE,IAAI1/B,EAAOkpC,GAAW3K,GAIlB8L,EAAUl+C,EAAM6T,GAHL,SAAUmrC,EAAa/qC,GACpC,OAAOwmC,GAAWuE,EAAa/qC,EAAIA,IAAKkC,EAAYo9B,EAAY8H,iBAE9B0D,GACpC,OAAOjC,GAAOoB,EAAS9L,EAAQ,GAAGn+B,IAAKm+B,EAAQ,GAAGj+B,UA2LL8/B,GAAS/4C,EAAMA,EAAM6/C,GAAqB,KAAM,OAC9E5H,IAhKE,SAAU59B,EAAMqgB,EAAUzf,EAAYo9B,GACvD,IAAIlnC,EAAQupB,EAASvpB,MACrB8vC,GAAQ9vC,GACR,IAAI6xC,EAz1BM,SAAU3oC,EAAMmD,EAAQvC,EAAY0+B,GAC9C,IAAIhhC,EAAOyB,GAAmBC,GAAM1B,KACpC,GAAoB,IAAhBA,EAAKnY,OACP,OAAO6Z,EAET,IAAK,IAAI/V,EAAIkZ,EAAOQ,SAAU1Z,GAAKkZ,EAAOO,UAAWzZ,IACnD,IAAK,IAAI8B,EAAIoX,EAAOM,SAAU1X,GAAKoX,EAAOK,UAAWzX,IAAK,CACxD,IAAI2S,EAAMJ,EAAKrU,GACXiN,EAAW0I,GAAQlB,EAAK3S,GAAGmL,SAC/BwI,GAAWhB,EAAK3S,EAAGiL,GAAWsoC,KAAgB,EAAOpoC,IAGzD,OAAO8I,EA60BO+lC,CAAM/lC,EAAMqgB,EAASld,OAAQvC,EAAYo9B,EAAY+H,MAAMjvC,IACzE,OAAOswC,GAAQuB,EAASv/C,EAASC,KAAKyN,EAAM,OA4JXioC,GAAoBlc,GAAQl9B,EAAM6/C,KACjEoE,GAAehM,IA3JE,SAAU59B,EAAMkgB,EAAYtf,EAAYo9B,GAC3D,IAGI2K,EAAUr+C,EAAM41B,GAHJ,SAAU/2B,EAAGgU,GAC3B,OAAOkiC,GAAQl2C,EAAGgU,EAAMyD,EAAYo9B,EAAYqB,QAAQliC,MAEf6C,GAC3C,OAAOonC,GAAQuB,EAASv/C,EAASC,KAAK62B,EAAW,OAsJZif,GAAsBtc,GAAQl9B,EAAM6/C,IACvEtjB,GAAa0b,IArJE,SAAU59B,EAAM0nC,EAAc9mC,EAAYuoC,GAC3D,IAIItI,EAJU,SAAUxiC,EAAOyjB,GAC7B,IAAI6lB,EAAKnlC,GAAUxD,UAAUX,GAC7B,OAAO2+B,GAAO2K,EAAI7lB,GAAY,GAEpB+nB,CAAQnC,EAAa1lB,UAAW0lB,EAAa5lB,YACrDkgB,EAxhLQ,SAAUtjC,EAAKE,GAC3B,MAAO,CACLF,IAAKA,EACLE,OAAQA,GAqhLSkrC,CAAQpC,EAAahpC,IAAKgpC,EAAa9oC,QAE1D,OADiBsjC,GAAQF,EAAchiC,EAAM6gC,EAAO6G,EAAa5lB,WAAYlhB,GAC3DvZ,MAAK,WACrB,OAAO+/C,GAAQpnC,EAAM5W,EAASR,KAAK8+C,EAAazzC,aAC/C,SAAU00C,GACX,IAAItK,EAASgJ,GAAgBsB,EAASjB,EAAahpC,IAAKgpC,EAAa9oC,QACrE,OAAOwoC,GAAQuB,EAAStK,SA36Bd,SAAUp9B,EAAWlS,GACjC,OAAOoO,GAAKpO,EAAOkF,SAAS7L,MAAK,SAAU+U,GACzC,OAAOqgC,GAAgBv8B,EAAW9D,GAAMjV,KAAI,SAAU20C,GAKpD,OAJYvxC,EAASA,EAAS,GAAIuxC,GAAU,CAC1C/a,WAAY/yB,EAAO+yB,WACnBE,UAAWjzB,EAAOizB,oBA+iCkBa,GAAQl9B,EAAM6/C,IACtDuE,GAAkBnM,IAlIE,SAAU59B,EAAM0nC,EAAc9mC,EAAYuoC,GAChE,IAAI7qC,EAAOyB,GAAmBC,GAAM1B,KAChCxF,EAAQ4uC,EAAa5wC,MAAM,GAAG8H,OAC9BkkB,EAAUxkB,EAAKopC,EAAa5wC,MAAM,GAAG4H,KACrCmiC,EAAQ4G,GAAYC,EAAa1lB,UAAW0lB,EAAa5lB,WAAYgB,GACrEknB,EAAazG,GAAWzqC,EAAOkH,EAAM6gC,EAAO6G,EAAa5lB,WAAYlhB,GACrEy9B,EAASgJ,GAAgB2C,EAAYtC,EAAa5wC,MAAM,GAAG4H,IAAKgpC,EAAa5wC,MAAM,GAAG8H,QAC1F,OAAOwoC,GAAQ4C,EAAY3L,KA2HgBmK,IAAsB,GAAO7iD,EAAMA,EAAM6/C,IAClFyE,GAAiBrM,IA1HE,SAAU59B,EAAM0nC,EAAc9mC,EAAYuoC,GAC/D,IAAI7qC,EAAOyB,GAAmBC,GAAM1B,KAChCxF,EAAQ4uC,EAAa5wC,MAAM4wC,EAAa5wC,MAAM3Q,OAAS,GAAGyY,OAAS8oC,EAAa5wC,MAAM4wC,EAAa5wC,MAAM3Q,OAAS,GAAGyQ,QACrHksB,EAAUxkB,EAAKopC,EAAa5wC,MAAM,GAAG4H,KACrCmiC,EAAQ4G,GAAYC,EAAa1lB,UAAW0lB,EAAa5lB,WAAYgB,GACrEknB,EAAazG,GAAWzqC,EAAOkH,EAAM6gC,EAAO6G,EAAa5lB,WAAYlhB,GACrEy9B,EAASgJ,GAAgB2C,EAAYtC,EAAa5wC,MAAM,GAAG4H,IAAKgpC,EAAa5wC,MAAM,GAAG8H,QAC1F,OAAOwoC,GAAQ4C,EAAY3L,KAmHcmK,IAAsB,GAAQ7iD,EAAMA,EAAM6/C,IACjF0E,GAAkBtM,IAlHE,SAAU59B,EAAM0nC,EAAc9mC,EAAYuoC,GAChE,IAAI7qC,EAAOyB,GAAmBC,GAAM1B,KAChCxF,EAAQ4uC,EAAa5wC,MAAM,GAAG4H,IAC9BokB,EAAUxkB,EAAKxF,GACf+nC,EAAQ4G,GAAYC,EAAa1lB,UAAW0lB,EAAa5lB,WAAYgB,GACrEknB,EAAanG,GAAW/qC,EAAOkH,EAAM6gC,EAAO6G,EAAa5lB,WAAYlhB,GACrEy9B,EAASgJ,GAAgB2C,EAAYtC,EAAa5wC,MAAM,GAAG4H,IAAKgpC,EAAa5wC,MAAM,GAAG8H,QAC1F,OAAOwoC,GAAQ4C,EAAY3L,KA2GgBI,GAAiB94C,EAAMA,EAAM6/C,IACtE2E,GAAiBvM,IA1GE,SAAU59B,EAAM0nC,EAAc9mC,EAAYuoC,GAC/D,IAAI7qC,EAAOyB,GAAmBC,GAAM1B,KAChCxF,EAAQ4uC,EAAa5wC,MAAM4wC,EAAa5wC,MAAM3Q,OAAS,GAAGuY,IAAMgpC,EAAa5wC,MAAM4wC,EAAa5wC,MAAM3Q,OAAS,GAAGwQ,QAClHmsB,EAAUxkB,EAAKopC,EAAa5wC,MAAM,GAAG4H,KACrCmiC,EAAQ4G,GAAYC,EAAa1lB,UAAW0lB,EAAa5lB,WAAYgB,GACrEknB,EAAanG,GAAW/qC,EAAOkH,EAAM6gC,EAAO6G,EAAa5lB,WAAYlhB,GACrEy9B,EAASgJ,GAAgB2C,EAAYtC,EAAa5wC,MAAM,GAAG4H,IAAKgpC,EAAa5wC,MAAM,GAAG8H,QAC1F,OAAOwoC,GAAQ4C,EAAY3L,KAmGcI,GAAiB94C,EAAMA,EAAM6/C,IACpE4E,GAlGkB,SAAU/rC,EAAOtP,GACrC,IAAIqsB,EAAQ5Y,GAAUxD,UAAUX,GAEhC,OADcqgC,GAAQtjB,EAAOrsB,GACd3G,MAAK,SAAUuzB,GAC5B,IAAI0uB,EAAmB1uB,EAAcA,EAAcx1B,OAAS,GACxDmkD,EAAc3uB,EAAc,GAAG/c,OAC/B2rC,EAAcF,EAAiBzrC,OAASyrC,EAAiBzzC,QACzD4zC,EAAsB1/C,EAAQ5C,EAAIkzB,EAAM/0B,KAAK,SAAUqY,GACzD,OAAOnW,EAAOmW,EAAI5H,OAAO,SAAUqG,GACjC,OAAOA,EAAKyB,QAAU0rC,GAAentC,EAAKyB,OAAS2rC,SAGvD,OAAO3C,GAAa4C,GAAqB,SAAUrtC,GACjD,MAA8B,OAAvBtY,GAAKsY,EAAKlJ,eAElBxM,MAAM,KAqFPgX,GAAa,SAAUT,GACzB,OAAOkhB,GAAYlhB,EAAI7F,aAWrBsyC,GAAkB,SAAUrrB,EAAQphB,GACtC,IAAI0sC,EAA8B,UAApBjsC,GAAWT,GACrB2sC,GAAkBtiD,EAAO2V,EAAIlH,OAAO,SAAUwZ,GAChD,MAA0B,OAAnB4O,GAAY5O,MAErB,OAAOo6B,GAAWC,EAAiBvhD,EAASR,KAAK,CAC/CgiD,MAAOF,EACPG,IAAKF,IACFvhD,EAASxC,QAEZkkD,GAAa,SAAU1rB,EAAQphB,GACjC,MAnBgB,WADmBjH,EAoBP0zC,GAAgBrrB,EAAQphB,GAAK3W,MAAK,WAC5D,OAAOoX,GAAWT,MACjB,SAAU+sC,GACX,MAAO,YArBA,SACc,UAAZh0C,EACF,SAEA,OANgB,IAAUA,GA0BjCi0C,GAAmB,SAAUr4C,EAAKs4C,EAAQC,GAC5C,IAAIC,EAAWx4C,EAAIgvB,UAAUspB,EAAQ,SACjCG,EAAgBH,EAAO9yC,WACvBkzC,EAAiBnsB,GAAYksB,GACjC,GAAIF,IAAmBG,EAAgB,CACrC,IAAIC,EAAe34C,EAAIqnC,OAAOkR,EAAgBC,GAAU,GACxD,IAAKG,EAAc,CACjBA,EAAe34C,EAAIyV,OAAO8iC,GAC1B,IAAIK,EAAoBJ,EAAS/kC,WACV,UAAnB8kC,EACF//C,EAAKkP,GAAWzH,GAAaH,QAAQ04C,GAAW,qBAAqB9jD,MAAK,WACxE,OAAO8jD,EAASllC,aAAaqlC,EAAcC,MAC1C,SAAUj7B,GACX,OAAO3d,EAAI64C,YAAYF,EAAch7B,EAAE3d,QAGzCw4C,EAAS9kC,YAAYilC,GAGF,UAAnBJ,GAAiD,UAAnBG,GAA8BC,EAAallC,WAC3EklC,EAAarlC,aAAaglC,EAAQK,EAAallC,YAE/CklC,EAAajlC,YAAY4kC,GAEtBG,EAAch4C,iBACjBT,EAAIiJ,OAAOwvC,KAabK,GAAiB,SAAUrsB,EAAQjiB,EAAMuuC,EAAa34C,GACxD,IAAIJ,EAAMysB,EAAOzsB,IACb0rB,EAXW,SAAUe,EAAQjiB,EAAMuuC,GACvC,GAAInmD,EAAcmmD,IAAgBxsB,GAAY/hB,KAAUuuC,EAAa,CACnE,IAAIrI,EAAajkB,EAAOzsB,IAAIg5C,OAAOxuC,EAAMuuC,GAEzC,OADApW,GAAYlW,EAAQikB,GACbA,EAEP,OAAOlmC,EAKKyuC,CAAWxsB,EAAQjiB,EAAMuuC,GAIvC,OAHKtmD,EAAY2N,IACfJ,EAAIk5C,UAAUxtB,EAAS,QAAStrB,GAE3BsrB,GAELytB,GAAkB,SAAU1sB,EAAQtoB,EAAO40C,EAAa34C,GAC1D,OAAO5K,EAAK2O,GAAO,SAAUwZ,GAC3B,OAAOm7B,GAAersB,EAAQ9O,EAAGo7B,EAAa34C,OAG9Cg5C,GAAoB,SAAU3sB,EAAQ6rB,EAAQljB,GAChD,IACMikB,EAaFr5C,EAAMysB,EAAOzsB,IACjB,GAAgB,WAAZo1B,EAAsB,CACxB,IAAIkkB,EAAuBlV,GAAmB3X,GAC1C8sB,EAAyC,SAAzBD,GAhBhBD,EAAe3tC,GAAMzL,GAAaH,QAAQw4C,EAAOn0C,MAAM,KAAK5O,KAAI,SAAUmW,GAC5E,OAAOC,GAAKD,MACX5W,MAAM,IACF2D,EAAQ4gD,GAAc,SAAUttC,GACrC,OAAO+rC,GAAgBrrB,EAAQ1gB,EAAI/L,QAClCzK,KAAI,SAAUikD,GACf,OAAIA,EAAavB,OAASuB,EAAatB,IAC9B,eAEAsB,EAAavB,MAAQ,UAAY,WAEzCnjD,MAAM,YAKwEwkD,EACjFH,GAAgB1sB,EAAQ6rB,EAAOn0C,MAAyB,YAAlBo1C,EAA8B,KAAO,KAAM,OACjFlB,GAAiBr4C,EAAKs4C,EAA0B,UAAlBiB,EAA4B,QAAU,cAEpEJ,GAAgB1sB,EAAQ6rB,EAAOn0C,MAAO,KAAM,MAC5Ck0C,GAAiBr4C,EAAKs4C,EAAoB,WAAZljB,EAAuB,QAAU,UAa/DqkB,GAAgC,SAAUl4C,GAC5C,OAAO,SAAU9F,EAAOiK,GACtB,IAAIg0C,EAAgBxnD,GAAKuJ,GACrB0V,EAA8B,QAAlBuoC,GAA6C,aAAlBA,EAZX,SAAUj+C,GAC5C,OAAOiQ,GAAMjQ,GAAOhG,MAAK,SAAUiW,GACjC,OAAO2N,GAAW3N,EAAOiiB,GAAS7U,0BACjCpkB,MAAK,WACN,OAAO+G,KACN,SAAU0I,GACX,OAAOA,EAAM,MAM6Dw1C,CAA8Bl+C,GAASA,EACjH,OAAO+M,GAAU2I,EAAW5P,EAAUmE,KAGtCk0C,GAAwBH,GAA8B,SACtDI,GAAiCJ,GAA8B,iBAC/DK,GAAwB,SAAUr+C,EAAO6xB,EAAY5nB,GACvD,OAAOk0C,GAAsBn+C,EAAOiK,GAAQnQ,KAAI,SAAUwkD,GACxD,OAAO3sB,GAAUE,MAChBx4B,MAAM,KAEPklD,GAAuB,SAAUv+C,EAAO8F,GAC1C,IA79IoB04C,EAAIC,EAAIpmD,EA69IxB8xB,EAAUg0B,GAAsBn+C,GAChC0+C,EAAUv0B,EAAQnwB,MAAK,SAAU+U,GACnC,OAAOkB,GAAMlB,MACZjV,KAAI,SAAUmW,GACf,OAAOC,GAAKD,MAEd,OAn+IoBuuC,EAm+IPr0B,EAn+IWs0B,EAm+IFC,EAn+IMrmD,EAm+IG,SAAU0W,EAAMmB,GAC7C,OAAO/V,EAAO+V,GAAM,SAAUI,GAC5B,OAAOrW,EAAO22B,GAAUtgB,EAAI/L,IAAImE,QAAQ,SAAUkL,GAChD,MAAoC,MAA7BvG,GAAMuG,EAAS9N,IAAqBQ,GAAKsN,EAAS7E,UAr+IxDyvC,EAAGplD,UAAYqlD,EAAGrlD,SAAW4B,EAASR,KAAKnC,EAAEmmD,EAAGjlD,WAAYklD,EAAGllD,aAAeyB,EAASxC,QAw+I3Fa,MAAM,KAGPslD,GAAe,SAAU3tB,EAAQgb,EAAUna,GAC7C,IAAI+sB,EAAc,SAAU5tB,GAC1B,MAAmC,UAA5Bv6B,GAAKs6B,GAAUC,KAQpBX,EAAe4Y,GAAiBjY,GAChC6tB,EAAgB7V,GAA4BhY,GAAUz5B,EAAOi1C,GAC7DsS,EAAU,SAAUrP,EAAWsP,EAAO1vB,EAAQ2c,EAAUgT,GAC1D,OAAO,SAAU/uC,EAAOtP,GACtBywB,GAAgBnhB,GAChB,IAAIozB,EAAO2I,IACPvgC,EAAMjH,GAAaH,QAAQ2sB,EAAOyC,UAClCC,EAAatE,GAAeC,EAAQ5jB,EAAK4kB,GACzCwf,EAAS1G,GAAMnY,EAAQ/gB,GACvB6/B,EAAkB9G,GAA4BhY,GAAUiF,KAAgB6B,KAC5E,OAAOinB,EAAM9uC,GAASw/B,EAAUpM,EAAMpzB,EAAOtP,EAAQ+yB,EAAYmc,EAAQC,GAAiB91C,MAAK,SAAU8R,GAOvG,OANA/R,EAAK+R,EAAOghC,SAAS,SAAUx8B,GAC7B02B,GAAWhW,EAAQ1gB,EAAI/L,QAEzBxK,EAAK+R,EAAOqF,UAAU,SAAUpC,GAC9Bm4B,GAAYlW,EAAQjiB,EAAKxK,QAEpBuH,EAAOmkC,OAAOn2C,KAAI,SAAUiV,GACjC,IAAIkwC,EA9gDL3S,GAAcC,GA8gDWx9B,GACpBklB,EAAMjD,EAAOzsB,IAAI26C,YAGrB,OAFAjrB,EAAIkrB,SAASF,EAAIp5C,QAAQtB,IAAK06C,EAAI9S,QAClClY,EAAImrB,OAAOH,EAAIp5C,QAAQtB,IAAK06C,EAAI9S,QACzB,CACLlY,IAAKA,EACL+qB,OAAQA,SAGThkD,EAASxC,SAGd6mD,EAAYP,EAAQ7D,IApCL,SAAUhrC,GAC3B,OAA+B,IAAxB2uC,EAAY5tB,IAAqB6K,GAAY5rB,GAAOC,KAAO,IAmCnB3Y,EAAMy0C,EAAU1E,IAC7DgY,EAAeR,EAAQjE,IAlCL,SAAU5qC,GAC9B,OAA+B,IAAxB2uC,EAAY5tB,IAAqB6K,GAAY5rB,GAAOH,QAAU,IAiCbvY,EAAMy0C,EAAU1E,IACtEiY,EAAqBT,EAAQzE,GAAkB9hD,EAAQhB,EAAMy0C,EAAU1E,IACvEkY,EAAoBV,EAAQtE,GAAiBjiD,EAAQhB,EAAMy0C,EAAU1E,IACrEmY,EAAwBX,EAAQpE,GAAqBniD,EAAQsmD,EAAe7S,EAAU1E,IACtFoY,EAAuBZ,EAAQlE,GAAoBriD,EAAQsmD,EAAe7S,EAAU1E,IACpFqY,EAAeb,EAAQvD,GAAYhjD,EAAQhB,EAAMy0C,EAAU1E,IAC3DsY,EAAiBd,EAAQtD,GAAcjjD,EAAQhB,EAAMy0C,EAAU1E,IAC/DuY,EAAoBf,EAAQnD,GAAiBpjD,EAAQhB,EAAMy0C,EAAU1E,IACrEwY,EAAmBhB,EAAQjD,GAAgBtjD,EAAQhB,EAAMy0C,EAAU1E,IACnEyY,EAAoBjB,EAAQhD,GAAiBvjD,EAAQhB,EAAMy0C,EAAU1E,IACrE0Y,EAAmBlB,EAAQ/C,GAAgBxjD,EAAQhB,EAAMy0C,EAAU1E,IACnE2Y,EAAenB,EAAQhrB,GAAYv7B,EAAQhB,EAAMy0C,EAAU1E,IAC3D4Y,EAAc,SAAUniD,EAAMoiD,GAChC,OAAOl4C,GAAMlK,EAAM,QAAQ5D,QAAO,SAAUjE,GAC1C,OAAOsF,EAAS2kD,EAAYjqD,OAuDhC,MAAO,CACLmpD,UAAWA,EACXC,aAAcA,EACdjF,iBAAkBkF,EAClB/E,gBAAiBgF,EACjB9E,oBAAqB+E,EACrB7E,mBAAoB8E,EACpBnE,WAAYoE,EACZnE,aAAcoE,EACdjE,gBAAiBkE,EACjBhE,eAAgBiE,EAChBhE,gBAAiBiE,EACjBhE,eAAgBiE,EAChBlsB,WAAYmsB,EACZG,iBAlEqB,SAAUpvB,EAAQjzB,GACvC,OAAOmiD,EAAYniD,EAAM,CACvB,KACA,OACChE,MAAK,SAAU7D,GAChB,IAAIwS,EAAQ5O,EAAIukD,GAAsB3sB,GAAkBV,GAASa,IAAa,SAAU3P,GACtF,OAAOA,EAAE3d,OAEXm5C,GAAgB1sB,EAAQtoB,EAAOxS,EAAM,UA2DvCmqD,gBAxDoB,SAAUrvB,EAAQjzB,GACtC,OAAOmiD,EAAYniD,EAAM,CACvB,SACA,OACA,WACChE,MAAK,SAAU7D,GAChB4D,EAAIykD,GAAqB7sB,GAAkBV,GAASkB,GAASI,WAAW,SAAUhiB,GAChF,OAAOqtC,GAAkB3sB,EAAQ1gB,EAAI/L,IAAKrO,UAkD9CilD,kBA9CwB2D,EAAQ3D,GAAmB5iD,EAAQhB,EAAMy0C,EAAU1E,IA+C3EgU,oBA9C0BwD,EAAQxD,GAAqB/iD,EAAQhB,EAAMy0C,EAAU1E,IA+C/EgZ,gBA9CoB,SAAUtvB,GAC9B,IAAI9gB,EAAOquC,GAAqB7sB,GAAkBV,GAASkB,GAASI,UACpE,GAAIpiB,EAAKnY,OAAS,EAAG,CACnB,IAAIwoD,EAAWzmD,EAAIoW,GAAM,SAAUjU,GACjC,OAAOygD,GAAW1rB,EAAQ/0B,EAAEsI,QAE1Bi8C,EAAYhlD,EAAS+kD,EAAU,UAC/BE,EAAYjlD,EAAS+kD,EAAU,UACnC,GAAKC,GAAcC,EAEZ,CACL,IAAIC,EAAUllD,EAAS+kD,EAAU,QACjC,OAAIC,GAAcE,GAAYD,EAElBD,GAAcE,IAAWD,EAG5B,GAFA,SAFA,SAJT,MAAO,SAsCXE,iBAzBqB,SAAU3vB,GAC/B,OAAOwoB,GAAa6E,GAAsB3sB,GAAkBV,GAASa,IAAa,SAAU9iB,GAC1F,MAAsB,OAAftY,GAAKsY,MACX1V,MAAM,KAuBTunD,gBArBoB5E,KAyBpB6E,GAAuB,CACzBrnC,OAAQ,CACN,kBAAmB,WACnBsM,MAAS,QAEXnY,WAAY,CAAE85B,OAAQ,KACtBqZ,WAAW,GA0BTC,GAAiB,SAAUjxC,GAC7B,IAAIE,EAAcxL,GAAaY,QAAQ,YAIvC,OAHArJ,EAAM+T,GAAS,WACb,OAAOgI,GAAO9H,EApBTxL,GAAaY,QAAQ,WAsBrB4K,GAELgxC,GAAa,SAAU9wC,EAAMJ,EAASmxC,EAAYC,GACpD,OAAOnlD,EAAMmU,GAAM,SAAUjU,GAC3B,OAxBY,SAAU6T,EAASmxC,EAAYC,EAAe10B,GAE5D,IADA,IAAIygB,EAAKzoC,GAAaY,QAAQ,MACrBzH,EAAI,EAAGA,EAAImS,EAASnS,IAAK,CAChC,IAAI8uB,EAAKD,EAAWy0B,GAActjD,EAAIujD,EAXjC18C,GAAaY,QAAQ,MAGrBZ,GAAaY,QAAQ,MAStBzH,EAAIujD,GACNh0C,GAAIuf,EAAI,QAAS,OAEfD,EAAWy0B,GACb/zC,GAAIuf,EAAI,QAAS,OAEnB3U,GAAO2U,EAAIjoB,GAAaY,QAAQ,OAChC0S,GAAOm1B,EAAIxgB,GAEb,OAAOwgB,EAWEkU,CAAUrxC,EAASmxC,EAAYC,EAAejlD,OAyCrDmlD,GAAmB,SAAUpwB,EAAQjiB,GACvCiiB,EAAOW,UAAUia,OAAO78B,EAAKxK,KAAK,GAClCysB,EAAOW,UAAU0vB,UAAS,IAgBxBC,GAAW,SAAUtwB,EAAQlhB,EAASI,EAAMqxC,EAAYN,GAC1D,IAAI1Z,EAAgBQ,GAAiB/W,GACjCiR,EAAU,CACZzoB,OAAQ+tB,EACR55B,WAAYm6B,GAAqB9W,GACjC8vB,UAAWpY,GAAe1X,IAS5B,OAPAA,EAAO0a,YAAYkB,QAAO,WACxB,IAAI38B,EAhEO,SAAUC,EAAMJ,EAASmxC,EAAYC,EAAeM,EAAYC,QAC1D,IAAfA,IACFA,EAAaZ,IAEf,IAAI5wC,EAAQzL,GAAaY,QAAQ,SAC7Bs8C,EAAqC,UAAfF,EAC1BpzC,GAAS6B,EAAOwxC,EAAWjoC,QAC3BrM,GAAO8C,EAAOwxC,EAAW9zC,YACrB8zC,EAAWX,WACbhpC,GAAO7H,EAAO8wC,GAAejxC,IAE/B,IAAI6xC,EAAmBztC,KAAKgC,IAAIhG,EAAM+wC,GACtC,GAAIS,GAAuBT,EAAa,EAAG,CACzC,IAAIzE,EAAQh4C,GAAaY,QAAQ,SACjC0S,GAAO7H,EAAOusC,GACd,IACIoF,EAAYZ,GAAWC,EAAYnxC,EADF,iBAAf0xC,EAAgCG,EAAmB,EACRT,GACjE5oC,GAASkkC,EAAOoF,GAElB,IAAIC,EAAQr9C,GAAaY,QAAQ,SACjC0S,GAAO7H,EAAO4xC,GACd,IAEIC,EAAYd,GAFFU,EAAsBxxC,EAAOyxC,EAAmBzxC,EAE1BJ,EADhB4xC,EAAsB,EAAIT,EACcC,GAE5D,OADA5oC,GAASupC,EAAOC,GACT7xC,EAuCO8xC,CAAS7xC,EAAMJ,EAASmxC,EAAYM,EAAY5Y,GAAmB3X,GAASiR,GACxF/0B,GAAI+C,EAAO,cAAe,SAC1B,IAAIvL,EAnCS,SAAUmB,GACzB,IAAIwW,EAAY7X,GAAaY,QAAQ,OACjCsI,EAAQlJ,GAAaH,QAAQwB,EAAQtB,IAAI0V,WAAU,IAEvD,OADAnC,GAAOuE,EAAW3O,GANR,SAAU7H,GACpB,OAAOA,EAAQtB,IAAIQ,UAMZi9C,CAAM3lC,GA+BA4lC,CAAWhyC,GACtB+gB,EAAOkxB,cAAcx9C,GACrBssB,EAAOmxB,eAEFv1C,GAAamkB,GAAUC,GAAS,8BAA8Bl3B,KAAI,SAAUmW,GAYjF,OAXI+3B,GAAehX,GACjByY,GAAczY,EAAQ/gB,GACbi4B,GAAmBlX,GAC5B2Y,GAAY15B,IACHw4B,GAAoBzX,IAtBd,SAAUlL,GAC7B,OAAOlvB,EAASkvB,KAAkC,IAAxBA,EAAMzqB,QAAQ,KAqBI+mD,CAAe7a,EAAczhB,SACrEyjB,GAAkBvY,EAAQ/gB,GAE5BmhB,GAAgBnhB,GAChBzC,GAAOyC,EAAO,eAlCD,SAAU+gB,EAAQ/gB,GACjClW,EAAKoS,GAAc8D,EAAO,OAAO,SAAUK,GACzC02B,GAAWhW,EAAQ1gB,EAAI/L,KACvBxK,EAAKoS,GAAcmE,EAAK,UAAU,SAAUvB,GAC1Cm4B,GAAYlW,EAAQjiB,EAAKxK,WA+B3B89C,CAAWrxB,EAAQ/gB,GAtCM,SAAU+gB,EAAQ+rB,GAC7CnwC,GAAamwC,EAAU,SAAShjD,KAAKrC,EAAM0pD,GAAkBpwB,IAsC3DsxB,CAAuBtxB,EAAQ/gB,GACxBA,EAAM1L,OACZlL,MAAM,OAEPkpD,GAAgC,SAAUvxB,EAAQ9gB,EAAMJ,EAASmyB,EAASugB,QAC5D,IAAZvgB,IACFA,EAAU,IAEZ,IAAIwgB,EAAa,SAAUxhC,GACzB,OAAO3pB,EAAS2pB,IAAQA,EAAM,GAEhC,GAAIwhC,EAAWvyC,IAASuyC,EAAW3yC,GAAU,CAC3C,IAAI4yC,EAAazgB,EAAQygB,YAAc,EACnCC,EAAgB1gB,EAAQ0gB,eAAiB,EAC7C,OAAOrB,GAAStwB,EAAQlhB,EAASI,EAAMyyC,EAAeD,GAGtD,OADAx9C,QAAQC,MAAMq9C,GACP,MAIPI,GAAuB,SAAUC,GACnC,OAAO,WACL,OAAOA,IAAe5pD,MAAK,WACzB,MAAO,MACN,SAAUmX,GACX,OAAOtW,EAAIsW,GAAO,SAAU3G,GAC1B,OAAOA,EAAElF,YAKbu+C,GAAuB,SAAUC,GACnC,OAAO,SAAU3yC,GACf,IAAI4yC,EAAU5yC,EAAMrY,OAAS,EAAIiD,EAASR,KAAKo2B,GAAUxgB,IAAUpV,EAASxC,OAC5EuqD,EAAaC,KAGbC,GAAc,SAAUjyB,GAC1B,OAAO,SAAUlhB,EAASI,EAAM+xB,QACd,IAAZA,IACFA,EAAU,IAEZ,IAAIhyB,EAAQsyC,GAA8BvxB,EAAQ9gB,EAAMJ,EAASmyB,EAAS,4FAE1E,OADAjR,EAAO0a,YAAYzR,MACZhqB,IAePizC,GAAgB,SAAUr9C,EAASoI,EAAU9X,GAC/C,IAAIgtD,EAAiBr0C,GAAajJ,EAASoI,EAAU,GACvC,IAAV9X,GAAegtD,GAAkB,EACnC31C,GAAO3H,EAASoI,GAEhBf,GAAIrH,EAASoI,EAAUiG,KAAKgC,IAAI/f,EAAOgtD,KAmCvCC,GAAW,SAAUnzC,EAAOtP,GAC9B,IAAIqsB,EAAQ5Y,GAAUxD,UAAUX,GAEhC,OADcugC,GAAgBxjB,EAAOrsB,GACtB7G,KAAI,SAAUyzB,GAC3B,IAAI0uB,EAAmB1uB,EAAcA,EAAcx1B,OAAS,GACxDmkD,EAAc3uB,EAAc,GAAG/c,OAC/B2rC,EAAcF,EAAiBzrC,OAASyrC,EAAiBzzC,QAG7D,OAAOhL,EAzCY,SAAUwvB,EAAOkvB,EAAaC,GACnD,GAAI/nC,GAAUQ,WAAWoY,GAAQ,CAC/B,IAAIq2B,EAAalpD,EAAOia,GAAUO,YAAYqY,IAAQ,SAAUpL,GAC9D,OAAOA,EAAIpR,QAAU0rC,GAAet6B,EAAIpR,OAAS2rC,KAE/CmH,EAAaxpD,EAAIupD,GAAY,SAAUnhC,GACzC,IAAIqhC,EAAYjjC,GAAK4B,EAAErc,SAEvB,OADAq9C,GAAcK,EAAW,OAAQpH,EAAcD,GACxCqH,KAELC,EAAeh/C,GAAaY,QAAQ,YAExC,OADAkT,GAASkrC,EAAcF,GAChB,CAACE,GAER,MAAO,GAyBaC,CAAiBz2B,EAAOkvB,EAAaC,GAtB1C,SAAUnvB,EAAOkvB,EAAaC,GAC/C,OAAOriD,EAAIkzB,EAAM/0B,KAAK,SAAUqY,GAC9B,IAAIozC,EAAcvpD,EAAOmW,EAAI5H,OAAO,SAAUqG,GAC5C,OAAOA,EAAKyB,QAAU0rC,GAAentC,EAAKyB,OAAS2rC,KAEjDwH,EAAc7pD,EAAI4pD,GAAa,SAAU30C,GAC3C,IAAI60C,EAAatjC,GAAKvR,EAAKlJ,SAE3B,OADAq9C,GAAcU,EAAY,UAAWzH,EAAcD,GAC5C0H,KAELC,EAASr/C,GAAaY,QAAQ,MAElC,OADAkT,GAASurC,EAAQF,GACVE,KAWQC,CAAa92B,EAAOkvB,EAAaC,QAKhD4H,GAAW,SAAU9zC,EAAOtP,EAAQ+yB,GACtC,IAAI7gB,EAAYuB,GAAUxD,UAAUX,GAEpC,OADcqgC,GAAQz9B,EAAWlS,GAClB3G,MAAK,SAAUuzB,GAC5B,IAAI3b,EAAOg9B,GAAO/7B,EAAW6gB,GAAY,GAErCswB,EADOryC,GAAmBC,GAAM1B,KACd/U,MAAMoyB,EAAc,GAAGjd,IAAKid,EAAcA,EAAcx1B,OAAS,GAAGuY,IAAMid,EAAcA,EAAcx1B,OAAS,GAAGwQ,SACpI07C,EAAejqD,EAAKgqD,GAAY,SAAU1zC,GAC5C,IAAIa,EAAWhX,EAAOmW,EAAI5H,OAAO,SAAUqG,GACzC,OAAQA,EAAKjG,YAEf,OAAOqI,EAASpZ,OAAS,EAAI,CAACmF,EAASA,EAAS,GAAIoT,GAAM,CAAE5H,MAAOyI,KAAe,MAEhF+yC,EAAgB/U,GAAa8U,EAAcvwB,GAC/C,OAAO/S,GAAOujC,EAAcnsD,OAAS,EAAGmsD,MACvCpqD,KAAI,SAAUoqD,GACf,OAhwDS,SAAUtyC,GACrB,OAAO9X,EAAI8X,GAAM,SAAUtB,GACzB,IAAI28B,EAAK5sB,GAAQ/P,EAAIzK,SAOrB,OANA9L,EAAKuW,EAAI5H,OAAO,SAAUqG,GACxB,IAAI60C,EAAatjC,GAAKvR,EAAKlJ,SAC3B8mC,GAASiX,EAAY,UAAW70C,EAAKvG,QAAS,GAC9CmkC,GAASiX,EAAY,UAAW70C,EAAKxG,QAAS,GAC9CuP,GAAOm1B,EAAI2W,MAEN3W,KAuvDAkX,CAAOD,OAIdE,GAAWtkC,QAAQC,KAAKC,MAAMC,QAAQ,sBAEtCokC,GAAsB,SAAU9/C,EAAKqL,EAAKnZ,GAe5C,OAZoB,SAAU6tD,EAAiBC,GAC7C,IAAK,IAAI1oD,EAAI,EAAGA,EAAI0oD,EAAKxsD,OAAQ8D,IAAK,CACpC,IAAI2oD,EAAejgD,EAAIgtB,SAASgzB,EAAK1oD,GAAIpF,GAIzC,QAH+B,IAApB6tD,IACTA,EAAkBE,GAEhBF,IAAoBE,EACtB,MAAO,GAGX,OAAOF,EAEFG,CAbHH,UADQ//C,EAAIqnC,OAAO,QAASh8B,KAgB9B80C,GAAa,SAAU1zB,EAAQphB,EAAKnZ,GAClCA,GACFu6B,EAAO2zB,UAAUxsD,MAAM,QAAU1B,EAAM,GAAImZ,IAQ3Cg1C,GAAe,SAAU5zB,EAAQphB,GACnCw0C,GAASrqD,KAAK,oBAAoBqnC,MAAM,MAAM,SAAU3qC,GACtDu6B,EAAO2zB,UAAUn3C,OAAO,QAAU/W,EAAM,GAAImZ,OAY5Ci1C,GAAiB,SAAUC,EAAWC,GAiBxC,OAhBkB,SAAU/qB,EAAQ79B,GAClC,OAAOA,EAAIjE,OAAO4B,EAAIkgC,GAAQ,SAAUzlB,GACtC,IAAIhP,EAAOgP,EAAKhP,MAAQgP,EAAKywC,MAC7B,OAPY,SAAUzwC,GAC1B,OAAOnM,GAAkBmM,EAAM,QAMvB0wC,CAAY1wC,GACP,CACLhP,KAAMA,EACN2/C,MAAOL,GAAetwC,EAAK4wC,OAGtB,CACL5/C,KAAMA,EACNpP,MAAOoe,EAAKpe,WAKbivD,CAAYN,EAAWC,GAAc,KAE1CM,GAAW,SAAU9gD,GACvB,OAAO,SAAUpO,GACf,OAAO+J,GAAW/J,EAAO,OAASoO,EAAI+gD,MAAMnvD,GAASA,IAGrDovD,GAAwB,SAAUhhD,EAAKqL,GACzC,IAAI/J,EAAUrB,GAAaH,QAAQuL,GACnC,MAAO,CACL41C,YAAa/2C,GAAO5I,EAAS,gBAAgBxM,MAAM,IACnDosD,YAAah3C,GAAO5I,EAAS,gBAAgBxM,MAAM,IACnDqsD,YAAaj3C,GAAO5I,EAAS,gBAAgB/L,IAAIurD,GAAS9gD,IAAMlL,MAAM,IACtEssD,gBAAiBl3C,GAAO5I,EAAS,oBAAoB/L,IAAIurD,GAAS9gD,IAAMlL,MAAM,MAG9EusD,GAAkB,SAAU7xB,GAC9B,IAAI8xB,EAAW9xB,EAAK,GAChB+xB,EAAiB/xB,EAAK54B,MAAM,GAahC,OAZApB,EAAK+rD,GAAgB,SAAUZ,GAC7BnrD,EAAKoN,GAAK0+C,IAAW,SAAU39C,GAC7Bd,GAAO89C,GAAO,SAAUa,EAAWC,GACjC,IAAIC,EAAkBJ,EAAS39C,GACP,KAApB+9C,GAA0B/9C,IAAQ89C,GAChCC,IAAoBF,IACtBF,EAAS39C,GAAO,aAMnB29C,GAELK,GAAiB,SAAUC,GAC7B,IAAIC,EAAc,CAChB,CACE3vD,KAAM,cACNP,KAAM,UACNgpB,MAAO,eACPgmC,MAAO,CACL,CACE3/C,KAAM,YACNpP,MAAO,IAET,CACEoP,KAAM,QACNpP,MAAO,SAET,CACEoP,KAAM,SACNpP,MAAO,UAET,CACEoP,KAAM,SACNpP,MAAO,UAET,CACEoP,KAAM,SACNpP,MAAO,UAET,CACEoP,KAAM,SACNpP,MAAO,UAET,CACEoP,KAAM,QACNpP,MAAO,SAET,CACEoP,KAAM,QACNpP,MAAO,SAET,CACEoP,KAAM,SACNpP,MAAO,UAET,CACEoP,KAAM,OACNpP,MAAO,QAET,CACEoP,KAAM,SACNpP,MAAO,YAIb,CACEM,KAAM,cACNP,KAAM,aACNgpB,MAAO,gBAET,CACEzoB,KAAM,kBACNP,KAAM,aACNgpB,MAAO,qBASX,MAAO,CACL8lC,MAAO,WACPvuD,KAAM,WACNyuD,MAJyB,SAAfiB,EAAwB,CALlB,CAChB1vD,KAAM,cACNP,KAAM,QACNgpB,MAAO,iBAEyChnB,OAAOkuD,GAAeA,IAOtEC,GAAe,SAAUv2B,EAASw2B,EAAYt1B,EAAQphB,GACxD,OAAOtT,EAAKwzB,GAAS,SAAUr5B,GAC7B,OAAOu6B,EAAO2zB,UAAU4B,UAAU32C,EAAK02C,EAAa7vD,MACnD4C,MAAM,KAEPmtD,GAAgB9uD,EAAM2uD,GAAc,CACtC,OACA,SACA,SACC,SACCI,GAAgB/uD,EAAM2uD,GAAc,CACtC,MACA,SACA,UACC,UA2GCK,GAAa,CACf,CACEjwD,KAAM,QACNP,KAAM,QACNgpB,MAAO,SAET,CACEzoB,KAAM,SACNP,KAAM,QACNgpB,MAAO,UAET,CACEzoB,KAAM,WACNP,KAAM,UACNgpB,MAAO,YACPgmC,MAAO,CACL,CACE3/C,KAAM,OACNpP,MAAO,MAET,CACEoP,KAAM,cACNpP,MAAO,QAIb,CACEM,KAAM,QACNP,KAAM,UACNgpB,MAAO,QACPgmC,MAAO,CACL,CACE3/C,KAAM,OACNpP,MAAO,IAET,CACEoP,KAAM,MACNpP,MAAO,OAET,CACEoP,KAAM,SACNpP,MAAO,OAET,CACEoP,KAAM,YACNpP,MAAO,YAET,CACEoP,KAAM,eACNpP,MAAO,cAIb,CACEM,KAAM,SACNP,KAAM,UACNgpB,MAAO,mBACPgmC,MAAO,CACL,CACE3/C,KAAM,OACNpP,MAAO,IAET,CACEoP,KAAM,OACNpP,MAAO,QAET,CACEoP,KAAM,SACNpP,MAAO,UAET,CACEoP,KAAM,QACNpP,MAAO,WAIb,CACEM,KAAM,SACNP,KAAM,UACNgpB,MAAO,iBACPgmC,MAAO,CACL,CACE3/C,KAAM,OACNpP,MAAO,IAET,CACEoP,KAAM,MACNpP,MAAO,OAET,CACEoP,KAAM,SACNpP,MAAO,UAET,CACEoP,KAAM,SACNpP,MAAO,aAKXwwD,GAAW,SAAU31B,GACvB,OAAO01B,GAAWxuD,OAjHD,SAAU84B,GAC3B,IAAI41B,EAAU/B,GA/8EO,SAAU7zB,GAC/B,OAAOA,EAAO4W,SAAS,wBAAyB,GAAI,SA88EvBif,CAAiB71B,IAC9C,OAAI41B,EAAQ7uD,OAAS,EACZiD,EAASR,KAAK,CACnB/D,KAAM,QACNP,KAAM,UACNgpB,MAAO,QACPgmC,MAAO0B,IAGJ5rD,EAASxC,OAuGSsuD,CAAa91B,GAAQ12B,YAG5CysD,GAAY,SAAUC,GACxB,OAAO,SAAUh2B,EAAQ1sB,GACvB,IAAIC,EAAMysB,EAAOzsB,IAoBjB,MAAO,CACLk5C,UApBc,SAAU7vC,EAAMzX,GACzB6wD,IAAc7wD,GACjBoO,EAAIk5C,UAAUn5C,EAAMsJ,EAAMzX,IAmB5B8wD,SAhBa,SAAUh9B,EAAM9zB,GACxB6wD,IAAc7wD,GACjBoO,EAAI0iD,SAAS3iD,EAAM2lB,EAAM9zB,IAe3B+wD,UAZc,SAAUZ,EAAYnwD,GAC/B6wD,IAAc7wD,IACH,KAAVA,EACF66B,EAAO2zB,UAAUn3C,OAAO84C,EAAY,CAAEnwD,MAAO,MAAQmO,GAAM,GAE3D0sB,EAAO2zB,UAAUxsD,MAAMmuD,EAAY,CAAEnwD,MAAOA,GAASmO,QAW3D6iD,GAAc,CAChBC,OAAQL,IAAU,GAClBM,SAAUN,IAAU,IAGlBO,GAAmB,SAAU5+C,GAC/B,OAAOuH,GAAMvH,EAAM,IAAI5O,KAAI,SAAUmW,GACnC,IAAI4C,EAAYuB,GAAUxD,UAAUX,GAChCqd,EAAWlZ,GAAUK,UAAU5B,GAC/B2B,EAAWra,EAAOmzB,GAAU,SAAUi6B,GACxC,OAAOttD,EAAOyO,GAAO,SAAU8+C,GAC7B,OAAOlhD,GAAKihD,EAAM1hD,QAAS2hD,SAG/B,OAAO1tD,EAAI0a,GAAU,SAAUzF,GAC7B,MAAO,CACLlJ,QAASkJ,EAAKlJ,QAAQtB,IACtBiM,OAAQ4D,GAAUS,YAAYhC,EAAW9D,EAAKyB,QAAQ1W,KAAI,SAAU8nB,GAClE,OAAOA,EAAI/b,QAAQtB,eAkBzBkjD,GAAgB,SAAUz2B,EAAQtoB,EAAOg/C,EAAS3zB,GACpD,IAAI4zB,EAAgC,IAAjBj/C,EAAM3Q,OACrB6vD,EAAelgD,GAASqsB,GAAM,SAAU59B,EAAO+R,GACjD,OAAOw/C,EAAQx/C,KAAS/R,KAE1B,GAAI6R,GAAK4/C,GAAgB,GAAKl/C,EAAM3Q,QAAU,EAAG,CAC/C,IAAI8vD,EAAW53C,GAAMvH,EAAM,IAC3B4+C,GAAiB5+C,GAAO3O,MAAK,SAAUwzB,GACrCxzB,EAAKwzB,GAAe,SAAUhZ,GAC5B,IAAIuzC,EAAUzK,GAAersB,EAAQzc,EAAK1O,QAASkuB,EAAKg0B,UACpDC,EAAWL,EAAeR,GAAYC,OAAOp2B,EAAQ82B,GAAWX,GAAYE,SAASr2B,EAAQ82B,IAtBjF,SAAUE,EAAUC,EAAal0B,GACvDi0B,EAASvK,UAAU,QAAS1pB,EAAKpvB,OACjCqjD,EAASvK,UAAU,QAAS1pB,EAAKm0B,OACjCF,EAASf,SAAS,SAAU91B,GAAY4C,EAAK9Q,SAC7CglC,EAAYhB,SAAS,QAAS91B,GAAY4C,EAAKjO,QAsBzCqiC,CAAkBH,EAHAzzC,EAAK/D,OAAO1W,KAAI,SAAU8nB,GAC1C,OAAO+lC,EAAeR,GAAYC,OAAOp2B,EAAQpP,GAAOulC,GAAYE,SAASr2B,EAAQpP,MACpFvoB,MAAM2uD,GACgCj0B,GACrCsU,GAAmBrX,IArBL,SAAUg3B,EAAUj0B,GAC5Ci0B,EAASd,UAAU,2BAA4BnzB,EAAK4xB,iBACpDqC,EAASd,UAAU,uBAAwBnzB,EAAK2xB,aAChDsC,EAASd,UAAU,uBAAwBnzB,EAAK0xB,aAChDuC,EAASd,UAAU,uBAAwB/1B,GAAY4C,EAAKyxB,cAkBpD4C,CAAoBJ,EAAUj0B,GAE5B4zB,IACF/C,GAAa5zB,EAAQ82B,GA5bX,SAAU92B,EAAQphB,GACpCw0C,GAASrqD,KAAK,oBAAoBqnC,MAAM,MAAM,SAAU3qC,GACtDu6B,EAAO2zB,UAAUn3C,OAAO,SAAW/W,EAAM,GAAImZ,MA2bvCy4C,CAAcr3B,EAAQ82B,IAEpB/zB,EAAKu0B,QACP5D,GAAW1zB,EAAQ82B,EAAS/zB,EAAKu0B,QAE/Bv0B,EAAKw0B,QA5cC,SAAUv3B,EAAQphB,EAAKnZ,GACnCA,GACFu6B,EAAO2zB,UAAUxsD,MAAM,SAAW1B,EAAM,GAAImZ,GA2ctC44C,CAAYx3B,EAAQ82B,EAAS/zB,EAAKw0B,cAIxC,IAAIE,EAAkBzgD,GAAKN,GAASkgD,GAAc,SAAUzf,EAAQjgC,GAClE,MAAe,UAARA,GAA2B,aAARA,MACtB,EACN2/C,EAAS9tD,MAAK,SAAUkW,GACtB,OAAOk3B,GAAkBnW,EAAQ/gB,EAAM1L,IAAK,CAC1C8iC,UAAWl/B,GAAIy/C,EAAc,YAC7B95C,MAAO26C,SAKXC,GAAmB,SAAU13B,EAAQtoB,EAAOg/C,EAAS7uC,GACvD,IAAIkb,EAAOlb,EAAI8vC,UACf9vC,EAAI+vC,QACJ53B,EAAO0a,YAAYmd,UAAS,WAC1BpB,GAAcz2B,EAAQtoB,EAAOg/C,EAAS3zB,GACtC/C,EAAOkD,YAGPy0B,GAAU,SAAU33B,EAAQtoB,GAC9B,IAAIogD,EAAYxB,GAAiB5+C,GAAO5O,KAAI,SAAUyzB,GACpD,OAAOzzB,EAAIyzB,GAAe,SAAUhZ,GAClC,OA1P2B,SAAUyc,EAAQjiB,EAAMs5B,EAAoB73B,GAC3E,IAAIjM,EAAMysB,EAAOzsB,IACbwkD,EAASv4C,EAAOnX,MAAM0V,GACtBwiB,EAAW,SAAU1rB,EAASiI,GAChC,OAAOvJ,EAAIgtB,SAAS1rB,EAASiI,IAAUvJ,EAAIitB,UAAU3rB,EAASiI,IAEhE,OAAO5Q,EAAS,CACd4oB,MAAOyL,EAASw3B,EAAQ,SACxB9lC,OAAQsO,EAASxiB,EAAM,UACvBpK,MAAOJ,EAAIitB,UAAUziB,EAAM,SAC3Bg5C,SAAUj3B,GAAY/hB,GACtBm5C,MAAO3jD,EAAIitB,UAAUziB,EAAM,QAAS,IACpCu5C,OAAQ9B,GAAcx1B,EAAQjiB,GAC9Bw5C,OAAQ9B,GAAcz1B,EAAQjiB,IAC7Bs5B,EAAqBkd,GAAsBhhD,EAAKwK,GAAQ,IA4OhDi6C,CAA2Bh4B,EAAQzc,EAAK1O,QAASwiC,GAAmBrX,GAASzc,EAAK/D,cAG7F,OAAOo1C,GAAgBkD,EAAUvvD,aAE/B0vD,GAAO,SAAUj4B,EAAQa,GAC3B,IAAInpB,EAAQ21C,GAAsB3sB,GAAkBV,GAASa,GAC7D,GAAqB,IAAjBnpB,EAAM3Q,OAAV,CAGA,IAAIg8B,EAAO40B,GAAQ33B,EAAQtoB,GACvBwgD,EAAiB,CACnBhzD,KAAM,WACNizD,KAAM,CACJ,CACEnE,MAAO,UACPvuD,KAAM,UACNyuD,MAAOyB,GAAS31B,IAElBk1B,GAAe,UAGfkD,EAAc,CAChBlzD,KAAM,QACNgvD,MAAO,CAAC,CACJhvD,KAAM,OACN4Z,QAAS,EACTo1C,MAAOyB,GAAS31B,MAGtBA,EAAOq4B,cAAcJ,KAAK,CACxBjE,MAAO,kBACPh9C,KAAM,SACN0D,KAAM28B,GAAmBrX,GAAUk4B,EAAiBE,EACpDE,QAAS,CACP,CACEpzD,KAAM,SACNO,KAAM,SACN8O,KAAM,UAER,CACErP,KAAM,SACNO,KAAM,OACN8O,KAAM,OACNgkD,SAAS,IAGbC,YAAaz1B,EACb01B,SAAU/xD,EAAMgxD,GAAkB13B,EAAQtoB,EAAOqrB,OAgBjD21B,GAAe,CACjB,CACExzD,KAAM,UACNO,KAAM,OACNyoB,MAAO,WACPgmC,MAAO,CACL,CACE3/C,KAAM,SACNpP,MAAO,UAET,CACEoP,KAAM,OACNpP,MAAO,QAET,CACEoP,KAAM,SACNpP,MAAO,YAIb,CACED,KAAM,UACNO,KAAM,QACNyoB,MAAO,YACPgmC,MAAO,CACL,CACE3/C,KAAM,OACNpP,MAAO,IAET,CACEoP,KAAM,OACNpP,MAAO,QAET,CACEoP,KAAM,SACNpP,MAAO,UAET,CACEoP,KAAM,QACNpP,MAAO,WAIb,CACE+oB,MAAO,SACPzoB,KAAM,SACNP,KAAM,UAGNyzD,GAAa,SAAU34B,GACzB,OAAO04B,GAAaxxD,OA9DD,SAAU84B,GAC7B,IAAI41B,EAAU/B,GAzuFM,SAAU7zB,GAC9B,OAAOA,EAAO4W,SAAS,uBAAwB,GAAI,SAwuFtBgiB,CAAgB54B,IAC7C,OAAI41B,EAAQ7uD,OAAS,EACZiD,EAASR,KAAK,CACnB/D,KAAM,QACNP,KAAM,UACNgpB,MAAO,QACPgmC,MAAO0B,IAGJ5rD,EAASxC,OAoDWqxD,CAAe74B,GAAQ12B,YAYhDwvD,GAAe,SAAU94B,EAAQ9gB,EAAMw3C,EAAS3zB,GAClD,IAAIg2B,EAA8B,IAAhB75C,EAAKnY,OACnB6vD,EAAelgD,GAASqsB,GAAM,SAAU59B,EAAO+R,GACjD,OAAOw/C,EAAQx/C,KAAS/R,KAE1B,GAAI6R,GAAK4/C,GAAgB,EAAG,CAC1B7tD,EAAKmW,GAAM,SAAU2sC,GACf9oB,EAAK79B,OAAS46B,GAAY+rB,EAAO9yC,aACnC4zC,GAAkB3sB,EAAQ6rB,EAAQ9oB,EAAK79B,MAEzC,IAAI8xD,EAAW+B,EAAc5C,GAAYC,OAAOp2B,EAAQ6rB,GAAUsK,GAAYE,SAASr2B,EAAQ6rB,IAnB3E,SAAUmL,EAAUj0B,GAC5Ci0B,EAASvK,UAAU,QAAS1pB,EAAKm0B,OACjCF,EAASf,SAAS,SAAU91B,GAAY4C,EAAK9Q,SAkBzC+mC,CAAoBhC,EAAUj0B,GAC1BuU,GAAkBtX,IAjBA,SAAUg3B,EAAUj0B,GAC9Ci0B,EAASf,SAAS,mBAAoBlzB,EAAK4xB,iBAC3CqC,EAASf,SAAS,eAAgBlzB,EAAK2xB,aACvCsC,EAASf,SAAS,eAAgBlzB,EAAK0xB,aAejCwE,CAAsBjC,EAAUj0B,GAE9BA,EAAKm2B,QAAUxC,EAAQwC,QACzBtF,GAAa5zB,EAAQ6rB,GACrB6H,GAAW1zB,EAAQ6rB,EAAQ9oB,EAAKm2B,WAGpC,IAAIC,EAAiBhiD,GAAIy/C,EAAc,QACnCa,GAAkB0B,GAAiBniD,GAAK4/C,GAAgB,EAC5D33C,GAAMzL,GAAaH,QAAQ6L,EAAK,KAAKnW,MAAK,SAAUkW,GAClD,OAAOk3B,GAAkBnW,EAAQ/gB,EAAM1L,IAAK,CAC1C8iC,UAAW8iB,EACXr8C,MAAO26C,SAKX2B,GAAkB,SAAUp5B,EAAQ9gB,EAAMw3C,EAAS7uC,GACrD,IAAIkb,EAAOlb,EAAI8vC,UACf9vC,EAAI+vC,QACJ53B,EAAO0a,YAAYmd,UAAS,WAC1BiB,GAAa94B,EAAQ9gB,EAAMw3C,EAAS3zB,GACpC/C,EAAOkD,YAGPm2B,GAAS,SAAUr5B,GACrB,IAAI9gB,EAAOquC,GAAqB7sB,GAAkBV,GAASkB,GAASI,UACpE,GAAoB,IAAhBpiB,EAAKnY,OAAT,CAGA,IAAIuyD,EAAWxwD,EAAIoW,GAAM,SAAU2sC,GACjC,OA7a4B,SAAU7rB,EAAQphB,EAAK04B,GACrD,IAAI/jC,EAAMysB,EAAOzsB,IACjB,OAAOrH,EAAS,CACd+lB,OAAQ1e,EAAIgtB,SAAS3hB,EAAK,WAAarL,EAAIitB,UAAU5hB,EAAK,UAC1Ds4C,MAAO3jD,EAAIitB,UAAU5hB,EAAK,QAAS,IACnC1Z,KAAMwmD,GAAW1rB,EAAQphB,GACzBs6C,MAAO1D,GAAcx1B,EAAQphB,IAC5B04B,EAAoBid,GAAsBhhD,EAAKqL,GAAO,IAsahD26C,CAA0Bv5B,EAAQ6rB,EAAOt4C,IAAK+jC,GAAkBtX,OAErE+C,EAAO6xB,GAAgB0E,GACvBpB,EAAiB,CACnBhzD,KAAM,WACNizD,KAAM,CACJ,CACEnE,MAAO,UACPvuD,KAAM,UACNyuD,MAAOyE,GAAW34B,IAEpBk1B,GAAe,SAGfkD,EAAc,CAChBlzD,KAAM,QACNgvD,MAAO,CAAC,CACJhvD,KAAM,OACN4Z,QAAS,EACTo1C,MAAOyE,GAAW34B,MAGxBA,EAAOq4B,cAAcJ,KAAK,CACxBjE,MAAO,iBACPh9C,KAAM,SACN0D,KAAM48B,GAAkBtX,GAAUk4B,EAAiBE,EACnDE,QAAS,CACP,CACEpzD,KAAM,SACNO,KAAM,SACN8O,KAAM,UAER,CACErP,KAAM,SACNO,KAAM,OACN8O,KAAM,OACNgkD,SAAS,IAGbC,YAAaz1B,EACb01B,SAAU/xD,EAAM0yD,GAAiBp5B,EAAQl3B,EAAIoW,GAAM,SAAUjU,GAC3D,OAAOA,EAAEsI,OACPwvB,OAIJy2B,GAAW1qC,QAAQC,KAAKC,MAAMC,QAAQ,eAEtCwqC,GAAa,SAAUz5B,EAAQ41B,EAAS8D,GAC1C,IAAIC,EAAoBD,EAAsB,CAC5C,CACEx0D,KAAM,QACNO,KAAM,OACNyoB,MAAO,OACP0rC,UAAW,WAEb,CACE10D,KAAM,QACNO,KAAM,OACNyoB,MAAO,OACP0rC,UAAW,YAX0B,GA0BrCC,EAr7FqB,SAAU75B,GACnC,OAAOA,EAAO4W,SAAS,4BAA4B,EAAM,WAo7FnCkjB,CAAqB95B,GAAU,CACnD,CACE96B,KAAM,QACNO,KAAM,cACNyoB,MAAO,eACP0rC,UAAW,WAEb,CACE10D,KAAM,QACNO,KAAM,cACNyoB,MAAO,eACP0rC,UAAW,WAEb,CACE10D,KAAM,QACNO,KAAM,SACNyoB,MAAO,gBAET,CACEhpB,KAAM,QACNgpB,MAAO,UACPgmC,MAAO,CAAC,CACJhvD,KAAM,WACNO,KAAM,UACNyoB,MAAO,mBAGX,GAwBA6rC,EAAgBnE,EAAQ7uD,OAAS,EAAI,CAAC,CACtC7B,KAAM,UACNO,KAAM,QACNyoB,MAAO,QACPgmC,MAAO0B,IACJ,GACP,OAAO+D,EAAiBzyD,OArEN,CAChB,CACEhC,KAAM,QACNO,KAAM,QACNyoB,MAAO,SAET,CACEhpB,KAAM,QACNO,KAAM,SACNyoB,MAAO,YA4DiChnB,OAAO2yD,GAAiB3yD,OA7BhD,CAAC,CACjBhC,KAAM,UACNO,KAAM,QACNyoB,MAAO,YACPgmC,MAAO,CACL,CACE3/C,KAAM,OACNpP,MAAO,IAET,CACEoP,KAAM,OACNpP,MAAO,QAET,CACEoP,KAAM,SACNpP,MAAO,UAET,CACEoP,KAAM,QACNpP,MAAO,aAU2E+B,OAAO6yD,IAG/FC,GAAY,SAAUzmD,EAAKqL,EAAKnZ,EAAMN,GACxC,GAAoB,OAAhByZ,EAAIuoC,SAAoC,OAAhBvoC,EAAIuoC,QAC1BvhD,EAASH,GACX8N,EAAI0iD,SAASr3C,EAAKnZ,EAAMN,GAExBoO,EAAI0iD,SAASr3C,EAAKnZ,QAGpB,GAAImZ,EAAIpF,SACN,IAAK,IAAI3O,EAAI,EAAGA,EAAI+T,EAAIpF,SAASzS,OAAQ8D,IACvCmvD,GAAUzmD,EAAKqL,EAAIpF,SAAS3O,GAAIpF,EAAMN,IA2C1C80D,GAAoB,SAAUj6B,EAAQ+rB,EAAU2K,EAAS7uC,GAC3D,IACIqyC,EADA3mD,EAAMysB,EAAOzsB,IAEbwvB,EAAOlb,EAAI8vC,UACXf,EAAelgD,GAASqsB,GAAM,SAAU59B,EAAO+R,GACjD,OAAOw/C,EAAQx/C,KAAS/R,KAE1B0iB,EAAI+vC,QACe,KAAf70B,EAAKm0B,cACAn0B,EAAKm0B,MAEdl3B,EAAO0a,YAAYmd,UAAS,WAC1B,IAAK9L,EAAU,CACb,IAAI/qC,EAAO/C,SAAS8kB,EAAK/hB,KAAM,KAAO,EAClC9B,EAAOjB,SAAS8kB,EAAK7jB,KAAM,KAAO,EACtC6sC,EAAWuE,GAAStwB,EAAQhf,EAAM9B,EAAM,EAAG,GAqB7C,GAnBIlI,GAAK4/C,GAAgB,KAvDJ,SAAU52B,EAAQ+rB,EAAUhpB,GACnD,IAAIxvB,EAAMysB,EAAOzsB,IACb6I,EAAQ,GACRoM,EAAS,GAgBb,GAfApM,EAAM86C,MAAQn0B,EAAKm0B,MACnB1uC,EAAOyJ,OAASkO,GAAY4C,EAAK9Q,QAC7B1e,EAAIitB,UAAUurB,EAAU,WAAavU,GAAmBxX,GAC1D5jB,EAAM0Y,MAhmJW,SAAU9d,GAC7B,OAAOA,EAAOA,EAAKjJ,QAAQ,MAAO,IAAM,GA+lJxBosD,CAAep3B,EAAKjO,OAElCtM,EAAOsM,MAAQqL,GAAY4C,EAAKjO,OAE9B0iB,GAAmBxX,IACrBxX,EAAO,gBAAkB2X,GAAY4C,EAAK0T,QAC1CjuB,EAAO,kBAAoB2X,GAAY4C,EAAKq3B,eAE5Ch+C,EAAMq6B,OAAS1T,EAAK0T,OACpBr6B,EAAMi+C,YAAct3B,EAAKs3B,YACzBj+C,EAAMg+C,YAAcr3B,EAAKq3B,aAEvB5iB,GAAmBxX,IAAW+rB,EAASvyC,SACzC,IAAK,IAAI3O,EAAI,EAAGA,EAAIkhD,EAASvyC,SAASzS,OAAQ8D,IAC5CmvD,GAAUzmD,EAAKw4C,EAASvyC,SAAS3O,GAAI,CACnC,eAAgBs1B,GAAY4C,EAAK0T,QACjCqC,QAAW3Y,GAAY4C,EAAKs3B,eAE1B9iB,GAAoBvX,IACtBg6B,GAAUzmD,EAAKw4C,EAASvyC,SAAS3O,GAAI,CAAE,eAAgBk4B,EAAK2xB,cAI9Dnd,GAAoBvX,KACtBxX,EAAO,oBAAsBua,EAAK4xB,gBAClCnsC,EAAO,gBAAkBua,EAAK2xB,YAC9BlsC,EAAO,gBAAkBua,EAAK0xB,aAEhCr4C,EAAMU,MAAQvJ,EAAI+mD,eAAepuD,EAASA,EAAS,GAAI6qC,GAAiB/W,IAAUxX,IAClFjV,EAAIgnD,WAAWxO,EAAU7/C,EAASA,EAAS,GAAI4qC,GAAqB9W,IAAU5jB,IAoB1Eo+C,CAAmBx6B,EAAQ+rB,EAAUhpB,IACrCm3B,EAAa3mD,EAAIqnC,OAAO,UAAWmR,GAAU,MAC1BhpB,EAAK03B,SACtBlnD,EAAIiJ,OAAO09C,IAERA,GAAcn3B,EAAK03B,WACtBP,EAAa3mD,EAAIyV,OAAO,YACbjV,UAAaylD,GAAS3oD,GA31J9B,IA21JmC,2BACtCk7C,EAASllC,aAAaqzC,EAAYnO,EAAS/kC,aAE1B,KAAf+b,EAAKm2B,MACPtF,GAAa5zB,EAAQ+rB,GAErB2H,GAAW1zB,EAAQ+rB,EAAUhpB,EAAKm2B,QAGtCl5B,EAAOkD,QACPlD,EAAOmxB,YACHn6C,GAAK4/C,GAAgB,EAAG,CAC1B,IAAI8D,EAAkBvjD,GAAIy/C,EAAc,WACpCxgB,GAAgBskB,GAAkB1jD,GAAK4/C,GAAgB,EAC3DzgB,GAAkBnW,EAAQ+rB,EAAU,CAClC1V,UAAWqkB,EACX59C,MAAOs5B,SAKXukB,GAAS,SAAU36B,EAAQ05B,GAC7B,IACI3N,EADAx4C,EAAMysB,EAAOzsB,IAEbwvB,EA9tBwB,SAAU/C,EAAQ46B,GAC9C,IAEyCrnD,EA8BnCsnD,EAKA/hB,EAjBAgiB,EApBFh+C,EAAQi6B,GAAiB/W,GACzB5jB,EAAQ06B,GAAqB9W,GA6B7B+6B,EAAWH,GA5B0BrnD,EA4BgBysB,EAAOzsB,IA3BvD,CACLkhD,YAAax9C,GAAM6F,EAAO,gBAAgBzU,MAAM,IAChDqsD,YAAaL,GAAS9gD,EAAT8gD,CAAcp9C,GAAM6F,EAAO,gBAAgBzU,MAAM,KAC9DssD,gBAAiBN,GAAS9gD,EAAT8gD,CAAcp9C,GAAM6F,EAAO,oBAAoBzU,MAAM,OAwBH,GAevE,OADW6D,EAASA,EAASA,EAASA,EAASA,EAASA,EAAS,GAnC/C,CAChB+lB,OAAQ,GACR6C,MAAO,OACPslC,YAAa,GACbC,YAAa,GACbI,SAAS,EACTvD,MAAO,GACPgC,MAAO,GACPziB,OAAQ,KA2ByE35B,GAAQV,GAAQ2+C,IAxB7FD,EAAch+C,EAAM,gBACpB06B,GAAmBxX,IAAW86B,EACzB,CAAErkB,OAAQqkB,GAEZ7jD,GAAMmF,EAAO,UAAUnU,MAAK,WACjC,MAAO,MACN,SAAUwuC,GACX,MAAO,CAAEA,OAAQA,SAKfokB,EAAU5jD,GAAM6F,EAAO,kBAAkBlU,GAAGqO,GAAMmF,EAAO,gBAAgBnU,MAAK,WAChF,MAAO,MACN,SAAUmyD,GACX,MAAO,CAAEA,YAAaA,MAEpBthB,EAAU7hC,GAAM6F,EAAO,kBAAkBlU,GAAGqO,GAAMmF,EAAO,gBAAgBnU,MAAK,WAChF,MAAO,MACN,SAAUoyD,GACX,MAAO,CAAEA,YAAaA,MAEjBnuD,EAASA,EAAS,GAAI2uD,GAAU/hB,KAmrB9BkiB,CAAwBh7B,EAAQuX,GAAoBvX,KACxC,IAAnB05B,GACF3N,EAAWx4C,EAAIgvB,UAAUvC,EAAOW,UAAUC,WAAY,QAASZ,EAAOrlB,YAEpEooB,EAlrB4B,SAAU/C,EAAQphB,EAAKg8C,GACvD,IAOIrnD,EAAMysB,EAAOzsB,IACjB,OAAOrH,EAAS,CACd4oB,MAAOvhB,EAAIgtB,SAAS3hB,EAAK,UAAYrL,EAAIitB,UAAU5hB,EAAK,SACxDqT,OAAQ1e,EAAIgtB,SAAS3hB,EAAK,WAAarL,EAAIitB,UAAU5hB,EAAK,UAC1Dw7C,YAAa7mD,EAAIgtB,SAAS3hB,EAAK,mBAAqBrL,EAAIitB,UAAU5hB,EAAK,eACvEy7C,YAAa9mD,EAAIitB,UAAU5hB,EAAK,gBAAkBy0C,GAAoBrzB,EAAOzsB,IAAKqL,EAAK,WACvF63B,OAbc,SAAUljC,EAAKqL,GAC7B,IAAIq8C,EAAiBx9C,GAAOjK,GAAaH,QAAQuL,GAAM,gBACvD,OAAI44B,GAAmBxX,IAAWi7B,EAAe7yD,SACxC6yD,EAAe5yD,MAAM,IAEvBkL,EAAIitB,UAAU5hB,EAAK,WAAay0C,GAAoBrzB,EAAOzsB,IAAKqL,EAAK,iBAAmBy0C,GAAoBrzB,EAAOzsB,IAAKqL,EAAK,UAQ5Hs8C,CAAU3nD,EAAKqL,GACvB67C,UAAWlnD,EAAIqnC,OAAO,UAAWh8B,GAAK,GACtCs4C,MAAO3jD,EAAIitB,UAAU5hB,EAAK,QAAS,IACnCs6C,MAAO1D,GAAcx1B,EAAQphB,IAC5Bg8C,EAAiBrG,GAAsBhhD,EAAKqL,GAAO,IAgqB3Cu8C,CAA4Bn7B,EAAQ+rB,EAAUxU,GAAoBvX,IAErEuX,GAAoBvX,KACtB+C,EAAK0xB,YAAc,GACnB1xB,EAAK2xB,YAAc,GACnB3xB,EAAK4xB,gBAAkB,KAI3B5xB,EAAK/hB,KAAO,IACZ+hB,EAAK7jB,KAAO,IACRq4B,GAAoBvX,KACtB+C,EAAK0xB,YAAc,GACnB1xB,EAAK2xB,YAAc,GACnB3xB,EAAK4xB,gBAAkB,KAG3B,IAAIiB,EAAU/B,GA7lGQ,SAAU7zB,GAChC,OAAOA,EAAO4W,SAAS,mBAAoB,GAAI,SA4lGlBwkB,CAAkBp7B,IAC3C41B,EAAQ7uD,OAAS,GACfg8B,EAAKm0B,QACPn0B,EAAKm0B,MAAQn0B,EAAKm0B,MAAMnpD,QAAQ,0BAA2B,KAG/D,IAAIstD,EAAe,CACjBn2D,KAAM,OACN4Z,QAAS,EACTo1C,MAAOuF,GAAWz5B,EAAQ41B,EAAS8D,IAqBjC4B,EAAa/jB,GAAoBvX,GAZ5B,CACL96B,KAAM,WACNizD,KAAM,CACJ,CACEnE,MAAO,UACPvuD,KAAM,UACNyuD,MAAO,CAACmH,IAEVnG,GAAe,WAdZ,CACLhwD,KAAM,QACNgvD,MAAO,CAACmH,IAiBZr7B,EAAOq4B,cAAcJ,KAAK,CACxBjE,MAAO,mBACPh9C,KAAM,SACN0D,KAAM4gD,EACN7C,SAAU/xD,EAAMuzD,GAAmBj6B,EAAQ+rB,EAAUhpB,GACrDu1B,QAAS,CACP,CACEpzD,KAAM,SACNO,KAAM,SACN8O,KAAM,UAER,CACErP,KAAM,SACNO,KAAM,OACN8O,KAAM,OACNgkD,SAAS,IAGbC,YAAaz1B,KAIbw4B,GAAmC,SAAUv7B,GAC/C,OAAOotB,GAA+B1sB,GAAkBV,GAASzU,GAAUyU,KAEzEw7B,GAA0B,SAAUx7B,GACtC,OAAOmtB,GAAsBzsB,GAAkBV,GAASzU,GAAUyU,KAEhEy7B,GAAmB,SAAUz7B,EAAQ2B,EAASC,EAAef,EAAY+B,GAC3E,IAAI3pB,EAASsS,GAAUyU,GAsCnB07B,EAAmB,SAAU39C,GAC/B,OAAOkB,GAAMlB,EAAM9E,IAEjB0iD,EAAc,SAAU18C,GAC1B,OAAO,SAAU8jB,GACf/C,EAAOW,UAAUqC,OAAOD,EAAKE,KAC7BjD,EAAOkD,QACPtB,EAAcuB,MAAMlkB,GACpBmhB,GAAgBnhB,GAChBk3B,GAAkBnW,EAAQ/gB,EAAM1L,IAAKwvB,EAAKirB,UAG1C4N,EAAiB,SAAU9N,GAC7B,OAAO0N,GAAwBx7B,GAAQj3B,MAAK,SAAUgV,GACpD29C,EAAiB39C,GAAMhV,MAAK,SAAUkW,GACpC,IAAI0jB,EAAUlB,GAAQZ,EAAY5hB,EAAOlB,GACzC+vC,EAAQ7uC,EAAO0jB,GAAS55B,KAAK4yD,EAAY18C,WAI3C48C,EAAmB,WACrB,OAAOL,GAAwBx7B,GAAQl3B,KAAI,SAAUiV,GACnD,OAAO29C,EAAiB39C,GAAM/U,MAAK,SAAUiW,GAC3C,IAAI0jB,EAAUlB,GAAQZ,EAAY5hB,EAAOlB,GACrC2kB,EAAatE,GAAe73B,EAAMiN,GAAaH,QAAQ2sB,EAAOyC,UAAWz4B,EAASxC,QACtF,OAAOurD,GAAS9zC,EAAO0jB,EAASD,UAIlCo5B,EAAmB,WACrB,OAAON,GAAwBx7B,GAAQl3B,KAAI,SAAUiV,GACnD,OAAO29C,EAAiB39C,GAAM/U,MAAK,SAAUiW,GAC3C,IAAI0jB,EAAUlB,GAAQZ,EAAY5hB,EAAOlB,GACzC,OAAOq0C,GAASnzC,EAAO0jB,UAIzBo5B,EAAmB,SAAUjO,EAASkO,GACxC,OAAOA,IAAUjzD,MAAK,SAAUmW,GAC9B,IAAI+8C,EAAanzD,EAAIoW,GAAM,SAAUI,GACnC,OAAOgQ,GAAKhQ,MAEdk8C,GAAwBx7B,GAAQj3B,MAAK,SAAUgV,GAC7C,OAAO29C,EAAiB39C,GAAMhV,MAAK,SAAUkW,GAC3C,IAAIyjB,EAAa/C,GAAMnsB,GAAaH,QAAQ2sB,EAAOyC,WAC/CE,EAlvJE,SAAU9B,EAAY9iB,EAAM6kB,EAAWF,GACrD,MAAO,CACL/B,UAAWA,GAAUE,GACrB+B,UAAWA,EACXF,WAAYA,GA8uJQw5B,CAAUr7B,EAAY9iB,EAAMk+C,EAAYv5B,GACtDorB,EAAQ7uC,EAAO0jB,GAAS55B,KAAK4yD,EAAY18C,cAKjD7I,GAAO,CACL+lD,mBAAoB,WAClB,OAAOP,EAAej6B,EAAQ6oB,eAEhC4R,mBAAoB,WAClB,OAAOR,EAAej6B,EAAQ4oB,aAEhC8R,wBAAyB,WACvB,OAAOT,EAAej6B,EAAQ0nB,mBAEhCiT,uBAAwB,WACtB,OAAOV,EAAej6B,EAAQ6nB,kBAEhC+S,wBAAyB,WACvB,OAAOX,EAAej6B,EAAQ+nB,sBAEhC8S,uBAAwB,WACtB,OAAOZ,EAAej6B,EAAQioB,qBAEhC6S,kBAAmB,WACjB,OAAOb,EAAej6B,EAAQ2sB,eAEhCoO,kBAAmB,WACjB,OAAOd,EAAej6B,EAAQ0sB,YAEhCsO,eAAgB,SAAUC,GACxB,OAAOd,IAAmB/yD,MAAK,SAAU43B,GACvCiC,EAAUi6B,WAAWl8B,GACrBi7B,EAAej6B,EAAQ2sB,kBAG3BwO,eAAgB,SAAUF,GACxB,OAAOf,IAAmB9yD,MAAK,SAAU43B,GACvCiC,EAAUm6B,QAAQp8B,GAClBi7B,EAAej6B,EAAQ0sB,eAG3B2O,gBAAiB,SAAUJ,GACzB,OAAOd,IAAmB/yD,MAAK,SAAU43B,GACvC,OAAOiC,EAAUi6B,WAAWl8B,OAGhCs8B,gBAAiB,SAAUL,GACzB,OAAOf,IAAmB9yD,MAAK,SAAU43B,GACvC,OAAOiC,EAAUm6B,QAAQp8B,OAG7Bu8B,uBAAwB,SAAUN,GAChC,OAAOb,EAAiBp6B,EAAQgpB,gBAAiB/nB,EAAUu6B,aAE7DC,sBAAuB,SAAUR,GAC/B,OAAOb,EAAiBp6B,EAAQkpB,eAAgBjoB,EAAUu6B,aAE5DE,uBAAwB,SAAUT,GAChC,OAAOb,EAAiBp6B,EAAQmpB,gBAAiBloB,EAAUo5B,UAE7DsB,sBAAuB,SAAUV,GAC/B,OAAOb,EAAiBp6B,EAAQopB,eAAgBnoB,EAAUo5B,UAE5DuB,eAnJe,WACf,OAAOhC,GAAiCv7B,GAAQj3B,MAAK,SAAUy0D,GAC7Dv+C,GAAMu+C,EAAevkD,GAAQ9P,OAAO/B,EAAI6R,IAASlQ,MAAK,SAAUkW,GAC9D,IAAIggC,EAASzrC,GAAac,SAAS,IAGnC,GAFA4L,GAAMjB,EAAOggC,GACbv3B,GAASzI,GACL+gB,EAAOzsB,IAAIkqD,QAAQz9B,EAAOrlB,WAC5BqlB,EAAO09B,WAAW,IAClB19B,EAAOW,UAAUg9B,wBACZ,CACL,IAAI16B,EAAMjD,EAAOzsB,IAAI26C,YACrBjrB,EAAIkrB,SAASlP,EAAO1rC,IAAK,GACzB0vB,EAAImrB,OAAOnP,EAAO1rC,IAAK,GACvBysB,EAAOW,UAAUqC,OAAOC,GACxBjD,EAAO49B,sBAsIbC,mBAAoB,SAAUC,EAAIjf,GAChC,OAlIgB,SAAUA,GAC5B,OAAO0c,GAAiCv7B,GAAQj3B,MAAK,SAAUy0D,GACxCtmB,GAAmBlX,IAAWgX,GAAehX,IAAWyX,GAAoBzX,IAE/F/gB,GAAMu+C,EAAevkD,GAAQlQ,MAAK,SAAUkW,GAC3B,aAAX4/B,GAA0BpU,GAAkBxrB,GAE1B,UAAX4/B,GAAuBnU,GAAgBzrB,GAE5B,eAAX4/B,GAA4BlU,GAAe1rB,IACpD05B,GAAY15B,GAFZw5B,GAAczY,EAAQ/gB,GAFtBs5B,GAAkBvY,EAAQ/gB,GAM5BmhB,GAAgBnhB,GAChBk3B,GAAkBnW,EAAQ/gB,EAAM1L,IAAK+iC,UAqHlCynB,CAAclf,MAEtB,SAAUmf,EAAMv4D,GACjB,OAAOu6B,EAAOi+B,WAAWx4D,EAAMu4D,MAEjC,IAAIE,EAAgC,SAAUl+B,EAAQ62B,GACpDA,EAAS9tD,MAAK,SAAUkW,GACtBk3B,GAAkBnW,EAAQ/gB,EAAM1L,IAAK+iC,QAGzClgC,GAAO,CACL+nD,iBAAkB,SAAUC,EAAKrxD,GAC/B,IAAI8pD,EAAW53C,GAAMyhB,GAAkBV,GAAS/mB,GAChD0oB,EAAQytB,iBAAiBpvB,EAAQjzB,GACjCmxD,EAA8Bl+B,EAAQ62B,IAExCwH,gBAAiB,SAAUD,EAAKrxD,GAC9B,IAAI8pD,EAAW53C,GAAMyhB,GAAkBV,GAAS/mB,GAChD0oB,EAAQ0tB,gBAAgBrvB,EAAQjzB,GAChCmxD,EAA8Bl+B,EAAQ62B,MAEvC,SAAUmH,EAAMv4D,GACjB,OAAOu6B,EAAOi+B,WAAWx4D,EAAMu4D,MAEjCh+B,EAAOi+B,WAAW,mBAAmB,SAAUG,EAAKrxD,GAClD,OAAOkK,GAAMlK,EAAM,QAAQhE,MAAK,SAAU7D,GACxC,OAAO02D,EAAwB,OAAT12D,EAAgBy8B,EAAQwoB,kBAAoBxoB,EAAQ2oB,2BAG9El0C,GAAO,CACLkoD,cAAe53D,EAAMi0D,GAAQ36B,GAAQ,GACrCu+B,iBAAkB73D,EAAM2yD,GAAQr5B,GAChCw+B,kBAAmB93D,EAAMuxD,GAAMj4B,EAAQa,KACtC,SAAUm9B,EAAMv4D,GACjB,OAAOu6B,EAAOi+B,WAAWx4D,GAAM,WAC7B,OAAOu4D,UAGXh+B,EAAOi+B,WAAW,kBAAkB,SAAUG,EAAKrxD,GAC7ClH,EAASkH,IAASoJ,GAAKpJ,GAAMhG,OAAS,EACxCwqD,GAA8BvxB,EAAQjzB,EAAKmS,KAAMnS,EAAK+R,QAAS/R,EAAKkkC,QAAS,+FAE7E0pB,GAAO36B,GAAQ,MAGnBA,EAAOi+B,WAAW,0BAA0B,SAAUG,EAAKrxD,GACzD,IAAI0xD,EAAgB,SAAU3hD,GAC5B,MAAO,YAAcA,EAAMrP,cAAcM,QAAQ,IAAK,KAExD,GAAKlI,EAASkH,GAAd,CAGA,IAAI2K,EAAQ21C,GAAsB3sB,GAAkBV,GAASa,EAAY5nB,GACzE,GAAqB,IAAjBvB,EAAM3Q,OAAV,CAGA,IAAI23D,EAAYhoD,GAAS3J,GAAM,SAAU5H,EAAO2X,GAC9C,OAAOkjB,EAAO2zB,UAAUx8C,IAAIsnD,EAAc3hD,KAAWlX,EAAST,OAt5OtD,SAAU8F,GACtB,IAAK,IAAI7F,KAAK6F,EACZ,GAAIqB,GAAezE,KAAKoD,EAAG7F,GACzB,OAAO,EAGX,OAAO,GAk5ODq4D,CAAQiB,KAGZtoD,GAAOsoD,GAAW,SAAUv5D,EAAO2X,GACjC/T,EAAK2O,GAAO,SAAUqG,GACpBo4C,GAAYC,OAAOp2B,EAAQjiB,EAAKxK,KAAK2iD,UAAUuI,EAAc3hD,GAAQ3X,SAGzEu2D,EAAiBhkD,EAAM,IAAI3O,MAAK,SAAUkW,GACxC,OAAOk3B,GAAkBnW,EAAQ/gB,EAAM1L,IAAK6iC,cAK9CuoB,GAAwB,SAAU3+B,EAAQ2B,EAASd,GACrD,IAAI5nB,EAASsS,GAAUyU,GAIvB5pB,GAAO,CACLioD,gBAAiB,WACf,OAAO18B,EAAQ2tB,gBAAgBtvB,IAEjCm+B,iBAAkB,WAChB,OAAOx8B,EAAQguB,iBAAiB3vB,IAElC4+B,gBAAiB,WACf,OAAOzR,GAAsBzsB,GAAkBV,IAASh3B,MAAK,SAAU+U,GACrE,OAZiB,SAAUA,GAC/B,OAAOkB,GAAMlB,EAAM9E,GAWRyiD,CAAiB39C,GAAMjV,KAAI,SAAUmW,GAC1C,IAAI0jB,EAAUlB,GAAQZ,EAAY5hB,EAAOlB,GACzC,OAAO4jB,EAAQiuB,gBAAgB3wC,EAAO0jB,SAEvCt6B,MAAM,OAEV,SAAU21D,EAAMv4D,GACjB,OAAOu6B,EAAO6+B,qBAAqBp5D,EAAMu4D,OA8BzCc,GAAc,CAChBC,yBAA0B,CACxBjqD,SAAU,QACV0T,OAAQ,CAAEw2C,gBAAiB,UAC3BC,gBAAgB,GAElBC,qBAAsB,CACpBpqD,SAAU,QACV0T,OAAQ,CAAE22C,YAAa,UACvBF,gBAAgB,GAElBG,qBAAsB,CACpBtqD,SAAU,QACV0T,OAAQ,CAAE62C,YAAa,UACvBJ,gBAAgB,GAElBK,qBAAsB,CACpBxqD,SAAU,QACV0T,OAAQ,CAAEsyC,YAAa,UACvBmE,gBAAgB,IAOhBM,GAAQlyC,GAAa,CACvB,CAAE7lB,KAAM,CAAC,YACT,CAAE6e,MAAO,CAAC,YACV,CACEgd,OAAQ,CACN,UACA,WAGJ,CAAEt3B,KAAM,CAAC,cAQPyzD,GAAetzD,EAASA,EAAS,GAAIqzD,IAAQ,CAAE/3D,KANtC,SAAUkH,GAIrB,YAHgB,IAAZA,IACFA,OAAUzI,GAELs5D,GAAM/3D,KAAKkH,MAIhB+wD,GAAW,SAAU/wD,EAASuK,GAChC,OAAOgG,GAAMvQ,EAASuK,GAAQjQ,MAAK,SAAUiW,GAC3C,IAAIhY,EAAMyQ,GAAMuH,GAIhB,OAHYxT,EAAUxE,GAAK,SAAU7B,GACnC,OAAOkQ,GAAK5G,EAAStJ,MAEV0D,KAAI,SAAU4Q,GACzB,MAAO,CACLA,MAAOA,EACPzS,IAAKA,UA8BTy4D,GARW,SAAU1wD,EAAO2wD,EAASn6C,EAAQo6C,GAC/C,MAAO,CACL5wD,MAAOA,EACP2wD,QAASA,EACTn6C,OAAQA,EACRo6C,QAASA,IAKTC,GAAQxyC,GAAa,CACvB,CAAEpN,OAAQ,CAAC,YACX,CACE4hB,GAAI,CACF,UACA,WAGJ,CAAE3hB,MAAO,CAAC,cAWR4/C,GAAO,CACT7/C,OAJa4/C,GAAM5/C,OAKnB4hB,GAJOg+B,GAAMh+B,GAKb3hB,MAJY2/C,GAAM3/C,MAKlBqO,KAbW,SAAUC,EAASuxC,EAAUC,EAAMC,GAC9C,OAAOzxC,EAAQvmB,KAAK83D,EAAUC,EAAMC,IAapCr/B,SAXa,SAAUs/B,GACvB,OAAOA,EAAKj4D,KAAKxB,EAAUA,EAAUA,KAanC05D,GAAQ9yC,GAAa,CACvB,CAAE+yC,SAAU,CAAC,QACb,CACEjrC,SAAU,CACR,YACA,eAGJ,CACEkrC,MAAO,CACL,QACA,UACA,SACA,cA4BFC,GAAe,CACjBF,SATaD,GAAMC,SAUnBjrC,SATagrC,GAAMhrC,SAUnBkrC,MATUF,GAAME,MAUhBE,eA5BmB,SAAUC,GAC7B,OAAOL,GAAME,MAAMG,EAASxxD,MAAOwxD,EAASb,QAASa,EAASh7C,OAAQg7C,EAASZ,UA4B/Ea,OAVW,SAAU9/B,GACrB,IAr+O0B9rB,EAq+OtB7F,EAjBW,SAAU2xB,GACzB,OAAOA,EAAUjrB,MAAM,CACrB0qD,SAAU,SAAUn9B,GAClB,OAAOzvB,GAAaH,QAAQ4vB,EAAIy9B,iBAElCvrC,SAAU,SAAUwrC,EAAWC,GAC7B,OAAOd,GAAKl/B,SAAS+/B,IAEvBN,MAAO,SAAUrxD,EAAO6xD,EAAUC,EAASC,GACzC,OAAO/xD,KAQCgyD,CAAWrgC,GACvB,OAt+O0B9rB,EAs+OP7F,EAr+OZwE,GAAaH,QAAQuF,GAAgB/D,GAAStB,IAAIqf,cA8+OzD7nB,MAPY20D,IAeVuB,GAA0B,SAAUh+B,EAAKpuB,GAC3C,OAAOouB,EAAIi+B,mBAAmBrsD,EAAQtB,MAoBpC4tD,GAAmB,SAAUxuC,EAAKguC,EAAWS,GAC/C,IAnBuBn+B,EAmBnBl4B,EAAQ4nB,EAAI9e,SAASwtD,cAGzB,OAtBuBp+B,EAoBdl4B,EAAO41D,EAnBX14D,MAAK,SAAUwQ,GAClBwqB,EAAIq+B,eAAe7oD,EAAElF,QACpB,SAAUkF,EAAG9Q,GACds7B,EAAIkrB,SAAS11C,EAAElF,IAAK5L,MACnB,SAAU8Q,GACXwqB,EAAIs+B,cAAc9oD,EAAElF,QAGR,SAAU0vB,EAAKi9B,GAC7BA,EAAKj4D,MAAK,SAAUwQ,GAClBwqB,EAAIu+B,aAAa/oD,EAAElF,QAClB,SAAUkF,EAAG9Q,GACds7B,EAAImrB,OAAO31C,EAAElF,IAAK5L,MACjB,SAAU8Q,GACXwqB,EAAIw+B,YAAYhpD,EAAElF,QAMpBmuD,CAAU32D,EAAOq2D,GACVr2D,GAEL42D,GAAgB,SAAUhvC,EAAK3jB,EAAO2wD,EAASn6C,EAAQo6C,GACzD,IAAI38B,EAAMtQ,EAAI9e,SAASwtD,cAGvB,OAFAp+B,EAAIkrB,SAASn/C,EAAMuE,IAAKosD,GACxB18B,EAAImrB,OAAO5oC,EAAOjS,IAAKqsD,GAChB38B,GAEL2+B,GAAS,SAAUC,GACrB,MAAO,CACLxvC,KAAMwvC,EAAKxvC,KACXC,IAAKuvC,EAAKvvC,IACVgR,MAAOu+B,EAAKv+B,MACZw+B,OAAQD,EAAKC,OACbhtC,MAAO+sC,EAAK/sC,MACZ7C,OAAQ4vC,EAAK5vC,SASb8vC,GAAQ10C,GAAa,CACvB,CACEqH,IAAK,CACH,QACA,UACA,SACA,YAGJ,CACEC,IAAK,CACH,QACA,UACA,SACA,cAIFqtC,GAAY,SAAUrvC,EAAKztB,EAAM6F,GACnC,OAAO7F,EAAKsO,GAAaH,QAAQtI,EAAM21D,gBAAiB31D,EAAMk3D,YAAazuD,GAAaH,QAAQtI,EAAMm3D,cAAen3D,EAAMo3D,YA+CzHC,GAAW,SAAUzvC,EAAKgO,GAE5B,OAjBe,SAAUhO,EAAK0vC,GAC9B,IAAIp/B,EAAMo/B,EAAO3tC,MACjB,OAAIuO,EAAIq/B,UACSD,EAAO1tC,MAAMxrB,QAAO,SAAUo5D,GAC3C,OAAyB,IAAlBA,EAAID,aAEGx5D,KAAI,SAAUy5D,GAC5B,OAAOR,GAAMptC,IAAInhB,GAAaH,QAAQkvD,EAAIL,cAAeK,EAAIJ,UAAW3uD,GAAaH,QAAQkvD,EAAI7B,gBAAiB6B,EAAIN,gBACrH35D,YAAW,WACZ,OAAO05D,GAAUrvC,EAAKovC,GAAMrtC,IAAKuO,MAG5B++B,GAAUrvC,EAAKovC,GAAMrtC,IAAKuO,GAK5Bu/B,CAAW7vC,EA/CJ,SAAUA,EAAKgO,GAC7B,OAAOA,EAAUjrB,MAAM,CACrB0qD,SAAU,SAAUn9B,GAClB,MAAO,CACLvO,IAAKluB,EAASy8B,GACdtO,IAAK3qB,EAASxC,OAGlB2tB,SAAU,SAAUwrC,EAAWS,GAC7B,MAAO,CACL1sC,IAAK7nB,GAAO,WACV,OAAOs0D,GAAiBxuC,EAAKguC,EAAWS,MAE1CzsC,IAAK9nB,GAAO,WACV,OAAO7C,EAASR,KAAK23D,GAAiBxuC,EAAKyuC,EAAYT,SAI7DN,MAAO,SAAUrxD,EAAO2wD,EAASn6C,EAAQo6C,GACvC,MAAO,CACLlrC,IAAK7nB,GAAO,WACV,OAAO80D,GAAchvC,EAAK3jB,EAAO2wD,EAASn6C,EAAQo6C,MAEpDjrC,IAAK9nB,GAAO,WACV,OAAO7C,EAASR,KAAKm4D,GAAchvC,EAAKnN,EAAQo6C,EAAS5wD,EAAO2wD,WAsB3D8C,CAAU9vC,EAAKgO,KAG1B+hC,GAAa,SAAU/vC,EAAKgO,GAE9B,OADgByhC,GAASzvC,EAAKgO,GACbjrB,MAAM,CACrBgf,IAAK,SAAU1lB,EAAO2wD,EAASn6C,EAAQo6C,GACrC,IAAI38B,EAAMtQ,EAAI9e,SAASwtD,cAGvB,OAFAp+B,EAAIkrB,SAASn/C,EAAMuE,IAAKosD,GACxB18B,EAAImrB,OAAO5oC,EAAOjS,IAAKqsD,GAChB38B,GAETtO,IAAK,SAAU3lB,EAAO2wD,EAASn6C,EAAQo6C,GACrC,IAAI38B,EAAMtQ,EAAI9e,SAASwtD,cAGvB,OAFAp+B,EAAIkrB,SAAS3oC,EAAOjS,IAAKqsD,GACzB38B,EAAImrB,OAAOp/C,EAAMuE,IAAKosD,GACf18B,MA2BT0/B,IAvBQZ,GAAMrtC,IACNqtC,GAAMptC,IAsBL,SAAUktC,EAAMz8D,EAAGuP,GAC9B,OAAOvP,GAAKy8D,EAAKxvC,MAAQjtB,GAAKy8D,EAAKv+B,OAAS3uB,GAAKktD,EAAKvvC,KAAO3d,GAAKktD,EAAKC,SAGrEc,GAAe,SAAUnoD,EAAKooD,EAAUz9D,EAAGuP,EAAGktD,GAChD,IAAIiB,EAAiB,SAAUn7D,GAC7B,IAAIsD,EAAIwP,EAAIlH,IAAI8tD,cAGhB,OAFAp2D,EAAEkjD,SAAS0U,EAAStvD,IAAK5L,GACzBsD,EAAEolD,UAAS,GACJplD,GAMLlE,EAASkhB,GAAM46C,GAAU97D,OACzBo0C,EApCe,SAAU4nB,EAAe39D,EAAGuP,EAAGquD,EAAMj8D,GACxD,GAAe,IAAXA,EACF,OAAO,EACF,GAAI3B,IAAM49D,EACf,OAAOj8D,EAAS,EAGlB,IADA,IAAIirC,EAASgxB,EACJn4D,EAAI,EAAGA,EAAI9D,EAAQ8D,IAAK,CAC/B,IAAIg3D,EAAOkB,EAAcl4D,GACrBo4D,EAAY//C,KAAKwO,IAAItsB,EAAIy8D,EAAKxvC,MAClC,GAAI1d,GAAKktD,EAAKC,OAAQ,CACpB,GAAIntD,EAAIktD,EAAKvvC,KAAO2wC,EAAYjxB,EAC9B,OAAOnnC,EAAI,EAEXmnC,EAASixB,GAIf,OAAO,EAkBMC,EALO,SAAUv7D,GAE5B,OADQm7D,EAAen7D,GACdqqB,0BAGgC5sB,EAAGuP,EAAGktD,EAAKv+B,MAAOv8B,GAC7D,OAAO+7D,EAAe3nB,IAsBpBgoB,GAAa,SAAU1oD,EAAKnH,EAAMlO,EAAGuP,GACvC,OAAO0D,GAAO/E,GArBH,SAAUmH,EAAKnH,EAAMlO,EAAGuP,GACnC,IAAI1J,EAAIwP,EAAIlH,IAAI8tD,cAChBp2D,EAAEm4D,WAAW9vD,EAAKC,KAClB,IAAI8vD,EAAQp4D,EAAEq4D,iBAId,OAHgBt3D,EAAQq3D,GAAO,SAAUxB,GACvC,OAAOc,GAAOd,EAAMz8D,EAAGuP,GAAK3K,EAASR,KAAKq4D,GAAQ73D,EAASxC,UAE5CsB,KAAI,SAAU+4D,GAC7B,OAAOe,GAAanoD,EAAKnH,EAAMlO,EAAGuP,EAAGktD,MAajB0B,CAAO9oD,EAAKnH,EAAMlO,EAAGuP,GATtB,SAAU8F,EAAKnH,EAAMlO,EAAGuP,GAC7C,IAAI1J,EAAIwP,EAAIlH,IAAI8tD,cACZxhC,EAAQrmB,GAASlG,GACrB,OAAOtH,EAAQ6zB,GAAO,SAAU73B,GAE9B,OADAiD,EAAEm4D,WAAWp7D,EAAEuL,KACRovD,GAAO13D,EAAE+mB,wBAAyB5sB,EAAGuP,GAAKwuD,GAAW1oD,EAAKzS,EAAG5C,EAAGuP,GAAK3K,EAASxC,UAIvCg8D,CAAiB/oD,EAAKnH,EAAMlO,EAAGuP,IAa7E8uD,GAAuB,SAAU5B,EAAMz8D,GACzC,OAAOA,EAAIy8D,EAAKxvC,KAAOwvC,EAAKv+B,MAAQl+B,GAElCs+D,GAAsB,SAAUjpD,EAAK9K,EAAQg0D,GAC/C,IAAI14D,EAAIwP,EAAIlH,IAAI8tD,cAGhB,OAFAp2D,EAAEm4D,WAAWzzD,EAAO4D,KACpBtI,EAAEolD,SAASsT,GACJ14D,GAEL24D,GAAkB,SAAUnpD,EAAKnH,EAAMlO,GACzC,IAAIy+D,EAAcppD,EAAIlH,IAAI8tD,cAC1BwC,EAAYT,WAAW9vD,EAAKC,KAC5B,IAAIsuD,EAAOgC,EAAY7xC,wBACnB2xC,EAAoBF,GAAqB5B,EAAMz8D,GAEnD,OAjBqB,OAgBbu+D,EAAyCt9C,GAAQuX,IAChDtqB,GAAMxK,KAAI,SAAU6G,GAC3B,OAAO+zD,GAAoBjpD,EAAK9K,EAAQg0D,OAGxCG,GAAgB,SAAUrpD,EAAKnH,EAAMlO,GACvC,IAAIy8D,EAAOvuD,EAAKC,IAAIye,wBAChB2xC,EAAoBF,GAAqB5B,EAAMz8D,GACnD,OAAO4E,EAASR,KAAKk6D,GAAoBjpD,EAAKnH,EAAMqwD,KAOlDI,GAAyB,SAAUtpD,EAAKrV,EAAGuP,GAC7C,OAAO3K,EAASC,KAAKwQ,EAAIlH,IAAIwwD,uBAAuB3+D,EAAGuP,IAAI3L,MAAK,SAAUwwB,GACxE,GAAuB,OAAnBA,EAAIwqC,WACN,OAAOh6D,EAASxC,OAElB,IAAIyD,EAAIwP,EAAIlH,IAAI8tD,cAGhB,OAFAp2D,EAAEkjD,SAAS30B,EAAIwqC,WAAYxqC,EAAI2hB,QAC/BlwC,EAAEolD,WACKrmD,EAASR,KAAKyB,OAGrBg5D,GAAsB,SAAUxpD,EAAKrV,EAAGuP,GAC1C,OAAO3K,EAASC,KAAKwQ,EAAIlH,IAAI0wD,oBAAoB7+D,EAAGuP,KAElDuvD,GAAkB,SAAUzpD,EAAKnH,EAAMlO,EAAGuP,GAC5C,IAAI1J,EAAIwP,EAAIlH,IAAI8tD,cAChBp2D,EAAEm4D,WAAW9vD,EAAKC,KAClB,IAAIsuD,EAAO52D,EAAE+mB,wBAGb,OA5Da,SAAUvX,EAAKnH,EAAMlO,EAAGuP,GACrC,IAAI1J,EAAIwP,EAAIlH,IAAI8tD,cAChBp2D,EAAEm4D,WAAW9vD,EAAKC,KAClB,IAAIsuD,EAAO52D,EAAE+mB,wBACTmyC,EAAWjhD,KAAKC,IAAI0+C,EAAKxvC,KAAMnP,KAAKgC,IAAI28C,EAAKv+B,MAAOl+B,IACpDg/D,EAAWlhD,KAAKC,IAAI0+C,EAAKvvC,IAAKpP,KAAKgC,IAAI28C,EAAKC,OAAQntD,IACxD,OAAOwuD,GAAW1oD,EAAKnH,EAAM6wD,EAAUC,GAsDhCC,CAAS5pD,EAAKnH,EAFN4P,KAAKC,IAAI0+C,EAAKxvC,KAAMnP,KAAKgC,IAAI28C,EAAKv+B,MAAOl+B,IACzC8d,KAAKC,IAAI0+C,EAAKvvC,IAAKpP,KAAKgC,IAAI28C,EAAKC,OAAQntD,MAGtD2vD,GAAkB,SAAU7pD,EAAKrV,EAAGuP,GACtC,OAAOnB,GAAaiB,UAAUgG,EAAKrV,EAAGuP,GAAG3L,MAAK,SAAUgM,GACtD,IAAIgJ,EAAW,WACb,OA9BO,SAAUvD,EAAKnH,EAAMlO,GAEhC,OADkC,IAA1BoU,GAASlG,GAAMvM,OAAe+8D,GAAgBF,IAC7CnpD,EAAKnH,EAAMlO,GA4BTiJ,CAAOoM,EAAKzF,EAAM5P,IAE3B,OAAiC,IAA1BoU,GAASxE,GAAMjO,OAAeiX,IAAakmD,GAAgBzpD,EAAKzF,EAAM5P,EAAGuP,GAAG9L,QAAQmV,OAG3FumD,GACE1wD,SAASkwD,uBACJA,GACElwD,SAASowD,oBACXA,GAEAK,GAUPE,GAAgB,SAAU3vD,EAASsmC,GACrC,IAAIspB,EAASh/D,GAAKoP,GAClB,MAAI,UAAY4vD,EACP3E,GAAK5/C,MAAMrL,GACRrK,EAAS,CACjB,KACA,OACCi6D,GAGe,IAAXtpB,EAAe2kB,GAAK7/C,OAAOpL,GAAWirD,GAAK5/C,MAAMrL,GAFjDirD,GAAKj+B,GAAGhtB,EAASsmC,IAKxBupB,GAAqB,SAAU/D,EAAWS,GAC5C,IAAIpyD,EAAQ2xD,EAAU14D,KAAK63D,GAAK7/C,OAAQukD,GAAe1E,GAAK5/C,OACxDsF,EAAS47C,EAAWn5D,KAAK63D,GAAK7/C,OAAQukD,GAAe1E,GAAK5/C,OAC9D,OAAOogD,GAAanrC,SAASnmB,EAAOwW,IAElCm/C,GAAkB,SAAU31D,EAAO2wD,EAASn6C,EAAQo6C,GACtD,IAAIe,EAAY6D,GAAcx1D,EAAO2wD,GACjCyB,EAAaoD,GAAch/C,EAAQo6C,GACvC,OAAOU,GAAanrC,SAASwrC,EAAWS,IAqBtCwD,GAAU,SAAU51D,EAAO2wD,EAASn6C,EAAQo6C,GAC9C,IAAI30D,EARU,SAAU+D,EAAO2wD,EAASn6C,EAAQo6C,GAChD,IACI38B,EADMvqB,GAAM1J,GACFuE,IAAI8tD,cAGlB,OAFAp+B,EAAIkrB,SAASn/C,EAAMuE,IAAKosD,GACxB18B,EAAImrB,OAAO5oC,EAAOjS,IAAKqsD,GAChB38B,EAGC4hC,CAAU71D,EAAO2wD,EAASn6C,EAAQo6C,GACtCkF,EAAOxvD,GAAKtG,EAAOwW,IAAWm6C,IAAYC,EAC9C,OAAO30D,EAAEq3D,YAAcwC,GAGrBC,GAAqB,SAAUpyC,GACjC,OAAO3oB,EAASC,KAAK0oB,EAAIqyC,iBAEvBC,GAAmB,SAAUtyC,EAAKsQ,GACpC8hC,GAAmBpyC,GAAK5pB,MAAK,SAAU43B,GACrCA,EAAUukC,kBACVvkC,EAAUwkC,SAASliC,OAGnBmiC,GAAa,SAAUzyC,EAAK3jB,EAAO2wD,EAASn6C,EAAQo6C,GACtD,IAAI38B,EAAM0+B,GAAchvC,EAAK3jB,EAAO2wD,EAASn6C,EAAQo6C,GACrDqF,GAAiBtyC,EAAKsQ,IAMpBoiC,GAAuB,SAAU1yC,EAAKwC,GACxC,OAAOitC,GAASzvC,EAAKwC,GAAUzf,MAAM,CACnCgf,IAAK,SAAU1lB,EAAO2wD,EAASn6C,EAAQo6C,GACrCwF,GAAWzyC,EAAK3jB,EAAO2wD,EAASn6C,EAAQo6C,IAE1CjrC,IAAK,SAAU3lB,EAAO2wD,EAASn6C,EAAQo6C,GACrCmF,GAAmBpyC,GAAK5pB,MAAK,SAAU43B,GACrC,GAAIA,EAAU2kC,iBACZ3kC,EAAU2kC,iBAAiBt2D,EAAMuE,IAAKosD,EAASn6C,EAAOjS,IAAKqsD,QACtD,GAAIj/B,EAAU4kC,OACnB,KAdc,SAAU5yC,EAAKgO,EAAW3xB,EAAO2wD,EAASn6C,EAAQo6C,GACxEj/B,EAAU0vB,SAASrhD,EAAMuE,IAAKosD,GAC9Bh/B,EAAU4kC,OAAO//C,EAAOjS,IAAKqsD,GAanB4F,CAAkB7yC,EAAKgO,EAAW3xB,EAAO2wD,EAASn6C,EAAQo6C,GAC1D,MAAOnnD,GACP2sD,GAAWzyC,EAAKnN,EAAQo6C,EAAS5wD,EAAO2wD,QAG1CyF,GAAWzyC,EAAKnN,EAAQo6C,EAAS5wD,EAAO2wD,UAM9C8F,GAAW,SAAU9yC,EAAK3jB,EAAO2wD,EAASn6C,EAAQo6C,GACpD,IAAIzqC,EAAWwvC,GAAgB31D,EAAO2wD,EAASn6C,EAAQo6C,GACvDyF,GAAqB1yC,EAAKwC,IAExBuwC,GAAc,SAAU/yC,EAAKguC,EAAWS,GAC1C,IAAIjsC,EAAWuvC,GAAmB/D,EAAWS,GAC7CiE,GAAqB1yC,EAAKwC,IAExBwwC,GAAW,SAAUhlC,GACvB,IAAIhO,EAAM2tC,GAAaG,OAAO9/B,GAAWptB,IACrCqyD,EAAc,SAAU52D,EAAO2wD,EAASn6C,EAAQo6C,GAClD,OAAO+B,GAAchvC,EAAK3jB,EAAO2wD,EAASn6C,EAAQo6C,IAEhDp8C,EA7EW,SAAUmd,GACzB,OAAOA,EAAUjrB,MAAM,CACrB0qD,SAAU,SAAUn9B,GAClB,IAAIj0B,EAAQwE,GAAaH,QAAQ4vB,EAAIy9B,gBACjCl7C,EAAShS,GAAaH,QAAQ4vB,EAAIi/B,cACtC,OAAOyC,GAAgB31D,EAAOi0B,EAAIg/B,YAAaz8C,EAAQyd,EAAIk/B,YAE7DhtC,SAAUuvC,GACVrE,MAAOsE,KAqEMkB,CAAWllC,GAC1B,OAAOyhC,GAASzvC,EAAKnP,GAAU9N,MAAM,CACnCgf,IAAKkxC,EACLjxC,IAAKixC,KAGLE,GAAY,SAAUnlC,GACxB,GAAIA,EAAUolC,WAAa,EAAG,CAC5B,IAAIC,EAAWrlC,EAAUslC,WAAW,GAChCC,EAAUvlC,EAAUslC,WAAWtlC,EAAUolC,WAAa,GAC1D,OAAO/7D,EAASR,KAAKk2D,GAAgBlsD,GAAaH,QAAQ2yD,EAAStF,gBAAiBsF,EAAS/D,YAAazuD,GAAaH,QAAQ6yD,EAAQhE,cAAegE,EAAQ/D,YAE9J,OAAOn4D,EAASxC,QAGhB2+D,GAAa,SAAUxlC,GACzB,GAA6B,OAAzBA,EAAUylC,YAA+C,OAAxBzlC,EAAU0lC,UAC7C,OAAOP,GAAUnlC,GAEjB,IAAI2lC,EAAS9yD,GAAaH,QAAQstB,EAAUylC,YACxCG,EAAU/yD,GAAaH,QAAQstB,EAAU0lC,WAC7C,OAAOzB,GAAQ0B,EAAQ3lC,EAAU6lC,aAAcD,EAAS5lC,EAAU8lC,aAAez8D,EAASR,KAAKk2D,GAAgB4G,EAAQ3lC,EAAU6lC,aAAcD,EAAS5lC,EAAU8lC,cAAgBX,GAAUnlC,IAG5L+lC,GAAe,SAAU/zC,EAAK9d,GAChC,IAAIouB,EAjamB,SAAUtQ,EAAK9d,GACtC,IAAIouB,EAAMtQ,EAAI9e,SAASwtD,cAEvB,OADAJ,GAAwBh+B,EAAKpuB,GACtBouB,EA8ZGi+B,CAAmBvuC,EAAK9d,GAClCowD,GAAiBtyC,EAAKsQ,IAOpB0jC,GAAQ,SAAUh0C,GACpB,OANa,SAAUA,GACvB,OAAOoyC,GAAmBpyC,GAAKxpB,QAAO,SAAUy9D,GAC9C,OAAOA,EAAIb,WAAa,KACvB/8D,KAAKm9D,IAGDU,CAASl0C,GAAK7pB,KAAI,SAAUiC,GACjC,OAAOu1D,GAAaD,MAAMt1D,EAAMiE,MAAOjE,EAAM40D,QAAS50D,EAAMya,OAAQza,EAAM60D,aAG1EkH,GAAiB,SAAUn0C,EAAKgO,GAElC,OAhYiB,SAAUsC,GAC3B,IAAIogC,EAAQpgC,EAAIqgC,iBACZzB,EAAOwB,EAAMt8D,OAAS,EAAIs8D,EAAM,GAAKpgC,EAAIjR,wBAC7C,OAAO6vC,EAAK/sC,MAAQ,GAAK+sC,EAAK5vC,OAAS,EAAIjoB,EAASR,KAAKq4D,GAAM/4D,IAAI84D,IAAU53D,EAASxC,OA6X/Eu/D,CADGrE,GAAW/vC,EAAKgO,KAGxBqmC,GAAa,SAAUr0C,EAAKvtB,EAAGuP,GACjC,OAtJgB,SAAUge,EAAKvtB,EAAGuP,GAClC,IAAI8F,EAAMjH,GAAaH,QAAQsf,EAAI9e,UACnC,OAAO0wD,GAAgB9pD,EAAKrV,EAAGuP,GAAG7L,KAAI,SAAUm6B,GAC9C,OAAOy8B,GAAgBlsD,GAAaH,QAAQ4vB,EAAIy9B,gBAAiBz9B,EAAIg/B,YAAazuD,GAAaH,QAAQ4vB,EAAIi/B,cAAej/B,EAAIk/B,cAmJzH8E,CAAYt0C,EAAKvtB,EAAGuP,IAQzBuyD,GAAWp4C,QAAQC,KAAKC,MAAMC,QAAQ,mBAEtCk4C,GAAU,SAAUnnC,EAAQ/mB,EAAQ8E,GACtC,OAAO2wB,GAAG1O,EAAQ/mB,EAtiBT,SAAUvK,EAASuK,GAE5B,OADgBwmD,GAAS/wD,EAASuK,GACjBhR,MAAK,WACpB,OAAOu3D,GAAah4D,KAAKkH,MACxB,SAAU0B,GACX,OAAOA,EAAKsJ,MAAQ,EAAItJ,EAAKnJ,IAAIF,OAASy4D,GAAan8B,OAAO30B,EAAS0B,EAAKnJ,IAAImJ,EAAKsJ,MAAQ,IAAM8lD,GAAazzD,KAAK2C,MAiiB7F8iB,CAAKzT,KAE7BqpD,GAAW,SAAUpnC,EAAQ/mB,EAAQ8E,GACvC,OAAO2wB,GAAG1O,EAAQ/mB,EAjiBT,SAAUvK,EAASuK,GAE5B,OADgBwmD,GAAS/wD,EAASuK,GACjBhR,MAAK,WACpB,OAAOu3D,GAAah4D,UACnB,SAAU4I,GACX,OAAOA,EAAKsJ,MAAQ,GAAK,EAAI8lD,GAAan8B,OAAO30B,EAAS0B,EAAKnJ,IAAImJ,EAAKsJ,MAAQ,IAAM8lD,GAAan5C,MAAM3X,MA4hBjF8vB,CAAKzgB,KAE7BspD,GAA6B,SAAUrnC,EAAQjiB,GACjD,IAAI4iB,EAAY2/B,GAAaD,MAAMtiD,EAAM,EAAGA,EAAM,GAClD,OAAO4nD,GAAShlC,IAUd+N,GAAK,SAAU1O,EAAQ/mB,EAAQ8E,GACjC,OAAOA,EAAK9V,KAAK+B,EAASxC,KAAMwC,EAASxC,MAAM,SAAUkH,EAAS8iB,GAChE,OAAOnL,GAAMmL,GAAM1oB,KAAI,SAAUiV,GAC/B,OAAOspD,GAA2BrnC,EAAQjiB,SAE3C,SAAUrP,GACX,OAAOuQ,GAAMvQ,EAASuK,GAAQjQ,MAAK,SAAUiW,GAE3C,OADA+gB,EAAOsnC,YAAY,0BAfK,SAAUtnC,EAAQ/gB,GAC9C,IAAIC,EAAO/D,GAAc8D,EAAO,MAChC,OAAOlT,EAAKmT,GAAMlW,MAAK,SAAU+C,GAC/B,OAAO6P,GAAa7P,EAAM,SAASjD,KAAI,SAAUud,GAC/C,OAAOghD,GAA2BrnC,EAAQ3Z,SAYnCkhD,CAAwBvnC,EAAQ/gB,UAIzCuoD,GAAe,CACjB,QACA,KACA,MA8BEC,GANW,SAAU9mC,EAAW0O,GAClC,MAAO,CACL1O,UAAWA,EACX0O,KAAMA,IAWNq4B,GANW,SAAU14D,EAAO2wD,EAASn6C,EAAQo6C,GAC/C,MAAO,CACL5wD,MAAO8wD,GAAKj+B,GAAG7yB,EAAO2wD,GACtBn6C,OAAQs6C,GAAKj+B,GAAGrc,EAAQo6C,KAKxB+H,GAAiB,SAAUh1C,EAAKgO,GAClC,IAAIsC,EAAMy/B,GAAW/vC,EAAKgO,GAC1B,OAAO++B,GAAgBlsD,GAAaH,QAAQ4vB,EAAIy9B,gBAAiBz9B,EAAIg/B,YAAazuD,GAAaH,QAAQ4vB,EAAIi/B,cAAej/B,EAAIk/B,YAE5HyF,GAAYF,GAaZG,GAAW,SAAUx8C,EAAWpS,EAAQjK,EAAOwW,EAAQsiD,GACzD,OAAKxyD,GAAKtG,EAAOwW,GAWRxb,EAASxC,OAVT8jB,GAAStc,EAAOwW,EAAQvM,GAAQjQ,MAAK,SAAU++D,GACpD,IAAIt8C,EAAQs8C,EAAQt8C,MAAMpjB,MAAM,IAChC,OAAIojB,EAAM1kB,OAAS,GACjB+gE,EAAYz8C,EAAWI,EAAOs8C,EAAQ/4D,MAAO+4D,EAAQviD,QAC9Cxb,EAASR,KAAKi+D,GAAgBz9D,EAASR,KAAKo+D,GAAU54D,EAAO,EAAGA,EAAOsuB,GAAOtuB,MAAU,KAExFhF,EAASxC,WAgBpBwgE,GAAW,SAAUzkD,EAAMupB,GAC7B,MAAO,CACLvpB,KAAMA,EACNupB,KAAMA,IAGNm7B,GAAY,SAAUl+C,EAAUxG,EAAM2kD,EAAYC,GAIpD,YAHmB,IAAfA,IACFA,EAAaC,IAERr+C,EAAS9M,WAAWnE,OAAOyK,GAAMza,KAAI,SAAUuD,GACpD,OAAO27D,GAAS37D,EAAG87D,OAGnBC,GAAW,SAAUr+C,EAAUxG,EAAMyW,EAAWmuC,GAIlD,YAHmB,IAAfA,IACFA,EAAaE,IAERruC,EAAUsuC,QAAQv+C,EAAUxG,GAAMza,KAAI,SAAUuD,GACrD,OAAO27D,GAAS37D,EAAG87D,OAGnBE,GAAU,SAAUt+C,EAAUxG,EAAMyW,EAAWmuC,QAC9B,IAAfA,IACFA,EAAaE,IAEf,IAAI7uD,EAAWuQ,EAAS9M,WAAWzD,SAAS+J,GAE5C,OADayW,EAAU3T,MAAM7M,GACf1Q,KAAI,SAAUmC,GAC1B,OAAO+8D,GAAS/8D,EAAGk9D,OAGnBI,GAAa,CACf,CACE75D,QAASu5D,GACTz2C,KAAM42C,GACNpqD,SAAUhU,EAASxC,QAErB,CACEkH,QAAS05D,GACT52C,KAAM62C,GACNrqD,SAAUhU,EAASR,KAAKy+D,KAE1B,CACEv5D,QAAS25D,GACT72C,KAAM62C,GACNrqD,SAAUhU,EAASR,KAAK4+D,MAGxBI,GAAO,SAAUz+C,EAAUxG,EAAMupB,EAAM9S,EAAWyuC,GAOpD,YANc,IAAVA,IACFA,EAAQF,IAEIj9D,EAAKm9D,GAAO,SAAUC,GAClC,OAAOA,EAAKh6D,UAAYo+B,KAEX9jC,MAAK,SAAU2/D,GAC5B,OAAOA,EAAKj6D,QAAQqb,EAAUxG,EAAMyW,EAAW2uC,EAAKn3C,MAAM3oB,SAAQ,WAChE,OAAO8/D,EAAK3qD,SAAShV,MAAK,SAAU+lC,GAClC,OAAOy5B,GAAKz+C,EAAUxG,EAAMwrB,EAAI/U,aA8BpC4uC,GAxBO,WAOT,MAAO,CACLN,QAPY,SAAUv+C,EAAUxG,GAChC,OAAOwG,EAASjX,QAAQuG,YAAYkK,IAOpC8C,MALU,SAAU7M,GACpB,OAAOA,EAASzS,OAAS,EAAIiD,EAASR,KAAKgQ,EAASA,EAASzS,OAAS,IAAMiD,EAASxC,UAmBrFohE,GAZQ,WAOV,MAAO,CACLN,QAPY,SAAUv+C,EAAUxG,GAChC,OAAOwG,EAASjX,QAAQyG,YAAYgK,IAOpC8C,MALU,SAAU7M,GACpB,OAAOA,EAASzS,OAAS,EAAIiD,EAASR,KAAKgQ,EAAS,IAAMxP,EAASxC,UAYnEqhE,GAAO,SAAU9+C,EAAUxG,EAAM1I,EAAWiyB,EAAM9S,EAAW/gB,GAE/D,OADWuvD,GAAKz+C,EAAUxG,EAAMupB,EAAM9S,GAC1BhxB,MAAK,SAAUhB,GACzB,OAAIiR,EAAOjR,EAAEub,MACJvZ,EAASxC,OAETqT,EAAU7S,EAAEub,MAAQvZ,EAASR,KAAKxB,EAAEub,MAAQslD,GAAK9+C,EAAU/hB,EAAEub,KAAM1I,EAAW7S,EAAE8kC,KAAM9S,EAAW/gB,OAW1G6vD,GAAS,SAAU/+C,GACrB,OAAO,SAAUlV,GACf,OAAwD,IAAjDkV,EAAS9M,WAAWzD,SAAS3E,GAAS9N,SAS7CgiE,GAlBS,SAAUh/C,EAAUxG,EAAM1I,EAAW5B,GAChD,OAAO4vD,GAAK9+C,EAAUxG,EAAM1I,EAAWutD,GAAUQ,KAAgB3vD,IAkB/D+vD,GAhBU,SAAUj/C,EAAUxG,EAAM1I,EAAW5B,GACjD,OAAO4vD,GAAK9+C,EAAUxG,EAAM1I,EAAWutD,GAAUQ,KAAiB3vD,IAiBhEgwD,GAAa7gD,KACb8gD,GAAW,SAAUr0D,EAASoE,GAChC,OAXa,SAAU8Q,EAAUxG,EAAMtK,GACvC,OAAO8vD,GAASh/C,EAAUxG,EAAMulD,GAAO/+C,GAAW9Q,GAU3CkwD,CAASF,GAAYp0D,EAASoE,IAEnCmwD,GAAU,SAAUv0D,EAASoE,GAC/B,OAXY,SAAU8Q,EAAUxG,EAAMtK,GACtC,OAAO+vD,GAAUj/C,EAAUxG,EAAMulD,GAAO/+C,GAAW9Q,GAU5CowD,CAAQJ,GAAYp0D,EAASoE,IAalCqwD,GAAQj8C,GAAa,CACvB,CAAE7lB,KAAM,CAAC,YACT,CAAE+hE,QAAS,IACX,CAAEC,SAAU,CAAC,SACb,CAAEC,WAAY,CAAC,WAObC,GAAQ,SAAU10D,GACpB,OAAO+G,GAAU/G,EAAM,OAuBrB20D,GAAcz9D,EAASA,EAAS,GAAIo9D,IAAQ,CAC9CM,OAtBW,SAAUC,EAAQ5pD,EAAQ6pD,EAAc5pD,EAAO6pD,EAAaC,EAAS/wD,GAChF,OAAO8C,GAAUmE,EAAO,QAASjH,GAAQjQ,MAAK,SAAUihE,GACtD,OAAOluD,GAAUkE,EAAQ,QAAShH,GAAQnQ,KAAI,SAAUohE,GACtD,OAAK50D,GAAK20D,EAAWC,GAUZ50D,GAAK4K,EAAO+pD,IAAc3sC,GAAO2sC,KAAeF,EAAcC,EAAQE,GAAcZ,GAAM9hE,KAAK,gBAT/F0jB,GAAYw+C,GAAO,CACxBO,EACAC,IACCjiE,MAAK,WACN,OAhBU,SAAU4hE,EAAQ5pD,EAAQC,GAC5C,IAAIiqD,EAAeN,EAAOO,QAAQnqD,GAC9BoqD,EAAcR,EAAOO,QAAQlqD,GACjC,OAAOmqD,EAAY/mC,MAAQ6mC,EAAa93C,MAAQg4C,EAAYh4C,KAAO83C,EAAa7mC,MAajEgnC,CAAcT,EAAQK,EAAYD,GAAaX,GAAMC,UAAYS,EAAQE,MAC/E,SAAUK,GACX,OAAOP,EAAQE,YAMpB7hE,MAAMihE,GAAM9hE,KAAK,aAOpB+mB,KALW,SAAUC,EAASC,EAAQ+7C,EAAWC,EAAYC,GAC7D,OAAOl8C,EAAQvmB,KAAKwmB,EAAQ+7C,EAAWC,EAAYC,MAuBjDrgE,GAAU,SAAUgd,EAAUxS,GAChC,OAAOpJ,EAAU4b,EAAU3gB,EAAM4O,GAAMT,KAGrC4yC,GAAO,SAAUzyC,GACnB,MAAsB,OAAfvP,GAAKuP,IAEV21D,GAAW,SAAUC,EAAMC,EAAQ5xD,GACrC,OAAO4xD,EAAOD,EAAM3xD,GAAQjQ,MAAK,SAAU2G,GACzC,OAAO0I,GAAO1I,IAA2C,IAAhCsY,GAAMtY,GAAQL,OAAOvI,OAAe4jE,GAASh7D,EAAQk7D,EAAQ5xD,GAAUjP,EAASR,KAAKmG,OAa9Gm7D,GAAe,SAAU7xD,EAAQpE,EAASsmC,EAAQnhB,GACpD,OANW,SAAUnlB,EAASsmC,GAC9B,OAAO1hC,GAAM5E,EAASsmC,GAAQhyC,OAAOs+C,IAAM5+C,SAAQ,WACjD,OAAO4Q,GAAM5E,EAASsmC,EAAS,GAAGhyC,OAAOs+C,OAIpCsjB,CAAOl2D,EAASsmC,GAAQnyC,MAAK,SAAUgiE,GAC5C,OAAOhxC,EAAUguC,SAASgD,GAAI/iE,MAAK,WACjC,OAAO0iE,GAASK,EAAIhxC,EAAU6wC,OAAQ5xD,GAAQnQ,IAAIkxB,EAAU7E,aAC3D,SAAU81C,GACX,OAnCc,SAAUp2D,GAC5B,OAAOiE,GAAOjE,GAAS7L,MAAK,SAAU8P,GACpC,IAAIoC,EAAa1B,GAASV,GAC1B,OAAOzO,GAAQ6Q,EAAYrG,GAAS/L,KAAI,SAAU4Q,GAChD,OAZS,SAAUZ,EAAQU,EAAU3E,EAAS6E,GAClD,MAAO,CACLZ,OAAQA,EACRU,SAAUA,EACV3E,QAASA,EACT6E,MAAOA,GAOEwxD,CAASpyD,EAAQoC,EAAYrG,EAAS6E,SA+BtCyxD,CAAcF,GAAUniE,KAAI,SAAUsH,GAC3C,OAAO0vD,GAAKj+B,GAAGzxB,EAAK0I,OAAQ1I,EAAKsJ,iBAKrC0xD,GAAQ,SAAUnyD,EAAQpE,EAASsmC,EAAQnhB,GAE7C,OADaytB,GAAK5yC,GAtBL,SAAUoE,EAAQpE,EAASmlB,GACxC,OAAOA,EAAUguC,SAASnzD,GAAShM,SAAQ,WACzC,OAAO8hE,GAAS91D,EAASmlB,EAAU6wC,OAAQ5xD,MAC1CnQ,IAAIkxB,EAAU7E,UAmBYk2C,CAASpyD,EAAQpE,EAASmlB,GAAa8wC,GAAa7xD,EAAQpE,EAASsmC,EAAQnhB,IAC5FlxB,KAAI,SAAUwiE,GAC1B,MAAO,CACLt8D,MAAOs8D,EACP9lD,OAAQ8lD,OAgBVC,GAAW,SAAUC,EAAOz2C,GAC9B,MAAO,CACL1C,KAAMm5C,EAAMn5C,KACZC,IAAKk5C,EAAMl5C,IAAMyC,EACjBuO,MAAOkoC,EAAMloC,MACbw+B,OAAQ0J,EAAM1J,OAAS/sC,IAGvB02C,GAAS,SAAUD,EAAOz2C,GAC5B,MAAO,CACL1C,KAAMm5C,EAAMn5C,KACZC,IAAKk5C,EAAMl5C,IAAMyC,EACjBuO,MAAOkoC,EAAMloC,MACbw+B,OAAQ0J,EAAM1J,OAAS/sC,IAGvBxC,GAAY,SAAUi5C,EAAOx5B,EAAQC,GACvC,MAAO,CACL5f,KAAMm5C,EAAMn5C,KAAO2f,EACnB1f,IAAKk5C,EAAMl5C,IAAM2f,EACjB3O,MAAOkoC,EAAMloC,MAAQ0O,EACrB8vB,OAAQ0J,EAAM1J,OAAS7vB,IAkBvBy5B,GAAU,SAAU7J,GACtB,MAAO,CACLxvC,KAAMwvC,EAAKxvC,KACXC,IAAKuvC,EAAKvvC,IACVgR,MAAOu+B,EAAKv+B,MACZw+B,OAAQD,EAAKC,SAGb6J,GAAa,SAAU9B,EAAQh1D,GACjC,OAAO7K,EAASR,KAAKqgE,EAAOO,QAAQv1D,KAElC+2D,GAAW,SAAU/B,EAAQh1D,EAASsmC,GACxC,OAAI/iC,GAAUvD,GACL82D,GAAW9B,EAAQh1D,GAAS/L,IAAI4iE,IAC9BrzD,GAAOxD,GAtBA,SAAUg1D,EAAQh1D,EAASsmC,GAC7C,OAAIA,GAAU,GAAKA,EAAS7d,GAAOzoB,GAC1Bg1D,EAAOgC,cAAch3D,EAASsmC,EAAQtmC,EAASsmC,EAAS,GACtDA,EAAS,EACX0uB,EAAOgC,cAAch3D,EAASsmC,EAAS,EAAGtmC,EAASsmC,GAErDnxC,EAASxC,OAiBPskE,CAAcjC,EAAQh1D,EAASsmC,GAAQryC,IAAI4iE,IAE3C1hE,EAASxC,QAGhBukE,GAAe,SAAUlC,EAAQh1D,GACnC,OAAIuD,GAAUvD,GACL82D,GAAW9B,EAAQh1D,GAAS/L,IAAI4iE,IAC9BrzD,GAAOxD,GACTg1D,EAAOgC,cAAch3D,EAAS,EAAGA,EAASyoB,GAAOzoB,IAAU/L,IAAI4iE,IAE/D1hE,EAASxC,QAMhBwkE,GAAQ3+C,GAAa,CACvB,CAAE7lB,KAAM,IACR,CAAEykE,MAAO,CAAC,YAKRC,GAAiB,SAAUrC,EAAQh1D,EAAS22D,GAC9C,OAttQsB73D,EAstQPkB,EAttQcgG,EAstQLqsC,GAltQjB5rC,IAHE,SAAU1R,EAAG+D,GACpB,OAAOA,EAAK/D,KAEe2R,GAAU5H,EAAOkH,EAAW5B,IAktQtBhR,KAAKX,GAAO,SAAUyW,GACvD,OAAOguD,GAAalC,EAAQ9rD,GAAM9U,QAAO,SAAUujB,GACjD,OANU,SAAUg/C,EAAOh/C,GAC/B,OAAOg/C,EAAMn5C,KAAO7F,EAAI6F,MAAQnP,KAAKwO,IAAIlF,EAAI8W,MAAQkoC,EAAMn5C,MAAQ,GAAKm5C,EAAMn5C,KAAO7F,EAAI8W,MAK9E6oC,CAAUX,EAAOh/C,SAxtQhB,IAAU7Y,EAAOkH,EAAW5B,GA0vQtCmzD,GAAe,CACjBlxB,MAzFc,SAAUswB,GACxB,OAAOA,EAAM1J,QAyFbuK,SAhCe,SAAUxC,EAAQh1D,EAASy3D,EAAUn9C,EAAUq8C,GAC9D,IAAIe,EAAahB,GAASC,EAjBZ,GAkBd,OAAItoD,KAAKwO,IAAI46C,EAASxK,OAAS3yC,EAAS2yC,QAAU,GAEvCwK,EAASh6C,IAAMk5C,EAAM1J,OADvBkK,GAAMC,MAAMM,GAGVD,EAASh6C,MAAQk5C,EAAM1J,OACzBkK,GAAMC,MAAMV,GAASC,EAAO,IAE5BU,GAAerC,EAAQh1D,EAAS22D,GAASQ,GAAMC,MAAM15C,GAAUg6C,EAzB1D,EAyBiF,IAAMP,GAAMxkE,QAwB3GolC,KAAM2+B,GACNV,OAAQzB,IAUNoD,GAAY,SAAU3C,EAAQ97B,EAAU5e,EAAUq8C,EAAOiB,GAC3D,OAAmB,IAAfA,EACKziE,EAASR,KAAKgiE,GAVT,SAAU3B,EAAQzkE,EAAGuP,GACnC,OAAOk1D,EAAOj1D,iBAAiBxP,EAAGuP,GAAGxL,QAAO,SAAUyV,GACpD,MAAqB,UAAdnZ,GAAKmZ,MACXxW,SASCskE,CAAU7C,EAAQ2B,EAAMn5C,KAAM0b,EAASmN,MAAMswB,IAP9B,SAAU3B,EAAQ97B,EAAU5e,EAAUq8C,EAAOiB,GAChE,OAAOD,GAAU3C,EAAQ97B,EAAU5e,EAAU4e,EAASnB,KAAK4+B,EA1D7C,GA0DgEiB,GAOrEE,CAAe9C,EAAQ97B,EAAU5e,EAAUq8C,EAAOiB,EAAa,GAEjE5C,EAAO+C,eAAepB,EAAMn5C,KAAM0b,EAASmN,MAAMswB,IAAQxiE,MAAK,SAAU6jE,GAC7E,OAAOA,EAAM79D,MAAM/G,KAAK+B,EAASxC,MAAM,SAAUqN,GAC/C,OAAOk3D,GAAalC,EAAQh1D,GAAS7L,MAAK,SAAUsjE,GAClD,OAAOv+B,EAASs+B,SAASxC,EAAQh1D,EAASy3D,EAAUn9C,EAAUq8C,GAAOvjE,KAAK+B,EAASxC,MAAM,SAAUslE,GACjG,OAAON,GAAU3C,EAAQ97B,EAAU5e,EAAU29C,EAAUL,EAAa,SAErE5jE,SAAQ,WACT,OAAOmB,EAASR,KAAKgiE,QAEtBxhE,EAASxC,UAkBZykE,GAAQ,SAAUl+B,EAAU87B,EAAQ2B,GACtC,IAAIuB,EAAQh/B,EAASnB,KAAK4+B,EA/FZ,GAgGVwB,EAAWR,GAAU3C,EAAQ97B,EAAUy9B,EAAOuB,EA/FlC,KA+FsD1kE,MAAM0kE,GAC5E,OAZgB,SAAUh/B,EAAUi/B,EAAUnD,GAC9C,OAAI97B,EAASmN,MAAM8xB,GAAYnD,EAAOoD,iBAC7BjjE,EAASR,KAAKukC,EAASmN,MAAM8xB,GAAYnD,EAAOoD,kBAC9Cl/B,EAASmN,MAAM8xB,GAAY,EAC7BhjE,EAASR,MAAMukC,EAASmN,MAAM8xB,IAE9BhjE,EAASxC,OAMX0lE,CAAYn/B,EAAUi/B,EAAUnD,GAAQ5hE,MAAK,WAClD,OAAO4hE,EAAO+C,eAAeI,EAAS36C,KAAM0b,EAASmN,MAAM8xB,OAC1D,SAAUz7C,GAEX,OADAs4C,EAAOsD,SAAS,EAAG57C,GACZs4C,EAAO+C,eAAeI,EAAS36C,KAAM0b,EAASmN,MAAM8xB,GAAYz7C,OAGvE67C,GAAU,CACZC,MAAO3mE,EAAMulE,GAjEE,CACf/wB,MAtFa,SAAUswB,GACvB,OAAOA,EAAMl5C,KAsFb+5C,SAda,SAAUxC,EAAQh1D,EAASy3D,EAAUn9C,EAAUq8C,GAC5D,IAAI8B,EAAc7B,GAAOD,EA7BX,GA8Bd,OAAItoD,KAAKwO,IAAI46C,EAASh6C,IAAMnD,EAASmD,KAAO,GAEjCg6C,EAASxK,OAAS0J,EAAMl5C,IAD1B05C,GAAMC,MAAMqB,GAGVhB,EAASxK,SAAW0J,EAAMl5C,IAC5B05C,GAAMC,MAAMR,GAAOD,EAAO,IAE1BU,GAAerC,EAAQh1D,EAAS22D,GAASQ,GAAMC,MAAM15C,GAAU+6C,EArC1D,EAqCkF,IAAMtB,GAAMxkE,QAM5GolC,KAAM6+B,GACNZ,OAAQ3B,KA8DRqE,QAAS7mE,EAAMulE,GAAOG,IACtBoB,QAzBY,SAAU3D,EAAQ2B,GAC9B,OAAO3B,EAAO+C,eAAepB,EAAMn5C,KAAMm5C,EAAMl5C,IAnFjC,IA4Gdm7C,UA7Bc,SAAU5D,EAAQ2B,GAChC,OAAO3B,EAAO+C,eAAepB,EAAMn5C,KAAMm5C,EAAM1J,OAhFjC,IA6Gd4L,YAAalnE,EA7GC,IAiHZmnE,GAAW,SAAU9D,EAAQ5wD,EAAQ+gB,GACvC,OAAO6vC,EAAO7E,eAAeh8D,MAAK,SAAU49D,GAC1C,OAAOwE,GAAMnyD,EAAQ2tD,EAAIphD,OAAQohD,EAAIhH,QAAS5lC,GAAW/xB,MAAK,WAC5D,OAAO+B,EAASR,KAAK0xC,GAAM0rB,EAAIphD,OAAQohD,EAAIhH,aAC1C,SAAUgO,GACX,IAAI7iE,EAAQ8+D,EAAOgE,UAAUD,GAE7B,OAzMQ,SAAUE,GACtB,OAAOnE,GAAYp7C,KAAKu/C,GAAU,SAAUC,GAC1C,OAAO/jE,EAASxC,UACf,WACD,OAAOwC,EAASxC,UACf,SAAUuW,GACX,OAAO/T,EAASR,KAAK0xC,GAAMn9B,EAAM,OAChC,SAAUA,GACX,OAAO/T,EAASR,KAAK0xC,GAAMn9B,EAAMuf,GAAOvf,QAiM/BiwD,CADQrE,GAAYC,OAAOC,EAAQjD,EAAIphD,OAAQohD,EAAIhH,QAAS70D,EAAMya,OAAQza,EAAM60D,QAAS5lC,EAAUgwC,QAAS/wD,WAKrHg1D,GAAS,SAAUpE,EAAQ5wD,EAAQpE,EAASsmC,EAAQnhB,EAAWyyC,GACjE,OAAmB,IAAfA,EACKziE,EAASxC,OAEX0mE,GAAUrE,EAAQ5wD,EAAQpE,EAASsmC,EAAQnhB,GAAWhxB,MAAK,SAAUmlE,GAC1E,IAAIpjE,EAAQ8+D,EAAOgE,UAAUM,GACzBL,EAAWnE,GAAYC,OAAOC,EAAQh1D,EAASsmC,EAAQpwC,EAAMya,OAAQza,EAAM60D,QAAS5lC,EAAUgwC,QAAS/wD,GAC3G,OAAO0wD,GAAYp7C,KAAKu/C,GAAU,WAChC,OAAO9jE,EAASxC,UACf,WACD,OAAOwC,EAASR,KAAK2kE,MACpB,SAAUpwD,GACX,OAAIzI,GAAKT,EAASkJ,IAAoB,IAAXo9B,EAClBizB,GAASvE,EAAQh1D,EAASsmC,EAAQswB,GAAQzxC,GAE1Ci0C,GAAOpE,EAAQ5wD,EAAQ8E,EAAM,EAAGic,EAAWyyC,EAAa,MAEhE,SAAU1uD,GACX,OAAIzI,GAAKT,EAASkJ,IAASo9B,IAAW7d,GAAOvf,GACpCqwD,GAASvE,EAAQh1D,EAASsmC,EAAQowB,GAAUvxC,GAE5Ci0C,GAAOpE,EAAQ5wD,EAAQ8E,EAAMuf,GAAOvf,GAAOic,EAAWyyC,EAAa,UAK9E2B,GAAW,SAAUvE,EAAQh1D,EAASsmC,EAAQvO,EAAM5S,GACtD,OAAO4xC,GAAS/B,EAAQh1D,EAASsmC,GAAQnyC,MAAK,SAAUwjB,GACtD,OAAO6hD,GAAMxE,EAAQ7vC,EAAW4S,EAAKpgB,EAAK4gD,GAAQM,oBAGlDW,GAAQ,SAAUxE,EAAQ7vC,EAAWxN,GACvC,IAAIhe,EAAU4E,KAAW5E,QACzB,OAAIA,EAAQ+B,YAAc/B,EAAQmC,YAAcnC,EAAQkC,aAAelC,EAAQ8B,SACtE0pB,EAAUs0C,WAAWzE,EAAQr9C,GAC3Bhe,EAAQgC,OACVwpB,EAAUu0C,QAAQ1E,EAAQr9C,GAE1BxiB,EAASxC,QAGhB0mE,GAAY,SAAUrE,EAAQ5wD,EAAQpE,EAASsmC,EAAQnhB,GACzD,OAAO4xC,GAAS/B,EAAQh1D,EAASsmC,GAAQnyC,MAAK,SAAUwjB,GACtD,OAAO6hD,GAAMxE,EAAQ7vC,EAAWxN,OAShCgiD,GAAc,SAAUx5D,EAAMiK,GAChC,OAvWO1D,GAuWWvG,GAAM,SAAUyD,GAChC,OAAOK,GAAOL,GAAGxP,QAAO,SAAUoD,GAChC,OAAOiJ,GAAKjJ,EAAG4S,QAzWehG,GAAQ7Q,SAD3B,IAA4B6Q,GA8WzCw1D,GAAW,SAAU5E,EAAQ5wD,EAAQ+gB,EAAWE,EAASosC,GAC3D,OAAOvqD,GAAUme,EAAS,QAASjhB,GAAQjQ,MAAK,SAAUgG,GACxD,OAAO+M,GAAU/M,EAAO,QAASiK,GAAQjQ,MAAK,SAAUiW,GACtD,OAAKuvD,GAAYlI,EAAQrnD,GAhBhB,SAAU4qD,EAAQ5wD,EAAQ+gB,GACvC,OAAO2zC,GAAS9D,EAAQ5wD,EAAQ+gB,GAAWhxB,MAAK,SAAU0lE,GACxD,OAAOT,GAAOpE,EAAQ5wD,EAAQy1D,EAAK75D,QAAS65D,EAAKvzB,OAAQnhB,EA5D3C,IA4DmElxB,IAAI+gE,EAAOgE,cAiBnFc,CAAS9E,EAAQ5wD,EAAQ+gB,GAAWhxB,MAAK,SAAU+B,GACxD,OAAOgR,GAAUhR,EAAMya,OAAQ,QAASvM,GAAQnQ,KAAI,SAAU0c,GAC5D,MAAO,CACLxW,MAAOA,EACPwW,OAAQA,EACRza,MAAOA,SAPJf,EAASxC,cAcpBonE,GAAW,SAAU/E,EAAQ5wD,EAAQ+gB,EAAWE,EAASosC,EAAQuI,GACnE,OAAIz7D,KAAW5E,QAAQgC,OACdxG,EAASxC,OAETqnE,EAAS30C,EAASjhB,GAAQpQ,SAAQ,WACvC,OAAO4lE,GAAS5E,EAAQ5wD,EAAQ+gB,EAAWE,EAASosC,GAAQx9D,KAAI,SAAUsH,GACxE,IAAIrF,EAAQqF,EAAKrF,MACjB,OAAO08D,GAAgBz9D,EAASR,KAAKo+D,GAAU78D,EAAMiE,MAAOjE,EAAM40D,QAAS50D,EAAMya,OAAQza,EAAM60D,WAAW,UAK9GkP,GAAe,SAAU50C,EAASjhB,GACpC,OAAO8C,GAAUme,EAAS,KAAMjhB,GAAQjQ,MAAK,SAAUub,GACrD,OAAOxI,GAAUwI,EAAU,QAAStL,GAAQjQ,MAAK,SAAUiW,GACzD,IAAIC,EAAO/D,GAAc8D,EAAO,MAChC,OAAI3J,GAAKiP,EAAUrF,EAAK,IAvZb,SAAUrK,EAASgG,EAAW5B,GAC7C,OAAO8vD,GAASE,GAAYp0D,EAASgG,EAAW5B,GAuZnC81D,CAAW9vD,GAAO,SAAUpK,GACjC,OAAO+oB,GAAO/oB,GAASzM,WACtB6Q,GAAQnQ,KAAI,SAAUiD,GACvB,IAAIijE,EAAa1xC,GAAOvxB,GACxB,OAAO07D,GAAgBz9D,EAASR,KAAKo+D,GAAU77D,EAAMijE,EAAYjjE,EAAMijE,KAAc,MAGhFhlE,EAASxC,cAKpBynE,GAAgB,SAAU/0C,EAASjhB,GACrC,OAAO8C,GAAUme,EAAS,KAAMjhB,GAAQjQ,MAAK,SAAUub,GACrD,OAAOxI,GAAUwI,EAAU,QAAStL,GAAQjQ,MAAK,SAAUiW,GACzD,IAAIC,EAAO/D,GAAc8D,EAAO,MAChC,OAAI3J,GAAKiP,EAAUrF,EAAKA,EAAKnY,OAAS,IAra1B,SAAU8N,EAASgG,EAAW5B,GAC9C,OAAO+vD,GAAUC,GAAYp0D,EAASgG,EAAW5B,GAqapCi2D,CAAYjwD,GAAO,SAAUpK,GAClC,OAAOwR,GAAMxR,GAASzM,WACrB6Q,GAAQnQ,KAAI,SAAUud,GACvB,OAAOohD,GAAgBz9D,EAASR,KAAKo+D,GAAUvhD,EAAO,EAAGA,EAAO,KAAK,MAGhErc,EAASxC,cAKpBozC,GAAS,SAAUivB,EAAQx+C,EAAWpS,EAAQ+gB,EAAWE,EAASosC,EAAQwB,GAC5E,OAAO2G,GAAS5E,EAAQ5wD,EAAQ+gB,EAAWE,EAASosC,GAAQt9D,MAAK,SAAUoH,GACzE,OAAOy3D,GAASx8C,EAAWpS,EAAQ7I,EAAKpB,MAAOoB,EAAKoV,OAAQsiD,OA0B5DqH,GAAW,SAAUx/D,EAAQsJ,GAC/B,OAAO8C,GAAUpM,EAAQ,QAASsJ,IAEhCm2D,GAAiB,SAAUvF,EAAQx+C,EAAWpS,EAAQo2D,GACxD,IAzBI7gD,EAyBAywB,GAzBAzwB,EAAUyL,GAAKjwB,EAASxC,QAarB,CACL27B,MAbU,WACV,OAAO3U,EAAQtS,IAAIlS,EAASxC,SAa5B0U,IAXQ,SAAUtS,GAClB,OAAO4kB,EAAQtS,IAAIlS,EAASR,KAAKI,KAWjC0lE,MATU,WACV,OAAO9gD,EAAQ3iB,MAAMzD,UASrBy5B,GAPO,SAAUx6B,GACjB,OAAOmnB,EAAQ3iB,MAAM9C,KAAK1B,MAexBkoE,EAAatwB,EAAO9b,MACpBqsC,EAAiB,SAAUpkC,GAC7B6T,EAAOpd,IAAG,SAAU7yB,GAClBqgE,EAAYI,kBAAkBpkD,GAC9B8jD,GAAS/jC,EAAMz7B,OAAQsJ,GAAQlQ,MAAK,SAAUyc,GAC5C8F,GAAStc,EAAOwW,EAAQvM,GAAQlQ,MAAK,SAAUg/D,GAC7C,IAAIt8C,EAAQs8C,EAAQt8C,MAAMpjB,MAAM,KAC5BojB,EAAM1kB,OAAS,GAAsB,IAAjB0kB,EAAM1kB,SAAiBuO,GAAKtG,EAAOwW,MACzD6pD,EAAYvH,YAAYz8C,EAAWI,EAAOs8C,EAAQ/4D,MAAO+4D,EAAQviD,QACjEqkD,EAAO6F,eAAelqD,cAiBhC,MAAO,CACL+pD,WAAYA,EACZx6B,UAbc,SAAU3J,GACxBikC,EAAYlsC,MAAM9X,GAClB8jD,GAAS/jC,EAAMz7B,OAAQsJ,GAAQlQ,KAAKk2C,EAAO/iC,MAY3Ci5B,UAVc,SAAU/J,GACxBokC,EAAepkC,IAUfukC,QARY,SAAUvkC,GACtBokC,EAAepkC,GACfmkC,OAUAhnD,GAAO,CACTy/C,SAAUzuD,GACVsxD,OAAQzB,GACRj0C,SAAU2qC,GAAK7/C,OACfquD,WAAYlB,GAAQG,QACpBgB,QAASnB,GAAQK,UACjBzD,QAASL,GAAYF,YAEnBphD,GAAK,CACP2/C,SAAU3uD,GACVwxD,OAAQ3B,GACR/zC,SAAU2qC,GAAK7/C,OACfquD,WAAYlB,GAAQC,MACpBkB,QAASnB,GAAQI,QACjBxD,QAASL,GAAYH,UAGnBoG,GAAQ,SAAU14D,GACpB,OAAO,SAAU24D,GACf,OAAOA,IAAY34D,IAGnB44D,GAAOF,GAAM,IACbG,GAASH,GAAM,IACfI,GAAe,SAAUH,GAC3B,OAAOA,GAAW,IAAMA,GAAW,IAEjCI,GAAQ,CACVC,WAAYN,GAAM,IAClBO,UAAWP,GAAM,KAEfQ,GAAQ,CACVF,WAAYN,GAAM,IAClBO,UAAWP,GAAM,KAiBfS,GAAe,SAAU19C,GAgE3B,MAAO,CACL/d,iBAhEqB,SAAUxP,EAAGuP,GAClC,OAAOnB,GAAaiB,UAAUjB,GAAaH,QAAQsf,EAAI9e,UAAWzO,EAAGuP,IAgErEy1D,QA9DY,SAAUv1D,GACtB,OAAOA,EAAQtB,IAAIye,yBA8DnB65C,cA5DkB,SAAU78D,EAAO2wD,EAASn6C,EAAQo6C,GACpD,IAAIgH,EAAMtG,GAAaD,MAAMrxD,EAAO2wD,EAASn6C,EAAQo6C,GACrD,OAAOkH,GAAen0C,EAAKi0C,IA2D3B5B,aAzDiB,WACjB,OAAO2B,GAAMh0C,GAAK7pB,KAAI,SAAUwnE,GAC9B,OAAO3I,GAAeh1C,EAAK29C,OAwD7BzC,UArDc,SAAUM,GACxB,IAAIh5C,EAAWmrC,GAAanrC,SAASg5C,EAAMn/D,MAAOm/D,EAAM3oD,QACxD,OAAOmiD,GAAeh1C,EAAKwC,IAoD3By3C,eAlDmB,SAAUxnE,EAAGuP,GAChC,OAAOqyD,GAAWr0C,EAAKvtB,EAAGuP,GAAG7L,KAAI,SAAUu3D,GACzC,OAAOqH,GAAarH,EAAMrxD,MAAOqxD,EAAMV,QAASU,EAAM76C,OAAQ66C,EAAMT,aAiDtE2Q,eA9CmB,YAh0BX,SAAU59C,GACpBoyC,GAAmBpyC,GAAK5pB,MAAK,SAAU43B,GACrC,OAAOA,EAAUukC,qBA+zBjB/hC,CAAMxQ,IA8CN69C,kBA5CsB,SAAUC,QAChB,IAAZA,IACFA,GAAU,GAEZ9J,GAAMh0C,GAAK5pB,MAAK,SAAU69D,GACxB,OAAOA,EAAI3+D,MAAK,SAAUg7B,GACxB,OAAOA,EAAIotB,SAASogB,MACnB,SAAU9P,EAAWS,GACtB,IAAIlB,EAAOuQ,EAAU9P,EAAYS,EACjCsE,GAAY/yC,EAAKutC,EAAMA,MACtB,SAAUlxD,EAAO2wD,EAASn6C,EAAQo6C,GACnC,IAAItsD,EAAOm9D,EAAUzhE,EAAQwW,EACzB21B,EAASs1B,EAAU9Q,EAAUC,EACjC6F,GAAS9yC,EAAKrf,EAAM6nC,EAAQ7nC,EAAM6nC,UAgCtCu1B,aAzBiB,SAAU9J,GAC3BnB,GAAS9yC,EAAKi0C,EAAI53D,MAAO43D,EAAIjH,QAASiH,EAAIphD,OAAQohD,EAAIhH,UAyBtD+Q,qBAvByB,SAAU3hE,EAAOwW,GAC1CkgD,GAAY/yC,EAAK3jB,EAAOwW,IAuBxBkqD,eA9BmB,SAAU76D,GAC7B6xD,GAAa/zC,EAAK9d,IA8BlBo4D,eAtBmB,WACnB,OAAOt6C,EAAIi+C,aAsBXC,WApBe,WACf,IAxEkBC,EAChBr2D,EACArV,EACAuP,EAsEF,OAzEkBm8D,EAwEFt9D,GAAaH,QAAQsf,EAAI9e,UAvEvC4G,OAAexU,IAAT6qE,EAAqBA,EAAKv9D,IAAMM,SACtCzO,EAAIqV,EAAIC,KAAKwY,YAAczY,EAAIoY,gBAAgBK,WAC/Cve,EAAI8F,EAAIC,KAAKsY,WAAavY,EAAIoY,gBAAgBG,UAC3CR,GAAcptB,EAAGuP,IAqEX2d,KAmBX66C,SAjBa,SAAU/nE,EAAGuP,IArErB,SAAUvP,EAAGuP,EAAGm8D,GACvB,IACIn+C,QADe1sB,IAAT6qE,EAAqBA,EAAKv9D,IAAMM,UAC5B+e,YACVD,GACFA,EAAIw6C,SAAS/nE,EAAGuP,GAkEhBo8D,CAAG3rE,EAAGuP,EAAGnB,GAAaH,QAAQsf,EAAI9e,cAoBlCm9D,GAAK,SAAU9xD,EAAM8B,GACvB,MAAO,CACL9B,KAAMA,EACN8B,KAAMA,IAaNiwD,GAAW,SAAUt+C,EAAKtH,EAAWpS,EAAQo2D,GAC/C,IAAIxF,EAASwG,GAAa19C,GACtBu+C,EAAkB,WAEpB,OADA7B,EAAYlsC,MAAM9X,GACXrhB,EAASxC,QAyElB,MAAO,CACL2pE,QAxEY,SAAU/lC,EAAOp8B,EAAO2wD,EAASn6C,EAAQo6C,EAAS5lC,GAC9D,IAAIo3C,EAAYhmC,EAAM1tB,IAClBmyD,EAAUuB,EAAUC,MACpBC,GAAkC,IAAvBF,EAAUE,SAmDzB,OAlDcplD,GAASb,EAAWgkD,EAAY1zC,kBAAkB1zB,MAAK,WACnE,OAAI8nE,GAAOF,IAAYyB,EACd5qE,EAAMk0C,GAAQivB,EAAQx+C,EAAWpS,EAAQsP,GAAM/C,EAAQxW,EAAOqgE,EAAYvH,aACxEgI,GAAKD,IAAYyB,EACnB5qE,EAAMk0C,GAAQivB,EAAQx+C,EAAWpS,EAAQoP,GAAI7C,EAAQxW,EAAOqgE,EAAYvH,aACtEiI,GAAOF,GACTnpE,EAAMkoE,GAAU/E,EAAQ5wD,EAAQsP,GAAM/C,EAAQxW,EAAOigE,IACnDa,GAAKD,GACPnpE,EAAMkoE,GAAU/E,EAAQ5wD,EAAQoP,GAAI7C,EAAQxW,EAAO8/D,IAEnD9kE,EAASxC,QAEjB,SAAU85B,GACX,IAAIiwC,EAAW,SAAUC,GACvB,OAAO,WAIL,OAHiBxlE,EAAQwlE,GAAU,SAAUjgD,GAC3C,OAlzBC,SAAUrS,EAAMJ,EAASuM,EAAWiW,EAAU+tC,GAMzD,OAAO9iD,GAAe+U,EAAUpiB,EAAMJ,EAASuwD,EAAYhjD,sBAAuBgjD,EAAY/iD,sBAAsBxjB,KAL9F,SAAU2oE,GAG9B,OAFApC,EAAYI,kBAAkBpkD,GAC9BgkD,EAAYvH,YAAYz8C,EAAWomD,EAAQhmD,MAAOgmD,EAAQziE,MAAOyiE,EAAQjsD,QAClEisD,EAAQhmD,SA8yBAwhB,CAAO1b,EAAMrS,KAAMqS,EAAMvQ,KAAMqK,EAAWiW,EAAU+tC,MAE3CpnE,MAAK,WACrB,OAAOmkB,GAASf,EAAWgkD,EAAYhjD,sBAAuBgjD,EAAY/iD,sBAAsBxjB,KAAI,SAAUgkB,GAC5G,IAAIqI,EAAW46C,GAAOF,IAAY71C,EAAUm2C,UAAUN,GAAW/P,GAAK5/C,MAAQ4/C,GAAK7/C,OAGnF,OAFA4pD,EAAO8G,qBAAqB7Q,GAAKj+B,GAAG/U,EAAMzG,MAAO,GAAI8O,EAASrI,EAAM7N,QACpEowD,EAAYlsC,MAAM9X,GACXo8C,GAAgBz9D,EAASxC,QAAQ,SAEzC,SAAUs5C,GACX,OAAO92C,EAASR,KAAKi+D,GAAgBz9D,EAASxC,QAAQ,SAI5D,OAAIuoE,GAAOF,IAAYyB,EACdC,EAAS,CAACP,GAAG,EAAI,KACflB,GAAKD,IAAYyB,EACnBC,EAAS,CAACP,IAAI,EAAG,KACfh3C,EAAUk2C,WAAWL,IAAYyB,EACnCC,EAAS,CACdP,GAAG,GAAI,GACPA,IAAI,EAAG,KAEAh3C,EAAUm2C,UAAUN,IAAYyB,EAClCC,EAAS,CACdP,GAAG,EAAG,GACNA,GAAG,EAAI,KAEAhB,GAAaH,KAAyB,IAAbyB,EAC3BJ,EAEAlnE,EAASxC,OAGbyjC,IAmBPymC,MAjBU,SAAUtmC,EAAOp8B,EAAO2wD,EAASn6C,EAAQo6C,GACnD,OAAO1zC,GAASb,EAAWgkD,EAAY1zC,kBAAkB1zB,MAAK,WAC5D,IAAImpE,EAAYhmC,EAAM1tB,IAClBmyD,EAAUuB,EAAUC,MAExB,OAAiB,MADqB,IAAvBD,EAAUE,UAEhBtnE,EAASxC,OAEdwoE,GAAaH,GAx3BZ,SAAUxkD,EAAWpS,EAAQjK,EAAO2wD,EAASn6C,EAAQo6C,EAASkI,GACvE,OAAMxyD,GAAKtG,EAAOwW,IAAWm6C,IAAYC,EAOhC51D,EAASxC,OANTuU,GAAU/M,EAAO,QAASiK,GAAQjQ,MAAK,SAAUY,GACtD,OAAOmS,GAAUyJ,EAAQ,QAASvM,GAAQjQ,MAAK,SAAU3B,GACvD,OAAOwgE,GAASx8C,EAAWpS,EAAQrP,EAAGvC,EAAGygE,SAq3BlC6J,CAAKtmD,EAAWpS,EAAQjK,EAAO2wD,EAASn6C,EAAQo6C,EAASyP,EAAYvH,aAErE99D,EAASxC,SAEjBwC,EAASxC,SAgGZoqE,GAjCS,SAAU1wC,EAAU2wC,EAAaC,GAC5C,IAAIC,EAA4B,SAAUl9D,GACxC2H,GAAO3H,EAASqsB,EAASI,UACzB9kB,GAAO3H,EAASqsB,EAASK,eACzB/kB,GAAO3H,EAASqsB,EAASM,eAEvBwwC,EAAwB,SAAUn9D,GACpCqH,GAAIrH,EAASqsB,EAASI,SAAU,MAE9B6B,EAAQ,SAAU9X,GACpBokD,EAAkBpkD,GAClBymD,KAEErC,EAAoB,SAAUpkD,GAChC,IAAIc,EAAOhR,GAAckQ,EAAW6V,EAASvF,kBAC7C5yB,EAAKojB,EAAM4lD,IASb,MAAO,CACLtC,kBAAmBA,EACnBtsC,MAAOA,EACP2kC,YAVgB,SAAUz8C,EAAW3T,EAAO1I,EAAOwW,GACnD2d,EAAM9X,GACNtiB,EAAK2O,EAAOs6D,GACZ91D,GAAIlN,EAAOkyB,EAASK,cAAe,KACnCrlB,GAAIsJ,EAAQ0b,EAASM,aAAc,KACnCqwC,EAAYn6D,EAAO1I,EAAOwW,IAM1BmW,iBAAkBuF,EAASvF,iBAC3BtP,sBAAuB6U,EAAS7U,sBAChCC,qBAAsB4U,EAAS5U,uBA4B/B2lD,GAAgB,SAAUhzD,EAAOtP,EAAQ+yB,GAC3C,IAAI7gB,EAAYuB,GAAUxD,UAAUX,GAEpC,OADcqgC,GAAQz9B,EAAWlS,GAClB7G,KAAI,SAAUyzB,GAC3B,IAAI3b,EAAOg9B,GAAO/7B,EAAW6gB,GAAY,GAGzC,MAAO,CACLwvC,cA5BiB,SAAUtxD,EAAM2b,EAAemG,GACpD,IAAIyvC,EAASvxD,EAAKzW,MAAM,EAAGoyB,EAAcA,EAAcx1B,OAAS,GAAGuY,IAAM,GACrE8yD,EAAYj0B,GAAag0B,EAAQzvC,GACrC,OAAO15B,EAAKopE,GAAW,SAAU96D,GAC/B,IAAI+6D,EAAc/6D,EAAOI,MAAMvN,MAAM,EAAGoyB,EAAcA,EAAcx1B,OAAS,GAAGyY,OAAS,GACzF,OAAO1W,EAAIupE,GAAa,SAAUt0D,GAChC,OAAOA,EAAKlJ,cAmBMy9D,CAAiB1xD,EAAM2b,EAAemG,GAIxD6vC,iBAnBoB,SAAU3xD,EAAM2b,EAAemG,GACvD,IAAI8vC,EAAW5xD,EAAKzW,MAAMoyB,EAAc,GAAGjd,IAAMid,EAAc,GAAGhlB,QAAU,EAAGqJ,EAAK7Z,QAChF0rE,EAAct0B,GAAaq0B,EAAU9vC,GACzC,OAAO15B,EAAKypE,GAAa,SAAUn7D,GACjC,IAAI+6D,EAAc/6D,EAAOI,MAAMvN,MAAMoyB,EAAc,GAAG/c,OAAS+c,EAAc,GAAG/kB,QAAU,EAAGF,EAAOI,MAAM3Q,QAC1G,OAAO+B,EAAIupE,GAAa,SAAUt0D,GAChC,OAAOA,EAAKlJ,cAUS69D,CAAoB9xD,EAAM2b,EAAemG,QAQhEiwC,GAAoB,SAAUl6D,GAChC,OAA8E,IAAvEk4B,GAAMn9B,GAAaH,QAAQoF,EAAE9I,QAAS,8BAE/C,SAASijE,GAAe5yC,EAAQsZ,EAAYu5B,GAC1C,IAcIxD,EAAcuC,GAA2B1wC,IAd3B,SAAUxpB,EAAO1I,EAAOwW,GACxCqtD,EAAiBlwC,UAAU55B,MAAK,SAAU45B,GACzB1jB,GAAMjQ,GACZjG,MAAK,SAAUkW,GACtB,IAAIogB,EAAe4Y,GAAiBjY,GAChC0C,EAAatE,GAAe73B,EAAMiN,GAAaH,QAAQ2sB,EAAOyC,UAAWpD,GACzEyzC,EAAab,GAAchzD,EAAO0jB,EAASD,IA5rKxB,SAAU1C,EAAQtoB,EAAO1I,EAAOwW,EAAQstD,GACrE9yC,EAAOiW,KAAK,uBAAwB,CAClCv+B,MAAOA,EACP1I,MAAOA,EACPwW,OAAQA,EACRstD,WAAYA,IAwrKRC,CAAyB/yC,EAAQtoB,EAAO1I,EAAOwW,EAAQstD,YAI/C,WACZ,OA1rK0B,SAAU9yC,GACtCA,EAAOiW,KAAK,uBAyrKH+8B,CAAwBhzC,MA8HjC,OA3HAA,EAAO6B,GAAG,QAAQ,SAAUoxC,GAC1B,IAAItgD,EAAMqN,EAAOygC,SACb/lD,EAAOqlB,GAAUC,GACjB/mB,EAASsS,GAAUyU,GAanBkzC,EA/PI,SAAUvgD,EAAKtH,EAAWpS,EAAQo2D,GAC5C,IAAIxF,EAASwG,GAAa19C,GACtBqY,EAAWokC,GAAevF,EAAQx+C,EAAWpS,EAAQo2D,GACzD,MAAO,CACLE,WAAYvkC,EAASukC,WACrBx6B,UAAW/J,EAAS+J,UACpBI,UAAWnK,EAASmK,UACpBw6B,QAAS3kC,EAAS2kC,SAwPEwD,CAAMxgD,EAAKjY,EAAMzB,EAAQo2D,GACzC+D,EAAcnC,GAASt+C,EAAKjY,EAAMzB,EAAQo2D,GAC1CgE,EArKO,SAAU1gD,EAAKtH,EAAWpS,EAAQo2D,GAC/C,IAAIxF,EAASwG,GAAa19C,GAC1B,OAAO,SAAU3jB,EAAOwW,GACtB6pD,EAAYI,kBAAkBpkD,GAC9BC,GAAStc,EAAOwW,EAAQvM,GAAQlQ,MAAK,SAAUg/D,GAC7C,IAAIt8C,EAAQs8C,EAAQt8C,MAAMpjB,MAAM,IAChCgnE,EAAYvH,YAAYz8C,EAAWI,EAAOs8C,EAAQ/4D,MAAO+4D,EAAQviD,QACjEqkD,EAAO6F,eAAelqD,GACtBqkD,EAAO2G,wBA6JQ8C,CAAS3gD,EAAKjY,EAAMzB,EAAQo2D,GAI7CrvC,EAAO6B,GAAG,uBAAuB,SAAUppB,GACzC,OAAO46D,EAAW56D,EAAEzJ,MAAOyJ,EAAE+M,WAE/B,IAuEM+tD,EACAC,EAxEFC,EAAiB,SAAUroC,EAAOsoC,IANpB,SAAUtoC,GAC1B,OAA8B,IAAvBA,EAAM1tB,IAAI4zD,UAMZqC,CAAYvoC,KAGbsoC,EAASrkC,MACXjE,EAAMiE,OAERqkC,EAAS/yC,UAAU53B,MAAK,SAAU6qE,GAChC,IAAIz+C,EAAWmrC,GAAanrC,SAASy+C,EAAG5kE,MAAO4kE,EAAGpuD,QAC9Cyd,EAAMy/B,GAAW/vC,EAAKwC,GAC1B6K,EAAOW,UAAUqC,OAAOC,QA8BxB4wC,EAAc,SAAUn2D,GAC1B,OAAsB,IAAfA,EAAIo2D,QA+CTC,GAjBER,EAAat5C,GAAKzmB,GAAaH,QAAQqH,IACvC84D,EAAgBv5C,GAAK,GAclB,CAAE+5C,SAbM,SAAUhvE,GACvB,IAAI2K,EAAS6D,GAAaH,QAAQrO,EAAE2K,QACpC,GAAqB,OAAjBlK,GAAKkK,IAAqC,OAAjBlK,GAAKkK,GAAkB,CAClD,IAAIskE,EAAKV,EAAW1nE,MAChBqoE,EAAMV,EAAc3nE,MACpByJ,GAAK2+D,EAAItkE,IAAW3K,EAAEmvE,UAAYD,EAAM,MAC1ClvE,EAAE88B,iBACFuxC,EAAW1jE,EAAQA,IAGvB4jE,EAAWr3D,IAAIvM,GACf6jE,EAAct3D,IAAIlX,EAAEmvE,cAKxBn0C,EAAO6B,GAAG,aArCM,SAAUoxC,GACxBC,EAAc3D,gBAqChBvvC,EAAO6B,GAAG,aAnCM,SAAUppB,GACpBo7D,EAAYp7D,IAAMk6D,GAAkBl6D,IACtCy6D,EAAcn+B,UAAU7E,GAAez3B,OAkC3CunB,EAAO6B,GAAG,aA/BM,SAAUppB,GAjBA,IAAUiF,QACdzX,KADcyX,EAkBVjF,GAjBhB6/C,SAGJkB,GAAShrD,QAAQ8B,UAA4B,IAAhBoN,EAAI46C,SAGR,IAAP,EAAd56C,EAAI46C,WAWkBqa,GAAkBl6D,IAC9Cy6D,EAAc/9B,UAAUjF,GAAez3B,OA8B3CunB,EAAO6B,GAAG,WA3BI,SAAUppB,GAClBo7D,EAAYp7D,IAAMk6D,GAAkBl6D,IACtCy6D,EAAcvD,QAAQz/B,GAAez3B,OA0BzCunB,EAAO6B,GAAG,WAAYkyC,EAAUC,UAChCh0C,EAAO6B,GAAG,SAjFE,SAAUuJ,GACpB,IAAIgpC,EAAelkC,GAAe9E,GAClC,GAAIgpC,EAAa12D,IAAI4zD,UAAYtB,GAAaoE,EAAa12D,IAAI2zD,OAAQ,CACrE,IAAIpuC,EAAMjD,EAAOW,UAAU2Z,SACvBtrC,EAAQwE,GAAaH,QAAQ4vB,EAAIy9B,gBACjCv2C,EAAM3W,GAAaH,QAAQ4vB,EAAIi/B,cACnCkR,EAAY1B,MAAM0C,EAAcplE,EAAOi0B,EAAIg/B,YAAa93C,EAAK8Y,EAAIk/B,WAAWp5D,MAAK,SAAU2qE,GACzFD,EAAeW,EAAcV,UA2EnC1zC,EAAO6B,GAAG,WAvEI,SAAUuJ,GACtB,IAAIgpC,EAAelkC,GAAe9E,GAClCkO,IAAavwC,MAAK,SAAU06B,GAC1B,OAAOA,EAAO4R,cAEhB,IAAIpS,EAAMjD,EAAOW,UAAU2Z,SACvBtrC,EAAQwE,GAAaH,QAAQ4vB,EAAIy9B,gBACjCv2C,EAAM3W,GAAaH,QAAQ4vB,EAAIi/B,cAC/BloC,EAAYrI,GAAYs+C,GAAOG,GAAnBz+C,CAA0Bne,GAAaH,QAAQ2sB,EAAOW,UAAUC,aAChFwyC,EAAYjC,QAAQiD,EAAcplE,EAAOi0B,EAAIg/B,YAAa93C,EAAK8Y,EAAIk/B,UAAWnoC,GAAWjxB,MAAK,SAAU2qE,GACtGD,EAAeW,EAAcV,MAE/Bp6B,IAAavwC,MAAK,SAAU06B,GAC1B,OAAOA,EAAO6R,iBA2DlBtV,EAAO6B,GAAG,cArHU,WAClB,IAAI+kC,EAAM5mC,EAAOW,UACb3xB,EAAQwE,GAAaH,QAAQuzD,EAAIhmC,YACjCzW,EAAM3W,GAAaH,QAAQuzD,EAAItpC,UACtBpS,GAAYjM,GAAO,CAC9BjQ,EACAmb,IAEKliB,MAAK,WACV,OAAOonE,EAAYlsC,MAAMzoB,KACxBnU,SA6GA,CAAE48B,MAAOksC,EAAYlsC,OAG9B,IAAIkxC,GAAsB,SAAUr0C,EAAQa,GAC1C,IAAI8B,EAAU1I,GAAKjwB,EAASxC,QACxB8sE,EAAiBr6C,GAAK,IACtBs6C,EAAmBvqE,EAASxC,OAC5BgtE,EAAYh8D,GAAM,WAClBi8D,EAAyB,SAAUv9D,GACrC,OAAOq9D,EAAiBrrE,QAAO,SAAUu0C,GACvC,OAAQA,EAAQvmC,OAGhBw9D,EAAc,WAChB,OAAOtnB,GAA+B1sB,GAAkBV,GAASzU,GAAUyU,IAASh3B,MAAK,SAAUw0D,GAEjG,OADcv+C,GAAMu+C,GACL10D,KAAI,SAAUmW,GAC3B,OAAIu1D,EAAUhX,GA1xNT,SAAUz/C,GACrB,MAAO,CACLlJ,QAASkJ,EACTkjB,SAAUj3B,EAASxC,OACnBs5B,WAAY92B,EAASxC,OACrBm5B,UAAW,CAAC5iB,IAsxNC42D,CAAOnX,GAEP/7B,GAAQZ,EAAY5hB,EAAOu+C,UAKtCoX,EAAsB,SAAUjyC,GAElC,OADe1jB,GAAM0jB,EAAQ9tB,SACb/L,KAAI,SAAUmW,GAC5B,IAAI4C,EAAYuB,GAAUxD,UAAUX,GAChCsd,EAAgB+iB,GAAQz9B,EAAW8gB,GAASt6B,MAAM,IAClDiZ,EAASjW,EAAMkxB,GAAe,SAAUpxB,EAAK4S,GAS/C,OARIA,EAAKjG,WACP3M,EAAI0pE,OAAQ,EACQ,IAAhB92D,EAAKyB,OACPrU,EAAI2pE,SAAU,EACL/2D,EAAKyB,OAASzB,EAAKvG,SAAWqK,EAAUjB,KAAK9B,UACtD3T,EAAI4pE,QAAS,IAGV5pE,IACN,CACD0pE,OAAO,EACPC,SAAS,EACTC,QAAQ,IAEV,MAAO,CACLj1B,UAAWH,GAAmB99B,EAAW8gB,GAASv6B,SAClD4sE,YAAaj1B,GAAqBl+B,EAAW8gB,GAASv6B,SACtDkZ,OAAQA,OAIV2zD,EAAe,WACjBtyC,EAAQzmB,IAAIrP,EAAO6nE,EAAP7nE,IACZ0nE,EAAmB5xC,EAAQ92B,MAAM7C,KAAK4rE,GACtC7rE,EAAKurE,EAAezoE,OAAO,SAAUo/B,GACnC,OAAOA,QAGPiqC,EAAU,SAAUrtD,EAAKstD,GAC3B,IAAIlqC,EAAU,WACZ,OAAOtI,EAAQ92B,MAAM5D,MAAK,WACxB4f,EAAIutD,aAAY,MACf,SAAUzyC,GACX9a,EAAIutD,YAAYD,EAAWxyC,QAK/B,OAFAsI,IACAqpC,EAAep4D,IAAIo4D,EAAezoE,MAAM3E,OAAO,CAAC+jC,KACzC,WACLqpC,EAAep4D,IAAI/S,EAAOmrE,EAAezoE,OAAO,SAAUskB,GACxD,OAAOA,IAAM8a,QAIfoqC,EAAuB,SAAUC,GACnC,OAAOf,EAAiBtrE,QAAO,SAAUw0C,GACvC,OAAOA,EAAQn8B,OAAOg0D,OA6C1B,OADAt1C,EAAO6B,GAAG,6CAA8CozC,GACjD,CACLM,aA3CiB,SAAU1tD,GAC3B,OAAOqtD,EAAQrtD,GAAK,SAAUi5B,GAC5B,OAAO,MA0CT00B,iBAvCqB,SAAU3tD,GAC/B,OAAOqtD,EAAQrtD,GAAK,SAAU8a,GAC5B,OAAO6xC,EAAU7xC,EAAQ9tB,aAsC3B4gE,cAnCkB,SAAUH,GAC5B,OAAO,SAAUztD,GACf,OAAOqtD,EAAQrtD,GAAK,SAAU8a,GAC5B,OAAO6xC,EAAU7xC,EAAQ9tB,UAAYwgE,EAAqBC,QAiC9DI,iBA7BqB,SAAUC,GAC/B,OAAO,SAAU9tD,GACf,OAAOqtD,EAAQrtD,GAAK,SAAU8a,GAC5B,OAAO6xC,EAAU7xC,EAAQ9tB,UAAY8gE,IAAmB/tE,cA2B5DguE,uBAvB2B,SAAUD,EAAkBL,GACvD,OAAO,SAAUztD,GACf,OAAOqtD,EAAQrtD,GAAK,SAAU8a,GAC5B,OAAO6xC,EAAU7xC,EAAQ9tB,UAAY8gE,IAAmB/tE,UAAYytE,EAAqBC,QAqB7FO,iBAjBqB,SAAUhuD,GAC/B,OAAOqtD,EAAQrtD,GAAK,SAAUiuD,GAC5B,OAAOrB,EAAuB,iBAgBhCsB,mBAbuB,SAAUluD,GACjC,OAAOqtD,EAAQrtD,GAAK,SAAUiuD,GAC5B,OAAOrB,EAAuB,mBAYhCQ,aAAcA,EACdtyC,QAAS,WACP,OAAOA,EAAQ92B,SAoWjBmqE,GAAS,SAAUh2C,GACrB,IAAIa,EAp8QW,SAAUo1C,EAAUr1C,EAAUjF,GAQ7C,MAAO,CAAE9vB,IAPC,WACR,OAAO+gB,GAAWqpD,IAAYt6C,GAAkB1zB,MAAK,WACnD,OAAO24B,IAAW93B,IAAIwlB,IAAQhmB,WAAWsmB,OACxC,SAAUlX,GACX,OAAO2W,GAAS3W,QA+7QHw+D,EAAW,WAC1B,OAAOn2C,GAAUC,MAChB,WACD,OAAOotB,GAA+B1sB,GAAkBV,MACvDkB,GAASvF,kBACRk3C,EAAmBwB,GAAoBr0C,EAAQa,GAC/Cs1C,EAAgBl9B,GAAiBjZ,GACjC4B,EAAgBgxC,GAAc5yC,EAAQm2C,EAAc78B,WAAYu5B,GAChElxC,EAAUgsB,GAAa3tB,EAAQm2C,EAAcn7B,SAAUna,GACvD+B,EA70EU,WACd,IAAI1jB,EAAO+a,GAAKjwB,EAASxC,QACrBwZ,EAAOiZ,GAAKjwB,EAASxC,QACrB4uE,EAAiB,SAAUxzC,GAC7BA,EAAU1mB,IAAIlS,EAASxC,SAEzB,MAAO,CACLw0D,QAAS98C,EAAKrT,IACdkxD,QAAS,SAAU9xD,GACjBiU,EAAKhD,IAAIjR,GACTmrE,EAAep1D,IAEjBq1D,UAAW,WACT,OAAOD,EAAel3D,IAExBi+C,WAAYn8C,EAAKnV,IACjBgxD,WAAY,SAAU3rC,GACpBlQ,EAAK9E,IAAIgV,GACTklD,EAAel3D,IAEjBo3D,aAAc,WACZ,OAAOF,EAAep1D,KAwzEVu1D,GAoBhB,OAnBA9a,GAAiBz7B,EAAQ2B,EAASC,EAAef,EAAY+B,GAC7D+7B,GAAsB3+B,EAAQ2B,EAASd,GACvCa,GAAe1B,EAAQa,EAAYc,EAASC,GAlN3B,SAAU5B,EAAQ6yC,EAAkBjwC,GACrD,IAAI4zC,EAAM,SAAUC,GAClB,OAAO,WACL,OAAOz2C,EAAOsnC,YAAYmP,KAG1BC,EAAoB,SAAU3zC,GAChC/C,EAAOsnC,YAAY,kBAAkB,EAAO,CAC1CpoD,KAAM6jB,EAAK4zC,QACX73D,QAASikB,EAAK6zC,cAGdC,EAAkB,CACpBtiE,KAAM,mBACN2gE,QAASrC,EAAiB0C,aAC1BuB,SAAUN,EAAI,kBAEZO,EAAc,CAChBxiE,KAAM,eACNyiE,KAAM,qBACN9B,QAASrC,EAAiB0C,aAC1BuB,SAAUN,EAAI,mBAEhBx2C,EAAO89B,GAAGxyB,SAAS2rC,YAAY,uBAAwB,CACrD1iE,KAAM,oBACNyiE,KAAM,yBACNF,SAAUN,EAAI,2BACdtB,QAASrC,EAAiB2C,mBAE5Bx1C,EAAO89B,GAAGxyB,SAAS2rC,YAAY,sBAAuB,CACpD1iE,KAAM,mBACNyiE,KAAM,yBACNF,SAAUN,EAAI,0BACdtB,QAASrC,EAAiB2C,mBAE5Bx1C,EAAO89B,GAAGxyB,SAAS2rC,YAAY,iBAAkB,CAC/C1iE,KAAM,aACNyiE,KAAM,mBACNF,SAAUN,EAAI,qBACdtB,QAASrC,EAAiB2C,mBAE5Bx1C,EAAO89B,GAAGxyB,SAAS2rC,YAAY,gBAAiB,CAC9C1iE,KAAM,iBACNyiE,KAAM,uBACNF,SAAUN,EAAI,oBACdtB,QAASrC,EAAiB2C,mBAE5Bx1C,EAAO89B,GAAGxyB,SAAS2rC,YAAY,cAAe,CAC5C1iE,KAAM,UACNyiE,KAAM,UACNF,SAAUN,EAAI,kBACdtB,QAASrC,EAAiB2C,mBAE5Bx1C,EAAO89B,GAAGxyB,SAAS2rC,YAAY,eAAgB,CAC7C1iE,KAAM,WACNyiE,KAAM,gBACNF,SAAUN,EAAI,mBACdtB,QAASrC,EAAiB2C,mBAE5Bx1C,EAAO89B,GAAGxyB,SAAS2rC,YAAY,sBAAuB,CACpD1iE,KAAM,mBACNyiE,KAAM,mBACNF,SAAUN,EAAI,0BACdtB,QAASrC,EAAiB6C,iBAAiB9yC,EAAUo5B,WAEvDh8B,EAAO89B,GAAGxyB,SAAS2rC,YAAY,qBAAsB,CACnD1iE,KAAM,kBACNyiE,KAAM,kBACNF,SAAUN,EAAI,yBACdtB,QAASrC,EAAiB6C,iBAAiB9yC,EAAUo5B,WASvDh8B,EAAO89B,GAAGxyB,SAAS2rC,YAAY,0BAA2B,CACxD1iE,KAAM,uBACNyiE,KAAM,6BACNF,SAAUN,EAAI,2BACdtB,QAASrC,EAAiB4C,cAAc,aAE1Cz1C,EAAO89B,GAAGxyB,SAAS2rC,YAAY,yBAA0B,CACvD1iE,KAAM,sBACNyiE,KAAM,4BACNF,SAAUN,EAAI,0BACdtB,QAASrC,EAAiB4C,cAAc,YAE1Cz1C,EAAO89B,GAAGxyB,SAAS2rC,YAAY,oBAAqB,CAClD1iE,KAAM,gBACNyiE,KAAM,sBACNF,SAAUN,EAAI,qBACdtB,QAASrC,EAAiB4C,cAAc,WAE1Cz1C,EAAO89B,GAAGxyB,SAAS2rC,YAAY,iBAAkB,CAC/C1iE,KAAM,aACNyiE,KAAM,aACNF,SAAUN,EAAI,kBACdtB,QAASrC,EAAiB4C,cAAc,WAE1Cz1C,EAAO89B,GAAGxyB,SAAS2rC,YAAY,kBAAmB,CAChD1iE,KAAM,cACNyiE,KAAM,mBACNF,SAAUN,EAAI,mBACdtB,QAASrC,EAAiB4C,cAAc,WAE1Cz1C,EAAO89B,GAAGxyB,SAAS2rC,YAAY,yBAA0B,CACvD1iE,KAAM,sBACNyiE,KAAM,sBACNF,SAAUN,EAAI,0BACdtB,QAASrC,EAAiB+C,uBAAuBhzC,EAAUu6B,WAAY,aAEzEn9B,EAAO89B,GAAGxyB,SAAS2rC,YAAY,wBAAyB,CACtD1iE,KAAM,qBACNyiE,KAAM,qBACNF,SAAUN,EAAI,yBACdtB,QAASrC,EAAiB+C,uBAAuBhzC,EAAUu6B,WAAY,YASzEn9B,EAAO89B,GAAGxyB,SAAS2rC,YAAY,iBAAkB,CAC/C1iE,KAAM,kBACNyiE,KAAM,wBACNF,SAAUN,EAAI,qBACdtB,QAASrC,EAAiB2C,mBAE5Bx1C,EAAO89B,GAAGxyB,SAAS2rC,YAAY,kBAAmB,CAChD1iE,KAAM,cACNyiE,KAAM,oBACNF,SAAUN,EAAI,sBACdtB,QAASrC,EAAiBgD,mBAE5B71C,EAAO89B,GAAGxyB,SAAS2rC,YAAY,kBAAmB,CAChD1iE,KAAM,aACNyiE,KAAM,oBACNF,SAAUN,EAAI,sBACdtB,QAASrC,EAAiBkD,sBASC,IAnrLZ,SAAU/1C,GAC3B,OAAOA,EAAO4W,SAAS,cAAc,EAAM,WAkrLvCsgC,CAAal3C,GACfA,EAAO89B,GAAGxyB,SAAS2rC,YAAY,cAAe,CAC5C1iE,KAAM,QACNyiE,KAAM,QACNF,SAAUN,EAAI,oBAGhBx2C,EAAO89B,GAAGxyB,SAAS6rC,kBAAkB,cAAe,CAClD5iE,KAAM,QACNyiE,KAAM,QACNI,gBAAiB,WACf,MAAO,CAAC,CACJlyE,KAAM,gBACNmyE,UAAW,cACXP,SAAUJ,OAKpB12C,EAAO89B,GAAGxyB,SAAS2rC,YAAY,oBAAqB,CAClD1iE,KAAM,eACNyiE,KAAM,QACNF,SAAUN,EAAI,oBAEhBx2C,EAAO89B,GAAGxyB,SAAS2rC,YAAY,aAAcJ,GAC7C72C,EAAO89B,GAAGxyB,SAAS2rC,YAAY,cAAeF,GAC9C/2C,EAAO89B,GAAGxyB,SAAS6rC,kBAAkB,MA3G3B,CACRjyE,KAAM,iBACNqP,KAAM,MACN6iE,gBAAiB,WACf,MAAO,6IAwGXp3C,EAAO89B,GAAGxyB,SAAS6rC,kBAAkB,SA3DxB,CACXjyE,KAAM,iBACNqP,KAAM,SACN6iE,gBAAiB,WACf,MAAO,oJAwDXp3C,EAAO89B,GAAGxyB,SAAS6rC,kBAAkB,OAnC1B,CACTjyE,KAAM,iBACNqP,KAAM,OACN6iE,gBAAiB,WACf,MAAO,oDAgCXp3C,EAAO89B,GAAGxyB,SAASgsC,eAAe,QAAS,CACzCrqC,OAAQ,WAEN,OADA4lC,EAAiBoC,eACVpC,EAAiBlwC,UAAU16B,MAAK,WACrC,MAAO,MACN,SAAU06B,GACX,MAA8B,YAA1Bl9B,GAAKk9B,EAAQ9tB,SACR,yBAEA,gEAqBf0iE,CAAav3C,EAAQ6yC,EAAkBjwC,GA7WxB,SAAU5C,EAAQ6yC,EAAkBjwC,GACnD5C,EAAO89B,GAAGxyB,SAASksC,cAAc,QAAS,CACxCC,QAAS,QACTT,KAAM,QACNU,MAAO,SAAUC,GACf,OAAOA,EAAS,4EAGpB,IAAInB,EAAM,SAAUC,GAClB,OAAO,WACL,OAAOz2C,EAAOsnC,YAAYmP,KAG9Bz2C,EAAO89B,GAAGxyB,SAASssC,UAAU,aAAc,CACzCH,QAAS,mBACTX,SAAUN,EAAI,iBACdQ,KAAM,QACN9B,QAASrC,EAAiB0C,eAE5Bv1C,EAAO89B,GAAGxyB,SAASssC,UAAU,cAAe,CAC1CH,QAAS,eACTX,SAAUN,EAAI,kBACdQ,KAAM,qBACN9B,QAASrC,EAAiB0C,eAE5Bv1C,EAAO89B,GAAGxyB,SAASssC,UAAU,iBAAkB,CAC7CH,QAAS,kBACTX,SAAUN,EAAI,qBACdQ,KAAM,wBACN9B,QAASrC,EAAiB2C,mBAE5Bx1C,EAAO89B,GAAGxyB,SAASssC,UAAU,kBAAmB,CAC9CH,QAAS,cACTX,SAAUN,EAAI,sBACdQ,KAAM,oBACN9B,QAASrC,EAAiBgD,mBAE5B71C,EAAO89B,GAAGxyB,SAASssC,UAAU,kBAAmB,CAC9CH,QAAS,aACTX,SAAUN,EAAI,sBACdQ,KAAM,oBACN9B,QAASrC,EAAiBkD,qBAE5B/1C,EAAO89B,GAAGxyB,SAASssC,UAAU,uBAAwB,CACnDH,QAAS,oBACTX,SAAUN,EAAI,2BACdQ,KAAM,yBACN9B,QAASrC,EAAiB2C,mBAE5Bx1C,EAAO89B,GAAGxyB,SAASssC,UAAU,sBAAuB,CAClDH,QAAS,mBACTX,SAAUN,EAAI,0BACdQ,KAAM,yBACN9B,QAASrC,EAAiB2C,mBAE5Bx1C,EAAO89B,GAAGxyB,SAASssC,UAAU,iBAAkB,CAC7CH,QAAS,aACTX,SAAUN,EAAI,qBACdQ,KAAM,mBACN9B,QAASrC,EAAiB2C,mBAE5Bx1C,EAAO89B,GAAGxyB,SAASssC,UAAU,gBAAiB,CAC5CH,QAAS,iBACTX,SAAUN,EAAI,oBACdQ,KAAM,uBACN9B,QAASrC,EAAiB2C,mBAE5Bx1C,EAAO89B,GAAGxyB,SAASssC,UAAU,uBAAwB,CACnDH,QAAS,uBACTX,SAAUN,EAAI,2BACdQ,KAAM,6BACN9B,QAASrC,EAAiB4C,cAAc,aAE1Cz1C,EAAO89B,GAAGxyB,SAASssC,UAAU,sBAAuB,CAClDH,QAAS,sBACTX,SAAUN,EAAI,0BACdQ,KAAM,4BACN9B,QAASrC,EAAiB4C,cAAc,YAE1Cz1C,EAAO89B,GAAGxyB,SAASssC,UAAU,iBAAkB,CAC7CH,QAAS,gBACTX,SAAUN,EAAI,qBACdQ,KAAM,sBACN9B,QAASrC,EAAiB4C,cAAc,WAE1Cz1C,EAAO89B,GAAGxyB,SAASssC,UAAU,cAAe,CAC1CH,QAAS,UACTT,KAAM,UACNF,SAAUN,EAAI,kBACdtB,QAASrC,EAAiB2C,mBAE5Bx1C,EAAO89B,GAAGxyB,SAASssC,UAAU,eAAgB,CAC3CH,QAAS,WACTT,KAAM,gBACNF,SAAUN,EAAI,mBACdtB,QAASrC,EAAiB2C,mBAE5Bx1C,EAAO89B,GAAGxyB,SAASssC,UAAU,sBAAuB,CAClDH,QAAS,mBACTT,KAAM,mBACNF,SAAUN,EAAI,0BACdtB,QAASrC,EAAiB6C,iBAAiB9yC,EAAUo5B,WAEvDh8B,EAAO89B,GAAGxyB,SAASssC,UAAU,qBAAsB,CACjDH,QAAS,kBACTT,KAAM,kBACNF,SAAUN,EAAI,yBACdtB,QAASrC,EAAiB6C,iBAAiB9yC,EAAUo5B,WAEvDh8B,EAAO89B,GAAGxyB,SAASssC,UAAU,cAAe,CAC1CH,QAAS,aACTT,KAAM,aACNF,SAAUN,EAAI,kBACdtB,QAASrC,EAAiB4C,cAAc,WAE1Cz1C,EAAO89B,GAAGxyB,SAASssC,UAAU,eAAgB,CAC3CH,QAAS,cACTT,KAAM,mBACNF,SAAUN,EAAI,mBACdtB,QAASrC,EAAiB4C,cAAc,WAE1Cz1C,EAAO89B,GAAGxyB,SAASssC,UAAU,sBAAuB,CAClDH,QAAS,sBACTT,KAAM,sBACNF,SAAUN,EAAI,0BACdtB,QAASrC,EAAiB+C,uBAAuBhzC,EAAUu6B,WAAY,aAEzEn9B,EAAO89B,GAAGxyB,SAASssC,UAAU,qBAAsB,CACjDH,QAAS,qBACTT,KAAM,qBACNF,SAAUN,EAAI,yBACdtB,QAASrC,EAAiB+C,uBAAuBhzC,EAAUu6B,WAAY,YAEzEn9B,EAAO89B,GAAGxyB,SAASssC,UAAU,oBAAqB,CAChDH,QAAS,eACTX,SAAUN,EAAI,kBACdQ,KAAM,UAsORa,CAAW73C,EAAQ6yC,EAAkBjwC,GAnOrB,SAAU5C,GAC1B,IAGI83C,EAx/KW,SAAU93C,GACzB,OAAOA,EAAO4W,SAAS,gBA1EC,8IAikLVmhC,CAAW/3C,GACrB83C,EAAQ/wE,OAAS,GACnBi5B,EAAO89B,GAAGxyB,SAAS0sC,kBAAkB,QAAS,CAC5Cn9D,UANU,SAAUoE,GACtB,OAAO+gB,EAAOzsB,IAAIpL,GAAG8W,EAAO,UAAY+gB,EAAOrlB,UAAUnQ,SAASyU,IAMhEi1C,MAAO4jB,EACPnkE,MAAO,OACPw9B,SAAU,SA0Nd8mC,CAAYj4C,GACZA,EAAO6B,GAAG,WAAW,WACnB7B,EAAOoC,WAAW81C,YAAYh3C,GAASK,eACvCvB,EAAOoC,WAAW81C,YAAYh3C,GAASM,cAtyErB,SAAUxB,GAC9BA,EAAO2zB,UAAUwkB,SAASrZ,IAsyExBsZ,CAAgBp4C,MAnwLG,SAAUA,GAC/B,OAAOA,EAAO4W,SAAS,wBAAwB,EAAM,WAowLjDyhC,CAAiBr4C,IACnBA,EAAO6B,GAAG,WAAW,SAAUppB,IA7rDpB,SAAU2yB,EAAOpL,EAAQ4B,GACtC,GAAIwJ,EAAMktC,UAAYpR,GAASqR,IAAK,CAClC,IAAIC,EAASz4C,GAAUC,GACnBy4C,EAAW,SAAU5jE,GACvB,IAAI4vD,EAASh/D,GAAKoP,GAClB,OAAOS,GAAKT,EAAS2jE,IAAWhuE,EAASg9D,GAAc/C,IAErDxhC,EAAMjD,EAAOW,UAAU2Z,SACvBjvB,EAAY7X,GAAaH,QAAQ+3B,EAAMkmC,SAAWruC,EAAIy9B,eAAiBz9B,EAAIi/B,cAC/EnkD,GAAKsN,EAAWotD,GAAU1vE,MAAK,SAAUgV,GACvCqtB,EAAMtJ,iBACN7iB,GAAMlB,EAAM06D,GAAU1vE,KAAK64B,EAAcuB,OACzCnD,EAAOW,UAAU0vB,SAASjlB,EAAMkmC,WACflmC,EAAMkmC,SAAWlK,GAAWD,IACxBnnC,EAAQy4C,EAAU16D,GACnChV,MAAK,SAAUgC,GACjBi1B,EAAOW,UAAUqC,OAAOj4B,UA8qD1B2tE,CAASjgE,EAAGunB,EAAQ4B,MAGxB5B,EAAO6B,GAAG,UAAU,WAClBs0C,EAAcxnC,aAnpHL,SAAU3O,EAAQ4C,EAAWuzC,EAAetD,GACvD,MAAO,CACL5gB,YAAaA,GAAYjyB,GACzB24C,iBAAkB7mB,GAAqBlvB,EAAUm6B,SACjD6b,iBAAkBhnB,GAAqBhvB,EAAUo5B,SACjD6c,iBAAkB/mB,GAAqBlvB,EAAUi6B,YACjDic,iBAAkBlnB,GAAqBhvB,EAAUu6B,YACjDgZ,cAAeA,EACftD,iBAAkBA,GA6oHbkG,CAAO/4C,EAAQ4C,EAAWuzC,EAAetD,IAGhDhkD,GAAOoa,IAAI,QAAS+sC,IAjrV1B","file":"plugin.js","sourcesContent":["/**\n * Copyright (c) Tiny Technologies, Inc. All rights reserved.\n * Licensed under the LGPL or a commercial license.\n * For LGPL see License.txt in the project root for license information.\n * For commercial licenses see https://www.tiny.cloud/\n *\n * Version: 5.8.2 (2021-06-23)\n */\n(function () {\n    'use strict';\n\n    var typeOf = function (x) {\n      var t = typeof x;\n      if (x === null) {\n        return 'null';\n      } else if (t === 'object' && (Array.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'Array')) {\n        return 'array';\n      } else if (t === 'object' && (String.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'String')) {\n        return 'string';\n      } else {\n        return t;\n      }\n    };\n    var isType = function (type) {\n      return function (value) {\n        return typeOf(value) === type;\n      };\n    };\n    var isSimpleType = function (type) {\n      return function (value) {\n        return typeof value === type;\n      };\n    };\n    var eq = function (t) {\n      return function (a) {\n        return t === a;\n      };\n    };\n    var isString = isType('string');\n    var isObject = isType('object');\n    var isArray = isType('array');\n    var isBoolean = isSimpleType('boolean');\n    var isUndefined = eq(undefined);\n    var isNullable = function (a) {\n      return a === null || a === undefined;\n    };\n    var isNonNullable = function (a) {\n      return !isNullable(a);\n    };\n    var isFunction = isSimpleType('function');\n    var isNumber = isSimpleType('number');\n\n    var noop = function () {\n    };\n    var compose = function (fa, fb) {\n      return function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        return fa(fb.apply(null, args));\n      };\n    };\n    var compose1 = function (fbc, fab) {\n      return function (a) {\n        return fbc(fab(a));\n      };\n    };\n    var constant = function (value) {\n      return function () {\n        return value;\n      };\n    };\n    var identity = function (x) {\n      return x;\n    };\n    function curry(fn) {\n      var initialArgs = [];\n      for (var _i = 1; _i < arguments.length; _i++) {\n        initialArgs[_i - 1] = arguments[_i];\n      }\n      return function () {\n        var restArgs = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          restArgs[_i] = arguments[_i];\n        }\n        var all = initialArgs.concat(restArgs);\n        return fn.apply(null, all);\n      };\n    }\n    var not = function (f) {\n      return function (t) {\n        return !f(t);\n      };\n    };\n    var die = function (msg) {\n      return function () {\n        throw new Error(msg);\n      };\n    };\n    var never = constant(false);\n    var always = constant(true);\n\n    var none = function () {\n      return NONE;\n    };\n    var NONE = function () {\n      var eq = function (o) {\n        return o.isNone();\n      };\n      var call = function (thunk) {\n        return thunk();\n      };\n      var id = function (n) {\n        return n;\n      };\n      var me = {\n        fold: function (n, _s) {\n          return n();\n        },\n        is: never,\n        isSome: never,\n        isNone: always,\n        getOr: id,\n        getOrThunk: call,\n        getOrDie: function (msg) {\n          throw new Error(msg || 'error: getOrDie called on none.');\n        },\n        getOrNull: constant(null),\n        getOrUndefined: constant(undefined),\n        or: id,\n        orThunk: call,\n        map: none,\n        each: noop,\n        bind: none,\n        exists: never,\n        forall: always,\n        filter: none,\n        equals: eq,\n        equals_: eq,\n        toArray: function () {\n          return [];\n        },\n        toString: constant('none()')\n      };\n      return me;\n    }();\n    var some = function (a) {\n      var constant_a = constant(a);\n      var self = function () {\n        return me;\n      };\n      var bind = function (f) {\n        return f(a);\n      };\n      var me = {\n        fold: function (n, s) {\n          return s(a);\n        },\n        is: function (v) {\n          return a === v;\n        },\n        isSome: always,\n        isNone: never,\n        getOr: constant_a,\n        getOrThunk: constant_a,\n        getOrDie: constant_a,\n        getOrNull: constant_a,\n        getOrUndefined: constant_a,\n        or: self,\n        orThunk: self,\n        map: function (f) {\n          return some(f(a));\n        },\n        each: function (f) {\n          f(a);\n        },\n        bind: bind,\n        exists: bind,\n        forall: bind,\n        filter: function (f) {\n          return f(a) ? me : NONE;\n        },\n        toArray: function () {\n          return [a];\n        },\n        toString: function () {\n          return 'some(' + a + ')';\n        },\n        equals: function (o) {\n          return o.is(a);\n        },\n        equals_: function (o, elementEq) {\n          return o.fold(never, function (b) {\n            return elementEq(a, b);\n          });\n        }\n      };\n      return me;\n    };\n    var from = function (value) {\n      return value === null || value === undefined ? NONE : some(value);\n    };\n    var Optional = {\n      some: some,\n      none: none,\n      from: from\n    };\n\n    var nativeSlice = Array.prototype.slice;\n    var nativeIndexOf = Array.prototype.indexOf;\n    var nativePush = Array.prototype.push;\n    var rawIndexOf = function (ts, t) {\n      return nativeIndexOf.call(ts, t);\n    };\n    var contains = function (xs, x) {\n      return rawIndexOf(xs, x) > -1;\n    };\n    var exists = function (xs, pred) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          return true;\n        }\n      }\n      return false;\n    };\n    var range = function (num, f) {\n      var r = [];\n      for (var i = 0; i < num; i++) {\n        r.push(f(i));\n      }\n      return r;\n    };\n    var map = function (xs, f) {\n      var len = xs.length;\n      var r = new Array(len);\n      for (var i = 0; i < len; i++) {\n        var x = xs[i];\n        r[i] = f(x, i);\n      }\n      return r;\n    };\n    var each = function (xs, f) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        f(x, i);\n      }\n    };\n    var eachr = function (xs, f) {\n      for (var i = xs.length - 1; i >= 0; i--) {\n        var x = xs[i];\n        f(x, i);\n      }\n    };\n    var partition = function (xs, pred) {\n      var pass = [];\n      var fail = [];\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        var arr = pred(x, i) ? pass : fail;\n        arr.push(x);\n      }\n      return {\n        pass: pass,\n        fail: fail\n      };\n    };\n    var filter = function (xs, pred) {\n      var r = [];\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          r.push(x);\n        }\n      }\n      return r;\n    };\n    var foldr = function (xs, f, acc) {\n      eachr(xs, function (x) {\n        acc = f(acc, x);\n      });\n      return acc;\n    };\n    var foldl = function (xs, f, acc) {\n      each(xs, function (x) {\n        acc = f(acc, x);\n      });\n      return acc;\n    };\n    var findUntil = function (xs, pred, until) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          return Optional.some(x);\n        } else if (until(x, i)) {\n          break;\n        }\n      }\n      return Optional.none();\n    };\n    var find = function (xs, pred) {\n      return findUntil(xs, pred, never);\n    };\n    var findIndex = function (xs, pred) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          return Optional.some(i);\n        }\n      }\n      return Optional.none();\n    };\n    var flatten = function (xs) {\n      var r = [];\n      for (var i = 0, len = xs.length; i < len; ++i) {\n        if (!isArray(xs[i])) {\n          throw new Error('Arr.flatten item ' + i + ' was not an array, input: ' + xs);\n        }\n        nativePush.apply(r, xs[i]);\n      }\n      return r;\n    };\n    var bind = function (xs, f) {\n      return flatten(map(xs, f));\n    };\n    var forall = function (xs, pred) {\n      for (var i = 0, len = xs.length; i < len; ++i) {\n        var x = xs[i];\n        if (pred(x, i) !== true) {\n          return false;\n        }\n      }\n      return true;\n    };\n    var reverse = function (xs) {\n      var r = nativeSlice.call(xs, 0);\n      r.reverse();\n      return r;\n    };\n    var mapToObject = function (xs, f) {\n      var r = {};\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        r[String(x)] = f(x, i);\n      }\n      return r;\n    };\n    var pure = function (x) {\n      return [x];\n    };\n    var sort = function (xs, comparator) {\n      var copy = nativeSlice.call(xs, 0);\n      copy.sort(comparator);\n      return copy;\n    };\n    var get = function (xs, i) {\n      return i >= 0 && i < xs.length ? Optional.some(xs[i]) : Optional.none();\n    };\n    var head = function (xs) {\n      return get(xs, 0);\n    };\n    var last = function (xs) {\n      return get(xs, xs.length - 1);\n    };\n    var findMap = function (arr, f) {\n      for (var i = 0; i < arr.length; i++) {\n        var r = f(arr[i], i);\n        if (r.isSome()) {\n          return r;\n        }\n      }\n      return Optional.none();\n    };\n\n    var __assign = function () {\n      __assign = Object.assign || function __assign(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n          s = arguments[i];\n          for (var p in s)\n            if (Object.prototype.hasOwnProperty.call(s, p))\n              t[p] = s[p];\n        }\n        return t;\n      };\n      return __assign.apply(this, arguments);\n    };\n    function __spreadArrays() {\n      for (var s = 0, i = 0, il = arguments.length; i < il; i++)\n        s += arguments[i].length;\n      for (var r = Array(s), k = 0, i = 0; i < il; i++)\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n          r[k] = a[j];\n      return r;\n    }\n\n    var cached = function (f) {\n      var called = false;\n      var r;\n      return function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        if (!called) {\n          called = true;\n          r = f.apply(null, args);\n        }\n        return r;\n      };\n    };\n\n    var DeviceType = function (os, browser, userAgent, mediaMatch) {\n      var isiPad = os.isiOS() && /ipad/i.test(userAgent) === true;\n      var isiPhone = os.isiOS() && !isiPad;\n      var isMobile = os.isiOS() || os.isAndroid();\n      var isTouch = isMobile || mediaMatch('(pointer:coarse)');\n      var isTablet = isiPad || !isiPhone && isMobile && mediaMatch('(min-device-width:768px)');\n      var isPhone = isiPhone || isMobile && !isTablet;\n      var iOSwebview = browser.isSafari() && os.isiOS() && /safari/i.test(userAgent) === false;\n      var isDesktop = !isPhone && !isTablet && !iOSwebview;\n      return {\n        isiPad: constant(isiPad),\n        isiPhone: constant(isiPhone),\n        isTablet: constant(isTablet),\n        isPhone: constant(isPhone),\n        isTouch: constant(isTouch),\n        isAndroid: os.isAndroid,\n        isiOS: os.isiOS,\n        isWebView: constant(iOSwebview),\n        isDesktop: constant(isDesktop)\n      };\n    };\n\n    var firstMatch = function (regexes, s) {\n      for (var i = 0; i < regexes.length; i++) {\n        var x = regexes[i];\n        if (x.test(s)) {\n          return x;\n        }\n      }\n      return undefined;\n    };\n    var find$1 = function (regexes, agent) {\n      var r = firstMatch(regexes, agent);\n      if (!r) {\n        return {\n          major: 0,\n          minor: 0\n        };\n      }\n      var group = function (i) {\n        return Number(agent.replace(r, '$' + i));\n      };\n      return nu(group(1), group(2));\n    };\n    var detect = function (versionRegexes, agent) {\n      var cleanedAgent = String(agent).toLowerCase();\n      if (versionRegexes.length === 0) {\n        return unknown();\n      }\n      return find$1(versionRegexes, cleanedAgent);\n    };\n    var unknown = function () {\n      return nu(0, 0);\n    };\n    var nu = function (major, minor) {\n      return {\n        major: major,\n        minor: minor\n      };\n    };\n    var Version = {\n      nu: nu,\n      detect: detect,\n      unknown: unknown\n    };\n\n    var detect$1 = function (candidates, userAgent) {\n      var agent = String(userAgent).toLowerCase();\n      return find(candidates, function (candidate) {\n        return candidate.search(agent);\n      });\n    };\n    var detectBrowser = function (browsers, userAgent) {\n      return detect$1(browsers, userAgent).map(function (browser) {\n        var version = Version.detect(browser.versionRegexes, userAgent);\n        return {\n          current: browser.name,\n          version: version\n        };\n      });\n    };\n    var detectOs = function (oses, userAgent) {\n      return detect$1(oses, userAgent).map(function (os) {\n        var version = Version.detect(os.versionRegexes, userAgent);\n        return {\n          current: os.name,\n          version: version\n        };\n      });\n    };\n    var UaString = {\n      detectBrowser: detectBrowser,\n      detectOs: detectOs\n    };\n\n    var checkRange = function (str, substr, start) {\n      return substr === '' || str.length >= substr.length && str.substr(start, start + substr.length) === substr;\n    };\n    var contains$1 = function (str, substr) {\n      return str.indexOf(substr) !== -1;\n    };\n    var startsWith = function (str, prefix) {\n      return checkRange(str, prefix, 0);\n    };\n    var endsWith = function (str, suffix) {\n      return checkRange(str, suffix, str.length - suffix.length);\n    };\n    var blank = function (r) {\n      return function (s) {\n        return s.replace(r, '');\n      };\n    };\n    var trim = blank(/^\\s+|\\s+$/g);\n    var isNotEmpty = function (s) {\n      return s.length > 0;\n    };\n\n    var normalVersionRegex = /.*?version\\/\\ ?([0-9]+)\\.([0-9]+).*/;\n    var checkContains = function (target) {\n      return function (uastring) {\n        return contains$1(uastring, target);\n      };\n    };\n    var browsers = [\n      {\n        name: 'Edge',\n        versionRegexes: [/.*?edge\\/ ?([0-9]+)\\.([0-9]+)$/],\n        search: function (uastring) {\n          return contains$1(uastring, 'edge/') && contains$1(uastring, 'chrome') && contains$1(uastring, 'safari') && contains$1(uastring, 'applewebkit');\n        }\n      },\n      {\n        name: 'Chrome',\n        versionRegexes: [\n          /.*?chrome\\/([0-9]+)\\.([0-9]+).*/,\n          normalVersionRegex\n        ],\n        search: function (uastring) {\n          return contains$1(uastring, 'chrome') && !contains$1(uastring, 'chromeframe');\n        }\n      },\n      {\n        name: 'IE',\n        versionRegexes: [\n          /.*?msie\\ ?([0-9]+)\\.([0-9]+).*/,\n          /.*?rv:([0-9]+)\\.([0-9]+).*/\n        ],\n        search: function (uastring) {\n          return contains$1(uastring, 'msie') || contains$1(uastring, 'trident');\n        }\n      },\n      {\n        name: 'Opera',\n        versionRegexes: [\n          normalVersionRegex,\n          /.*?opera\\/([0-9]+)\\.([0-9]+).*/\n        ],\n        search: checkContains('opera')\n      },\n      {\n        name: 'Firefox',\n        versionRegexes: [/.*?firefox\\/\\ ?([0-9]+)\\.([0-9]+).*/],\n        search: checkContains('firefox')\n      },\n      {\n        name: 'Safari',\n        versionRegexes: [\n          normalVersionRegex,\n          /.*?cpu os ([0-9]+)_([0-9]+).*/\n        ],\n        search: function (uastring) {\n          return (contains$1(uastring, 'safari') || contains$1(uastring, 'mobile/')) && contains$1(uastring, 'applewebkit');\n        }\n      }\n    ];\n    var oses = [\n      {\n        name: 'Windows',\n        search: checkContains('win'),\n        versionRegexes: [/.*?windows\\ nt\\ ?([0-9]+)\\.([0-9]+).*/]\n      },\n      {\n        name: 'iOS',\n        search: function (uastring) {\n          return contains$1(uastring, 'iphone') || contains$1(uastring, 'ipad');\n        },\n        versionRegexes: [\n          /.*?version\\/\\ ?([0-9]+)\\.([0-9]+).*/,\n          /.*cpu os ([0-9]+)_([0-9]+).*/,\n          /.*cpu iphone os ([0-9]+)_([0-9]+).*/\n        ]\n      },\n      {\n        name: 'Android',\n        search: checkContains('android'),\n        versionRegexes: [/.*?android\\ ?([0-9]+)\\.([0-9]+).*/]\n      },\n      {\n        name: 'OSX',\n        search: checkContains('mac os x'),\n        versionRegexes: [/.*?mac\\ os\\ x\\ ?([0-9]+)_([0-9]+).*/]\n      },\n      {\n        name: 'Linux',\n        search: checkContains('linux'),\n        versionRegexes: []\n      },\n      {\n        name: 'Solaris',\n        search: checkContains('sunos'),\n        versionRegexes: []\n      },\n      {\n        name: 'FreeBSD',\n        search: checkContains('freebsd'),\n        versionRegexes: []\n      },\n      {\n        name: 'ChromeOS',\n        search: checkContains('cros'),\n        versionRegexes: [/.*?chrome\\/([0-9]+)\\.([0-9]+).*/]\n      }\n    ];\n    var PlatformInfo = {\n      browsers: constant(browsers),\n      oses: constant(oses)\n    };\n\n    var edge = 'Edge';\n    var chrome = 'Chrome';\n    var ie = 'IE';\n    var opera = 'Opera';\n    var firefox = 'Firefox';\n    var safari = 'Safari';\n    var unknown$1 = function () {\n      return nu$1({\n        current: undefined,\n        version: Version.unknown()\n      });\n    };\n    var nu$1 = function (info) {\n      var current = info.current;\n      var version = info.version;\n      var isBrowser = function (name) {\n        return function () {\n          return current === name;\n        };\n      };\n      return {\n        current: current,\n        version: version,\n        isEdge: isBrowser(edge),\n        isChrome: isBrowser(chrome),\n        isIE: isBrowser(ie),\n        isOpera: isBrowser(opera),\n        isFirefox: isBrowser(firefox),\n        isSafari: isBrowser(safari)\n      };\n    };\n    var Browser = {\n      unknown: unknown$1,\n      nu: nu$1,\n      edge: constant(edge),\n      chrome: constant(chrome),\n      ie: constant(ie),\n      opera: constant(opera),\n      firefox: constant(firefox),\n      safari: constant(safari)\n    };\n\n    var windows = 'Windows';\n    var ios = 'iOS';\n    var android = 'Android';\n    var linux = 'Linux';\n    var osx = 'OSX';\n    var solaris = 'Solaris';\n    var freebsd = 'FreeBSD';\n    var chromeos = 'ChromeOS';\n    var unknown$2 = function () {\n      return nu$2({\n        current: undefined,\n        version: Version.unknown()\n      });\n    };\n    var nu$2 = function (info) {\n      var current = info.current;\n      var version = info.version;\n      var isOS = function (name) {\n        return function () {\n          return current === name;\n        };\n      };\n      return {\n        current: current,\n        version: version,\n        isWindows: isOS(windows),\n        isiOS: isOS(ios),\n        isAndroid: isOS(android),\n        isOSX: isOS(osx),\n        isLinux: isOS(linux),\n        isSolaris: isOS(solaris),\n        isFreeBSD: isOS(freebsd),\n        isChromeOS: isOS(chromeos)\n      };\n    };\n    var OperatingSystem = {\n      unknown: unknown$2,\n      nu: nu$2,\n      windows: constant(windows),\n      ios: constant(ios),\n      android: constant(android),\n      linux: constant(linux),\n      osx: constant(osx),\n      solaris: constant(solaris),\n      freebsd: constant(freebsd),\n      chromeos: constant(chromeos)\n    };\n\n    var detect$2 = function (userAgent, mediaMatch) {\n      var browsers = PlatformInfo.browsers();\n      var oses = PlatformInfo.oses();\n      var browser = UaString.detectBrowser(browsers, userAgent).fold(Browser.unknown, Browser.nu);\n      var os = UaString.detectOs(oses, userAgent).fold(OperatingSystem.unknown, OperatingSystem.nu);\n      var deviceType = DeviceType(os, browser, userAgent, mediaMatch);\n      return {\n        browser: browser,\n        os: os,\n        deviceType: deviceType\n      };\n    };\n    var PlatformDetection = { detect: detect$2 };\n\n    var mediaMatch = function (query) {\n      return window.matchMedia(query).matches;\n    };\n    var platform = cached(function () {\n      return PlatformDetection.detect(navigator.userAgent, mediaMatch);\n    });\n    var detect$3 = function () {\n      return platform();\n    };\n\n    var compareDocumentPosition = function (a, b, match) {\n      return (a.compareDocumentPosition(b) & match) !== 0;\n    };\n    var documentPositionContainedBy = function (a, b) {\n      return compareDocumentPosition(a, b, Node.DOCUMENT_POSITION_CONTAINED_BY);\n    };\n\n    var COMMENT = 8;\n    var DOCUMENT = 9;\n    var DOCUMENT_FRAGMENT = 11;\n    var ELEMENT = 1;\n    var TEXT = 3;\n\n    var fromHtml = function (html, scope) {\n      var doc = scope || document;\n      var div = doc.createElement('div');\n      div.innerHTML = html;\n      if (!div.hasChildNodes() || div.childNodes.length > 1) {\n        console.error('HTML does not have a single root node', html);\n        throw new Error('HTML must have a single root node');\n      }\n      return fromDom(div.childNodes[0]);\n    };\n    var fromTag = function (tag, scope) {\n      var doc = scope || document;\n      var node = doc.createElement(tag);\n      return fromDom(node);\n    };\n    var fromText = function (text, scope) {\n      var doc = scope || document;\n      var node = doc.createTextNode(text);\n      return fromDom(node);\n    };\n    var fromDom = function (node) {\n      if (node === null || node === undefined) {\n        throw new Error('Node cannot be null or undefined');\n      }\n      return { dom: node };\n    };\n    var fromPoint = function (docElm, x, y) {\n      return Optional.from(docElm.dom.elementFromPoint(x, y)).map(fromDom);\n    };\n    var SugarElement = {\n      fromHtml: fromHtml,\n      fromTag: fromTag,\n      fromText: fromText,\n      fromDom: fromDom,\n      fromPoint: fromPoint\n    };\n\n    var is = function (element, selector) {\n      var dom = element.dom;\n      if (dom.nodeType !== ELEMENT) {\n        return false;\n      } else {\n        var elem = dom;\n        if (elem.matches !== undefined) {\n          return elem.matches(selector);\n        } else if (elem.msMatchesSelector !== undefined) {\n          return elem.msMatchesSelector(selector);\n        } else if (elem.webkitMatchesSelector !== undefined) {\n          return elem.webkitMatchesSelector(selector);\n        } else if (elem.mozMatchesSelector !== undefined) {\n          return elem.mozMatchesSelector(selector);\n        } else {\n          throw new Error('Browser lacks native selectors');\n        }\n      }\n    };\n    var bypassSelector = function (dom) {\n      return dom.nodeType !== ELEMENT && dom.nodeType !== DOCUMENT && dom.nodeType !== DOCUMENT_FRAGMENT || dom.childElementCount === 0;\n    };\n    var all = function (selector, scope) {\n      var base = scope === undefined ? document : scope.dom;\n      return bypassSelector(base) ? [] : map(base.querySelectorAll(selector), SugarElement.fromDom);\n    };\n    var one = function (selector, scope) {\n      var base = scope === undefined ? document : scope.dom;\n      return bypassSelector(base) ? Optional.none() : Optional.from(base.querySelector(selector)).map(SugarElement.fromDom);\n    };\n\n    var eq$1 = function (e1, e2) {\n      return e1.dom === e2.dom;\n    };\n    var regularContains = function (e1, e2) {\n      var d1 = e1.dom;\n      var d2 = e2.dom;\n      return d1 === d2 ? false : d1.contains(d2);\n    };\n    var ieContains = function (e1, e2) {\n      return documentPositionContainedBy(e1.dom, e2.dom);\n    };\n    var contains$2 = function (e1, e2) {\n      return detect$3().browser.isIE() ? ieContains(e1, e2) : regularContains(e1, e2);\n    };\n    var is$1 = is;\n\n    var keys = Object.keys;\n    var hasOwnProperty = Object.hasOwnProperty;\n    var each$1 = function (obj, f) {\n      var props = keys(obj);\n      for (var k = 0, len = props.length; k < len; k++) {\n        var i = props[k];\n        var x = obj[i];\n        f(x, i);\n      }\n    };\n    var map$1 = function (obj, f) {\n      return tupleMap(obj, function (x, i) {\n        return {\n          k: i,\n          v: f(x, i)\n        };\n      });\n    };\n    var tupleMap = function (obj, f) {\n      var r = {};\n      each$1(obj, function (x, i) {\n        var tuple = f(x, i);\n        r[tuple.k] = tuple.v;\n      });\n      return r;\n    };\n    var objAcc = function (r) {\n      return function (x, i) {\n        r[i] = x;\n      };\n    };\n    var internalFilter = function (obj, pred, onTrue, onFalse) {\n      var r = {};\n      each$1(obj, function (x, i) {\n        (pred(x, i) ? onTrue : onFalse)(x, i);\n      });\n      return r;\n    };\n    var filter$1 = function (obj, pred) {\n      var t = {};\n      internalFilter(obj, pred, objAcc(t), noop);\n      return t;\n    };\n    var mapToArray = function (obj, f) {\n      var r = [];\n      each$1(obj, function (value, name) {\n        r.push(f(value, name));\n      });\n      return r;\n    };\n    var values = function (obj) {\n      return mapToArray(obj, function (v) {\n        return v;\n      });\n    };\n    var size = function (obj) {\n      return keys(obj).length;\n    };\n    var get$1 = function (obj, key) {\n      return has(obj, key) ? Optional.from(obj[key]) : Optional.none();\n    };\n    var has = function (obj, key) {\n      return hasOwnProperty.call(obj, key);\n    };\n    var hasNonNullableKey = function (obj, key) {\n      return has(obj, key) && obj[key] !== undefined && obj[key] !== null;\n    };\n    var isEmpty = function (r) {\n      for (var x in r) {\n        if (hasOwnProperty.call(r, x)) {\n          return false;\n        }\n      }\n      return true;\n    };\n\n    var validSectionList = [\n      'tfoot',\n      'thead',\n      'tbody',\n      'colgroup'\n    ];\n    var isValidSection = function (parentName) {\n      return contains(validSectionList, parentName);\n    };\n    var grid = function (rows, columns) {\n      return {\n        rows: rows,\n        columns: columns\n      };\n    };\n    var address = function (row, column) {\n      return {\n        row: row,\n        column: column\n      };\n    };\n    var detail = function (element, rowspan, colspan) {\n      return {\n        element: element,\n        rowspan: rowspan,\n        colspan: colspan\n      };\n    };\n    var detailnew = function (element, rowspan, colspan, isNew) {\n      return {\n        element: element,\n        rowspan: rowspan,\n        colspan: colspan,\n        isNew: isNew\n      };\n    };\n    var extended = function (element, rowspan, colspan, row, column, isLocked) {\n      return {\n        element: element,\n        rowspan: rowspan,\n        colspan: colspan,\n        row: row,\n        column: column,\n        isLocked: isLocked\n      };\n    };\n    var rowdata = function (element, cells, section) {\n      return {\n        element: element,\n        cells: cells,\n        section: section\n      };\n    };\n    var elementnew = function (element, isNew, isLocked) {\n      return {\n        element: element,\n        isNew: isNew,\n        isLocked: isLocked\n      };\n    };\n    var rowdatanew = function (element, cells, section, isNew) {\n      return {\n        element: element,\n        cells: cells,\n        section: section,\n        isNew: isNew\n      };\n    };\n    var rowcells = function (cells, section) {\n      return {\n        cells: cells,\n        section: section\n      };\n    };\n    var rowdetails = function (details, section) {\n      return {\n        details: details,\n        section: section\n      };\n    };\n    var bounds = function (startRow, startCol, finishRow, finishCol) {\n      return {\n        startRow: startRow,\n        startCol: startCol,\n        finishRow: finishRow,\n        finishCol: finishCol\n      };\n    };\n    var columnext = function (element, colspan, column) {\n      return {\n        element: element,\n        colspan: colspan,\n        column: column\n      };\n    };\n\n    var Global = typeof window !== 'undefined' ? window : Function('return this;')();\n\n    var name = function (element) {\n      var r = element.dom.nodeName;\n      return r.toLowerCase();\n    };\n    var type = function (element) {\n      return element.dom.nodeType;\n    };\n    var isType$1 = function (t) {\n      return function (element) {\n        return type(element) === t;\n      };\n    };\n    var isComment = function (element) {\n      return type(element) === COMMENT || name(element) === '#comment';\n    };\n    var isElement = isType$1(ELEMENT);\n    var isText = isType$1(TEXT);\n    var isDocument = isType$1(DOCUMENT);\n    var isDocumentFragment = isType$1(DOCUMENT_FRAGMENT);\n    var isTag = function (tag) {\n      return function (e) {\n        return isElement(e) && name(e) === tag;\n      };\n    };\n\n    var owner = function (element) {\n      return SugarElement.fromDom(element.dom.ownerDocument);\n    };\n    var documentOrOwner = function (dos) {\n      return isDocument(dos) ? dos : owner(dos);\n    };\n    var defaultView = function (element) {\n      return SugarElement.fromDom(documentOrOwner(element).dom.defaultView);\n    };\n    var parent = function (element) {\n      return Optional.from(element.dom.parentNode).map(SugarElement.fromDom);\n    };\n    var parents = function (element, isRoot) {\n      var stop = isFunction(isRoot) ? isRoot : never;\n      var dom = element.dom;\n      var ret = [];\n      while (dom.parentNode !== null && dom.parentNode !== undefined) {\n        var rawParent = dom.parentNode;\n        var p = SugarElement.fromDom(rawParent);\n        ret.push(p);\n        if (stop(p) === true) {\n          break;\n        } else {\n          dom = rawParent;\n        }\n      }\n      return ret;\n    };\n    var offsetParent = function (element) {\n      return Optional.from(element.dom.offsetParent).map(SugarElement.fromDom);\n    };\n    var prevSibling = function (element) {\n      return Optional.from(element.dom.previousSibling).map(SugarElement.fromDom);\n    };\n    var nextSibling = function (element) {\n      return Optional.from(element.dom.nextSibling).map(SugarElement.fromDom);\n    };\n    var children = function (element) {\n      return map(element.dom.childNodes, SugarElement.fromDom);\n    };\n    var child = function (element, index) {\n      var cs = element.dom.childNodes;\n      return Optional.from(cs[index]).map(SugarElement.fromDom);\n    };\n    var firstChild = function (element) {\n      return child(element, 0);\n    };\n\n    var isShadowRoot = function (dos) {\n      return isDocumentFragment(dos) && isNonNullable(dos.dom.host);\n    };\n    var supported = isFunction(Element.prototype.attachShadow) && isFunction(Node.prototype.getRootNode);\n    var isSupported = constant(supported);\n    var getRootNode = supported ? function (e) {\n      return SugarElement.fromDom(e.dom.getRootNode());\n    } : documentOrOwner;\n    var getShadowRoot = function (e) {\n      var r = getRootNode(e);\n      return isShadowRoot(r) ? Optional.some(r) : Optional.none();\n    };\n    var getShadowHost = function (e) {\n      return SugarElement.fromDom(e.dom.host);\n    };\n    var getOriginalEventTarget = function (event) {\n      if (isSupported() && isNonNullable(event.target)) {\n        var el = SugarElement.fromDom(event.target);\n        if (isElement(el) && isOpenShadowHost(el)) {\n          if (event.composed && event.composedPath) {\n            var composedPath = event.composedPath();\n            if (composedPath) {\n              return head(composedPath);\n            }\n          }\n        }\n      }\n      return Optional.from(event.target);\n    };\n    var isOpenShadowHost = function (element) {\n      return isNonNullable(element.dom.shadowRoot);\n    };\n\n    var inBody = function (element) {\n      var dom = isText(element) ? element.dom.parentNode : element.dom;\n      if (dom === undefined || dom === null || dom.ownerDocument === null) {\n        return false;\n      }\n      var doc = dom.ownerDocument;\n      return getShadowRoot(SugarElement.fromDom(dom)).fold(function () {\n        return doc.body.contains(dom);\n      }, compose1(inBody, getShadowHost));\n    };\n    var body = function () {\n      return getBody(SugarElement.fromDom(document));\n    };\n    var getBody = function (doc) {\n      var b = doc.dom.body;\n      if (b === null || b === undefined) {\n        throw new Error('Body is not available yet');\n      }\n      return SugarElement.fromDom(b);\n    };\n\n    var ancestors = function (scope, predicate, isRoot) {\n      return filter(parents(scope, isRoot), predicate);\n    };\n    var children$1 = function (scope, predicate) {\n      return filter(children(scope), predicate);\n    };\n    var descendants = function (scope, predicate) {\n      var result = [];\n      each(children(scope), function (x) {\n        if (predicate(x)) {\n          result = result.concat([x]);\n        }\n        result = result.concat(descendants(x, predicate));\n      });\n      return result;\n    };\n\n    var ancestors$1 = function (scope, selector, isRoot) {\n      return ancestors(scope, function (e) {\n        return is(e, selector);\n      }, isRoot);\n    };\n    var children$2 = function (scope, selector) {\n      return children$1(scope, function (e) {\n        return is(e, selector);\n      });\n    };\n    var descendants$1 = function (scope, selector) {\n      return all(selector, scope);\n    };\n\n    function ClosestOrAncestor (is, ancestor, scope, a, isRoot) {\n      if (is(scope, a)) {\n        return Optional.some(scope);\n      } else if (isFunction(isRoot) && isRoot(scope)) {\n        return Optional.none();\n      } else {\n        return ancestor(scope, a, isRoot);\n      }\n    }\n\n    var ancestor = function (scope, predicate, isRoot) {\n      var element = scope.dom;\n      var stop = isFunction(isRoot) ? isRoot : never;\n      while (element.parentNode) {\n        element = element.parentNode;\n        var el = SugarElement.fromDom(element);\n        if (predicate(el)) {\n          return Optional.some(el);\n        } else if (stop(el)) {\n          break;\n        }\n      }\n      return Optional.none();\n    };\n    var closest = function (scope, predicate, isRoot) {\n      var is = function (s, test) {\n        return test(s);\n      };\n      return ClosestOrAncestor(is, ancestor, scope, predicate, isRoot);\n    };\n    var child$1 = function (scope, predicate) {\n      var pred = function (node) {\n        return predicate(SugarElement.fromDom(node));\n      };\n      var result = find(scope.dom.childNodes, pred);\n      return result.map(SugarElement.fromDom);\n    };\n    var descendant = function (scope, predicate) {\n      var descend = function (node) {\n        for (var i = 0; i < node.childNodes.length; i++) {\n          var child_1 = SugarElement.fromDom(node.childNodes[i]);\n          if (predicate(child_1)) {\n            return Optional.some(child_1);\n          }\n          var res = descend(node.childNodes[i]);\n          if (res.isSome()) {\n            return res;\n          }\n        }\n        return Optional.none();\n      };\n      return descend(scope.dom);\n    };\n\n    var ancestor$1 = function (scope, selector, isRoot) {\n      return ancestor(scope, function (e) {\n        return is(e, selector);\n      }, isRoot);\n    };\n    var child$2 = function (scope, selector) {\n      return child$1(scope, function (e) {\n        return is(e, selector);\n      });\n    };\n    var descendant$1 = function (scope, selector) {\n      return one(selector, scope);\n    };\n    var closest$1 = function (scope, selector, isRoot) {\n      var is$1 = function (element, selector) {\n        return is(element, selector);\n      };\n      return ClosestOrAncestor(is$1, ancestor$1, scope, selector, isRoot);\n    };\n\n    var rawSet = function (dom, key, value) {\n      if (isString(value) || isBoolean(value) || isNumber(value)) {\n        dom.setAttribute(key, value + '');\n      } else {\n        console.error('Invalid call to Attribute.set. Key ', key, ':: Value ', value, ':: Element ', dom);\n        throw new Error('Attribute value was not simple');\n      }\n    };\n    var set = function (element, key, value) {\n      rawSet(element.dom, key, value);\n    };\n    var setAll = function (element, attrs) {\n      var dom = element.dom;\n      each$1(attrs, function (v, k) {\n        rawSet(dom, k, v);\n      });\n    };\n    var get$2 = function (element, key) {\n      var v = element.dom.getAttribute(key);\n      return v === null ? undefined : v;\n    };\n    var getOpt = function (element, key) {\n      return Optional.from(get$2(element, key));\n    };\n    var remove = function (element, key) {\n      element.dom.removeAttribute(key);\n    };\n    var clone = function (element) {\n      return foldl(element.dom.attributes, function (acc, attr) {\n        acc[attr.name] = attr.value;\n        return acc;\n      }, {});\n    };\n\n    var isSupported$1 = function (dom) {\n      return dom.style !== undefined && isFunction(dom.style.getPropertyValue);\n    };\n\n    var internalSet = function (dom, property, value) {\n      if (!isString(value)) {\n        console.error('Invalid call to CSS.set. Property ', property, ':: Value ', value, ':: Element ', dom);\n        throw new Error('CSS value must be a string: ' + value);\n      }\n      if (isSupported$1(dom)) {\n        dom.style.setProperty(property, value);\n      }\n    };\n    var internalRemove = function (dom, property) {\n      if (isSupported$1(dom)) {\n        dom.style.removeProperty(property);\n      }\n    };\n    var set$1 = function (element, property, value) {\n      var dom = element.dom;\n      internalSet(dom, property, value);\n    };\n    var setAll$1 = function (element, css) {\n      var dom = element.dom;\n      each$1(css, function (v, k) {\n        internalSet(dom, k, v);\n      });\n    };\n    var get$3 = function (element, property) {\n      var dom = element.dom;\n      var styles = window.getComputedStyle(dom);\n      var r = styles.getPropertyValue(property);\n      return r === '' && !inBody(element) ? getUnsafeProperty(dom, property) : r;\n    };\n    var getUnsafeProperty = function (dom, property) {\n      return isSupported$1(dom) ? dom.style.getPropertyValue(property) : '';\n    };\n    var getRaw = function (element, property) {\n      var dom = element.dom;\n      var raw = getUnsafeProperty(dom, property);\n      return Optional.from(raw).filter(function (r) {\n        return r.length > 0;\n      });\n    };\n    var remove$1 = function (element, property) {\n      var dom = element.dom;\n      internalRemove(dom, property);\n      if (getOpt(element, 'style').map(trim).is('')) {\n        remove(element, 'style');\n      }\n    };\n    var copy = function (source, target) {\n      var sourceDom = source.dom;\n      var targetDom = target.dom;\n      if (isSupported$1(sourceDom) && isSupported$1(targetDom)) {\n        targetDom.style.cssText = sourceDom.style.cssText;\n      }\n    };\n\n    var getAttrValue = function (cell, name, fallback) {\n      if (fallback === void 0) {\n        fallback = 0;\n      }\n      return getOpt(cell, name).map(function (value) {\n        return parseInt(value, 10);\n      }).getOr(fallback);\n    };\n    var getSpan = function (cell, type) {\n      return getAttrValue(cell, type, 1);\n    };\n    var hasColspan = function (cell) {\n      return getSpan(cell, 'colspan') > 1;\n    };\n    var hasRowspan = function (cell) {\n      return getSpan(cell, 'rowspan') > 1;\n    };\n    var getCssValue = function (element, property) {\n      return parseInt(get$3(element, property), 10);\n    };\n    var minWidth = constant(10);\n    var minHeight = constant(10);\n\n    var firstLayer = function (scope, selector) {\n      return filterFirstLayer(scope, selector, always);\n    };\n    var filterFirstLayer = function (scope, selector, predicate) {\n      return bind(children(scope), function (x) {\n        if (is(x, selector)) {\n          return predicate(x) ? [x] : [];\n        } else {\n          return filterFirstLayer(x, selector, predicate);\n        }\n      });\n    };\n\n    var lookup = function (tags, element, isRoot) {\n      if (isRoot === void 0) {\n        isRoot = never;\n      }\n      if (isRoot(element)) {\n        return Optional.none();\n      }\n      if (contains(tags, name(element))) {\n        return Optional.some(element);\n      }\n      var isRootOrUpperTable = function (elm) {\n        return is(elm, 'table') || isRoot(elm);\n      };\n      return ancestor$1(element, tags.join(','), isRootOrUpperTable);\n    };\n    var cell = function (element, isRoot) {\n      return lookup([\n        'td',\n        'th'\n      ], element, isRoot);\n    };\n    var cells = function (ancestor) {\n      return firstLayer(ancestor, 'th,td');\n    };\n    var columns = function (ancestor) {\n      if (is(ancestor, 'colgroup')) {\n        return children$2(ancestor, 'col');\n      } else {\n        return bind(columnGroups(ancestor), function (columnGroup) {\n          return children$2(columnGroup, 'col');\n        });\n      }\n    };\n    var table = function (element, isRoot) {\n      return closest$1(element, 'table', isRoot);\n    };\n    var rows = function (ancestor) {\n      return firstLayer(ancestor, 'tr');\n    };\n    var columnGroups = function (ancestor) {\n      return table(ancestor).fold(constant([]), function (table) {\n        return children$2(table, 'colgroup');\n      });\n    };\n\n    var fromRowsOrColGroups = function (elems, getSection) {\n      return map(elems, function (row) {\n        if (name(row) === 'colgroup') {\n          var cells$1 = map(columns(row), function (column) {\n            var colspan = getAttrValue(column, 'span', 1);\n            return detail(column, 1, colspan);\n          });\n          return rowdata(row, cells$1, 'colgroup');\n        } else {\n          var cells$1 = map(cells(row), function (cell) {\n            var rowspan = getAttrValue(cell, 'rowspan', 1);\n            var colspan = getAttrValue(cell, 'colspan', 1);\n            return detail(cell, rowspan, colspan);\n          });\n          return rowdata(row, cells$1, getSection(row));\n        }\n      });\n    };\n    var getParentSection = function (group) {\n      return parent(group).map(function (parent) {\n        var parentName = name(parent);\n        return isValidSection(parentName) ? parentName : 'tbody';\n      }).getOr('tbody');\n    };\n    var fromTable = function (table) {\n      var rows$1 = rows(table);\n      var columnGroups$1 = columnGroups(table);\n      var elems = __spreadArrays(columnGroups$1, rows$1);\n      return fromRowsOrColGroups(elems, getParentSection);\n    };\n    var fromPastedRows = function (elems, section) {\n      return fromRowsOrColGroups(elems, function () {\n        return section;\n      });\n    };\n\n    var addCells = function (gridRow, index, cells) {\n      var existingCells = gridRow.cells;\n      var before = existingCells.slice(0, index);\n      var after = existingCells.slice(index);\n      var newCells = before.concat(cells).concat(after);\n      return setCells(gridRow, newCells);\n    };\n    var addCell = function (gridRow, index, cell) {\n      return addCells(gridRow, index, [cell]);\n    };\n    var mutateCell = function (gridRow, index, cell) {\n      var cells = gridRow.cells;\n      cells[index] = cell;\n    };\n    var setCells = function (gridRow, cells) {\n      return rowcells(cells, gridRow.section);\n    };\n    var mapCells = function (gridRow, f) {\n      var cells = gridRow.cells;\n      var r = map(cells, f);\n      return rowcells(r, gridRow.section);\n    };\n    var getCell = function (gridRow, index) {\n      return gridRow.cells[index];\n    };\n    var getCellElement = function (gridRow, index) {\n      return getCell(gridRow, index).element;\n    };\n    var cellLength = function (gridRow) {\n      return gridRow.cells.length;\n    };\n    var extractGridDetails = function (grid) {\n      var result = partition(grid, function (row) {\n        return row.section === 'colgroup';\n      });\n      return {\n        rows: result.fail,\n        cols: result.pass\n      };\n    };\n\n    var LOCKED_COL_ATTR = 'data-snooker-locked-cols';\n    var getLockedColumnsFromTable = function (table) {\n      return getOpt(table, LOCKED_COL_ATTR).bind(function (lockedColStr) {\n        return Optional.from(lockedColStr.match(/\\d+/g));\n      }).map(function (lockedCols) {\n        return mapToObject(lockedCols, always);\n      });\n    };\n    var getLockedColumnsFromGrid = function (grid) {\n      var locked = foldl(extractGridDetails(grid).rows, function (acc, row) {\n        each(row.cells, function (cell, idx) {\n          if (cell.isLocked) {\n            acc[idx] = true;\n          }\n        });\n        return acc;\n      }, {});\n      var lockedArr = mapToArray(locked, function (_val, key) {\n        return parseInt(key, 10);\n      });\n      return sort(lockedArr);\n    };\n\n    var key = function (row, column) {\n      return row + ',' + column;\n    };\n    var getAt = function (warehouse, row, column) {\n      var raw = warehouse.access[key(row, column)];\n      return raw !== undefined ? Optional.some(raw) : Optional.none();\n    };\n    var findItem = function (warehouse, item, comparator) {\n      var filtered = filterItems(warehouse, function (detail) {\n        return comparator(item, detail.element);\n      });\n      return filtered.length > 0 ? Optional.some(filtered[0]) : Optional.none();\n    };\n    var filterItems = function (warehouse, predicate) {\n      var all = bind(warehouse.all, function (r) {\n        return r.cells;\n      });\n      return filter(all, predicate);\n    };\n    var generateColumns = function (rowData) {\n      var columnsGroup = {};\n      var index = 0;\n      each(rowData.cells, function (column) {\n        var colspan = column.colspan;\n        range(colspan, function (columnIndex) {\n          var colIndex = index + columnIndex;\n          columnsGroup[colIndex] = columnext(column.element, colspan, colIndex);\n        });\n        index += colspan;\n      });\n      return columnsGroup;\n    };\n    var generate = function (list) {\n      var access = {};\n      var cells = [];\n      var columns = {};\n      var tableOpt = head(list).map(function (rowData) {\n        return rowData.element;\n      }).bind(table);\n      var lockedColumns = tableOpt.bind(getLockedColumnsFromTable).getOr({});\n      var maxRows = 0;\n      var maxColumns = 0;\n      var rowCount = 0;\n      each(list, function (rowData) {\n        if (rowData.section === 'colgroup') {\n          columns = generateColumns(rowData);\n        } else {\n          var currentRow_1 = [];\n          each(rowData.cells, function (rowCell) {\n            var start = 0;\n            while (access[key(rowCount, start)] !== undefined) {\n              start++;\n            }\n            var isLocked = hasNonNullableKey(lockedColumns, start.toString());\n            var current = extended(rowCell.element, rowCell.rowspan, rowCell.colspan, rowCount, start, isLocked);\n            for (var occupiedColumnPosition = 0; occupiedColumnPosition < rowCell.colspan; occupiedColumnPosition++) {\n              for (var occupiedRowPosition = 0; occupiedRowPosition < rowCell.rowspan; occupiedRowPosition++) {\n                var rowPosition = rowCount + occupiedRowPosition;\n                var columnPosition = start + occupiedColumnPosition;\n                var newpos = key(rowPosition, columnPosition);\n                access[newpos] = current;\n                maxColumns = Math.max(maxColumns, columnPosition + 1);\n              }\n            }\n            currentRow_1.push(current);\n          });\n          maxRows++;\n          cells.push(rowdata(rowData.element, currentRow_1, rowData.section));\n          rowCount++;\n        }\n      });\n      var grid$1 = grid(maxRows, maxColumns);\n      return {\n        grid: grid$1,\n        access: access,\n        all: cells,\n        columns: columns\n      };\n    };\n    var fromTable$1 = function (table) {\n      var list = fromTable(table);\n      return generate(list);\n    };\n    var justCells = function (warehouse) {\n      return bind(warehouse.all, function (w) {\n        return w.cells;\n      });\n    };\n    var justColumns = function (warehouse) {\n      return values(warehouse.columns);\n    };\n    var hasColumns = function (warehouse) {\n      return keys(warehouse.columns).length > 0;\n    };\n    var getColumnAt = function (warehouse, columnIndex) {\n      return Optional.from(warehouse.columns[columnIndex]);\n    };\n    var Warehouse = {\n      fromTable: fromTable$1,\n      generate: generate,\n      getAt: getAt,\n      findItem: findItem,\n      filterItems: filterItems,\n      justCells: justCells,\n      justColumns: justColumns,\n      hasColumns: hasColumns,\n      getColumnAt: getColumnAt\n    };\n\n    var inSelection = function (bounds, detail) {\n      var leftEdge = detail.column;\n      var rightEdge = detail.column + detail.colspan - 1;\n      var topEdge = detail.row;\n      var bottomEdge = detail.row + detail.rowspan - 1;\n      return leftEdge <= bounds.finishCol && rightEdge >= bounds.startCol && (topEdge <= bounds.finishRow && bottomEdge >= bounds.startRow);\n    };\n    var isWithin = function (bounds, detail) {\n      return detail.column >= bounds.startCol && detail.column + detail.colspan - 1 <= bounds.finishCol && detail.row >= bounds.startRow && detail.row + detail.rowspan - 1 <= bounds.finishRow;\n    };\n    var isRectangular = function (warehouse, bounds) {\n      var isRect = true;\n      var detailIsWithin = curry(isWithin, bounds);\n      for (var i = bounds.startRow; i <= bounds.finishRow; i++) {\n        for (var j = bounds.startCol; j <= bounds.finishCol; j++) {\n          isRect = isRect && Warehouse.getAt(warehouse, i, j).exists(detailIsWithin);\n        }\n      }\n      return isRect ? Optional.some(bounds) : Optional.none();\n    };\n\n    var getBounds = function (detailA, detailB) {\n      return bounds(Math.min(detailA.row, detailB.row), Math.min(detailA.column, detailB.column), Math.max(detailA.row + detailA.rowspan - 1, detailB.row + detailB.rowspan - 1), Math.max(detailA.column + detailA.colspan - 1, detailB.column + detailB.colspan - 1));\n    };\n    var getAnyBox = function (warehouse, startCell, finishCell) {\n      var startCoords = Warehouse.findItem(warehouse, startCell, eq$1);\n      var finishCoords = Warehouse.findItem(warehouse, finishCell, eq$1);\n      return startCoords.bind(function (sc) {\n        return finishCoords.map(function (fc) {\n          return getBounds(sc, fc);\n        });\n      });\n    };\n    var getBox = function (warehouse, startCell, finishCell) {\n      return getAnyBox(warehouse, startCell, finishCell).bind(function (bounds) {\n        return isRectangular(warehouse, bounds);\n      });\n    };\n\n    var moveBy = function (warehouse, cell, row, column) {\n      return Warehouse.findItem(warehouse, cell, eq$1).bind(function (detail) {\n        var startRow = row > 0 ? detail.row + detail.rowspan - 1 : detail.row;\n        var startCol = column > 0 ? detail.column + detail.colspan - 1 : detail.column;\n        var dest = Warehouse.getAt(warehouse, startRow + row, startCol + column);\n        return dest.map(function (d) {\n          return d.element;\n        });\n      });\n    };\n    var intercepts = function (warehouse, start, finish) {\n      return getAnyBox(warehouse, start, finish).map(function (bounds) {\n        var inside = Warehouse.filterItems(warehouse, curry(inSelection, bounds));\n        return map(inside, function (detail) {\n          return detail.element;\n        });\n      });\n    };\n    var parentCell = function (warehouse, innerCell) {\n      var isContainedBy = function (c1, c2) {\n        return contains$2(c2, c1);\n      };\n      return Warehouse.findItem(warehouse, innerCell, isContainedBy).map(function (detail) {\n        return detail.element;\n      });\n    };\n\n    var moveBy$1 = function (cell, deltaRow, deltaColumn) {\n      return table(cell).bind(function (table) {\n        var warehouse = getWarehouse(table);\n        return moveBy(warehouse, cell, deltaRow, deltaColumn);\n      });\n    };\n    var intercepts$1 = function (table, first, last) {\n      var warehouse = getWarehouse(table);\n      return intercepts(warehouse, first, last);\n    };\n    var nestedIntercepts = function (table, first, firstTable, last, lastTable) {\n      var warehouse = getWarehouse(table);\n      var optStartCell = eq$1(table, firstTable) ? Optional.some(first) : parentCell(warehouse, first);\n      var optLastCell = eq$1(table, lastTable) ? Optional.some(last) : parentCell(warehouse, last);\n      return optStartCell.bind(function (startCell) {\n        return optLastCell.bind(function (lastCell) {\n          return intercepts(warehouse, startCell, lastCell);\n        });\n      });\n    };\n    var getBox$1 = function (table, first, last) {\n      var warehouse = getWarehouse(table);\n      return getBox(warehouse, first, last);\n    };\n    var getWarehouse = Warehouse.fromTable;\n\n    var before = function (marker, element) {\n      var parent$1 = parent(marker);\n      parent$1.each(function (v) {\n        v.dom.insertBefore(element.dom, marker.dom);\n      });\n    };\n    var after = function (marker, element) {\n      var sibling = nextSibling(marker);\n      sibling.fold(function () {\n        var parent$1 = parent(marker);\n        parent$1.each(function (v) {\n          append(v, element);\n        });\n      }, function (v) {\n        before(v, element);\n      });\n    };\n    var prepend = function (parent, element) {\n      var firstChild$1 = firstChild(parent);\n      firstChild$1.fold(function () {\n        append(parent, element);\n      }, function (v) {\n        parent.dom.insertBefore(element.dom, v.dom);\n      });\n    };\n    var append = function (parent, element) {\n      parent.dom.appendChild(element.dom);\n    };\n    var wrap = function (element, wrapper) {\n      before(element, wrapper);\n      append(wrapper, element);\n    };\n\n    var before$1 = function (marker, elements) {\n      each(elements, function (x) {\n        before(marker, x);\n      });\n    };\n    var after$1 = function (marker, elements) {\n      each(elements, function (x, i) {\n        var e = i === 0 ? marker : elements[i - 1];\n        after(e, x);\n      });\n    };\n    var append$1 = function (parent, elements) {\n      each(elements, function (x) {\n        append(parent, x);\n      });\n    };\n\n    var empty = function (element) {\n      element.dom.textContent = '';\n      each(children(element), function (rogue) {\n        remove$2(rogue);\n      });\n    };\n    var remove$2 = function (element) {\n      var dom = element.dom;\n      if (dom.parentNode !== null) {\n        dom.parentNode.removeChild(dom);\n      }\n    };\n    var unwrap = function (wrapper) {\n      var children$1 = children(wrapper);\n      if (children$1.length > 0) {\n        before$1(wrapper, children$1);\n      }\n      remove$2(wrapper);\n    };\n\n    var NodeValue = function (is, name) {\n      var get = function (element) {\n        if (!is(element)) {\n          throw new Error('Can only get ' + name + ' value of a ' + name + ' node');\n        }\n        return getOption(element).getOr('');\n      };\n      var getOption = function (element) {\n        return is(element) ? Optional.from(element.dom.nodeValue) : Optional.none();\n      };\n      var set = function (element, value) {\n        if (!is(element)) {\n          throw new Error('Can only set raw ' + name + ' value of a ' + name + ' node');\n        }\n        element.dom.nodeValue = value;\n      };\n      return {\n        get: get,\n        getOption: getOption,\n        set: set\n      };\n    };\n\n    var api = NodeValue(isText, 'text');\n    var get$4 = function (element) {\n      return api.get(element);\n    };\n    var getOption = function (element) {\n      return api.getOption(element);\n    };\n    var set$2 = function (element, value) {\n      return api.set(element, value);\n    };\n\n    var TagBoundaries = [\n      'body',\n      'p',\n      'div',\n      'article',\n      'aside',\n      'figcaption',\n      'figure',\n      'footer',\n      'header',\n      'nav',\n      'section',\n      'ol',\n      'ul',\n      'li',\n      'table',\n      'thead',\n      'tbody',\n      'tfoot',\n      'caption',\n      'tr',\n      'td',\n      'th',\n      'h1',\n      'h2',\n      'h3',\n      'h4',\n      'h5',\n      'h6',\n      'blockquote',\n      'pre',\n      'address'\n    ];\n\n    function DomUniverse () {\n      var clone$1 = function (element) {\n        return SugarElement.fromDom(element.dom.cloneNode(false));\n      };\n      var document = function (element) {\n        return documentOrOwner(element).dom;\n      };\n      var isBoundary = function (element) {\n        if (!isElement(element)) {\n          return false;\n        }\n        if (name(element) === 'body') {\n          return true;\n        }\n        return contains(TagBoundaries, name(element));\n      };\n      var isEmptyTag = function (element) {\n        if (!isElement(element)) {\n          return false;\n        }\n        return contains([\n          'br',\n          'img',\n          'hr',\n          'input'\n        ], name(element));\n      };\n      var isNonEditable = function (element) {\n        return isElement(element) && get$2(element, 'contenteditable') === 'false';\n      };\n      var comparePosition = function (element, other) {\n        return element.dom.compareDocumentPosition(other.dom);\n      };\n      var copyAttributesTo = function (source, destination) {\n        var as = clone(source);\n        setAll(destination, as);\n      };\n      var isSpecial = function (element) {\n        var tag = name(element);\n        return contains([\n          'script',\n          'noscript',\n          'iframe',\n          'noframes',\n          'noembed',\n          'title',\n          'style',\n          'textarea',\n          'xmp'\n        ], tag);\n      };\n      return {\n        up: constant({\n          selector: ancestor$1,\n          closest: closest$1,\n          predicate: ancestor,\n          all: parents\n        }),\n        down: constant({\n          selector: descendants$1,\n          predicate: descendants\n        }),\n        styles: constant({\n          get: get$3,\n          getRaw: getRaw,\n          set: set$1,\n          remove: remove$1\n        }),\n        attrs: constant({\n          get: get$2,\n          set: set,\n          remove: remove,\n          copyTo: copyAttributesTo\n        }),\n        insert: constant({\n          before: before,\n          after: after,\n          afterAll: after$1,\n          append: append,\n          appendAll: append$1,\n          prepend: prepend,\n          wrap: wrap\n        }),\n        remove: constant({\n          unwrap: unwrap,\n          remove: remove$2\n        }),\n        create: constant({\n          nu: SugarElement.fromTag,\n          clone: clone$1,\n          text: SugarElement.fromText\n        }),\n        query: constant({\n          comparePosition: comparePosition,\n          prevSibling: prevSibling,\n          nextSibling: nextSibling\n        }),\n        property: constant({\n          children: children,\n          name: name,\n          parent: parent,\n          document: document,\n          isText: isText,\n          isComment: isComment,\n          isElement: isElement,\n          isSpecial: isSpecial,\n          getText: get$4,\n          setText: set$2,\n          isBoundary: isBoundary,\n          isEmptyTag: isEmptyTag,\n          isNonEditable: isNonEditable\n        }),\n        eq: eq$1,\n        is: is$1\n      };\n    }\n\n    var all$1 = function (universe, look, elements, f) {\n      var head = elements[0];\n      var tail = elements.slice(1);\n      return f(universe, look, head, tail);\n    };\n    var oneAll = function (universe, look, elements) {\n      return elements.length > 0 ? all$1(universe, look, elements, unsafeOne) : Optional.none();\n    };\n    var unsafeOne = function (universe, look, head, tail) {\n      var start = look(universe, head);\n      return foldr(tail, function (b, a) {\n        var current = look(universe, a);\n        return commonElement(universe, b, current);\n      }, start);\n    };\n    var commonElement = function (universe, start, end) {\n      return start.bind(function (s) {\n        return end.filter(curry(universe.eq, s));\n      });\n    };\n\n    var eq$2 = function (universe, item) {\n      return curry(universe.eq, item);\n    };\n    var ancestors$2 = function (universe, start, end, isRoot) {\n      if (isRoot === void 0) {\n        isRoot = never;\n      }\n      var ps1 = [start].concat(universe.up().all(start));\n      var ps2 = [end].concat(universe.up().all(end));\n      var prune = function (path) {\n        var index = findIndex(path, isRoot);\n        return index.fold(function () {\n          return path;\n        }, function (ind) {\n          return path.slice(0, ind + 1);\n        });\n      };\n      var pruned1 = prune(ps1);\n      var pruned2 = prune(ps2);\n      var shared = find(pruned1, function (x) {\n        return exists(pruned2, eq$2(universe, x));\n      });\n      return {\n        firstpath: pruned1,\n        secondpath: pruned2,\n        shared: shared\n      };\n    };\n\n    var sharedOne = oneAll;\n    var ancestors$3 = ancestors$2;\n\n    var universe = DomUniverse();\n    var sharedOne$1 = function (look, elements) {\n      return sharedOne(universe, function (_universe, element) {\n        return look(element);\n      }, elements);\n    };\n    var ancestors$4 = function (start, finish, isRoot) {\n      return ancestors$3(universe, start, finish, isRoot);\n    };\n\n    var lookupTable = function (container) {\n      return ancestor$1(container, 'table');\n    };\n    var identify = function (start, finish, isRoot) {\n      var getIsRoot = function (rootTable) {\n        return function (element) {\n          return isRoot !== undefined && isRoot(element) || eq$1(element, rootTable);\n        };\n      };\n      if (eq$1(start, finish)) {\n        return Optional.some({\n          boxes: Optional.some([start]),\n          start: start,\n          finish: finish\n        });\n      } else {\n        return lookupTable(start).bind(function (startTable) {\n          return lookupTable(finish).bind(function (finishTable) {\n            if (eq$1(startTable, finishTable)) {\n              return Optional.some({\n                boxes: intercepts$1(startTable, start, finish),\n                start: start,\n                finish: finish\n              });\n            } else if (contains$2(startTable, finishTable)) {\n              var ancestorCells = ancestors$1(finish, 'td,th', getIsRoot(startTable));\n              var finishCell = ancestorCells.length > 0 ? ancestorCells[ancestorCells.length - 1] : finish;\n              return Optional.some({\n                boxes: nestedIntercepts(startTable, start, startTable, finish, finishTable),\n                start: start,\n                finish: finishCell\n              });\n            } else if (contains$2(finishTable, startTable)) {\n              var ancestorCells = ancestors$1(start, 'td,th', getIsRoot(finishTable));\n              var startCell = ancestorCells.length > 0 ? ancestorCells[ancestorCells.length - 1] : start;\n              return Optional.some({\n                boxes: nestedIntercepts(finishTable, start, startTable, finish, finishTable),\n                start: start,\n                finish: startCell\n              });\n            } else {\n              return ancestors$4(start, finish).shared.bind(function (lca) {\n                return closest$1(lca, 'table', isRoot).bind(function (lcaTable) {\n                  var finishAncestorCells = ancestors$1(finish, 'td,th', getIsRoot(lcaTable));\n                  var finishCell = finishAncestorCells.length > 0 ? finishAncestorCells[finishAncestorCells.length - 1] : finish;\n                  var startAncestorCells = ancestors$1(start, 'td,th', getIsRoot(lcaTable));\n                  var startCell = startAncestorCells.length > 0 ? startAncestorCells[startAncestorCells.length - 1] : start;\n                  return Optional.some({\n                    boxes: nestedIntercepts(lcaTable, start, startTable, finish, finishTable),\n                    start: startCell,\n                    finish: finishCell\n                  });\n                });\n              });\n            }\n          });\n        });\n      }\n    };\n    var retrieve = function (container, selector) {\n      var sels = descendants$1(container, selector);\n      return sels.length > 0 ? Optional.some(sels) : Optional.none();\n    };\n    var getLast = function (boxes, lastSelectedSelector) {\n      return find(boxes, function (box) {\n        return is(box, lastSelectedSelector);\n      });\n    };\n    var getEdges = function (container, firstSelectedSelector, lastSelectedSelector) {\n      return descendant$1(container, firstSelectedSelector).bind(function (first) {\n        return descendant$1(container, lastSelectedSelector).bind(function (last) {\n          return sharedOne$1(lookupTable, [\n            first,\n            last\n          ]).map(function (table) {\n            return {\n              first: first,\n              last: last,\n              table: table\n            };\n          });\n        });\n      });\n    };\n    var expandTo = function (finish, firstSelectedSelector) {\n      return ancestor$1(finish, 'table').bind(function (table) {\n        return descendant$1(table, firstSelectedSelector).bind(function (start) {\n          return identify(start, finish).bind(function (identified) {\n            return identified.boxes.map(function (boxes) {\n              return {\n                boxes: boxes,\n                start: identified.start,\n                finish: identified.finish\n              };\n            });\n          });\n        });\n      });\n    };\n    var shiftSelection = function (boxes, deltaRow, deltaColumn, firstSelectedSelector, lastSelectedSelector) {\n      return getLast(boxes, lastSelectedSelector).bind(function (last) {\n        return moveBy$1(last, deltaRow, deltaColumn).bind(function (finish) {\n          return expandTo(finish, firstSelectedSelector);\n        });\n      });\n    };\n\n    var retrieve$1 = function (container, selector) {\n      return retrieve(container, selector);\n    };\n    var retrieveBox = function (container, firstSelectedSelector, lastSelectedSelector) {\n      return getEdges(container, firstSelectedSelector, lastSelectedSelector).bind(function (edges) {\n        var isRoot = function (ancestor) {\n          return eq$1(container, ancestor);\n        };\n        var sectionSelector = 'thead,tfoot,tbody,table';\n        var firstAncestor = ancestor$1(edges.first, sectionSelector, isRoot);\n        var lastAncestor = ancestor$1(edges.last, sectionSelector, isRoot);\n        return firstAncestor.bind(function (fA) {\n          return lastAncestor.bind(function (lA) {\n            return eq$1(fA, lA) ? getBox$1(edges.table, edges.first, edges.last) : Optional.none();\n          });\n        });\n      });\n    };\n\n    var generate$1 = function (cases) {\n      if (!isArray(cases)) {\n        throw new Error('cases must be an array');\n      }\n      if (cases.length === 0) {\n        throw new Error('there must be at least one case');\n      }\n      var constructors = [];\n      var adt = {};\n      each(cases, function (acase, count) {\n        var keys$1 = keys(acase);\n        if (keys$1.length !== 1) {\n          throw new Error('one and only one name per case');\n        }\n        var key = keys$1[0];\n        var value = acase[key];\n        if (adt[key] !== undefined) {\n          throw new Error('duplicate key detected:' + key);\n        } else if (key === 'cata') {\n          throw new Error('cannot have a case named cata (sorry)');\n        } else if (!isArray(value)) {\n          throw new Error('case arguments must be an array');\n        }\n        constructors.push(key);\n        adt[key] = function () {\n          var args = [];\n          for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n          }\n          var argLength = args.length;\n          if (argLength !== value.length) {\n            throw new Error('Wrong number of arguments to case ' + key + '. Expected ' + value.length + ' (' + value + '), got ' + argLength);\n          }\n          var match = function (branches) {\n            var branchKeys = keys(branches);\n            if (constructors.length !== branchKeys.length) {\n              throw new Error('Wrong number of arguments to match. Expected: ' + constructors.join(',') + '\\nActual: ' + branchKeys.join(','));\n            }\n            var allReqd = forall(constructors, function (reqKey) {\n              return contains(branchKeys, reqKey);\n            });\n            if (!allReqd) {\n              throw new Error('Not all branches were specified when using match. Specified: ' + branchKeys.join(', ') + '\\nRequired: ' + constructors.join(', '));\n            }\n            return branches[key].apply(null, args);\n          };\n          return {\n            fold: function () {\n              var foldArgs = [];\n              for (var _i = 0; _i < arguments.length; _i++) {\n                foldArgs[_i] = arguments[_i];\n              }\n              if (foldArgs.length !== cases.length) {\n                throw new Error('Wrong number of arguments to fold. Expected ' + cases.length + ', got ' + foldArgs.length);\n              }\n              var target = foldArgs[count];\n              return target.apply(null, args);\n            },\n            match: match,\n            log: function (label) {\n              console.log(label, {\n                constructors: constructors,\n                constructor: key,\n                params: args\n              });\n            }\n          };\n        };\n      });\n      return adt;\n    };\n    var Adt = { generate: generate$1 };\n\n    var type$1 = Adt.generate([\n      { none: [] },\n      { multiple: ['elements'] },\n      { single: ['element'] }\n    ]);\n    var cata = function (subject, onNone, onMultiple, onSingle) {\n      return subject.fold(onNone, onMultiple, onSingle);\n    };\n    var none$1 = type$1.none;\n    var multiple = type$1.multiple;\n    var single = type$1.single;\n\n    var Selections = function (lazyRoot, getStart, selectedSelector) {\n      var get = function () {\n        return retrieve$1(lazyRoot(), selectedSelector).fold(function () {\n          return getStart().map(single).getOrThunk(none$1);\n        }, function (cells) {\n          return multiple(cells);\n        });\n      };\n      return { get: get };\n    };\n\n    var global = tinymce.util.Tools.resolve('tinymce.PluginManager');\n\n    var clone$1 = function (original, isDeep) {\n      return SugarElement.fromDom(original.dom.cloneNode(isDeep));\n    };\n    var shallow = function (original) {\n      return clone$1(original, false);\n    };\n    var deep = function (original) {\n      return clone$1(original, true);\n    };\n    var shallowAs = function (original, tag) {\n      var nu = SugarElement.fromTag(tag);\n      var attributes = clone(original);\n      setAll(nu, attributes);\n      return nu;\n    };\n    var copy$1 = function (original, tag) {\n      var nu = shallowAs(original, tag);\n      var cloneChildren = children(deep(original));\n      append$1(nu, cloneChildren);\n      return nu;\n    };\n\n    var cat = function (arr) {\n      var r = [];\n      var push = function (x) {\n        r.push(x);\n      };\n      for (var i = 0; i < arr.length; i++) {\n        arr[i].each(push);\n      }\n      return r;\n    };\n    var lift2 = function (oa, ob, f) {\n      return oa.isSome() && ob.isSome() ? Optional.some(f(oa.getOrDie(), ob.getOrDie())) : Optional.none();\n    };\n    var bindFrom = function (a, f) {\n      return a !== undefined && a !== null ? f(a) : Optional.none();\n    };\n    var someIf = function (b, a) {\n      return b ? Optional.some(a) : Optional.none();\n    };\n\n    var Dimension = function (name, getOffset) {\n      var set = function (element, h) {\n        if (!isNumber(h) && !h.match(/^[0-9]+$/)) {\n          throw new Error(name + '.set accepts only positive integer values. Value was ' + h);\n        }\n        var dom = element.dom;\n        if (isSupported$1(dom)) {\n          dom.style[name] = h + 'px';\n        }\n      };\n      var get = function (element) {\n        var r = getOffset(element);\n        if (r <= 0 || r === null) {\n          var css = get$3(element, name);\n          return parseFloat(css) || 0;\n        }\n        return r;\n      };\n      var getOuter = get;\n      var aggregate = function (element, properties) {\n        return foldl(properties, function (acc, property) {\n          var val = get$3(element, property);\n          var value = val === undefined ? 0 : parseInt(val, 10);\n          return isNaN(value) ? acc : acc + value;\n        }, 0);\n      };\n      var max = function (element, value, properties) {\n        var cumulativeInclusions = aggregate(element, properties);\n        var absoluteMax = value > cumulativeInclusions ? value - cumulativeInclusions : 0;\n        return absoluteMax;\n      };\n      return {\n        set: set,\n        get: get,\n        getOuter: getOuter,\n        aggregate: aggregate,\n        max: max\n      };\n    };\n\n    var api$1 = Dimension('width', function (element) {\n      return element.dom.offsetWidth;\n    });\n    var get$5 = function (element) {\n      return api$1.get(element);\n    };\n    var getOuter = function (element) {\n      return api$1.getOuter(element);\n    };\n\n    var columns$1 = function (warehouse, isValidCell) {\n      if (isValidCell === void 0) {\n        isValidCell = always;\n      }\n      var grid = warehouse.grid;\n      var cols = range(grid.columns, identity);\n      var rowsArr = range(grid.rows, identity);\n      return map(cols, function (col) {\n        var getBlock = function () {\n          return bind(rowsArr, function (r) {\n            return Warehouse.getAt(warehouse, r, col).filter(function (detail) {\n              return detail.column === col;\n            }).toArray();\n          });\n        };\n        var isValid = function (detail) {\n          return detail.colspan === 1 && isValidCell(detail.element);\n        };\n        var getFallback = function () {\n          return Warehouse.getAt(warehouse, 0, col);\n        };\n        return decide(getBlock, isValid, getFallback);\n      });\n    };\n    var decide = function (getBlock, isValid, getFallback) {\n      var inBlock = getBlock();\n      var validInBlock = find(inBlock, isValid);\n      var detailOption = validInBlock.orThunk(function () {\n        return Optional.from(inBlock[0]).orThunk(getFallback);\n      });\n      return detailOption.map(function (detail) {\n        return detail.element;\n      });\n    };\n    var rows$1 = function (warehouse) {\n      var grid = warehouse.grid;\n      var rowsArr = range(grid.rows, identity);\n      var cols = range(grid.columns, identity);\n      return map(rowsArr, function (row) {\n        var getBlock = function () {\n          return bind(cols, function (c) {\n            return Warehouse.getAt(warehouse, row, c).filter(function (detail) {\n              return detail.row === row;\n            }).fold(constant([]), function (detail) {\n              return [detail];\n            });\n          });\n        };\n        var isSingle = function (detail) {\n          return detail.rowspan === 1;\n        };\n        var getFallback = function () {\n          return Warehouse.getAt(warehouse, row, 0);\n        };\n        return decide(getBlock, isSingle, getFallback);\n      });\n    };\n\n    var deduce = function (xs, index) {\n      if (index < 0 || index >= xs.length - 1) {\n        return Optional.none();\n      }\n      var current = xs[index].fold(function () {\n        var rest = reverse(xs.slice(0, index));\n        return findMap(rest, function (a, i) {\n          return a.map(function (aa) {\n            return {\n              value: aa,\n              delta: i + 1\n            };\n          });\n        });\n      }, function (c) {\n        return Optional.some({\n          value: c,\n          delta: 0\n        });\n      });\n      var next = xs[index + 1].fold(function () {\n        var rest = xs.slice(index + 1);\n        return findMap(rest, function (a, i) {\n          return a.map(function (aa) {\n            return {\n              value: aa,\n              delta: i + 1\n            };\n          });\n        });\n      }, function (n) {\n        return Optional.some({\n          value: n,\n          delta: 1\n        });\n      });\n      return current.bind(function (c) {\n        return next.map(function (n) {\n          var extras = n.delta + c.delta;\n          return Math.abs(n.value - c.value) / extras;\n        });\n      });\n    };\n\n    var onDirection = function (isLtr, isRtl) {\n      return function (element) {\n        return getDirection(element) === 'rtl' ? isRtl : isLtr;\n      };\n    };\n    var getDirection = function (element) {\n      return get$3(element, 'direction') === 'rtl' ? 'rtl' : 'ltr';\n    };\n\n    var api$2 = Dimension('height', function (element) {\n      var dom = element.dom;\n      return inBody(element) ? dom.getBoundingClientRect().height : dom.offsetHeight;\n    });\n    var get$6 = function (element) {\n      return api$2.get(element);\n    };\n    var getOuter$1 = function (element) {\n      return api$2.getOuter(element);\n    };\n\n    var r = function (left, top) {\n      var translate = function (x, y) {\n        return r(left + x, top + y);\n      };\n      return {\n        left: left,\n        top: top,\n        translate: translate\n      };\n    };\n    var SugarPosition = r;\n\n    var boxPosition = function (dom) {\n      var box = dom.getBoundingClientRect();\n      return SugarPosition(box.left, box.top);\n    };\n    var firstDefinedOrZero = function (a, b) {\n      if (a !== undefined) {\n        return a;\n      } else {\n        return b !== undefined ? b : 0;\n      }\n    };\n    var absolute = function (element) {\n      var doc = element.dom.ownerDocument;\n      var body = doc.body;\n      var win = doc.defaultView;\n      var html = doc.documentElement;\n      if (body === element.dom) {\n        return SugarPosition(body.offsetLeft, body.offsetTop);\n      }\n      var scrollTop = firstDefinedOrZero(win === null || win === void 0 ? void 0 : win.pageYOffset, html.scrollTop);\n      var scrollLeft = firstDefinedOrZero(win === null || win === void 0 ? void 0 : win.pageXOffset, html.scrollLeft);\n      var clientTop = firstDefinedOrZero(html.clientTop, body.clientTop);\n      var clientLeft = firstDefinedOrZero(html.clientLeft, body.clientLeft);\n      return viewport(element).translate(scrollLeft - clientLeft, scrollTop - clientTop);\n    };\n    var viewport = function (element) {\n      var dom = element.dom;\n      var doc = dom.ownerDocument;\n      var body = doc.body;\n      if (body === dom) {\n        return SugarPosition(body.offsetLeft, body.offsetTop);\n      }\n      if (!inBody(element)) {\n        return SugarPosition(0, 0);\n      }\n      return boxPosition(dom);\n    };\n\n    var rowInfo = function (row, y) {\n      return {\n        row: row,\n        y: y\n      };\n    };\n    var colInfo = function (col, x) {\n      return {\n        col: col,\n        x: x\n      };\n    };\n    var rtlEdge = function (cell) {\n      var pos = absolute(cell);\n      return pos.left + getOuter(cell);\n    };\n    var ltrEdge = function (cell) {\n      return absolute(cell).left;\n    };\n    var getLeftEdge = function (index, cell) {\n      return colInfo(index, ltrEdge(cell));\n    };\n    var getRightEdge = function (index, cell) {\n      return colInfo(index, rtlEdge(cell));\n    };\n    var getTop = function (cell) {\n      return absolute(cell).top;\n    };\n    var getTopEdge = function (index, cell) {\n      return rowInfo(index, getTop(cell));\n    };\n    var getBottomEdge = function (index, cell) {\n      return rowInfo(index, getTop(cell) + getOuter$1(cell));\n    };\n    var findPositions = function (getInnerEdge, getOuterEdge, array) {\n      if (array.length === 0) {\n        return [];\n      }\n      var lines = map(array.slice(1), function (cellOption, index) {\n        return cellOption.map(function (cell) {\n          return getInnerEdge(index, cell);\n        });\n      });\n      var lastLine = array[array.length - 1].map(function (cell) {\n        return getOuterEdge(array.length - 1, cell);\n      });\n      return lines.concat([lastLine]);\n    };\n    var negate = function (step) {\n      return -step;\n    };\n    var height = {\n      delta: identity,\n      positions: function (optElements) {\n        return findPositions(getTopEdge, getBottomEdge, optElements);\n      },\n      edge: getTop\n    };\n    var ltr = {\n      delta: identity,\n      edge: ltrEdge,\n      positions: function (optElements) {\n        return findPositions(getLeftEdge, getRightEdge, optElements);\n      }\n    };\n    var rtl = {\n      delta: negate,\n      edge: rtlEdge,\n      positions: function (optElements) {\n        return findPositions(getRightEdge, getLeftEdge, optElements);\n      }\n    };\n    var detect$4 = onDirection(ltr, rtl);\n    var width = {\n      delta: function (amount, table) {\n        return detect$4(table).delta(amount, table);\n      },\n      positions: function (cols, table) {\n        return detect$4(table).positions(cols, table);\n      },\n      edge: function (cell) {\n        return detect$4(cell).edge(cell);\n      }\n    };\n\n    var units = {\n      unsupportedLength: [\n        'em',\n        'ex',\n        'cap',\n        'ch',\n        'ic',\n        'rem',\n        'lh',\n        'rlh',\n        'vw',\n        'vh',\n        'vi',\n        'vb',\n        'vmin',\n        'vmax',\n        'cm',\n        'mm',\n        'Q',\n        'in',\n        'pc',\n        'pt',\n        'px'\n      ],\n      fixed: [\n        'px',\n        'pt'\n      ],\n      relative: ['%'],\n      empty: ['']\n    };\n    var pattern = function () {\n      var decimalDigits = '[0-9]+';\n      var signedInteger = '[+-]?' + decimalDigits;\n      var exponentPart = '[eE]' + signedInteger;\n      var dot = '\\\\.';\n      var opt = function (input) {\n        return '(?:' + input + ')?';\n      };\n      var unsignedDecimalLiteral = [\n        'Infinity',\n        decimalDigits + dot + opt(decimalDigits) + opt(exponentPart),\n        dot + decimalDigits + opt(exponentPart),\n        decimalDigits + opt(exponentPart)\n      ].join('|');\n      var float = '[+-]?(?:' + unsignedDecimalLiteral + ')';\n      return new RegExp('^(' + float + ')(.*)$');\n    }();\n    var isUnit = function (unit, accepted) {\n      return exists(accepted, function (acc) {\n        return exists(units[acc], function (check) {\n          return unit === check;\n        });\n      });\n    };\n    var parse = function (input, accepted) {\n      var match = Optional.from(pattern.exec(input));\n      return match.bind(function (array) {\n        var value = Number(array[1]);\n        var unitRaw = array[2];\n        if (isUnit(unitRaw, accepted)) {\n          return Optional.some({\n            value: value,\n            unit: unitRaw\n          });\n        } else {\n          return Optional.none();\n        }\n      });\n    };\n\n    var needManualCalc = function () {\n      var browser = detect$3().browser;\n      return browser.isIE() || browser.isEdge();\n    };\n    var toNumber = function (px, fallback) {\n      var num = parseFloat(px);\n      return isNaN(num) ? fallback : num;\n    };\n    var getProp = function (elm, name, fallback) {\n      return toNumber(get$3(elm, name), fallback);\n    };\n    var getCalculatedHeight = function (cell) {\n      var height = cell.dom.getBoundingClientRect().height;\n      var boxSizing = get$3(cell, 'box-sizing');\n      if (boxSizing === 'border-box') {\n        return height;\n      } else {\n        var paddingTop = getProp(cell, 'padding-top', 0);\n        var paddingBottom = getProp(cell, 'padding-bottom', 0);\n        var borderTop = getProp(cell, 'border-top-width', 0);\n        var borderBottom = getProp(cell, 'border-bottom-width', 0);\n        var borders = borderTop + borderBottom;\n        return height - paddingTop - paddingBottom - borders;\n      }\n    };\n    var getCalculatedWidth = function (cell) {\n      var width = cell.dom.getBoundingClientRect().width;\n      var boxSizing = get$3(cell, 'box-sizing');\n      if (boxSizing === 'border-box') {\n        return width;\n      } else {\n        var paddingLeft = getProp(cell, 'padding-left', 0);\n        var paddingRight = getProp(cell, 'padding-right', 0);\n        var borderLeft = getProp(cell, 'border-left-width', 0);\n        var borderRight = getProp(cell, 'border-right-width', 0);\n        var borders = borderLeft + borderRight;\n        return width - paddingLeft - paddingRight - borders;\n      }\n    };\n    var getHeight = function (cell) {\n      return needManualCalc() ? getCalculatedHeight(cell) : getProp(cell, 'height', get$6(cell));\n    };\n    var getWidth = function (cell) {\n      return needManualCalc() ? getCalculatedWidth(cell) : getProp(cell, 'width', get$5(cell));\n    };\n\n    var rPercentageBasedSizeRegex = /(\\d+(\\.\\d+)?)%/;\n    var rPixelBasedSizeRegex = /(\\d+(\\.\\d+)?)px|em/;\n    var getPercentSize = function (elm, getter) {\n      var relativeParent = offsetParent(elm).getOr(getBody(owner(elm)));\n      return getter(elm) / getter(relativeParent) * 100;\n    };\n    var setPixelWidth = function (cell, amount) {\n      set$1(cell, 'width', amount + 'px');\n    };\n    var setPercentageWidth = function (cell, amount) {\n      set$1(cell, 'width', amount + '%');\n    };\n    var setHeight = function (cell, amount) {\n      set$1(cell, 'height', amount + 'px');\n    };\n    var getHeightValue = function (cell) {\n      return getRaw(cell, 'height').getOrThunk(function () {\n        return getHeight(cell) + 'px';\n      });\n    };\n    var convert = function (cell, number, getter, setter) {\n      var newSize = table(cell).map(function (table) {\n        var total = getter(table);\n        return Math.floor(number / 100 * total);\n      }).getOr(number);\n      setter(cell, newSize);\n      return newSize;\n    };\n    var normalizePixelSize = function (value, cell, getter, setter) {\n      var number = parseInt(value, 10);\n      return endsWith(value, '%') && name(cell) !== 'table' ? convert(cell, number, getter, setter) : number;\n    };\n    var getTotalHeight = function (cell) {\n      var value = getHeightValue(cell);\n      if (!value) {\n        return get$6(cell);\n      }\n      return normalizePixelSize(value, cell, get$6, setHeight);\n    };\n    var get$7 = function (cell, type, f) {\n      var v = f(cell);\n      var span = getSpan(cell, type);\n      return v / span;\n    };\n    var getRawWidth = function (element) {\n      var cssWidth = getRaw(element, 'width');\n      return cssWidth.fold(function () {\n        return Optional.from(get$2(element, 'width'));\n      }, function (width) {\n        return Optional.some(width);\n      });\n    };\n    var normalizePercentageWidth = function (cellWidth, tableSize) {\n      return cellWidth / tableSize.pixelWidth() * 100;\n    };\n    var choosePercentageSize = function (element, width, tableSize) {\n      var percentMatch = rPercentageBasedSizeRegex.exec(width);\n      if (percentMatch !== null) {\n        return parseFloat(percentMatch[1]);\n      } else {\n        var intWidth = getWidth(element);\n        return normalizePercentageWidth(intWidth, tableSize);\n      }\n    };\n    var getPercentageWidth = function (cell, tableSize) {\n      var width = getRawWidth(cell);\n      return width.fold(function () {\n        var intWidth = get$5(cell);\n        return normalizePercentageWidth(intWidth, tableSize);\n      }, function (w) {\n        return choosePercentageSize(cell, w, tableSize);\n      });\n    };\n    var normalizePixelWidth = function (cellWidth, tableSize) {\n      return cellWidth / 100 * tableSize.pixelWidth();\n    };\n    var choosePixelSize = function (element, width, tableSize) {\n      var pixelMatch = rPixelBasedSizeRegex.exec(width);\n      if (pixelMatch !== null) {\n        return parseInt(pixelMatch[1], 10);\n      }\n      var percentMatch = rPercentageBasedSizeRegex.exec(width);\n      if (percentMatch !== null) {\n        var floatWidth = parseFloat(percentMatch[1]);\n        return normalizePixelWidth(floatWidth, tableSize);\n      }\n      return getWidth(element);\n    };\n    var getPixelWidth = function (cell, tableSize) {\n      var width = getRawWidth(cell);\n      return width.fold(function () {\n        return getWidth(cell);\n      }, function (w) {\n        return choosePixelSize(cell, w, tableSize);\n      });\n    };\n    var getHeight$1 = function (cell) {\n      return get$7(cell, 'rowspan', getTotalHeight);\n    };\n    var getGenericWidth = function (cell) {\n      var width = getRawWidth(cell);\n      return width.bind(function (w) {\n        return parse(w, [\n          'fixed',\n          'relative',\n          'empty'\n        ]);\n      });\n    };\n    var setGenericWidth = function (cell, amount, unit) {\n      set$1(cell, 'width', amount + unit);\n    };\n    var getPixelTableWidth = function (table) {\n      return get$5(table) + 'px';\n    };\n    var getPercentTableWidth = function (table) {\n      return getPercentSize(table, get$5) + '%';\n    };\n    var isPercentSizing = function (table) {\n      return getRawWidth(table).exists(function (size) {\n        return rPercentageBasedSizeRegex.test(size);\n      });\n    };\n    var isPixelSizing = function (table) {\n      return getRawWidth(table).exists(function (size) {\n        return rPixelBasedSizeRegex.test(size);\n      });\n    };\n    var isNoneSizing = function (table) {\n      return getRawWidth(table).isNone();\n    };\n    var percentageBasedSizeRegex = constant(rPercentageBasedSizeRegex);\n    var pixelBasedSizeRegex = constant(rPixelBasedSizeRegex);\n\n    var isCol = isTag('col');\n    var getRaw$1 = function (cell, property, getter) {\n      return getRaw(cell, property).fold(function () {\n        return getter(cell) + 'px';\n      }, function (raw) {\n        return raw;\n      });\n    };\n    var getRawW = function (cell, tableSize) {\n      var fallback = function (e) {\n        return isCol(e) ? get$5(e) : getPixelWidth(e, tableSize);\n      };\n      return getRaw$1(cell, 'width', fallback);\n    };\n    var getRawH = function (cell) {\n      return getRaw$1(cell, 'height', getHeight$1);\n    };\n    var justCols = function (warehouse) {\n      return map(Warehouse.justColumns(warehouse), function (column) {\n        return Optional.from(column.element);\n      });\n    };\n    var hasRawStyle = function (cell, prop) {\n      return getRaw(cell, prop).isSome();\n    };\n    var isValidColumn = function (cell) {\n      return !isCol(cell) || hasRawStyle(cell, 'width');\n    };\n    var getDimension = function (cellOpt, index, backups, filter, getter, fallback) {\n      return cellOpt.filter(filter).fold(function () {\n        return fallback(deduce(backups, index));\n      }, function (cell) {\n        return getter(cell);\n      });\n    };\n    var getWidthFrom = function (warehouse, table, getWidth, fallback, tableSize) {\n      var columnCells = columns$1(warehouse, function (cell) {\n        return hasRawStyle(cell, 'width');\n      });\n      var columns = Warehouse.hasColumns(warehouse) ? justCols(warehouse) : columnCells;\n      var backups = [Optional.some(width.edge(table))].concat(map(width.positions(columnCells, table), function (pos) {\n        return pos.map(function (p) {\n          return p.x;\n        });\n      }));\n      var colFilter = not(hasColspan);\n      return map(columns, function (cellOption, c) {\n        return getDimension(cellOption, c, backups, colFilter, function (column) {\n          if (isValidColumn(column)) {\n            return getWidth(column, tableSize);\n          } else {\n            var cell = bindFrom(columnCells[c], identity);\n            return getDimension(cell, c, backups, colFilter, function (cell) {\n              return fallback(Optional.some(get$5(cell)));\n            }, fallback);\n          }\n        }, fallback);\n      });\n    };\n    var getDeduced = function (deduced) {\n      return deduced.map(function (d) {\n        return d + 'px';\n      }).getOr('');\n    };\n    var getRawWidths = function (warehouse, table, tableSize) {\n      return getWidthFrom(warehouse, table, getRawW, getDeduced, tableSize);\n    };\n    var getPercentageWidths = function (warehouse, table, tableSize) {\n      return getWidthFrom(warehouse, table, getPercentageWidth, function (deduced) {\n        return deduced.fold(function () {\n          return tableSize.minCellWidth();\n        }, function (cellWidth) {\n          return cellWidth / tableSize.pixelWidth() * 100;\n        });\n      }, tableSize);\n    };\n    var getPixelWidths = function (warehouse, table, tableSize) {\n      return getWidthFrom(warehouse, table, getPixelWidth, function (deduced) {\n        return deduced.getOrThunk(tableSize.minCellWidth);\n      }, tableSize);\n    };\n    var getHeightFrom = function (warehouse, table, direction, getHeight, fallback) {\n      var rows = rows$1(warehouse);\n      var backups = [Optional.some(direction.edge(table))].concat(map(direction.positions(rows, table), function (pos) {\n        return pos.map(function (p) {\n          return p.y;\n        });\n      }));\n      return map(rows, function (cellOption, c) {\n        return getDimension(cellOption, c, backups, not(hasRowspan), getHeight, fallback);\n      });\n    };\n    var getPixelHeights = function (warehouse, table, direction) {\n      return getHeightFrom(warehouse, table, direction, getHeight$1, function (deduced) {\n        return deduced.getOrThunk(minHeight);\n      });\n    };\n    var getRawHeights = function (warehouse, table, direction) {\n      return getHeightFrom(warehouse, table, direction, getRawH, getDeduced);\n    };\n\n    var Cell = function (initial) {\n      var value = initial;\n      var get = function () {\n        return value;\n      };\n      var set = function (v) {\n        value = v;\n      };\n      return {\n        get: get,\n        set: set\n      };\n    };\n\n    var noneSize = function (table) {\n      var getWidth = function () {\n        return get$5(table);\n      };\n      var zero = constant(0);\n      var getWidths = function (warehouse, tableSize) {\n        return getPixelWidths(warehouse, table, tableSize);\n      };\n      return {\n        width: getWidth,\n        pixelWidth: getWidth,\n        getWidths: getWidths,\n        getCellDelta: zero,\n        singleColumnWidth: constant([0]),\n        minCellWidth: zero,\n        setElementWidth: noop,\n        adjustTableWidth: noop,\n        isRelative: true,\n        label: 'none'\n      };\n    };\n    var percentageSize = function (initialWidth, table) {\n      var floatWidth = Cell(parseFloat(initialWidth));\n      var pixelWidth = Cell(get$5(table));\n      var getCellDelta = function (delta) {\n        return delta / pixelWidth.get() * 100;\n      };\n      var singleColumnWidth = function (w, _delta) {\n        return [100 - w];\n      };\n      var minCellWidth = function () {\n        return minWidth() / pixelWidth.get() * 100;\n      };\n      var adjustTableWidth = function (delta) {\n        var currentWidth = floatWidth.get();\n        var change = delta / 100 * currentWidth;\n        var newWidth = currentWidth + change;\n        setPercentageWidth(table, newWidth);\n        floatWidth.set(newWidth);\n        pixelWidth.set(get$5(table));\n      };\n      var getWidths = function (warehouse, tableSize) {\n        return getPercentageWidths(warehouse, table, tableSize);\n      };\n      return {\n        width: floatWidth.get,\n        pixelWidth: pixelWidth.get,\n        getWidths: getWidths,\n        getCellDelta: getCellDelta,\n        singleColumnWidth: singleColumnWidth,\n        minCellWidth: minCellWidth,\n        setElementWidth: setPercentageWidth,\n        adjustTableWidth: adjustTableWidth,\n        isRelative: true,\n        label: 'percent'\n      };\n    };\n    var pixelSize = function (initialWidth, table) {\n      var width = Cell(initialWidth);\n      var getWidth = width.get;\n      var getCellDelta = identity;\n      var singleColumnWidth = function (w, delta) {\n        var newNext = Math.max(minWidth(), w + delta);\n        return [newNext - w];\n      };\n      var adjustTableWidth = function (delta) {\n        var newWidth = getWidth() + delta;\n        setPixelWidth(table, newWidth);\n        width.set(newWidth);\n      };\n      var getWidths = function (warehouse, tableSize) {\n        return getPixelWidths(warehouse, table, tableSize);\n      };\n      return {\n        width: getWidth,\n        pixelWidth: getWidth,\n        getWidths: getWidths,\n        getCellDelta: getCellDelta,\n        singleColumnWidth: singleColumnWidth,\n        minCellWidth: minWidth,\n        setElementWidth: setPixelWidth,\n        adjustTableWidth: adjustTableWidth,\n        isRelative: false,\n        label: 'pixel'\n      };\n    };\n    var chooseSize = function (element, width) {\n      var percentMatch = percentageBasedSizeRegex().exec(width);\n      if (percentMatch !== null) {\n        return percentageSize(percentMatch[1], element);\n      }\n      var pixelMatch = pixelBasedSizeRegex().exec(width);\n      if (pixelMatch !== null) {\n        var intWidth = parseInt(pixelMatch[1], 10);\n        return pixelSize(intWidth, element);\n      }\n      var fallbackWidth = get$5(element);\n      return pixelSize(fallbackWidth, element);\n    };\n    var getTableSize = function (table) {\n      var width = getRawWidth(table);\n      return width.fold(function () {\n        return noneSize(table);\n      }, function (w) {\n        return chooseSize(table, w);\n      });\n    };\n    var TableSize = {\n      getTableSize: getTableSize,\n      pixelSize: pixelSize,\n      percentageSize: percentageSize,\n      noneSize: noneSize\n    };\n\n    var statsStruct = function (minRow, minCol, maxRow, maxCol, allCells, selectedCells) {\n      return {\n        minRow: minRow,\n        minCol: minCol,\n        maxRow: maxRow,\n        maxCol: maxCol,\n        allCells: allCells,\n        selectedCells: selectedCells\n      };\n    };\n    var findSelectedStats = function (house, isSelected) {\n      var totalColumns = house.grid.columns;\n      var totalRows = house.grid.rows;\n      var minRow = totalRows;\n      var minCol = totalColumns;\n      var maxRow = 0;\n      var maxCol = 0;\n      var allCells = [];\n      var selectedCells = [];\n      each$1(house.access, function (detail) {\n        allCells.push(detail);\n        if (isSelected(detail)) {\n          selectedCells.push(detail);\n          var startRow = detail.row;\n          var endRow = startRow + detail.rowspan - 1;\n          var startCol = detail.column;\n          var endCol = startCol + detail.colspan - 1;\n          if (startRow < minRow) {\n            minRow = startRow;\n          } else if (endRow > maxRow) {\n            maxRow = endRow;\n          }\n          if (startCol < minCol) {\n            minCol = startCol;\n          } else if (endCol > maxCol) {\n            maxCol = endCol;\n          }\n        }\n      });\n      return statsStruct(minRow, minCol, maxRow, maxCol, allCells, selectedCells);\n    };\n    var makeCell = function (list, seenSelected, rowIndex) {\n      var row = list[rowIndex].element;\n      var td = SugarElement.fromTag('td');\n      append(td, SugarElement.fromTag('br'));\n      var f = seenSelected ? append : prepend;\n      f(row, td);\n    };\n    var fillInGaps = function (list, house, stats, isSelected) {\n      var totalColumns = house.grid.columns;\n      var totalRows = house.grid.rows;\n      for (var i = 0; i < totalRows; i++) {\n        var seenSelected = false;\n        for (var j = 0; j < totalColumns; j++) {\n          if (!(i < stats.minRow || i > stats.maxRow || j < stats.minCol || j > stats.maxCol)) {\n            var needCell = Warehouse.getAt(house, i, j).filter(isSelected).isNone();\n            if (needCell) {\n              makeCell(list, seenSelected, i);\n            } else {\n              seenSelected = true;\n            }\n          }\n        }\n      }\n    };\n    var clean = function (replica, stats, house, widthDelta) {\n      each$1(house.columns, function (col) {\n        if (col.column < stats.minCol || col.column > stats.maxCol) {\n          remove$2(col.element);\n        }\n      });\n      var emptyRows = filter(firstLayer(replica, 'tr'), function (row) {\n        return row.dom.childElementCount === 0;\n      });\n      each(emptyRows, remove$2);\n      if (stats.minCol === stats.maxCol || stats.minRow === stats.maxRow) {\n        each(firstLayer(replica, 'th,td'), function (cell) {\n          remove(cell, 'rowspan');\n          remove(cell, 'colspan');\n        });\n      }\n      remove(replica, LOCKED_COL_ATTR);\n      remove(replica, 'data-snooker-col-series');\n      var tableSize = TableSize.getTableSize(replica);\n      tableSize.adjustTableWidth(widthDelta);\n    };\n    var getTableWidthDelta = function (table, warehouse, tableSize, stats) {\n      if (stats.minCol === 0 && warehouse.grid.columns === stats.maxCol + 1) {\n        return 0;\n      }\n      var colWidths = getPixelWidths(warehouse, table, tableSize);\n      var allColsWidth = foldl(colWidths, function (acc, width) {\n        return acc + width;\n      }, 0);\n      var selectedColsWidth = foldl(colWidths.slice(stats.minCol, stats.maxCol + 1), function (acc, width) {\n        return acc + width;\n      }, 0);\n      var newWidth = selectedColsWidth / allColsWidth * tableSize.pixelWidth();\n      var delta = newWidth - tableSize.pixelWidth();\n      return tableSize.getCellDelta(delta);\n    };\n    var extract = function (table, selectedSelector) {\n      var isSelected = function (detail) {\n        return is(detail.element, selectedSelector);\n      };\n      var replica = deep(table);\n      var list = fromTable(replica);\n      var tableSize = TableSize.getTableSize(table);\n      var replicaHouse = Warehouse.generate(list);\n      var replicaStats = findSelectedStats(replicaHouse, isSelected);\n      var selector = 'th:not(' + selectedSelector + ')' + ',td:not(' + selectedSelector + ')';\n      var unselectedCells = filterFirstLayer(replica, 'th,td', function (cell) {\n        return is(cell, selector);\n      });\n      each(unselectedCells, remove$2);\n      fillInGaps(list, replicaHouse, replicaStats, isSelected);\n      var house = Warehouse.fromTable(table);\n      var widthDelta = getTableWidthDelta(table, house, tableSize, replicaStats);\n      clean(replica, replicaStats, replicaHouse, widthDelta);\n      return replica;\n    };\n\n    var nbsp = '\\xA0';\n\n    var getEnd = function (element) {\n      return name(element) === 'img' ? 1 : getOption(element).fold(function () {\n        return children(element).length;\n      }, function (v) {\n        return v.length;\n      });\n    };\n    var isTextNodeWithCursorPosition = function (el) {\n      return getOption(el).filter(function (text) {\n        return text.trim().length !== 0 || text.indexOf(nbsp) > -1;\n      }).isSome();\n    };\n    var elementsWithCursorPosition = [\n      'img',\n      'br'\n    ];\n    var isCursorPosition = function (elem) {\n      var hasCursorPosition = isTextNodeWithCursorPosition(elem);\n      return hasCursorPosition || contains(elementsWithCursorPosition, name(elem));\n    };\n\n    var first = function (element) {\n      return descendant(element, isCursorPosition);\n    };\n    var last$1 = function (element) {\n      return descendantRtl(element, isCursorPosition);\n    };\n    var descendantRtl = function (scope, predicate) {\n      var descend = function (element) {\n        var children$1 = children(element);\n        for (var i = children$1.length - 1; i >= 0; i--) {\n          var child = children$1[i];\n          if (predicate(child)) {\n            return Optional.some(child);\n          }\n          var res = descend(child);\n          if (res.isSome()) {\n            return res;\n          }\n        }\n        return Optional.none();\n      };\n      return descend(scope);\n    };\n\n    var transferableAttributes = {\n      scope: [\n        'row',\n        'col'\n      ]\n    };\n    var createCell = function () {\n      var td = SugarElement.fromTag('td');\n      append(td, SugarElement.fromTag('br'));\n      return td;\n    };\n    var createCol = function () {\n      return SugarElement.fromTag('col');\n    };\n    var createColgroup = function () {\n      return SugarElement.fromTag('colgroup');\n    };\n    var replace = function (cell, tag, attrs) {\n      var replica = copy$1(cell, tag);\n      each$1(attrs, function (v, k) {\n        if (v === null) {\n          remove(replica, k);\n        } else {\n          set(replica, k, v);\n        }\n      });\n      return replica;\n    };\n    var pasteReplace = function (cell) {\n      return cell;\n    };\n    var newRow = function (doc) {\n      return function () {\n        return SugarElement.fromTag('tr', doc.dom);\n      };\n    };\n    var cloneFormats = function (oldCell, newCell, formats) {\n      var first$1 = first(oldCell);\n      return first$1.map(function (firstText) {\n        var formatSelector = formats.join(',');\n        var parents = ancestors$1(firstText, formatSelector, function (element) {\n          return eq$1(element, oldCell);\n        });\n        return foldr(parents, function (last, parent) {\n          var clonedFormat = shallow(parent);\n          remove(clonedFormat, 'contenteditable');\n          append(last, clonedFormat);\n          return clonedFormat;\n        }, newCell);\n      }).getOr(newCell);\n    };\n    var cloneAppropriateAttributes = function (original, clone) {\n      each$1(transferableAttributes, function (validAttributes, attributeName) {\n        return getOpt(original, attributeName).filter(function (attribute) {\n          return contains(validAttributes, attribute);\n        }).each(function (attribute) {\n          return set(clone, attributeName, attribute);\n        });\n      });\n    };\n    var cellOperations = function (mutate, doc, formatsToClone) {\n      var cloneCss = function (prev, clone) {\n        copy(prev.element, clone);\n        remove$1(clone, 'height');\n        if (prev.colspan !== 1) {\n          remove$1(clone, 'width');\n        }\n      };\n      var newCell = function (prev) {\n        var docu = owner(prev.element);\n        var td = SugarElement.fromTag(name(prev.element), docu.dom);\n        var formats = formatsToClone.getOr([\n          'strong',\n          'em',\n          'b',\n          'i',\n          'span',\n          'font',\n          'h1',\n          'h2',\n          'h3',\n          'h4',\n          'h5',\n          'h6',\n          'p',\n          'div'\n        ]);\n        var lastNode = formats.length > 0 ? cloneFormats(prev.element, td, formats) : td;\n        append(lastNode, SugarElement.fromTag('br'));\n        cloneCss(prev, td);\n        cloneAppropriateAttributes(prev.element, td);\n        mutate(prev.element, td);\n        return td;\n      };\n      var newCol = function (prev) {\n        var doc = owner(prev.element);\n        var col = SugarElement.fromTag(name(prev.element), doc.dom);\n        cloneCss(prev, col);\n        mutate(prev.element, col);\n        return col;\n      };\n      return {\n        col: newCol,\n        colgroup: createColgroup,\n        row: newRow(doc),\n        cell: newCell,\n        replace: replace,\n        gap: createCell\n      };\n    };\n    var paste = function (doc) {\n      return {\n        col: createCol,\n        colgroup: createColgroup,\n        row: newRow(doc),\n        cell: createCell,\n        replace: pasteReplace,\n        gap: createCell\n      };\n    };\n\n    var fromHtml$1 = function (html, scope) {\n      var doc = scope || document;\n      var div = doc.createElement('div');\n      div.innerHTML = html;\n      return children(SugarElement.fromDom(div));\n    };\n    var fromDom$1 = function (nodes) {\n      return map(nodes, SugarElement.fromDom);\n    };\n\n    var getNodeName = function (elm) {\n      return elm.nodeName.toLowerCase();\n    };\n    var getBody$1 = function (editor) {\n      return SugarElement.fromDom(editor.getBody());\n    };\n    var getPixelWidth$1 = function (elm) {\n      return elm.getBoundingClientRect().width;\n    };\n    var getPixelHeight = function (elm) {\n      return elm.getBoundingClientRect().height;\n    };\n    var getIsRoot = function (editor) {\n      return function (element) {\n        return eq$1(element, getBody$1(editor));\n      };\n    };\n    var removePxSuffix = function (size) {\n      return size ? size.replace(/px$/, '') : '';\n    };\n    var addPxSuffix = function (size) {\n      return /^\\d+(\\.\\d+)?$/.test(size) ? size + 'px' : size;\n    };\n    var removeDataStyle = function (table) {\n      remove(table, 'data-mce-style');\n      var removeStyleAttribute = function (element) {\n        return remove(element, 'data-mce-style');\n      };\n      each(cells(table), removeStyleAttribute);\n      each(columns(table), removeStyleAttribute);\n    };\n    var getRawWidth$1 = function (editor, elm) {\n      var raw = editor.dom.getStyle(elm, 'width') || editor.dom.getAttrib(elm, 'width');\n      return Optional.from(raw).filter(isNotEmpty);\n    };\n    var isPercentage = function (value) {\n      return /^(\\d+(\\.\\d+)?)%$/.test(value);\n    };\n    var isPixel = function (value) {\n      return /^(\\d+(\\.\\d+)?)px$/.test(value);\n    };\n    var getSelectionStart = function (editor) {\n      return SugarElement.fromDom(editor.selection.getStart());\n    };\n\n    var selection = function (selections) {\n      return cata(selections.get(), constant([]), identity, pure);\n    };\n    var unmergable = function (selections) {\n      var hasSpan = function (elem, type) {\n        return getOpt(elem, type).exists(function (span) {\n          return parseInt(span, 10) > 1;\n        });\n      };\n      var hasRowOrColSpan = function (elem) {\n        return hasSpan(elem, 'rowspan') || hasSpan(elem, 'colspan');\n      };\n      var candidates = selection(selections);\n      return candidates.length > 0 && forall(candidates, hasRowOrColSpan) ? Optional.some(candidates) : Optional.none();\n    };\n    var mergable = function (table, selections, ephemera) {\n      return cata(selections.get(), Optional.none, function (cells) {\n        if (cells.length <= 1) {\n          return Optional.none();\n        } else {\n          return retrieveBox(table, ephemera.firstSelectedSelector, ephemera.lastSelectedSelector).map(function (bounds) {\n            return {\n              bounds: bounds,\n              cells: cells\n            };\n          });\n        }\n      }, Optional.none);\n    };\n\n    var strSelected = 'data-mce-selected';\n    var strSelectedSelector = 'td[' + strSelected + '],th[' + strSelected + ']';\n    var strAttributeSelector = '[' + strSelected + ']';\n    var strFirstSelected = 'data-mce-first-selected';\n    var strFirstSelectedSelector = 'td[' + strFirstSelected + '],th[' + strFirstSelected + ']';\n    var strLastSelected = 'data-mce-last-selected';\n    var strLastSelectedSelector = 'td[' + strLastSelected + '],th[' + strLastSelected + ']';\n    var attributeSelector = strAttributeSelector;\n    var ephemera = {\n      selected: strSelected,\n      selectedSelector: strSelectedSelector,\n      firstSelected: strFirstSelected,\n      firstSelectedSelector: strFirstSelectedSelector,\n      lastSelected: strLastSelected,\n      lastSelectedSelector: strLastSelectedSelector\n    };\n\n    var noMenu = function (cell) {\n      return {\n        element: cell,\n        mergable: Optional.none(),\n        unmergable: Optional.none(),\n        selection: [cell]\n      };\n    };\n    var forMenu = function (selections, table, cell) {\n      return {\n        element: cell,\n        mergable: mergable(table, selections, ephemera),\n        unmergable: unmergable(selections),\n        selection: selection(selections)\n      };\n    };\n    var paste$1 = function (element, clipboard, generators) {\n      return {\n        element: element,\n        clipboard: clipboard,\n        generators: generators\n      };\n    };\n    var pasteRows = function (selections, cell, clipboard, generators) {\n      return {\n        selection: selection(selections),\n        clipboard: clipboard,\n        generators: generators\n      };\n    };\n\n    var extractSelected = function (cells) {\n      return table(cells[0]).map(function (table) {\n        var replica = extract(table, attributeSelector);\n        removeDataStyle(replica);\n        return [replica];\n      });\n    };\n    var serializeElements = function (editor, elements) {\n      return map(elements, function (elm) {\n        return editor.selection.serializer.serialize(elm.dom, {});\n      }).join('');\n    };\n    var getTextContent = function (elements) {\n      return map(elements, function (element) {\n        return element.dom.innerText;\n      }).join('');\n    };\n    var registerEvents = function (editor, selections, actions, cellSelection) {\n      editor.on('BeforeGetContent', function (e) {\n        var multiCellContext = function (cells) {\n          e.preventDefault();\n          extractSelected(cells).each(function (elements) {\n            e.content = e.format === 'text' ? getTextContent(elements) : serializeElements(editor, elements);\n          });\n        };\n        if (e.selection === true) {\n          cata(selections.get(), noop, multiCellContext, noop);\n        }\n      });\n      editor.on('BeforeSetContent', function (e) {\n        if (e.selection === true && e.paste === true) {\n          var cellOpt = Optional.from(editor.dom.getParent(editor.selection.getStart(), 'th,td'));\n          cellOpt.each(function (domCell) {\n            var cell = SugarElement.fromDom(domCell);\n            table(cell).each(function (table) {\n              var elements = filter(fromHtml$1(e.content), function (content) {\n                return name(content) !== 'meta';\n              });\n              var isTable = function (elm) {\n                return name(elm) === 'table';\n              };\n              if (elements.length === 1 && isTable(elements[0])) {\n                e.preventDefault();\n                var doc = SugarElement.fromDom(editor.getDoc());\n                var generators = paste(doc);\n                var targets = paste$1(cell, elements[0], generators);\n                actions.pasteCells(table, targets).each(function (data) {\n                  editor.selection.setRng(data.rng);\n                  editor.focus();\n                  cellSelection.clear(table);\n                });\n              }\n            });\n          });\n        }\n      });\n    };\n\n    var adt = Adt.generate([\n      { none: [] },\n      { only: ['index'] },\n      {\n        left: [\n          'index',\n          'next'\n        ]\n      },\n      {\n        middle: [\n          'prev',\n          'index',\n          'next'\n        ]\n      },\n      {\n        right: [\n          'prev',\n          'index'\n        ]\n      }\n    ]);\n    var ColumnContext = __assign({}, adt);\n\n    var neighbours = function (input, index) {\n      if (input.length === 0) {\n        return ColumnContext.none();\n      }\n      if (input.length === 1) {\n        return ColumnContext.only(0);\n      }\n      if (index === 0) {\n        return ColumnContext.left(0, 1);\n      }\n      if (index === input.length - 1) {\n        return ColumnContext.right(index - 1, index);\n      }\n      if (index > 0 && index < input.length - 1) {\n        return ColumnContext.middle(index - 1, index, index + 1);\n      }\n      return ColumnContext.none();\n    };\n    var determine = function (input, column, step, tableSize, resize) {\n      var result = input.slice(0);\n      var context = neighbours(input, column);\n      var onNone = constant(map(result, constant(0)));\n      var onOnly = function (index) {\n        return tableSize.singleColumnWidth(result[index], step);\n      };\n      var onLeft = function (index, next) {\n        return resize.calcLeftEdgeDeltas(result, index, next, step, tableSize.minCellWidth(), tableSize.isRelative);\n      };\n      var onMiddle = function (prev, index, next) {\n        return resize.calcMiddleDeltas(result, prev, index, next, step, tableSize.minCellWidth(), tableSize.isRelative);\n      };\n      var onRight = function (prev, index) {\n        return resize.calcRightEdgeDeltas(result, prev, index, step, tableSize.minCellWidth(), tableSize.isRelative);\n      };\n      return context.fold(onNone, onOnly, onLeft, onMiddle, onRight);\n    };\n\n    var total = function (start, end, measures) {\n      var r = 0;\n      for (var i = start; i < end; i++) {\n        r += measures[i] !== undefined ? measures[i] : 0;\n      }\n      return r;\n    };\n    var recalculateWidthForCells = function (warehouse, widths) {\n      var all = Warehouse.justCells(warehouse);\n      return map(all, function (cell) {\n        var width = total(cell.column, cell.column + cell.colspan, widths);\n        return {\n          element: cell.element,\n          width: width,\n          colspan: cell.colspan\n        };\n      });\n    };\n    var recalculateWidthForColumns = function (warehouse, widths) {\n      var groups = Warehouse.justColumns(warehouse);\n      return map(groups, function (column, index) {\n        return {\n          element: column.element,\n          width: widths[index],\n          colspan: column.colspan\n        };\n      });\n    };\n    var recalculateHeightForCells = function (warehouse, heights) {\n      var all = Warehouse.justCells(warehouse);\n      return map(all, function (cell) {\n        var height = total(cell.row, cell.row + cell.rowspan, heights);\n        return {\n          element: cell.element,\n          height: height,\n          rowspan: cell.rowspan\n        };\n      });\n    };\n    var matchRowHeight = function (warehouse, heights) {\n      return map(warehouse.all, function (row, i) {\n        return {\n          element: row.element,\n          height: heights[i]\n        };\n      });\n    };\n\n    var sumUp = function (newSize) {\n      return foldr(newSize, function (b, a) {\n        return b + a;\n      }, 0);\n    };\n    var recalculate = function (warehouse, widths) {\n      if (Warehouse.hasColumns(warehouse)) {\n        return recalculateWidthForColumns(warehouse, widths);\n      } else {\n        return recalculateWidthForCells(warehouse, widths);\n      }\n    };\n    var recalculateAndApply = function (warehouse, widths, tableSize) {\n      var newSizes = recalculate(warehouse, widths);\n      each(newSizes, function (cell) {\n        tableSize.setElementWidth(cell.element, cell.width);\n      });\n    };\n    var adjustWidth = function (table, delta, index, resizing, tableSize) {\n      var warehouse = Warehouse.fromTable(table);\n      var step = tableSize.getCellDelta(delta);\n      var widths = tableSize.getWidths(warehouse, tableSize);\n      var isLastColumn = index === warehouse.grid.columns - 1;\n      var clampedStep = resizing.clampTableDelta(widths, index, step, tableSize.minCellWidth(), isLastColumn);\n      var deltas = determine(widths, index, clampedStep, tableSize, resizing);\n      var newWidths = map(deltas, function (dx, i) {\n        return dx + widths[i];\n      });\n      recalculateAndApply(warehouse, newWidths, tableSize);\n      resizing.resizeTable(tableSize.adjustTableWidth, clampedStep, isLastColumn);\n    };\n    var adjustHeight = function (table, delta, index, direction) {\n      var warehouse = Warehouse.fromTable(table);\n      var heights = getPixelHeights(warehouse, table, direction);\n      var newHeights = map(heights, function (dy, i) {\n        return index === i ? Math.max(delta + dy, minHeight()) : dy;\n      });\n      var newCellSizes = recalculateHeightForCells(warehouse, newHeights);\n      var newRowSizes = matchRowHeight(warehouse, newHeights);\n      each(newRowSizes, function (row) {\n        setHeight(row.element, row.height);\n      });\n      each(newCellSizes, function (cell) {\n        setHeight(cell.element, cell.height);\n      });\n      var total = sumUp(newHeights);\n      setHeight(table, total);\n    };\n    var adjustAndRedistributeWidths = function (_table, list, details, tableSize, resizeBehaviour) {\n      var warehouse = Warehouse.generate(list);\n      var sizes = tableSize.getWidths(warehouse, tableSize);\n      var tablePixelWidth = tableSize.pixelWidth();\n      var _a = resizeBehaviour.calcRedestributedWidths(sizes, tablePixelWidth, details.pixelDelta, tableSize.isRelative), newSizes = _a.newSizes, delta = _a.delta;\n      recalculateAndApply(warehouse, newSizes, tableSize);\n      tableSize.adjustTableWidth(delta);\n    };\n    var adjustWidthTo = function (_table, list, _info, tableSize) {\n      var warehouse = Warehouse.generate(list);\n      var widths = tableSize.getWidths(warehouse, tableSize);\n      recalculateAndApply(warehouse, widths, tableSize);\n    };\n\n    var zero = function (array) {\n      return map(array, constant(0));\n    };\n    var surround = function (sizes, startIndex, endIndex, results, f) {\n      return f(sizes.slice(0, startIndex)).concat(results).concat(f(sizes.slice(endIndex)));\n    };\n    var clampDeltaHelper = function (predicate) {\n      return function (sizes, index, delta, minCellSize) {\n        if (!predicate(delta)) {\n          return delta;\n        } else {\n          var newSize = Math.max(minCellSize, sizes[index] - Math.abs(delta));\n          var diff = Math.abs(newSize - sizes[index]);\n          return delta >= 0 ? diff : -diff;\n        }\n      };\n    };\n    var clampNegativeDelta = clampDeltaHelper(function (delta) {\n      return delta < 0;\n    });\n    var clampDelta = clampDeltaHelper(always);\n    var resizeTable = function () {\n      var calcFixedDeltas = function (sizes, index, next, delta, minCellSize) {\n        var clampedDelta = clampNegativeDelta(sizes, index, delta, minCellSize);\n        return surround(sizes, index, next + 1, [\n          clampedDelta,\n          0\n        ], zero);\n      };\n      var calcRelativeDeltas = function (sizes, index, delta, minCellSize) {\n        var ratio = (100 + delta) / 100;\n        var newThis = Math.max(minCellSize, (sizes[index] + delta) / ratio);\n        return map(sizes, function (size, idx) {\n          var newSize = idx === index ? newThis : size / ratio;\n          return newSize - size;\n        });\n      };\n      var calcLeftEdgeDeltas = function (sizes, index, next, delta, minCellSize, isRelative) {\n        if (isRelative) {\n          return calcRelativeDeltas(sizes, index, delta, minCellSize);\n        } else {\n          return calcFixedDeltas(sizes, index, next, delta, minCellSize);\n        }\n      };\n      var calcMiddleDeltas = function (sizes, _prev, index, next, delta, minCellSize, isRelative) {\n        return calcLeftEdgeDeltas(sizes, index, next, delta, minCellSize, isRelative);\n      };\n      var resizeTable = function (resizer, delta) {\n        return resizer(delta);\n      };\n      var calcRightEdgeDeltas = function (sizes, _prev, index, delta, minCellSize, isRelative) {\n        if (isRelative) {\n          return calcRelativeDeltas(sizes, index, delta, minCellSize);\n        } else {\n          var clampedDelta = clampNegativeDelta(sizes, index, delta, minCellSize);\n          return zero(sizes.slice(0, index)).concat([clampedDelta]);\n        }\n      };\n      var calcRedestributedWidths = function (sizes, totalWidth, pixelDelta, isRelative) {\n        if (isRelative) {\n          var tableWidth = totalWidth + pixelDelta;\n          var ratio_1 = tableWidth / totalWidth;\n          var newSizes = map(sizes, function (size) {\n            return size / ratio_1;\n          });\n          return {\n            delta: ratio_1 * 100 - 100,\n            newSizes: newSizes\n          };\n        } else {\n          return {\n            delta: pixelDelta,\n            newSizes: sizes\n          };\n        }\n      };\n      return {\n        resizeTable: resizeTable,\n        clampTableDelta: clampNegativeDelta,\n        calcLeftEdgeDeltas: calcLeftEdgeDeltas,\n        calcMiddleDeltas: calcMiddleDeltas,\n        calcRightEdgeDeltas: calcRightEdgeDeltas,\n        calcRedestributedWidths: calcRedestributedWidths\n      };\n    };\n    var preserveTable = function () {\n      var calcLeftEdgeDeltas = function (sizes, index, next, delta, minCellSize) {\n        var idx = delta >= 0 ? next : index;\n        var clampedDelta = clampDelta(sizes, idx, delta, minCellSize);\n        return surround(sizes, index, next + 1, [\n          clampedDelta,\n          -clampedDelta\n        ], zero);\n      };\n      var calcMiddleDeltas = function (sizes, _prev, index, next, delta, minCellSize) {\n        return calcLeftEdgeDeltas(sizes, index, next, delta, minCellSize);\n      };\n      var resizeTable = function (resizer, delta, isLastColumn) {\n        if (isLastColumn) {\n          resizer(delta);\n        }\n      };\n      var calcRightEdgeDeltas = function (sizes, _prev, _index, delta, _minCellSize, isRelative) {\n        if (isRelative) {\n          return zero(sizes);\n        } else {\n          var diff = delta / sizes.length;\n          return map(sizes, constant(diff));\n        }\n      };\n      var clampTableDelta = function (sizes, index, delta, minCellSize, isLastColumn) {\n        if (isLastColumn) {\n          if (delta >= 0) {\n            return delta;\n          } else {\n            var maxDelta = foldl(sizes, function (a, b) {\n              return a + b - minCellSize;\n            }, 0);\n            return Math.max(-maxDelta, delta);\n          }\n        } else {\n          return clampNegativeDelta(sizes, index, delta, minCellSize);\n        }\n      };\n      var calcRedestributedWidths = function (sizes, _totalWidth, _pixelDelta, _isRelative) {\n        return {\n          delta: 0,\n          newSizes: sizes\n        };\n      };\n      return {\n        resizeTable: resizeTable,\n        clampTableDelta: clampTableDelta,\n        calcLeftEdgeDeltas: calcLeftEdgeDeltas,\n        calcMiddleDeltas: calcMiddleDeltas,\n        calcRightEdgeDeltas: calcRightEdgeDeltas,\n        calcRedestributedWidths: calcRedestributedWidths\n      };\n    };\n\n    var only = function (element, isResizable) {\n      var parent = Optional.from(element.dom.documentElement).map(SugarElement.fromDom).getOr(element);\n      return {\n        parent: constant(parent),\n        view: constant(element),\n        origin: constant(SugarPosition(0, 0)),\n        isResizable: isResizable\n      };\n    };\n    var detached = function (editable, chrome, isResizable) {\n      var origin = function () {\n        return absolute(chrome);\n      };\n      return {\n        parent: constant(chrome),\n        view: constant(editable),\n        origin: origin,\n        isResizable: isResizable\n      };\n    };\n    var body$1 = function (editable, chrome, isResizable) {\n      return {\n        parent: constant(chrome),\n        view: constant(editable),\n        origin: constant(SugarPosition(0, 0)),\n        isResizable: isResizable\n      };\n    };\n    var ResizeWire = {\n      only: only,\n      detached: detached,\n      body: body$1\n    };\n\n    var adt$1 = Adt.generate([\n      { invalid: ['raw'] },\n      { pixels: ['value'] },\n      { percent: ['value'] }\n    ]);\n    var validateFor = function (suffix, type, value) {\n      var rawAmount = value.substring(0, value.length - suffix.length);\n      var amount = parseFloat(rawAmount);\n      return rawAmount === amount.toString() ? type(amount) : adt$1.invalid(value);\n    };\n    var from$1 = function (value) {\n      if (endsWith(value, '%')) {\n        return validateFor('%', adt$1.percent, value);\n      }\n      if (endsWith(value, 'px')) {\n        return validateFor('px', adt$1.pixels, value);\n      }\n      return adt$1.invalid(value);\n    };\n    var Size = __assign(__assign({}, adt$1), { from: from$1 });\n\n    var redistributeToPercent = function (widths, totalWidth) {\n      return map(widths, function (w) {\n        var colType = Size.from(w);\n        return colType.fold(function () {\n          return w;\n        }, function (px) {\n          var ratio = px / totalWidth * 100;\n          return ratio + '%';\n        }, function (pc) {\n          return pc + '%';\n        });\n      });\n    };\n    var redistributeToPx = function (widths, totalWidth, newTotalWidth) {\n      var scale = newTotalWidth / totalWidth;\n      return map(widths, function (w) {\n        var colType = Size.from(w);\n        return colType.fold(function () {\n          return w;\n        }, function (px) {\n          return px * scale + 'px';\n        }, function (pc) {\n          return pc / 100 * newTotalWidth + 'px';\n        });\n      });\n    };\n    var redistributeEmpty = function (newWidthType, columns) {\n      var f = newWidthType.fold(function () {\n        return constant('');\n      }, function (pixels) {\n        var num = pixels / columns;\n        return constant(num + 'px');\n      }, function () {\n        var num = 100 / columns;\n        return constant(num + '%');\n      });\n      return range(columns, f);\n    };\n    var redistributeValues = function (newWidthType, widths, totalWidth) {\n      return newWidthType.fold(function () {\n        return widths;\n      }, function (px) {\n        return redistributeToPx(widths, totalWidth, px);\n      }, function (_pc) {\n        return redistributeToPercent(widths, totalWidth);\n      });\n    };\n    var redistribute = function (widths, totalWidth, newWidth) {\n      var newType = Size.from(newWidth);\n      var floats = forall(widths, function (s) {\n        return s === '0px';\n      }) ? redistributeEmpty(newType, widths.length) : redistributeValues(newType, widths, totalWidth);\n      return normalize(floats);\n    };\n    var sum = function (values, fallback) {\n      if (values.length === 0) {\n        return fallback;\n      }\n      return foldr(values, function (rest, v) {\n        return Size.from(v).fold(constant(0), identity, identity) + rest;\n      }, 0);\n    };\n    var roundDown = function (num, unit) {\n      var floored = Math.floor(num);\n      return {\n        value: floored + unit,\n        remainder: num - floored\n      };\n    };\n    var add = function (value, amount) {\n      return Size.from(value).fold(constant(value), function (px) {\n        return px + amount + 'px';\n      }, function (pc) {\n        return pc + amount + '%';\n      });\n    };\n    var normalize = function (values) {\n      if (values.length === 0) {\n        return values;\n      }\n      var scan = foldr(values, function (rest, value) {\n        var info = Size.from(value).fold(function () {\n          return {\n            value: value,\n            remainder: 0\n          };\n        }, function (num) {\n          return roundDown(num, 'px');\n        }, function (num) {\n          return {\n            value: num + '%',\n            remainder: 0\n          };\n        });\n        return {\n          output: [info.value].concat(rest.output),\n          remainder: rest.remainder + info.remainder\n        };\n      }, {\n        output: [],\n        remainder: 0\n      });\n      var r = scan.output;\n      return r.slice(0, r.length - 1).concat([add(r[r.length - 1], Math.round(scan.remainder))]);\n    };\n    var validate = Size.from;\n\n    var redistributeToW = function (newWidths, cells, unit) {\n      each(cells, function (cell) {\n        var widths = newWidths.slice(cell.column, cell.colspan + cell.column);\n        var w = sum(widths, minWidth());\n        set$1(cell.element, 'width', w + unit);\n      });\n    };\n    var redistributeToColumns = function (newWidths, columns, unit) {\n      each(columns, function (column, index) {\n        var width = sum([newWidths[index]], minWidth());\n        set$1(column.element, 'width', width + unit);\n      });\n    };\n    var redistributeToH = function (newHeights, rows, cells, unit) {\n      each(cells, function (cell) {\n        var heights = newHeights.slice(cell.row, cell.rowspan + cell.row);\n        var h = sum(heights, minHeight());\n        set$1(cell.element, 'height', h + unit);\n      });\n      each(rows, function (row, i) {\n        set$1(row.element, 'height', newHeights[i]);\n      });\n    };\n    var getUnit = function (newSize) {\n      return validate(newSize).fold(constant('px'), constant('px'), constant('%'));\n    };\n    var redistribute$1 = function (table, optWidth, optHeight, tableSize) {\n      var warehouse = Warehouse.fromTable(table);\n      var rows = warehouse.all;\n      var cells = Warehouse.justCells(warehouse);\n      var columns = Warehouse.justColumns(warehouse);\n      optWidth.each(function (newWidth) {\n        var widthUnit = getUnit(newWidth);\n        var totalWidth = get$5(table);\n        var oldWidths = getRawWidths(warehouse, table, tableSize);\n        var nuWidths = redistribute(oldWidths, totalWidth, newWidth);\n        if (Warehouse.hasColumns(warehouse)) {\n          redistributeToColumns(nuWidths, columns, widthUnit);\n        } else {\n          redistributeToW(nuWidths, cells, widthUnit);\n        }\n        set$1(table, 'width', newWidth);\n      });\n      optHeight.each(function (newHeight) {\n        var hUnit = getUnit(newHeight);\n        var totalHeight = get$6(table);\n        var oldHeights = getRawHeights(warehouse, table, height);\n        var nuHeights = redistribute(oldHeights, totalHeight, newHeight);\n        redistributeToH(nuHeights, rows, cells, hUnit);\n        set$1(table, 'height', newHeight);\n      });\n    };\n    var isPercentSizing$1 = isPercentSizing;\n    var isPixelSizing$1 = isPixelSizing;\n    var isNoneSizing$1 = isNoneSizing;\n    var getPercentTableWidth$1 = getPercentTableWidth;\n\n    var getGridSize = function (table) {\n      var warehouse = Warehouse.fromTable(table);\n      return warehouse.grid;\n    };\n\n    var Event = function (fields) {\n      var handlers = [];\n      var bind = function (handler) {\n        if (handler === undefined) {\n          throw new Error('Event bind error: undefined handler');\n        }\n        handlers.push(handler);\n      };\n      var unbind = function (handler) {\n        handlers = filter(handlers, function (h) {\n          return h !== handler;\n        });\n      };\n      var trigger = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        var event = {};\n        each(fields, function (name, i) {\n          event[name] = args[i];\n        });\n        each(handlers, function (handler) {\n          handler(event);\n        });\n      };\n      return {\n        bind: bind,\n        unbind: unbind,\n        trigger: trigger\n      };\n    };\n\n    var create = function (typeDefs) {\n      var registry = map$1(typeDefs, function (event) {\n        return {\n          bind: event.bind,\n          unbind: event.unbind\n        };\n      });\n      var trigger = map$1(typeDefs, function (event) {\n        return event.trigger;\n      });\n      return {\n        registry: registry,\n        trigger: trigger\n      };\n    };\n\n    var last$2 = function (fn, rate) {\n      var timer = null;\n      var cancel = function () {\n        if (timer !== null) {\n          clearTimeout(timer);\n          timer = null;\n        }\n      };\n      var throttle = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        if (timer !== null) {\n          clearTimeout(timer);\n        }\n        timer = setTimeout(function () {\n          fn.apply(null, args);\n          timer = null;\n        }, rate);\n      };\n      return {\n        cancel: cancel,\n        throttle: throttle\n      };\n    };\n\n    var sort$1 = function (arr) {\n      return arr.slice(0).sort();\n    };\n    var reqMessage = function (required, keys) {\n      throw new Error('All required keys (' + sort$1(required).join(', ') + ') were not specified. Specified keys were: ' + sort$1(keys).join(', ') + '.');\n    };\n    var unsuppMessage = function (unsupported) {\n      throw new Error('Unsupported keys for object: ' + sort$1(unsupported).join(', '));\n    };\n    var validateStrArr = function (label, array) {\n      if (!isArray(array)) {\n        throw new Error('The ' + label + ' fields must be an array. Was: ' + array + '.');\n      }\n      each(array, function (a) {\n        if (!isString(a)) {\n          throw new Error('The value ' + a + ' in the ' + label + ' fields was not a string.');\n        }\n      });\n    };\n    var invalidTypeMessage = function (incorrect, type) {\n      throw new Error('All values need to be of type: ' + type + '. Keys (' + sort$1(incorrect).join(', ') + ') were not.');\n    };\n    var checkDupes = function (everything) {\n      var sorted = sort$1(everything);\n      var dupe = find(sorted, function (s, i) {\n        return i < sorted.length - 1 && s === sorted[i + 1];\n      });\n      dupe.each(function (d) {\n        throw new Error('The field: ' + d + ' occurs more than once in the combined fields: [' + sorted.join(', ') + '].');\n      });\n    };\n\n    var base = function (handleUnsupported, required) {\n      return baseWith(handleUnsupported, required, {\n        validate: isFunction,\n        label: 'function'\n      });\n    };\n    var baseWith = function (handleUnsupported, required, pred) {\n      if (required.length === 0) {\n        throw new Error('You must specify at least one required field.');\n      }\n      validateStrArr('required', required);\n      checkDupes(required);\n      return function (obj) {\n        var keys$1 = keys(obj);\n        var allReqd = forall(required, function (req) {\n          return contains(keys$1, req);\n        });\n        if (!allReqd) {\n          reqMessage(required, keys$1);\n        }\n        handleUnsupported(required, keys$1);\n        var invalidKeys = filter(required, function (key) {\n          return !pred.validate(obj[key], key);\n        });\n        if (invalidKeys.length > 0) {\n          invalidTypeMessage(invalidKeys, pred.label);\n        }\n        return obj;\n      };\n    };\n    var handleExact = function (required, keys) {\n      var unsupported = filter(keys, function (key) {\n        return !contains(required, key);\n      });\n      if (unsupported.length > 0) {\n        unsuppMessage(unsupported);\n      }\n    };\n    var exactly = function (required) {\n      return base(handleExact, required);\n    };\n\n    var DragMode = exactly([\n      'compare',\n      'extract',\n      'mutate',\n      'sink'\n    ]);\n    var DragSink = exactly([\n      'element',\n      'start',\n      'stop',\n      'destroy'\n    ]);\n    var DragApi = exactly([\n      'forceDrop',\n      'drop',\n      'move',\n      'delayDrop'\n    ]);\n\n    var InDrag = function () {\n      var previous = Optional.none();\n      var reset = function () {\n        previous = Optional.none();\n      };\n      var update = function (mode, nu) {\n        var result = previous.map(function (old) {\n          return mode.compare(old, nu);\n        });\n        previous = Optional.some(nu);\n        return result;\n      };\n      var onEvent = function (event, mode) {\n        var dataOption = mode.extract(event);\n        dataOption.each(function (data) {\n          var offset = update(mode, data);\n          offset.each(function (d) {\n            events.trigger.move(d);\n          });\n        });\n      };\n      var events = create({ move: Event(['info']) });\n      return {\n        onEvent: onEvent,\n        reset: reset,\n        events: events.registry\n      };\n    };\n\n    var NoDrag = function () {\n      var events = create({ move: Event(['info']) });\n      return {\n        onEvent: noop,\n        reset: noop,\n        events: events.registry\n      };\n    };\n\n    var Movement = function () {\n      var noDragState = NoDrag();\n      var inDragState = InDrag();\n      var dragState = noDragState;\n      var on = function () {\n        dragState.reset();\n        dragState = inDragState;\n      };\n      var off = function () {\n        dragState.reset();\n        dragState = noDragState;\n      };\n      var onEvent = function (event, mode) {\n        dragState.onEvent(event, mode);\n      };\n      var isOn = function () {\n        return dragState === inDragState;\n      };\n      return {\n        on: on,\n        off: off,\n        isOn: isOn,\n        onEvent: onEvent,\n        events: inDragState.events\n      };\n    };\n\n    var setup = function (mutation, mode, settings) {\n      var active = false;\n      var events = create({\n        start: Event([]),\n        stop: Event([])\n      });\n      var movement = Movement();\n      var drop = function () {\n        sink.stop();\n        if (movement.isOn()) {\n          movement.off();\n          events.trigger.stop();\n        }\n      };\n      var throttledDrop = last$2(drop, 200);\n      var go = function (parent) {\n        sink.start(parent);\n        movement.on();\n        events.trigger.start();\n      };\n      var mousemove = function (event) {\n        throttledDrop.cancel();\n        movement.onEvent(event, mode);\n      };\n      movement.events.move.bind(function (event) {\n        mode.mutate(mutation, event.info);\n      });\n      var on = function () {\n        active = true;\n      };\n      var off = function () {\n        active = false;\n      };\n      var runIfActive = function (f) {\n        return function () {\n          var args = [];\n          for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n          }\n          if (active) {\n            f.apply(null, args);\n          }\n        };\n      };\n      var sink = mode.sink(DragApi({\n        forceDrop: drop,\n        drop: runIfActive(drop),\n        move: runIfActive(mousemove),\n        delayDrop: runIfActive(throttledDrop.throttle)\n      }), settings);\n      var destroy = function () {\n        sink.destroy();\n      };\n      return {\n        element: sink.element,\n        go: go,\n        on: on,\n        off: off,\n        destroy: destroy,\n        events: events.registry\n      };\n    };\n\n    var mkEvent = function (target, x, y, stop, prevent, kill, raw) {\n      return {\n        target: target,\n        x: x,\n        y: y,\n        stop: stop,\n        prevent: prevent,\n        kill: kill,\n        raw: raw\n      };\n    };\n    var fromRawEvent = function (rawEvent) {\n      var target = SugarElement.fromDom(getOriginalEventTarget(rawEvent).getOr(rawEvent.target));\n      var stop = function () {\n        return rawEvent.stopPropagation();\n      };\n      var prevent = function () {\n        return rawEvent.preventDefault();\n      };\n      var kill = compose(prevent, stop);\n      return mkEvent(target, rawEvent.clientX, rawEvent.clientY, stop, prevent, kill, rawEvent);\n    };\n    var handle = function (filter, handler) {\n      return function (rawEvent) {\n        if (filter(rawEvent)) {\n          handler(fromRawEvent(rawEvent));\n        }\n      };\n    };\n    var binder = function (element, event, filter, handler, useCapture) {\n      var wrapped = handle(filter, handler);\n      element.dom.addEventListener(event, wrapped, useCapture);\n      return { unbind: curry(unbind, element, event, wrapped, useCapture) };\n    };\n    var bind$1 = function (element, event, filter, handler) {\n      return binder(element, event, filter, handler, false);\n    };\n    var unbind = function (element, event, handler, useCapture) {\n      element.dom.removeEventListener(event, handler, useCapture);\n    };\n\n    var filter$2 = always;\n    var bind$2 = function (element, event, handler) {\n      return bind$1(element, event, filter$2, handler);\n    };\n    var fromRawEvent$1 = fromRawEvent;\n\n    var read = function (element, attr) {\n      var value = get$2(element, attr);\n      return value === undefined || value === '' ? [] : value.split(' ');\n    };\n    var add$1 = function (element, attr, id) {\n      var old = read(element, attr);\n      var nu = old.concat([id]);\n      set(element, attr, nu.join(' '));\n      return true;\n    };\n    var remove$3 = function (element, attr, id) {\n      var nu = filter(read(element, attr), function (v) {\n        return v !== id;\n      });\n      if (nu.length > 0) {\n        set(element, attr, nu.join(' '));\n      } else {\n        remove(element, attr);\n      }\n      return false;\n    };\n\n    var supports = function (element) {\n      return element.dom.classList !== undefined;\n    };\n    var get$8 = function (element) {\n      return read(element, 'class');\n    };\n    var add$2 = function (element, clazz) {\n      return add$1(element, 'class', clazz);\n    };\n    var remove$4 = function (element, clazz) {\n      return remove$3(element, 'class', clazz);\n    };\n\n    var add$3 = function (element, clazz) {\n      if (supports(element)) {\n        element.dom.classList.add(clazz);\n      } else {\n        add$2(element, clazz);\n      }\n    };\n    var cleanClass = function (element) {\n      var classList = supports(element) ? element.dom.classList : get$8(element);\n      if (classList.length === 0) {\n        remove(element, 'class');\n      }\n    };\n    var remove$5 = function (element, clazz) {\n      if (supports(element)) {\n        var classList = element.dom.classList;\n        classList.remove(clazz);\n      } else {\n        remove$4(element, clazz);\n      }\n      cleanClass(element);\n    };\n    var has$1 = function (element, clazz) {\n      return supports(element) && element.dom.classList.contains(clazz);\n    };\n\n    var css = function (namespace) {\n      var dashNamespace = namespace.replace(/\\./g, '-');\n      var resolve = function (str) {\n        return dashNamespace + '-' + str;\n      };\n      return { resolve: resolve };\n    };\n\n    var styles = css('ephox-dragster');\n    var resolve = styles.resolve;\n\n    var Blocker = function (options) {\n      var settings = __assign({ layerClass: resolve('blocker') }, options);\n      var div = SugarElement.fromTag('div');\n      set(div, 'role', 'presentation');\n      setAll$1(div, {\n        position: 'fixed',\n        left: '0px',\n        top: '0px',\n        width: '100%',\n        height: '100%'\n      });\n      add$3(div, resolve('blocker'));\n      add$3(div, settings.layerClass);\n      var element = function () {\n        return div;\n      };\n      var destroy = function () {\n        remove$2(div);\n      };\n      return {\n        element: element,\n        destroy: destroy\n      };\n    };\n\n    var compare = function (old, nu) {\n      return SugarPosition(nu.left - old.left, nu.top - old.top);\n    };\n    var extract$1 = function (event) {\n      return Optional.some(SugarPosition(event.x, event.y));\n    };\n    var mutate = function (mutation, info) {\n      mutation.mutate(info.left, info.top);\n    };\n    var sink = function (dragApi, settings) {\n      var blocker = Blocker(settings);\n      var mdown = bind$2(blocker.element(), 'mousedown', dragApi.forceDrop);\n      var mup = bind$2(blocker.element(), 'mouseup', dragApi.drop);\n      var mmove = bind$2(blocker.element(), 'mousemove', dragApi.move);\n      var mout = bind$2(blocker.element(), 'mouseout', dragApi.delayDrop);\n      var destroy = function () {\n        blocker.destroy();\n        mup.unbind();\n        mmove.unbind();\n        mout.unbind();\n        mdown.unbind();\n      };\n      var start = function (parent) {\n        append(parent, blocker.element());\n      };\n      var stop = function () {\n        remove$2(blocker.element());\n      };\n      return DragSink({\n        element: blocker.element,\n        start: start,\n        stop: stop,\n        destroy: destroy\n      });\n    };\n    var MouseDrag = DragMode({\n      compare: compare,\n      extract: extract$1,\n      sink: sink,\n      mutate: mutate\n    });\n\n    var transform = function (mutation, settings) {\n      if (settings === void 0) {\n        settings = {};\n      }\n      var mode = settings.mode !== undefined ? settings.mode : MouseDrag;\n      return setup(mutation, mode, settings);\n    };\n\n    var isContentEditableTrue = function (elm) {\n      return get$2(elm, 'contenteditable') === 'true';\n    };\n    var findClosestContentEditable = function (target, isRoot) {\n      return closest$1(target, '[contenteditable]', isRoot);\n    };\n\n    var styles$1 = css('ephox-snooker');\n    var resolve$1 = styles$1.resolve;\n\n    var Mutation = function () {\n      var events = create({\n        drag: Event([\n          'xDelta',\n          'yDelta'\n        ])\n      });\n      var mutate = function (x, y) {\n        events.trigger.drag(x, y);\n      };\n      return {\n        mutate: mutate,\n        events: events.registry\n      };\n    };\n\n    var BarMutation = function () {\n      var events = create({\n        drag: Event([\n          'xDelta',\n          'yDelta',\n          'target'\n        ])\n      });\n      var target = Optional.none();\n      var delegate = Mutation();\n      delegate.events.drag.bind(function (event) {\n        target.each(function (t) {\n          events.trigger.drag(event.xDelta, event.yDelta, t);\n        });\n      });\n      var assign = function (t) {\n        target = Optional.some(t);\n      };\n      var get = function () {\n        return target;\n      };\n      return {\n        assign: assign,\n        get: get,\n        mutate: delegate.mutate,\n        events: events.registry\n      };\n    };\n\n    var col = function (column, x, y, w, h) {\n      var bar = SugarElement.fromTag('div');\n      setAll$1(bar, {\n        position: 'absolute',\n        left: x - w / 2 + 'px',\n        top: y + 'px',\n        height: h + 'px',\n        width: w + 'px'\n      });\n      setAll(bar, {\n        'data-column': column,\n        'role': 'presentation'\n      });\n      return bar;\n    };\n    var row = function (r, x, y, w, h) {\n      var bar = SugarElement.fromTag('div');\n      setAll$1(bar, {\n        position: 'absolute',\n        left: x + 'px',\n        top: y - h / 2 + 'px',\n        height: h + 'px',\n        width: w + 'px'\n      });\n      setAll(bar, {\n        'data-row': r,\n        'role': 'presentation'\n      });\n      return bar;\n    };\n\n    var resizeBar = resolve$1('resizer-bar');\n    var resizeRowBar = resolve$1('resizer-rows');\n    var resizeColBar = resolve$1('resizer-cols');\n    var BAR_THICKNESS = 7;\n    var resizableRows = function (warehouse, isResizable) {\n      return bind(warehouse.all, function (row, i) {\n        return isResizable(row.element) ? [i] : [];\n      });\n    };\n    var resizableColumns = function (warehouse, isResizable) {\n      var resizableCols = [];\n      range(warehouse.grid.columns, function (index) {\n        var colElmOpt = Warehouse.getColumnAt(warehouse, index).map(function (col) {\n          return col.element;\n        });\n        if (colElmOpt.forall(isResizable)) {\n          resizableCols.push(index);\n        }\n      });\n      return filter(resizableCols, function (colIndex) {\n        var columnCells = Warehouse.filterItems(warehouse, function (cell) {\n          return cell.column === colIndex;\n        });\n        return forall(columnCells, function (cell) {\n          return isResizable(cell.element);\n        });\n      });\n    };\n    var destroy = function (wire) {\n      var previous = descendants$1(wire.parent(), '.' + resizeBar);\n      each(previous, remove$2);\n    };\n    var drawBar = function (wire, positions, create) {\n      var origin = wire.origin();\n      each(positions, function (cpOption) {\n        cpOption.each(function (cp) {\n          var bar = create(origin, cp);\n          add$3(bar, resizeBar);\n          append(wire.parent(), bar);\n        });\n      });\n    };\n    var refreshCol = function (wire, colPositions, position, tableHeight) {\n      drawBar(wire, colPositions, function (origin, cp) {\n        var colBar = col(cp.col, cp.x - origin.left, position.top - origin.top, BAR_THICKNESS, tableHeight);\n        add$3(colBar, resizeColBar);\n        return colBar;\n      });\n    };\n    var refreshRow = function (wire, rowPositions, position, tableWidth) {\n      drawBar(wire, rowPositions, function (origin, cp) {\n        var rowBar = row(cp.row, position.left - origin.left, cp.y - origin.top, tableWidth, BAR_THICKNESS);\n        add$3(rowBar, resizeRowBar);\n        return rowBar;\n      });\n    };\n    var refreshGrid = function (warhouse, wire, table, rows, cols) {\n      var position = absolute(table);\n      var isResizable = wire.isResizable;\n      var rowPositions = rows.length > 0 ? height.positions(rows, table) : [];\n      var resizableRowBars = rowPositions.length > 0 ? resizableRows(warhouse, isResizable) : [];\n      var resizableRowPositions = filter(rowPositions, function (_pos, i) {\n        return exists(resizableRowBars, function (barIndex) {\n          return i === barIndex;\n        });\n      });\n      refreshRow(wire, resizableRowPositions, position, getOuter(table));\n      var colPositions = cols.length > 0 ? width.positions(cols, table) : [];\n      var resizableColBars = colPositions.length > 0 ? resizableColumns(warhouse, isResizable) : [];\n      var resizableColPositions = filter(colPositions, function (_pos, i) {\n        return exists(resizableColBars, function (barIndex) {\n          return i === barIndex;\n        });\n      });\n      refreshCol(wire, resizableColPositions, position, getOuter$1(table));\n    };\n    var refresh = function (wire, table) {\n      destroy(wire);\n      if (wire.isResizable(table)) {\n        var warehouse = Warehouse.fromTable(table);\n        var rows = rows$1(warehouse);\n        var cols = columns$1(warehouse);\n        refreshGrid(warehouse, wire, table, rows, cols);\n      }\n    };\n    var each$2 = function (wire, f) {\n      var bars = descendants$1(wire.parent(), '.' + resizeBar);\n      each(bars, f);\n    };\n    var hide = function (wire) {\n      each$2(wire, function (bar) {\n        set$1(bar, 'display', 'none');\n      });\n    };\n    var show = function (wire) {\n      each$2(wire, function (bar) {\n        set$1(bar, 'display', 'block');\n      });\n    };\n    var isRowBar = function (element) {\n      return has$1(element, resizeRowBar);\n    };\n    var isColBar = function (element) {\n      return has$1(element, resizeColBar);\n    };\n\n    var resizeBarDragging = resolve$1('resizer-bar-dragging');\n    var BarManager = function (wire) {\n      var mutation = BarMutation();\n      var resizing = transform(mutation, {});\n      var hoverTable = Optional.none();\n      var getResizer = function (element, type) {\n        return Optional.from(get$2(element, type));\n      };\n      mutation.events.drag.bind(function (event) {\n        getResizer(event.target, 'data-row').each(function (_dataRow) {\n          var currentRow = getCssValue(event.target, 'top');\n          set$1(event.target, 'top', currentRow + event.yDelta + 'px');\n        });\n        getResizer(event.target, 'data-column').each(function (_dataCol) {\n          var currentCol = getCssValue(event.target, 'left');\n          set$1(event.target, 'left', currentCol + event.xDelta + 'px');\n        });\n      });\n      var getDelta = function (target, dir) {\n        var newX = getCssValue(target, dir);\n        var oldX = getAttrValue(target, 'data-initial-' + dir, 0);\n        return newX - oldX;\n      };\n      resizing.events.stop.bind(function () {\n        mutation.get().each(function (target) {\n          hoverTable.each(function (table) {\n            getResizer(target, 'data-row').each(function (row) {\n              var delta = getDelta(target, 'top');\n              remove(target, 'data-initial-top');\n              events.trigger.adjustHeight(table, delta, parseInt(row, 10));\n            });\n            getResizer(target, 'data-column').each(function (column) {\n              var delta = getDelta(target, 'left');\n              remove(target, 'data-initial-left');\n              events.trigger.adjustWidth(table, delta, parseInt(column, 10));\n            });\n            refresh(wire, table);\n          });\n        });\n      });\n      var handler = function (target, dir) {\n        events.trigger.startAdjust();\n        mutation.assign(target);\n        set(target, 'data-initial-' + dir, getCssValue(target, dir));\n        add$3(target, resizeBarDragging);\n        set$1(target, 'opacity', '0.2');\n        resizing.go(wire.parent());\n      };\n      var mousedown = bind$2(wire.parent(), 'mousedown', function (event) {\n        if (isRowBar(event.target)) {\n          handler(event.target, 'top');\n        }\n        if (isColBar(event.target)) {\n          handler(event.target, 'left');\n        }\n      });\n      var isRoot = function (e) {\n        return eq$1(e, wire.view());\n      };\n      var findClosestEditableTable = function (target) {\n        return closest$1(target, 'table', isRoot).filter(function (table) {\n          return findClosestContentEditable(table, isRoot).exists(isContentEditableTrue);\n        });\n      };\n      var mouseover = bind$2(wire.view(), 'mouseover', function (event) {\n        findClosestEditableTable(event.target).fold(function () {\n          if (inBody(event.target)) {\n            destroy(wire);\n          }\n        }, function (table) {\n          hoverTable = Optional.some(table);\n          refresh(wire, table);\n        });\n      });\n      var destroy$1 = function () {\n        mousedown.unbind();\n        mouseover.unbind();\n        resizing.destroy();\n        destroy(wire);\n      };\n      var refresh$1 = function (tbl) {\n        refresh(wire, tbl);\n      };\n      var events = create({\n        adjustHeight: Event([\n          'table',\n          'delta',\n          'row'\n        ]),\n        adjustWidth: Event([\n          'table',\n          'delta',\n          'column'\n        ]),\n        startAdjust: Event([])\n      });\n      return {\n        destroy: destroy$1,\n        refresh: refresh$1,\n        on: resizing.on,\n        off: resizing.off,\n        hideBars: curry(hide, wire),\n        showBars: curry(show, wire),\n        events: events.registry\n      };\n    };\n\n    var create$1 = function (wire, resizing, lazySizing) {\n      var hdirection = height;\n      var vdirection = width;\n      var manager = BarManager(wire);\n      var events = create({\n        beforeResize: Event([\n          'table',\n          'type'\n        ]),\n        afterResize: Event([\n          'table',\n          'type'\n        ]),\n        startDrag: Event([])\n      });\n      manager.events.adjustHeight.bind(function (event) {\n        var table = event.table;\n        events.trigger.beforeResize(table, 'row');\n        var delta = hdirection.delta(event.delta, table);\n        adjustHeight(table, delta, event.row, hdirection);\n        events.trigger.afterResize(table, 'row');\n      });\n      manager.events.startAdjust.bind(function (_event) {\n        events.trigger.startDrag();\n      });\n      manager.events.adjustWidth.bind(function (event) {\n        var table = event.table;\n        events.trigger.beforeResize(table, 'col');\n        var delta = vdirection.delta(event.delta, table);\n        var tableSize = lazySizing(table);\n        adjustWidth(table, delta, event.column, resizing, tableSize);\n        events.trigger.afterResize(table, 'col');\n      });\n      return {\n        on: manager.on,\n        off: manager.off,\n        hideBars: manager.hideBars,\n        showBars: manager.showBars,\n        destroy: manager.destroy,\n        events: events.registry\n      };\n    };\n    var TableResize = { create: create$1 };\n\n    var fireNewRow = function (editor, row) {\n      return editor.fire('newrow', { node: row });\n    };\n    var fireNewCell = function (editor, cell) {\n      return editor.fire('newcell', { node: cell });\n    };\n    var fireObjectResizeStart = function (editor, target, width, height, origin) {\n      editor.fire('ObjectResizeStart', {\n        target: target,\n        width: width,\n        height: height,\n        origin: origin\n      });\n    };\n    var fireObjectResized = function (editor, target, width, height, origin) {\n      editor.fire('ObjectResized', {\n        target: target,\n        width: width,\n        height: height,\n        origin: origin\n      });\n    };\n    var fireTableSelectionChange = function (editor, cells, start, finish, otherCells) {\n      editor.fire('TableSelectionChange', {\n        cells: cells,\n        start: start,\n        finish: finish,\n        otherCells: otherCells\n      });\n    };\n    var fireTableSelectionClear = function (editor) {\n      editor.fire('TableSelectionClear');\n    };\n    var fireTableModified = function (editor, table, data) {\n      editor.fire('TableModified', __assign(__assign({}, data), { table: table }));\n    };\n    var styleModified = {\n      structure: false,\n      style: true\n    };\n    var structureModified = {\n      structure: true,\n      style: false\n    };\n\n    var defaultTableToolbar = 'tableprops tabledelete | tableinsertrowbefore tableinsertrowafter tabledeleterow | tableinsertcolbefore tableinsertcolafter tabledeletecol';\n    var defaultStyles = {\n      'border-collapse': 'collapse',\n      'width': '100%'\n    };\n    var determineDefaultStyles = function (editor) {\n      if (isPixelsForced(editor)) {\n        var editorWidth = editor.getBody().offsetWidth;\n        return __assign(__assign({}, defaultStyles), { width: editorWidth + 'px' });\n      } else if (isResponsiveForced(editor)) {\n        return filter$1(defaultStyles, function (_value, key) {\n          return key !== 'width';\n        });\n      } else {\n        return defaultStyles;\n      }\n    };\n    var defaultAttributes = { border: '1' };\n    var defaultColumnResizingBehaviour = 'preservetable';\n    var getTableSizingMode = function (editor) {\n      return editor.getParam('table_sizing_mode', 'auto');\n    };\n    var getTableResponseWidth = function (editor) {\n      return editor.getParam('table_responsive_width');\n    };\n    var getDefaultAttributes = function (editor) {\n      return editor.getParam('table_default_attributes', defaultAttributes, 'object');\n    };\n    var getDefaultStyles = function (editor) {\n      return editor.getParam('table_default_styles', determineDefaultStyles(editor), 'object');\n    };\n    var hasTableResizeBars = function (editor) {\n      return editor.getParam('table_resize_bars', true, 'boolean');\n    };\n    var hasTabNavigation = function (editor) {\n      return editor.getParam('table_tab_navigation', true, 'boolean');\n    };\n    var hasAdvancedCellTab = function (editor) {\n      return editor.getParam('table_cell_advtab', true, 'boolean');\n    };\n    var hasAdvancedRowTab = function (editor) {\n      return editor.getParam('table_row_advtab', true, 'boolean');\n    };\n    var hasAdvancedTableTab = function (editor) {\n      return editor.getParam('table_advtab', true, 'boolean');\n    };\n    var hasAppearanceOptions = function (editor) {\n      return editor.getParam('table_appearance_options', true, 'boolean');\n    };\n    var hasTableGrid = function (editor) {\n      return editor.getParam('table_grid', true, 'boolean');\n    };\n    var shouldStyleWithCss = function (editor) {\n      return editor.getParam('table_style_by_css', false, 'boolean');\n    };\n    var getCellClassList = function (editor) {\n      return editor.getParam('table_cell_class_list', [], 'array');\n    };\n    var getRowClassList = function (editor) {\n      return editor.getParam('table_row_class_list', [], 'array');\n    };\n    var getTableClassList = function (editor) {\n      return editor.getParam('table_class_list', [], 'array');\n    };\n    var isPercentagesForced = function (editor) {\n      return getTableSizingMode(editor) === 'relative' || getTableResponseWidth(editor) === true;\n    };\n    var isPixelsForced = function (editor) {\n      return getTableSizingMode(editor) === 'fixed' || getTableResponseWidth(editor) === false;\n    };\n    var isResponsiveForced = function (editor) {\n      return getTableSizingMode(editor) === 'responsive';\n    };\n    var getToolbar = function (editor) {\n      return editor.getParam('table_toolbar', defaultTableToolbar);\n    };\n    var useColumnGroup = function (editor) {\n      return editor.getParam('table_use_colgroups', false, 'boolean');\n    };\n    var getTableHeaderType = function (editor) {\n      var defaultValue = 'section';\n      var value = editor.getParam('table_header_type', defaultValue, 'string');\n      var validValues = [\n        'section',\n        'cells',\n        'sectionCells',\n        'auto'\n      ];\n      if (!contains(validValues, value)) {\n        return defaultValue;\n      } else {\n        return value;\n      }\n    };\n    var getColumnResizingBehaviour = function (editor) {\n      var validModes = [\n        'preservetable',\n        'resizetable'\n      ];\n      var givenMode = editor.getParam('table_column_resizing', defaultColumnResizingBehaviour, 'string');\n      return find(validModes, function (mode) {\n        return mode === givenMode;\n      }).getOr(defaultColumnResizingBehaviour);\n    };\n    var isPreserveTableColumnResizing = function (editor) {\n      return getColumnResizingBehaviour(editor) === 'preservetable';\n    };\n    var isResizeTableColumnResizing = function (editor) {\n      return getColumnResizingBehaviour(editor) === 'resizetable';\n    };\n    var getCloneElements = function (editor) {\n      var cloneElements = editor.getParam('table_clone_elements');\n      if (isString(cloneElements)) {\n        return Optional.some(cloneElements.split(/[ ,]/));\n      } else if (Array.isArray(cloneElements)) {\n        return Optional.some(cloneElements);\n      } else {\n        return Optional.none();\n      }\n    };\n    var hasObjectResizing = function (editor) {\n      var objectResizing = editor.getParam('object_resizing', true);\n      return isString(objectResizing) ? objectResizing === 'table' : objectResizing;\n    };\n\n    var get$9 = function (editor, table) {\n      if (isPercentagesForced(editor)) {\n        var width = getRawWidth$1(editor, table.dom).filter(isPercentage).getOrThunk(function () {\n          return getPercentTableWidth$1(table);\n        });\n        return TableSize.percentageSize(width, table);\n      } else if (isPixelsForced(editor)) {\n        return TableSize.pixelSize(get$5(table), table);\n      } else {\n        return TableSize.getTableSize(table);\n      }\n    };\n\n    var cleanupLegacyAttributes = function (element) {\n      remove(element, 'width');\n    };\n    var convertToPercentSize = function (table, tableSize) {\n      var newWidth = getPercentTableWidth(table);\n      redistribute$1(table, Optional.some(newWidth), Optional.none(), tableSize);\n      cleanupLegacyAttributes(table);\n    };\n    var convertToPixelSize = function (table, tableSize) {\n      var newWidth = getPixelTableWidth(table);\n      redistribute$1(table, Optional.some(newWidth), Optional.none(), tableSize);\n      cleanupLegacyAttributes(table);\n    };\n    var convertToNoneSize = function (table) {\n      remove$1(table, 'width');\n      var columns$1 = columns(table);\n      var rowElements = columns$1.length > 0 ? columns$1 : cells(table);\n      each(rowElements, function (cell) {\n        remove$1(cell, 'width');\n        cleanupLegacyAttributes(cell);\n      });\n      cleanupLegacyAttributes(table);\n    };\n\n    var enforcePercentage = function (editor, table) {\n      var tableSizing = get$9(editor, table);\n      convertToPercentSize(table, tableSizing);\n    };\n    var enforcePixels = function (editor, table) {\n      var tableSizing = get$9(editor, table);\n      convertToPixelSize(table, tableSizing);\n    };\n    var enforceNone = convertToNoneSize;\n    var syncPixels = function (table) {\n      var warehouse = Warehouse.fromTable(table);\n      if (!Warehouse.hasColumns(warehouse)) {\n        each(cells(table), function (cell) {\n          var computedWidth = get$3(cell, 'width');\n          set$1(cell, 'width', computedWidth);\n          remove(cell, 'width');\n        });\n      }\n    };\n\n    var createContainer = function () {\n      var container = SugarElement.fromTag('div');\n      setAll$1(container, {\n        position: 'static',\n        height: '0',\n        width: '0',\n        padding: '0',\n        margin: '0',\n        border: '0'\n      });\n      append(body(), container);\n      return container;\n    };\n    var get$a = function (editor, isResizable) {\n      return editor.inline ? ResizeWire.body(getBody$1(editor), createContainer(), isResizable) : ResizeWire.only(SugarElement.fromDom(editor.getDoc()), isResizable);\n    };\n    var remove$6 = function (editor, wire) {\n      if (editor.inline) {\n        remove$2(wire.parent());\n      }\n    };\n\n    var barResizerPrefix = 'bar-';\n    var isResizable = function (elm) {\n      return get$2(elm, 'data-mce-resize') !== 'false';\n    };\n    var getResizeHandler = function (editor) {\n      var selectionRng = Optional.none();\n      var resize = Optional.none();\n      var wire = Optional.none();\n      var startW;\n      var startRawW;\n      var isTable = function (elm) {\n        return elm.nodeName === 'TABLE';\n      };\n      var lazyResize = function () {\n        return resize;\n      };\n      var lazyWire = function () {\n        return wire.getOr(ResizeWire.only(SugarElement.fromDom(editor.getBody()), isResizable));\n      };\n      var lazySizing = function (table) {\n        return get$9(editor, table);\n      };\n      var lazyResizingBehaviour = function () {\n        return isPreserveTableColumnResizing(editor) ? preserveTable() : resizeTable();\n      };\n      var getNumColumns = function (table) {\n        return getGridSize(table).columns;\n      };\n      var afterCornerResize = function (table, origin, width) {\n        var isRightEdgeResize = endsWith(origin, 'e');\n        if (startRawW === '') {\n          enforcePercentage(editor, table);\n        }\n        if (width !== startW && startRawW !== '') {\n          set$1(table, 'width', startRawW);\n          var resizing = lazyResizingBehaviour();\n          var tableSize = lazySizing(table);\n          var col = isPreserveTableColumnResizing(editor) || isRightEdgeResize ? getNumColumns(table) - 1 : 0;\n          adjustWidth(table, width - startW, col, resizing, tableSize);\n        } else if (isPercentage(startRawW)) {\n          var percentW = parseFloat(startRawW.replace('%', ''));\n          var targetPercentW = width * percentW / startW;\n          set$1(table, 'width', targetPercentW + '%');\n        }\n        if (isPixel(startRawW)) {\n          syncPixels(table);\n        }\n      };\n      var destroy = function () {\n        resize.each(function (sz) {\n          sz.destroy();\n        });\n        wire.each(function (w) {\n          remove$6(editor, w);\n        });\n      };\n      editor.on('init', function () {\n        var rawWire = get$a(editor, isResizable);\n        wire = Optional.some(rawWire);\n        if (hasObjectResizing(editor) && hasTableResizeBars(editor)) {\n          var resizing = lazyResizingBehaviour();\n          var sz = TableResize.create(rawWire, resizing, lazySizing);\n          sz.on();\n          sz.events.startDrag.bind(function (_event) {\n            selectionRng = Optional.some(editor.selection.getRng());\n          });\n          sz.events.beforeResize.bind(function (event) {\n            var rawTable = event.table.dom;\n            fireObjectResizeStart(editor, rawTable, getPixelWidth$1(rawTable), getPixelHeight(rawTable), barResizerPrefix + event.type);\n          });\n          sz.events.afterResize.bind(function (event) {\n            var table = event.table;\n            var rawTable = table.dom;\n            removeDataStyle(table);\n            selectionRng.each(function (rng) {\n              editor.selection.setRng(rng);\n              editor.focus();\n            });\n            fireObjectResized(editor, rawTable, getPixelWidth$1(rawTable), getPixelHeight(rawTable), barResizerPrefix + event.type);\n            editor.undoManager.add();\n          });\n          resize = Optional.some(sz);\n        }\n      });\n      editor.on('ObjectResizeStart', function (e) {\n        var targetElm = e.target;\n        if (isTable(targetElm)) {\n          var table = SugarElement.fromDom(targetElm);\n          each(editor.dom.select('.mce-clonedresizable'), function (clone) {\n            editor.dom.addClass(clone, 'mce-' + getColumnResizingBehaviour(editor) + '-columns');\n          });\n          if (!isPixelSizing$1(table) && isPixelsForced(editor)) {\n            enforcePixels(editor, table);\n          } else if (!isPercentSizing$1(table) && isPercentagesForced(editor)) {\n            enforcePercentage(editor, table);\n          }\n          if (isNoneSizing$1(table) && startsWith(e.origin, barResizerPrefix)) {\n            enforcePercentage(editor, table);\n          }\n          startW = e.width;\n          startRawW = isResponsiveForced(editor) ? '' : getRawWidth$1(editor, targetElm).getOr('');\n        }\n      });\n      editor.on('ObjectResized', function (e) {\n        var targetElm = e.target;\n        if (isTable(targetElm)) {\n          var table = SugarElement.fromDom(targetElm);\n          var origin_1 = e.origin;\n          if (startsWith(origin_1, 'corner-')) {\n            afterCornerResize(table, origin_1, e.width);\n          }\n          removeDataStyle(table);\n          fireTableModified(editor, table.dom, styleModified);\n        }\n      });\n      editor.on('SwitchMode', function () {\n        lazyResize().each(function (resize) {\n          if (editor.mode.isReadOnly()) {\n            resize.hideBars();\n          } else {\n            resize.showBars();\n          }\n        });\n      });\n      return {\n        lazyResize: lazyResize,\n        lazyWire: lazyWire,\n        destroy: destroy\n      };\n    };\n\n    var point = function (element, offset) {\n      return {\n        element: element,\n        offset: offset\n      };\n    };\n\n    var scan = function (universe, element, direction) {\n      if (universe.property().isText(element) && universe.property().getText(element).trim().length === 0 || universe.property().isComment(element)) {\n        return direction(element).bind(function (elem) {\n          return scan(universe, elem, direction).orThunk(function () {\n            return Optional.some(elem);\n          });\n        });\n      } else {\n        return Optional.none();\n      }\n    };\n    var toEnd = function (universe, element) {\n      if (universe.property().isText(element)) {\n        return universe.property().getText(element).length;\n      }\n      var children = universe.property().children(element);\n      return children.length;\n    };\n    var freefallRtl = function (universe, element) {\n      var candidate = scan(universe, element, universe.query().prevSibling).getOr(element);\n      if (universe.property().isText(candidate)) {\n        return point(candidate, toEnd(universe, candidate));\n      }\n      var children = universe.property().children(candidate);\n      return children.length > 0 ? freefallRtl(universe, children[children.length - 1]) : point(candidate, toEnd(universe, candidate));\n    };\n\n    var freefallRtl$1 = freefallRtl;\n\n    var universe$1 = DomUniverse();\n    var freefallRtl$2 = function (element) {\n      return freefallRtl$1(universe$1, element);\n    };\n\n    var halve = function (main, other) {\n      var colspan = getSpan(main, 'colspan');\n      if (colspan === 1) {\n        var width = getGenericWidth(main);\n        width.each(function (w) {\n          var newWidth = w.value / 2;\n          setGenericWidth(main, newWidth, w.unit);\n          setGenericWidth(other, newWidth, w.unit);\n        });\n      }\n    };\n\n    var setIfNot = function (element, property, value, ignore) {\n      if (value === ignore) {\n        remove(element, property);\n      } else {\n        set(element, property, value);\n      }\n    };\n    var insert = function (table, selector, element) {\n      last(children$2(table, selector)).fold(function () {\n        return prepend(table, element);\n      }, function (child) {\n        return after(child, element);\n      });\n    };\n    var generateSection = function (table, sectionName) {\n      var section = child$2(table, sectionName).getOrThunk(function () {\n        var newSection = SugarElement.fromTag(sectionName, owner(table).dom);\n        if (sectionName === 'thead') {\n          insert(table, 'caption,colgroup', newSection);\n        } else if (sectionName === 'colgroup') {\n          insert(table, 'caption', newSection);\n        } else {\n          append(table, newSection);\n        }\n        return newSection;\n      });\n      empty(section);\n      return section;\n    };\n    var render = function (table, grid) {\n      var newRows = [];\n      var newCells = [];\n      var syncRows = function (gridSection) {\n        return map(gridSection, function (row) {\n          if (row.isNew) {\n            newRows.push(row.element);\n          }\n          var tr = row.element;\n          empty(tr);\n          each(row.cells, function (cell) {\n            if (cell.isNew) {\n              newCells.push(cell.element);\n            }\n            setIfNot(cell.element, 'colspan', cell.colspan, 1);\n            setIfNot(cell.element, 'rowspan', cell.rowspan, 1);\n            append(tr, cell.element);\n          });\n          return tr;\n        });\n      };\n      var syncColGroup = function (gridSection) {\n        return bind(gridSection, function (colGroup) {\n          return map(colGroup.cells, function (col) {\n            setIfNot(col.element, 'span', col.colspan, 1);\n            return col.element;\n          });\n        });\n      };\n      var renderSection = function (gridSection, sectionName) {\n        var section = generateSection(table, sectionName);\n        var sync = sectionName === 'colgroup' ? syncColGroup : syncRows;\n        var sectionElems = sync(gridSection);\n        append$1(section, sectionElems);\n      };\n      var removeSection = function (sectionName) {\n        child$2(table, sectionName).each(remove$2);\n      };\n      var renderOrRemoveSection = function (gridSection, sectionName) {\n        if (gridSection.length > 0) {\n          renderSection(gridSection, sectionName);\n        } else {\n          removeSection(sectionName);\n        }\n      };\n      var headSection = [];\n      var bodySection = [];\n      var footSection = [];\n      var columnGroupsSection = [];\n      each(grid, function (row) {\n        switch (row.section) {\n        case 'thead':\n          headSection.push(row);\n          break;\n        case 'tbody':\n          bodySection.push(row);\n          break;\n        case 'tfoot':\n          footSection.push(row);\n          break;\n        case 'colgroup':\n          columnGroupsSection.push(row);\n          break;\n        }\n      });\n      renderOrRemoveSection(columnGroupsSection, 'colgroup');\n      renderOrRemoveSection(headSection, 'thead');\n      renderOrRemoveSection(bodySection, 'tbody');\n      renderOrRemoveSection(footSection, 'tfoot');\n      return {\n        newRows: newRows,\n        newCells: newCells\n      };\n    };\n    var copy$2 = function (grid) {\n      return map(grid, function (row) {\n        var tr = shallow(row.element);\n        each(row.cells, function (cell) {\n          var clonedCell = deep(cell.element);\n          setIfNot(clonedCell, 'colspan', cell.colspan, 1);\n          setIfNot(clonedCell, 'rowspan', cell.rowspan, 1);\n          append(tr, clonedCell);\n        });\n        return tr;\n      });\n    };\n\n    var getColumn = function (grid, index) {\n      return map(grid, function (row) {\n        return getCell(row, index);\n      });\n    };\n    var getRow = function (grid, index) {\n      return grid[index];\n    };\n    var findDiff = function (xs, comp) {\n      if (xs.length === 0) {\n        return 0;\n      }\n      var first = xs[0];\n      var index = findIndex(xs, function (x) {\n        return !comp(first.element, x.element);\n      });\n      return index.fold(function () {\n        return xs.length;\n      }, function (ind) {\n        return ind;\n      });\n    };\n    var subgrid = function (grid, row, column, comparator) {\n      var restOfRow = getRow(grid, row).cells.slice(column);\n      var endColIndex = findDiff(restOfRow, comparator);\n      var restOfColumn = getColumn(grid, column).slice(row);\n      var endRowIndex = findDiff(restOfColumn, comparator);\n      return {\n        colspan: endColIndex,\n        rowspan: endRowIndex\n      };\n    };\n\n    var toDetails = function (grid, comparator) {\n      var seen = map(grid, function (row) {\n        return map(row.cells, never);\n      });\n      var updateSeen = function (rowIndex, columnIndex, rowspan, colspan) {\n        for (var row = rowIndex; row < rowIndex + rowspan; row++) {\n          for (var column = columnIndex; column < columnIndex + colspan; column++) {\n            seen[row][column] = true;\n          }\n        }\n      };\n      return map(grid, function (row, rowIndex) {\n        var details = bind(row.cells, function (cell, columnIndex) {\n          if (seen[rowIndex][columnIndex] === false) {\n            var result = subgrid(grid, rowIndex, columnIndex, comparator);\n            updateSeen(rowIndex, columnIndex, result.rowspan, result.colspan);\n            return [detailnew(cell.element, result.rowspan, result.colspan, cell.isNew)];\n          } else {\n            return [];\n          }\n        });\n        return rowdetails(details, row.section);\n      });\n    };\n    var toGrid = function (warehouse, generators, isNew) {\n      var grid = [];\n      if (Warehouse.hasColumns(warehouse)) {\n        var groupElementNew = map(Warehouse.justColumns(warehouse), function (column) {\n          return elementnew(column.element, isNew, false);\n        });\n        grid.push(rowcells(groupElementNew, 'colgroup'));\n      }\n      for (var rowIndex = 0; rowIndex < warehouse.grid.rows; rowIndex++) {\n        var rowCells = [];\n        for (var columnIndex = 0; columnIndex < warehouse.grid.columns; columnIndex++) {\n          var element = Warehouse.getAt(warehouse, rowIndex, columnIndex).map(function (item) {\n            return elementnew(item.element, isNew, item.isLocked);\n          }).getOrThunk(function () {\n            return elementnew(generators.gap(), true, false);\n          });\n          rowCells.push(element);\n        }\n        var row = rowcells(rowCells, warehouse.all[rowIndex].section);\n        grid.push(row);\n      }\n      return grid;\n    };\n\n    var fromWarehouse = function (warehouse, generators) {\n      return toGrid(warehouse, generators, false);\n    };\n    var deriveRows = function (rendered, generators) {\n      var findRow = function (details) {\n        var rowOfCells = findMap(details, function (detail) {\n          return parent(detail.element).map(function (row) {\n            var isNew = parent(row).isNone();\n            return elementnew(row, isNew, false);\n          });\n        });\n        return rowOfCells.getOrThunk(function () {\n          return elementnew(generators.row(), true, false);\n        });\n      };\n      return map(rendered, function (details) {\n        var row = findRow(details.details);\n        return rowdatanew(row.element, details.details, details.section, row.isNew);\n      });\n    };\n    var toDetailList = function (grid, generators) {\n      var rendered = toDetails(grid, eq$1);\n      return deriveRows(rendered, generators);\n    };\n    var findInWarehouse = function (warehouse, element) {\n      return findMap(warehouse.all, function (r) {\n        return find(r.cells, function (e) {\n          return eq$1(element, e.element);\n        });\n      });\n    };\n    var extractCells = function (warehouse, target, predicate) {\n      var details = map(target.selection, function (cell$1) {\n        return cell(cell$1).bind(function (lc) {\n          return findInWarehouse(warehouse, lc);\n        }).filter(predicate);\n      });\n      var cells = cat(details);\n      return someIf(cells.length > 0, cells);\n    };\n    var run = function (operation, extract, adjustment, postAction, genWrappers) {\n      return function (wire, table, target, generators, sizing, resizeBehaviour) {\n        var warehouse = Warehouse.fromTable(table);\n        var output = extract(warehouse, target).map(function (info) {\n          var model = fromWarehouse(warehouse, generators);\n          var result = operation(model, info, eq$1, genWrappers(generators));\n          var lockedColumns = getLockedColumnsFromGrid(result.grid);\n          var grid = toDetailList(result.grid, generators);\n          return {\n            info: info,\n            grid: grid,\n            cursor: result.cursor,\n            lockedColumns: lockedColumns\n          };\n        });\n        return output.bind(function (out) {\n          var newElements = render(table, out.grid);\n          var tableSizing = Optional.from(sizing).getOrThunk(function () {\n            return TableSize.getTableSize(table);\n          });\n          var resizing = Optional.from(resizeBehaviour).getOrThunk(preserveTable);\n          adjustment(table, out.grid, out.info, tableSizing, resizing);\n          postAction(table);\n          refresh(wire, table);\n          remove(table, LOCKED_COL_ATTR);\n          if (out.lockedColumns.length > 0) {\n            set(table, LOCKED_COL_ATTR, out.lockedColumns.join(','));\n          }\n          return Optional.some({\n            cursor: out.cursor,\n            newRows: newElements.newRows,\n            newCells: newElements.newCells\n          });\n        });\n      };\n    };\n    var onCell = function (warehouse, target) {\n      return cell(target.element).bind(function (cell) {\n        return findInWarehouse(warehouse, cell);\n      });\n    };\n    var onPaste = function (warehouse, target) {\n      return cell(target.element).bind(function (cell) {\n        return findInWarehouse(warehouse, cell).map(function (details) {\n          var value = __assign(__assign({}, details), {\n            generators: target.generators,\n            clipboard: target.clipboard\n          });\n          return value;\n        });\n      });\n    };\n    var onPasteByEditor = function (warehouse, target) {\n      return extractCells(warehouse, target, always).map(function (cells) {\n        return {\n          cells: cells,\n          generators: target.generators,\n          clipboard: target.clipboard\n        };\n      });\n    };\n    var onMergable = function (_warehouse, target) {\n      return target.mergable;\n    };\n    var onUnmergable = function (_warehouse, target) {\n      return target.unmergable;\n    };\n    var onCells = function (warehouse, target) {\n      return extractCells(warehouse, target, always);\n    };\n    var onUnlockedCell = function (warehouse, target) {\n      return onCell(warehouse, target).filter(function (detail) {\n        return !detail.isLocked;\n      });\n    };\n    var onUnlockedCells = function (warehouse, target) {\n      return extractCells(warehouse, target, function (detail) {\n        return !detail.isLocked;\n      });\n    };\n    var isUnlockedTableCell = function (warehouse, cell) {\n      return findInWarehouse(warehouse, cell).exists(function (detail) {\n        return !detail.isLocked;\n      });\n    };\n    var allUnlocked = function (warehouse, cells) {\n      return forall(cells, function (cell) {\n        return isUnlockedTableCell(warehouse, cell);\n      });\n    };\n    var onUnlockedMergable = function (warehouse, target) {\n      return onMergable(warehouse, target).filter(function (mergeable) {\n        return allUnlocked(warehouse, mergeable.cells);\n      });\n    };\n    var onUnlockedUnmergable = function (warehouse, target) {\n      return onUnmergable(warehouse, target).filter(function (cells) {\n        return allUnlocked(warehouse, cells);\n      });\n    };\n\n    var merge = function (grid, bounds, comparator, substitution) {\n      var rows = extractGridDetails(grid).rows;\n      if (rows.length === 0) {\n        return grid;\n      }\n      for (var i = bounds.startRow; i <= bounds.finishRow; i++) {\n        for (var j = bounds.startCol; j <= bounds.finishCol; j++) {\n          var row = rows[i];\n          var isLocked = getCell(row, j).isLocked;\n          mutateCell(row, j, elementnew(substitution(), false, isLocked));\n        }\n      }\n      return grid;\n    };\n    var unmerge = function (grid, target, comparator, substitution) {\n      var rows = extractGridDetails(grid).rows;\n      var first = true;\n      for (var i = 0; i < rows.length; i++) {\n        for (var j = 0; j < cellLength(rows[0]); j++) {\n          var row = rows[i];\n          var currentCell = getCell(row, j);\n          var currentCellElm = currentCell.element;\n          var isToReplace = comparator(currentCellElm, target);\n          if (isToReplace === true && first === false) {\n            mutateCell(row, j, elementnew(substitution(), true, currentCell.isLocked));\n          } else if (isToReplace === true) {\n            first = false;\n          }\n        }\n      }\n      return grid;\n    };\n    var uniqueCells = function (row, comparator) {\n      return foldl(row, function (rest, cell) {\n        return exists(rest, function (currentCell) {\n          return comparator(currentCell.element, cell.element);\n        }) ? rest : rest.concat([cell]);\n      }, []);\n    };\n    var splitCols = function (grid, index, comparator, substitution) {\n      if (index > 0 && index < grid[0].cells.length) {\n        each(grid, function (row) {\n          var prevCell = row.cells[index - 1];\n          var current = row.cells[index];\n          var isToReplace = comparator(current.element, prevCell.element);\n          if (isToReplace) {\n            mutateCell(row, index, elementnew(substitution(), true, current.isLocked));\n          }\n        });\n      }\n      return grid;\n    };\n    var splitRows = function (grid, index, comparator, substitution) {\n      var rows = extractGridDetails(grid).rows;\n      if (index > 0 && index < rows.length) {\n        var rowPrevCells = rows[index - 1].cells;\n        var cells = uniqueCells(rowPrevCells, comparator);\n        each(cells, function (cell) {\n          var replacement = Optional.none();\n          for (var i = index; i < rows.length; i++) {\n            var _loop_1 = function (j) {\n              var row = rows[i];\n              var current = getCell(row, j);\n              var isToReplace = comparator(current.element, cell.element);\n              if (isToReplace) {\n                if (replacement.isNone()) {\n                  replacement = Optional.some(substitution());\n                }\n                replacement.each(function (sub) {\n                  mutateCell(row, j, elementnew(sub, true, current.isLocked));\n                });\n              }\n            };\n            for (var j = 0; j < cellLength(rows[0]); j++) {\n              _loop_1(j);\n            }\n          }\n        });\n      }\n      return grid;\n    };\n\n    var value = function (o) {\n      var is = function (v) {\n        return o === v;\n      };\n      var or = function (_opt) {\n        return value(o);\n      };\n      var orThunk = function (_f) {\n        return value(o);\n      };\n      var map = function (f) {\n        return value(f(o));\n      };\n      var mapError = function (_f) {\n        return value(o);\n      };\n      var each = function (f) {\n        f(o);\n      };\n      var bind = function (f) {\n        return f(o);\n      };\n      var fold = function (_, onValue) {\n        return onValue(o);\n      };\n      var exists = function (f) {\n        return f(o);\n      };\n      var forall = function (f) {\n        return f(o);\n      };\n      var toOptional = function () {\n        return Optional.some(o);\n      };\n      return {\n        is: is,\n        isValue: always,\n        isError: never,\n        getOr: constant(o),\n        getOrThunk: constant(o),\n        getOrDie: constant(o),\n        or: or,\n        orThunk: orThunk,\n        fold: fold,\n        map: map,\n        mapError: mapError,\n        each: each,\n        bind: bind,\n        exists: exists,\n        forall: forall,\n        toOptional: toOptional\n      };\n    };\n    var error = function (message) {\n      var getOrThunk = function (f) {\n        return f();\n      };\n      var getOrDie = function () {\n        return die(String(message))();\n      };\n      var or = function (opt) {\n        return opt;\n      };\n      var orThunk = function (f) {\n        return f();\n      };\n      var map = function (_f) {\n        return error(message);\n      };\n      var mapError = function (f) {\n        return error(f(message));\n      };\n      var bind = function (_f) {\n        return error(message);\n      };\n      var fold = function (onError, _) {\n        return onError(message);\n      };\n      return {\n        is: never,\n        isValue: never,\n        isError: always,\n        getOr: identity,\n        getOrThunk: getOrThunk,\n        getOrDie: getOrDie,\n        or: or,\n        orThunk: orThunk,\n        fold: fold,\n        map: map,\n        mapError: mapError,\n        each: noop,\n        bind: bind,\n        exists: never,\n        forall: always,\n        toOptional: Optional.none\n      };\n    };\n    var fromOption = function (opt, err) {\n      return opt.fold(function () {\n        return error(err);\n      }, value);\n    };\n    var Result = {\n      value: value,\n      error: error,\n      fromOption: fromOption\n    };\n\n    var measure = function (startAddress, gridA, gridB) {\n      if (startAddress.row >= gridA.length || startAddress.column > cellLength(gridA[0])) {\n        return Result.error('invalid start address out of table bounds, row: ' + startAddress.row + ', column: ' + startAddress.column);\n      }\n      var rowRemainder = gridA.slice(startAddress.row);\n      var colRemainder = rowRemainder[0].cells.slice(startAddress.column);\n      var colRequired = cellLength(gridB[0]);\n      var rowRequired = gridB.length;\n      return Result.value({\n        rowDelta: rowRemainder.length - rowRequired,\n        colDelta: colRemainder.length - colRequired\n      });\n    };\n    var measureWidth = function (gridA, gridB) {\n      var colLengthA = cellLength(gridA[0]);\n      var colLengthB = cellLength(gridB[0]);\n      return {\n        rowDelta: 0,\n        colDelta: colLengthA - colLengthB\n      };\n    };\n    var measureHeight = function (gridA, gridB) {\n      var rowLengthA = gridA.length;\n      var rowLengthB = gridB.length;\n      return {\n        rowDelta: rowLengthA - rowLengthB,\n        colDelta: 0\n      };\n    };\n    var generateElements = function (amount, row, generators, isLocked) {\n      var generator = row.section === 'colgroup' ? generators.col : generators.cell;\n      return range(amount, function (idx) {\n        return elementnew(generator(), true, isLocked(idx));\n      });\n    };\n    var rowFill = function (grid, amount, generators, lockedColumns) {\n      return grid.concat(range(amount, function () {\n        var row = grid[grid.length - 1];\n        var elements = generateElements(row.cells.length, row, generators, function (idx) {\n          return has(lockedColumns, idx.toString());\n        });\n        return setCells(row, elements);\n      }));\n    };\n    var colFill = function (grid, amount, generators, startIndex) {\n      return map(grid, function (row) {\n        var newChildren = generateElements(amount, row, generators, never);\n        return addCells(row, startIndex, newChildren);\n      });\n    };\n    var lockedColFill = function (grid, generators, lockedColumns) {\n      return map(grid, function (row) {\n        return foldl(lockedColumns, function (acc, colNum) {\n          var newChild = generateElements(1, row, generators, always)[0];\n          return addCell(acc, colNum, newChild);\n        }, row);\n      });\n    };\n    var tailor = function (gridA, delta, generators) {\n      var fillCols = delta.colDelta < 0 ? colFill : identity;\n      var fillRows = delta.rowDelta < 0 ? rowFill : identity;\n      var lockedColumns = getLockedColumnsFromGrid(gridA);\n      var gridWidth = cellLength(gridA[0]);\n      var isLastColLocked = exists(lockedColumns, function (locked) {\n        return locked === gridWidth - 1;\n      });\n      var modifiedCols = fillCols(gridA, Math.abs(delta.colDelta), generators, isLastColLocked ? gridWidth - 1 : gridWidth);\n      var newLockedColumns = getLockedColumnsFromGrid(modifiedCols);\n      return fillRows(modifiedCols, Math.abs(delta.rowDelta), generators, mapToObject(newLockedColumns, always));\n    };\n\n    var isSpanning = function (grid, row, col, comparator) {\n      var candidate = getCell(grid[row], col);\n      var matching = curry(comparator, candidate.element);\n      var currentRow = grid[row];\n      return grid.length > 1 && cellLength(currentRow) > 1 && (col > 0 && matching(getCellElement(currentRow, col - 1)) || col < currentRow.cells.length - 1 && matching(getCellElement(currentRow, col + 1)) || row > 0 && matching(getCellElement(grid[row - 1], col)) || row < grid.length - 1 && matching(getCellElement(grid[row + 1], col)));\n    };\n    var mergeTables = function (startAddress, gridA, gridB, generator, comparator, lockedColumns) {\n      var startRow = startAddress.row;\n      var startCol = startAddress.column;\n      var mergeHeight = gridB.length;\n      var mergeWidth = cellLength(gridB[0]);\n      var endRow = startRow + mergeHeight;\n      var endCol = startCol + mergeWidth + lockedColumns.length;\n      var lockedColumnObj = mapToObject(lockedColumns, always);\n      for (var r = startRow; r < endRow; r++) {\n        var skippedCol = 0;\n        for (var c = startCol; c < endCol; c++) {\n          if (lockedColumnObj[c]) {\n            skippedCol++;\n            continue;\n          }\n          if (isSpanning(gridA, r, c, comparator)) {\n            unmerge(gridA, getCellElement(gridA[r], c), comparator, generator.cell);\n          }\n          var gridBColIndex = c - startCol - skippedCol;\n          var newCell = getCell(gridB[r - startRow], gridBColIndex);\n          var newCellElm = newCell.element;\n          var replacement = generator.replace(newCellElm);\n          mutateCell(gridA[r], c, elementnew(replacement, true, newCell.isLocked));\n        }\n      }\n      return gridA;\n    };\n    var getValidStartAddress = function (currentStartAddress, grid, lockedColumns) {\n      var gridColLength = cellLength(grid[0]);\n      var adjustedRowAddress = extractGridDetails(grid).cols.length + currentStartAddress.row;\n      var possibleColAddresses = range(gridColLength - currentStartAddress.column, function (num) {\n        return num + currentStartAddress.column;\n      });\n      var validColAddress = find(possibleColAddresses, function (num) {\n        return forall(lockedColumns, function (col) {\n          return col !== num;\n        });\n      }).getOr(gridColLength - 1);\n      return {\n        row: adjustedRowAddress,\n        column: validColAddress\n      };\n    };\n    var getLockedColumnsWithinBounds = function (startAddress, grid, lockedColumns) {\n      return filter(lockedColumns, function (colNum) {\n        return colNum >= startAddress.column && colNum <= cellLength(grid[0]) + startAddress.column;\n      });\n    };\n    var merge$1 = function (startAddress, gridA, gridB, generator, comparator) {\n      var lockedColumns = getLockedColumnsFromGrid(gridA);\n      var validStartAddress = getValidStartAddress(startAddress, gridA, lockedColumns);\n      var gridBRows = extractGridDetails(gridB).rows;\n      var lockedColumnsWithinBounds = getLockedColumnsWithinBounds(validStartAddress, gridBRows, lockedColumns);\n      var result = measure(validStartAddress, gridA, gridBRows);\n      return result.map(function (diff) {\n        var delta = __assign(__assign({}, diff), { colDelta: diff.colDelta - lockedColumnsWithinBounds.length });\n        var fittedGrid = tailor(gridA, delta, generator);\n        var newLockedColumns = getLockedColumnsFromGrid(fittedGrid);\n        var newLockedColumnsWithinBounds = getLockedColumnsWithinBounds(validStartAddress, gridBRows, newLockedColumns);\n        return mergeTables(validStartAddress, fittedGrid, gridBRows, generator, comparator, newLockedColumnsWithinBounds);\n      });\n    };\n    var insertCols = function (index, gridA, gridB, generator, comparator) {\n      splitCols(gridA, index, comparator, generator.cell);\n      var delta = measureHeight(gridB, gridA);\n      var fittedNewGrid = tailor(gridB, delta, generator);\n      var secondDelta = measureHeight(gridA, fittedNewGrid);\n      var fittedOldGrid = tailor(gridA, secondDelta, generator);\n      return map(fittedOldGrid, function (gridRow, i) {\n        return addCells(gridRow, index, fittedNewGrid[i].cells);\n      });\n    };\n    var insertRows = function (index, gridA, gridB, generator, comparator) {\n      splitRows(gridA, index, comparator, generator.cell);\n      var locked = getLockedColumnsFromGrid(gridA);\n      var diff = measureWidth(gridA, gridB);\n      var delta = __assign(__assign({}, diff), { colDelta: diff.colDelta - locked.length });\n      var fittedOldGrid = tailor(gridA, delta, generator);\n      var _a = extractGridDetails(fittedOldGrid), oldCols = _a.cols, oldRows = _a.rows;\n      var newLocked = getLockedColumnsFromGrid(fittedOldGrid);\n      var secondDiff = measureWidth(gridB, gridA);\n      var secondDelta = __assign(__assign({}, secondDiff), { colDelta: secondDiff.colDelta + newLocked.length });\n      var fittedGridB = lockedColFill(gridB, generator, newLocked);\n      var fittedNewGrid = tailor(fittedGridB, secondDelta, generator);\n      return oldCols.concat(oldRows.slice(0, index)).concat(fittedNewGrid).concat(oldRows.slice(index, oldRows.length));\n    };\n\n    var insertRowAt = function (grid, index, example, comparator, substitution) {\n      var _a = extractGridDetails(grid), rows = _a.rows, cols = _a.cols;\n      var before = rows.slice(0, index);\n      var after = rows.slice(index);\n      var between = mapCells(rows[example], function (ex, c) {\n        var withinSpan = index > 0 && index < rows.length && comparator(getCellElement(rows[index - 1], c), getCellElement(rows[index], c));\n        var ret = withinSpan ? getCell(rows[index], c) : elementnew(substitution(ex.element, comparator), true, ex.isLocked);\n        return ret;\n      });\n      return cols.concat(before).concat([between]).concat(after);\n    };\n    var getElementFor = function (row, column, section, withinSpan, example, comparator, substitution) {\n      if (section === 'colgroup' || !withinSpan) {\n        var cell = getCell(row, example);\n        return elementnew(substitution(cell.element, comparator), true, false);\n      } else {\n        return getCell(row, column);\n      }\n    };\n    var insertColumnAt = function (grid, index, example, comparator, substitution) {\n      return map(grid, function (row) {\n        var withinSpan = index > 0 && index < cellLength(row) && comparator(getCellElement(row, index - 1), getCellElement(row, index));\n        var sub = getElementFor(row, index, row.section, withinSpan, example, comparator, substitution);\n        return addCell(row, index, sub);\n      });\n    };\n    var deleteColumnsAt = function (grid, columns) {\n      return bind(grid, function (row) {\n        var existingCells = row.cells;\n        var cells = foldr(columns, function (acc, column) {\n          return column >= 0 && column < acc.length ? acc.slice(0, column).concat(acc.slice(column + 1)) : acc;\n        }, existingCells);\n        return cells.length > 0 ? [rowcells(cells, row.section)] : [];\n      });\n    };\n    var deleteRowsAt = function (grid, start, finish) {\n      var _a = extractGridDetails(grid), rows = _a.rows, cols = _a.cols;\n      return cols.concat(rows.slice(0, start)).concat(rows.slice(finish + 1));\n    };\n\n    var replaceIn = function (grid, targets, comparator, substitution) {\n      var isTarget = function (cell) {\n        return exists(targets, function (target) {\n          return comparator(cell.element, target.element);\n        });\n      };\n      return map(grid, function (row) {\n        return mapCells(row, function (cell) {\n          return isTarget(cell) ? elementnew(substitution(cell.element, comparator), true, cell.isLocked) : cell;\n        });\n      });\n    };\n    var notStartRow = function (grid, rowIndex, colIndex, comparator) {\n      return getCellElement(grid[rowIndex], colIndex) !== undefined && (rowIndex > 0 && comparator(getCellElement(grid[rowIndex - 1], colIndex), getCellElement(grid[rowIndex], colIndex)));\n    };\n    var notStartColumn = function (row, index, comparator) {\n      return index > 0 && comparator(getCellElement(row, index - 1), getCellElement(row, index));\n    };\n    var replaceColumn = function (grid, index, comparator, substitution) {\n      var rows = extractGridDetails(grid).rows;\n      var targets = bind(rows, function (row, i) {\n        var alreadyAdded = notStartRow(grid, i, index, comparator) || notStartColumn(row, index, comparator);\n        return alreadyAdded ? [] : [getCell(row, index)];\n      });\n      return replaceIn(grid, targets, comparator, substitution);\n    };\n    var replaceRow = function (grid, index, comparator, substitution) {\n      var rows = extractGridDetails(grid).rows;\n      var targetRow = rows[index];\n      var targets = bind(targetRow.cells, function (item, i) {\n        var alreadyAdded = notStartRow(rows, index, i, comparator) || notStartColumn(targetRow, i, comparator);\n        return alreadyAdded ? [] : [item];\n      });\n      return replaceIn(grid, targets, comparator, substitution);\n    };\n\n    var uniqueColumns = function (details) {\n      var uniqueCheck = function (rest, detail) {\n        var columnExists = exists(rest, function (currentDetail) {\n          return currentDetail.column === detail.column;\n        });\n        return columnExists ? rest : rest.concat([detail]);\n      };\n      return foldl(details, uniqueCheck, []).sort(function (detailA, detailB) {\n        return detailA.column - detailB.column;\n      });\n    };\n\n    var elementToData = function (element) {\n      var colspan = getAttrValue(element, 'colspan', 1);\n      var rowspan = getAttrValue(element, 'rowspan', 1);\n      return {\n        element: element,\n        colspan: colspan,\n        rowspan: rowspan\n      };\n    };\n    var modification = function (generators, toData) {\n      if (toData === void 0) {\n        toData = elementToData;\n      }\n      var position = Cell(Optional.none());\n      var nu = function (data) {\n        switch (name(data.element)) {\n        case 'col':\n          return generators.col(data);\n        default:\n          return generators.cell(data);\n        }\n      };\n      var nuFrom = function (element) {\n        var data = toData(element);\n        return nu(data);\n      };\n      var add = function (element) {\n        var replacement = nuFrom(element);\n        if (position.get().isNone()) {\n          position.set(Optional.some(replacement));\n        }\n        recent = Optional.some({\n          item: element,\n          replacement: replacement\n        });\n        return replacement;\n      };\n      var recent = Optional.none();\n      var getOrInit = function (element, comparator) {\n        return recent.fold(function () {\n          return add(element);\n        }, function (p) {\n          return comparator(element, p.item) ? p.replacement : add(element);\n        });\n      };\n      return {\n        getOrInit: getOrInit,\n        cursor: position.get\n      };\n    };\n    var transform$1 = function (scope, tag) {\n      return function (generators) {\n        var position = Cell(Optional.none());\n        var list = [];\n        var find$1 = function (element, comparator) {\n          return find(list, function (x) {\n            return comparator(x.item, element);\n          });\n        };\n        var makeNew = function (element) {\n          var attrs = { scope: scope };\n          var cell = generators.replace(element, tag, attrs);\n          list.push({\n            item: element,\n            sub: cell\n          });\n          if (position.get().isNone()) {\n            position.set(Optional.some(cell));\n          }\n          return cell;\n        };\n        var replaceOrInit = function (element, comparator) {\n          if (name(element) === 'col') {\n            return element;\n          } else {\n            return find$1(element, comparator).fold(function () {\n              return makeNew(element);\n            }, function (p) {\n              return comparator(element, p.item) ? p.sub : makeNew(element);\n            });\n          }\n        };\n        return {\n          replaceOrInit: replaceOrInit,\n          cursor: position.get\n        };\n      };\n    };\n    var getScopeAttribute = function (cell) {\n      return getOpt(cell, 'scope').map(function (attribute) {\n        return attribute.substr(0, 3);\n      });\n    };\n    var merging = function (generators) {\n      var position = Cell(Optional.none());\n      var unmerge = function (cell) {\n        if (position.get().isNone()) {\n          position.set(Optional.some(cell));\n        }\n        var scope = getScopeAttribute(cell);\n        scope.each(function (attribute) {\n          return set(cell, 'scope', attribute);\n        });\n        return function () {\n          var raw = generators.cell({\n            element: cell,\n            colspan: 1,\n            rowspan: 1\n          });\n          remove$1(raw, 'width');\n          remove$1(cell, 'width');\n          scope.each(function (attribute) {\n            return set(raw, 'scope', attribute);\n          });\n          return raw;\n        };\n      };\n      var merge = function (cells) {\n        var getScopeProperty = function () {\n          var stringAttributes = cat(map(cells, getScopeAttribute));\n          if (stringAttributes.length === 0) {\n            return Optional.none();\n          } else {\n            var baseScope_1 = stringAttributes[0];\n            var scopes_1 = [\n              'row',\n              'col'\n            ];\n            var isMixed = exists(stringAttributes, function (attribute) {\n              return attribute !== baseScope_1 && contains(scopes_1, attribute);\n            });\n            return isMixed ? Optional.none() : Optional.from(baseScope_1);\n          }\n        };\n        remove$1(cells[0], 'width');\n        getScopeProperty().fold(function () {\n          return remove(cells[0], 'scope');\n        }, function (attribute) {\n          return set(cells[0], 'scope', attribute + 'group');\n        });\n        return constant(cells[0]);\n      };\n      return {\n        unmerge: unmerge,\n        merge: merge,\n        cursor: position.get\n      };\n    };\n    var Generators = {\n      modification: modification,\n      transform: transform$1,\n      merging: merging\n    };\n\n    var blockList = [\n      'body',\n      'p',\n      'div',\n      'article',\n      'aside',\n      'figcaption',\n      'figure',\n      'footer',\n      'header',\n      'nav',\n      'section',\n      'ol',\n      'ul',\n      'table',\n      'thead',\n      'tfoot',\n      'tbody',\n      'caption',\n      'tr',\n      'td',\n      'th',\n      'h1',\n      'h2',\n      'h3',\n      'h4',\n      'h5',\n      'h6',\n      'blockquote',\n      'pre',\n      'address'\n    ];\n    var isList = function (universe, item) {\n      var tagName = universe.property().name(item);\n      return contains([\n        'ol',\n        'ul'\n      ], tagName);\n    };\n    var isBlock = function (universe, item) {\n      var tagName = universe.property().name(item);\n      return contains(blockList, tagName);\n    };\n    var isEmptyTag = function (universe, item) {\n      return contains([\n        'br',\n        'img',\n        'hr',\n        'input'\n      ], universe.property().name(item));\n    };\n\n    var universe$2 = DomUniverse();\n    var isBlock$1 = function (element) {\n      return isBlock(universe$2, element);\n    };\n    var isList$1 = function (element) {\n      return isList(universe$2, element);\n    };\n    var isEmptyTag$1 = function (element) {\n      return isEmptyTag(universe$2, element);\n    };\n\n    var merge$2 = function (cells) {\n      var isBr = function (el) {\n        return name(el) === 'br';\n      };\n      var advancedBr = function (children) {\n        return forall(children, function (c) {\n          return isBr(c) || isText(c) && get$4(c).trim().length === 0;\n        });\n      };\n      var isListItem = function (el) {\n        return name(el) === 'li' || ancestor(el, isList$1).isSome();\n      };\n      var siblingIsBlock = function (el) {\n        return nextSibling(el).map(function (rightSibling) {\n          if (isBlock$1(rightSibling)) {\n            return true;\n          }\n          if (isEmptyTag$1(rightSibling)) {\n            return name(rightSibling) === 'img' ? false : true;\n          }\n          return false;\n        }).getOr(false);\n      };\n      var markCell = function (cell) {\n        return last$1(cell).bind(function (rightEdge) {\n          var rightSiblingIsBlock = siblingIsBlock(rightEdge);\n          return parent(rightEdge).map(function (parent) {\n            return rightSiblingIsBlock === true || isListItem(parent) || isBr(rightEdge) || isBlock$1(parent) && !eq$1(cell, parent) ? [] : [SugarElement.fromTag('br')];\n          });\n        }).getOr([]);\n      };\n      var markContent = function () {\n        var content = bind(cells, function (cell) {\n          var children$1 = children(cell);\n          return advancedBr(children$1) ? [] : children$1.concat(markCell(cell));\n        });\n        return content.length === 0 ? [SugarElement.fromTag('br')] : content;\n      };\n      var contents = markContent();\n      empty(cells[0]);\n      append$1(cells[0], contents);\n    };\n\n    var prune = function (table) {\n      var cells$1 = cells(table);\n      if (cells$1.length === 0) {\n        remove$2(table);\n      }\n    };\n    var outcome = function (grid, cursor) {\n      return {\n        grid: grid,\n        cursor: cursor\n      };\n    };\n    var elementFromGrid = function (grid, row, column) {\n      var rows = extractGridDetails(grid).rows;\n      return findIn(rows, row, column).orThunk(function () {\n        return findIn(rows, 0, 0);\n      });\n    };\n    var findIn = function (grid, row, column) {\n      return Optional.from(grid[row]).bind(function (r) {\n        return Optional.from(r.cells[column]).bind(function (c) {\n          return Optional.from(c.element);\n        });\n      });\n    };\n    var bundle = function (grid, row, column) {\n      var rows = extractGridDetails(grid).rows;\n      return outcome(grid, findIn(rows, row, column));\n    };\n    var uniqueRows = function (details) {\n      var rowCompilation = function (rest, detail) {\n        var rowExists = exists(rest, function (currentDetail) {\n          return currentDetail.row === detail.row;\n        });\n        return rowExists ? rest : rest.concat([detail]);\n      };\n      return foldl(details, rowCompilation, []).sort(function (detailA, detailB) {\n        return detailA.row - detailB.row;\n      });\n    };\n    var opInsertRowsBefore = function (grid, details, comparator, genWrappers) {\n      var targetIndex = details[0].row;\n      var rows = uniqueRows(details);\n      var newGrid = foldr(rows, function (acc, row) {\n        var newG = insertRowAt(acc.grid, targetIndex, row.row + acc.delta, comparator, genWrappers.getOrInit);\n        return {\n          grid: newG,\n          delta: acc.delta + 1\n        };\n      }, {\n        grid: grid,\n        delta: 0\n      }).grid;\n      return bundle(newGrid, targetIndex, details[0].column);\n    };\n    var opInsertRowsAfter = function (grid, details, comparator, genWrappers) {\n      var rows = uniqueRows(details);\n      var target = rows[rows.length - 1];\n      var targetIndex = target.row + target.rowspan;\n      var newGrid = foldr(rows, function (newG, row) {\n        return insertRowAt(newG, targetIndex, row.row, comparator, genWrappers.getOrInit);\n      }, grid);\n      return bundle(newGrid, targetIndex, details[0].column);\n    };\n    var opInsertColumnsBefore = function (grid, extractDetail, comparator, genWrappers) {\n      var details = extractDetail.details;\n      var columns = uniqueColumns(details);\n      var targetIndex = columns[0].column;\n      var newGrid = foldr(columns, function (acc, col) {\n        var newG = insertColumnAt(acc.grid, targetIndex, col.column + acc.delta, comparator, genWrappers.getOrInit);\n        return {\n          grid: newG,\n          delta: acc.delta + 1\n        };\n      }, {\n        grid: grid,\n        delta: 0\n      }).grid;\n      return bundle(newGrid, details[0].row, targetIndex);\n    };\n    var opInsertColumnsAfter = function (grid, extractDetail, comparator, genWrappers) {\n      var details = extractDetail.details;\n      var target = details[details.length - 1];\n      var targetIndex = target.column + target.colspan;\n      var columns = uniqueColumns(details);\n      var newGrid = foldr(columns, function (newG, col) {\n        return insertColumnAt(newG, targetIndex, col.column, comparator, genWrappers.getOrInit);\n      }, grid);\n      return bundle(newGrid, details[0].row, targetIndex);\n    };\n    var opMakeRowHeader = function (grid, detail, comparator, genWrappers) {\n      var newGrid = replaceRow(grid, detail.row, comparator, genWrappers.replaceOrInit);\n      return bundle(newGrid, detail.row, detail.column);\n    };\n    var opMakeRowsHeader = function (initialGrid, details, comparator, genWrappers) {\n      var rows = uniqueRows(details);\n      var replacer = function (currentGrid, row) {\n        return replaceRow(currentGrid, row.row, comparator, genWrappers.replaceOrInit);\n      };\n      var newGrid = foldl(rows, replacer, initialGrid);\n      return bundle(newGrid, details[0].row, details[0].column);\n    };\n    var opMakeColumnHeader = function (initialGrid, detail, comparator, genWrappers) {\n      var newGrid = replaceColumn(initialGrid, detail.column, comparator, genWrappers.replaceOrInit);\n      return bundle(newGrid, detail.row, detail.column);\n    };\n    var opMakeColumnsHeader = function (initialGrid, details, comparator, genWrappers) {\n      var columns = uniqueColumns(details);\n      var replacer = function (currentGrid, column) {\n        return replaceColumn(currentGrid, column.column, comparator, genWrappers.replaceOrInit);\n      };\n      var newGrid = foldl(columns, replacer, initialGrid);\n      return bundle(newGrid, details[0].row, details[0].column);\n    };\n    var opUnmakeRowHeader = function (grid, detail, comparator, genWrappers) {\n      var newGrid = replaceRow(grid, detail.row, comparator, genWrappers.replaceOrInit);\n      return bundle(newGrid, detail.row, detail.column);\n    };\n    var opUnmakeRowsHeader = function (initialGrid, details, comparator, genWrappers) {\n      var rows = uniqueRows(details);\n      var replacer = function (currentGrid, row) {\n        return replaceRow(currentGrid, row.row, comparator, genWrappers.replaceOrInit);\n      };\n      var newGrid = foldl(rows, replacer, initialGrid);\n      return bundle(newGrid, details[0].row, details[0].column);\n    };\n    var opUnmakeColumnHeader = function (initialGrid, detail, comparator, genWrappers) {\n      var newGrid = replaceColumn(initialGrid, detail.column, comparator, genWrappers.replaceOrInit);\n      return bundle(newGrid, detail.row, detail.column);\n    };\n    var opUnmakeColumnsHeader = function (initialGrid, details, comparator, genWrappers) {\n      var columns = uniqueColumns(details);\n      var replacer = function (currentGrid, column) {\n        return replaceColumn(currentGrid, column.column, comparator, genWrappers.replaceOrInit);\n      };\n      var newGrid = foldl(columns, replacer, initialGrid);\n      return bundle(newGrid, details[0].row, details[0].column);\n    };\n    var opEraseColumns = function (grid, extractDetail, _comparator, _genWrappers) {\n      var columns = uniqueColumns(extractDetail.details);\n      var newGrid = deleteColumnsAt(grid, map(columns, function (column) {\n        return column.column;\n      }));\n      var cursor = elementFromGrid(newGrid, columns[0].row, columns[0].column);\n      return outcome(newGrid, cursor);\n    };\n    var opEraseRows = function (grid, details, _comparator, _genWrappers) {\n      var rows = uniqueRows(details);\n      var newGrid = deleteRowsAt(grid, rows[0].row, rows[rows.length - 1].row);\n      var cursor = elementFromGrid(newGrid, details[0].row, details[0].column);\n      return outcome(newGrid, cursor);\n    };\n    var opMergeCells = function (grid, mergable, comparator, genWrappers) {\n      var cells = mergable.cells;\n      merge$2(cells);\n      var newGrid = merge(grid, mergable.bounds, comparator, genWrappers.merge(cells));\n      return outcome(newGrid, Optional.from(cells[0]));\n    };\n    var opUnmergeCells = function (grid, unmergable, comparator, genWrappers) {\n      var unmerge$1 = function (b, cell) {\n        return unmerge(b, cell, comparator, genWrappers.unmerge(cell));\n      };\n      var newGrid = foldr(unmergable, unmerge$1, grid);\n      return outcome(newGrid, Optional.from(unmergable[0]));\n    };\n    var opPasteCells = function (grid, pasteDetails, comparator, _genWrappers) {\n      var gridify = function (table, generators) {\n        var wh = Warehouse.fromTable(table);\n        return toGrid(wh, generators, true);\n      };\n      var gridB = gridify(pasteDetails.clipboard, pasteDetails.generators);\n      var startAddress = address(pasteDetails.row, pasteDetails.column);\n      var mergedGrid = merge$1(startAddress, grid, gridB, pasteDetails.generators, comparator);\n      return mergedGrid.fold(function () {\n        return outcome(grid, Optional.some(pasteDetails.element));\n      }, function (newGrid) {\n        var cursor = elementFromGrid(newGrid, pasteDetails.row, pasteDetails.column);\n        return outcome(newGrid, cursor);\n      });\n    };\n    var gridifyRows = function (rows, generators, context) {\n      var pasteDetails = fromPastedRows(rows, context.section);\n      var wh = Warehouse.generate(pasteDetails);\n      return toGrid(wh, generators, true);\n    };\n    var opPasteColsBefore = function (grid, pasteDetails, comparator, _genWrappers) {\n      var rows = extractGridDetails(grid).rows;\n      var index = pasteDetails.cells[0].column;\n      var context = rows[pasteDetails.cells[0].row];\n      var gridB = gridifyRows(pasteDetails.clipboard, pasteDetails.generators, context);\n      var mergedGrid = insertCols(index, grid, gridB, pasteDetails.generators, comparator);\n      var cursor = elementFromGrid(mergedGrid, pasteDetails.cells[0].row, pasteDetails.cells[0].column);\n      return outcome(mergedGrid, cursor);\n    };\n    var opPasteColsAfter = function (grid, pasteDetails, comparator, _genWrappers) {\n      var rows = extractGridDetails(grid).rows;\n      var index = pasteDetails.cells[pasteDetails.cells.length - 1].column + pasteDetails.cells[pasteDetails.cells.length - 1].colspan;\n      var context = rows[pasteDetails.cells[0].row];\n      var gridB = gridifyRows(pasteDetails.clipboard, pasteDetails.generators, context);\n      var mergedGrid = insertCols(index, grid, gridB, pasteDetails.generators, comparator);\n      var cursor = elementFromGrid(mergedGrid, pasteDetails.cells[0].row, pasteDetails.cells[0].column);\n      return outcome(mergedGrid, cursor);\n    };\n    var opPasteRowsBefore = function (grid, pasteDetails, comparator, _genWrappers) {\n      var rows = extractGridDetails(grid).rows;\n      var index = pasteDetails.cells[0].row;\n      var context = rows[index];\n      var gridB = gridifyRows(pasteDetails.clipboard, pasteDetails.generators, context);\n      var mergedGrid = insertRows(index, grid, gridB, pasteDetails.generators, comparator);\n      var cursor = elementFromGrid(mergedGrid, pasteDetails.cells[0].row, pasteDetails.cells[0].column);\n      return outcome(mergedGrid, cursor);\n    };\n    var opPasteRowsAfter = function (grid, pasteDetails, comparator, _genWrappers) {\n      var rows = extractGridDetails(grid).rows;\n      var index = pasteDetails.cells[pasteDetails.cells.length - 1].row + pasteDetails.cells[pasteDetails.cells.length - 1].rowspan;\n      var context = rows[pasteDetails.cells[0].row];\n      var gridB = gridifyRows(pasteDetails.clipboard, pasteDetails.generators, context);\n      var mergedGrid = insertRows(index, grid, gridB, pasteDetails.generators, comparator);\n      var cursor = elementFromGrid(mergedGrid, pasteDetails.cells[0].row, pasteDetails.cells[0].column);\n      return outcome(mergedGrid, cursor);\n    };\n    var opGetColumnType = function (table, target) {\n      var house = Warehouse.fromTable(table);\n      var details = onCells(house, target);\n      return details.bind(function (selectedCells) {\n        var lastSelectedCell = selectedCells[selectedCells.length - 1];\n        var minColRange = selectedCells[0].column;\n        var maxColRange = lastSelectedCell.column + lastSelectedCell.colspan;\n        var selectedColumnCells = flatten(map(house.all, function (row) {\n          return filter(row.cells, function (cell) {\n            return cell.column >= minColRange && cell.column < maxColRange;\n          });\n        }));\n        return getCellsType(selectedColumnCells, function (cell) {\n          return name(cell.element) === 'th';\n        });\n      }).getOr('');\n    };\n    var getCellsType = function (cells, headerPred) {\n      var headerCells = filter(cells, headerPred);\n      if (headerCells.length === 0) {\n        return Optional.some('td');\n      } else if (headerCells.length === cells.length) {\n        return Optional.some('th');\n      } else {\n        return Optional.none();\n      }\n    };\n    var resize = adjustWidthTo;\n    var adjustAndRedistributeWidths$1 = adjustAndRedistributeWidths;\n    var firstColumnIsLocked = function (_warehouse, details) {\n      return exists(details, function (detail) {\n        return detail.column === 0 && detail.isLocked;\n      });\n    };\n    var lastColumnIsLocked = function (warehouse, details) {\n      return exists(details, function (detail) {\n        return detail.column + detail.colspan >= warehouse.grid.columns && detail.isLocked;\n      });\n    };\n    var getColumnsWidth = function (warehouse, details) {\n      var columns = columns$1(warehouse);\n      var uniqueCols = uniqueColumns(details);\n      return foldl(uniqueCols, function (acc, detail) {\n        var column = columns[detail.column];\n        var colWidth = column.map(getOuter).getOr(0);\n        return acc + colWidth;\n      }, 0);\n    };\n    var insertColumnsExtractor = function (before) {\n      return function (warehouse, target) {\n        return onCells(warehouse, target).filter(function (details) {\n          var checkLocked = before ? firstColumnIsLocked : lastColumnIsLocked;\n          return !checkLocked(warehouse, details);\n        }).map(function (details) {\n          return {\n            details: details,\n            pixelDelta: getColumnsWidth(warehouse, details)\n          };\n        });\n      };\n    };\n    var eraseColumnsExtractor = function (warehouse, target) {\n      return onUnlockedCells(warehouse, target).map(function (details) {\n        return {\n          details: details,\n          pixelDelta: -getColumnsWidth(warehouse, details)\n        };\n      });\n    };\n    var pasteColumnsExtractor = function (before) {\n      return function (warehouse, target) {\n        return onPasteByEditor(warehouse, target).filter(function (details) {\n          var checkLocked = before ? firstColumnIsLocked : lastColumnIsLocked;\n          return !checkLocked(warehouse, details.cells);\n        });\n      };\n    };\n    var insertRowsBefore = run(opInsertRowsBefore, onCells, noop, noop, Generators.modification);\n    var insertRowsAfter = run(opInsertRowsAfter, onCells, noop, noop, Generators.modification);\n    var insertColumnsBefore = run(opInsertColumnsBefore, insertColumnsExtractor(true), adjustAndRedistributeWidths$1, noop, Generators.modification);\n    var insertColumnsAfter = run(opInsertColumnsAfter, insertColumnsExtractor(false), adjustAndRedistributeWidths$1, noop, Generators.modification);\n    var eraseColumns = run(opEraseColumns, eraseColumnsExtractor, adjustAndRedistributeWidths$1, prune, Generators.modification);\n    var eraseRows = run(opEraseRows, onCells, noop, prune, Generators.modification);\n    var makeColumnHeader = run(opMakeColumnHeader, onUnlockedCell, noop, noop, Generators.transform('row', 'th'));\n    var makeColumnsHeader = run(opMakeColumnsHeader, onUnlockedCells, noop, noop, Generators.transform('row', 'th'));\n    var unmakeColumnHeader = run(opUnmakeColumnHeader, onUnlockedCell, noop, noop, Generators.transform(null, 'td'));\n    var unmakeColumnsHeader = run(opUnmakeColumnsHeader, onUnlockedCells, noop, noop, Generators.transform(null, 'td'));\n    var makeRowHeader = run(opMakeRowHeader, onCell, noop, noop, Generators.transform('col', 'th'));\n    var makeRowsHeader = run(opMakeRowsHeader, onCells, noop, noop, Generators.transform('col', 'th'));\n    var unmakeRowHeader = run(opUnmakeRowHeader, onCell, noop, noop, Generators.transform(null, 'td'));\n    var unmakeRowsHeader = run(opUnmakeRowsHeader, onCells, noop, noop, Generators.transform(null, 'td'));\n    var mergeCells = run(opMergeCells, onUnlockedMergable, resize, noop, Generators.merging);\n    var unmergeCells = run(opUnmergeCells, onUnlockedUnmergable, resize, noop, Generators.merging);\n    var pasteCells = run(opPasteCells, onPaste, resize, noop, Generators.modification);\n    var pasteColsBefore = run(opPasteColsBefore, pasteColumnsExtractor(true), noop, noop, Generators.modification);\n    var pasteColsAfter = run(opPasteColsAfter, pasteColumnsExtractor(false), noop, noop, Generators.modification);\n    var pasteRowsBefore = run(opPasteRowsBefore, onPasteByEditor, noop, noop, Generators.modification);\n    var pasteRowsAfter = run(opPasteRowsAfter, onPasteByEditor, noop, noop, Generators.modification);\n    var getColumnType = opGetColumnType;\n\n    var getSection = function (elm) {\n      return getNodeName(elm.parentNode);\n    };\n    var mapSectionNameToType = function (section) {\n      if (section === 'thead') {\n        return 'header';\n      } else if (section === 'tfoot') {\n        return 'footer';\n      } else {\n        return 'body';\n      }\n    };\n    var detectHeaderRow = function (editor, elm) {\n      var isThead = getSection(elm) === 'thead';\n      var areAllCellsThs = !exists(elm.cells, function (c) {\n        return getNodeName(c) !== 'th';\n      });\n      return isThead || areAllCellsThs ? Optional.some({\n        thead: isThead,\n        ths: areAllCellsThs\n      }) : Optional.none();\n    };\n    var getRowType = function (editor, elm) {\n      return mapSectionNameToType(detectHeaderRow(editor, elm).fold(function () {\n        return getSection(elm);\n      }, function (_rowConfig) {\n        return 'thead';\n      }));\n    };\n    var switchRowSection = function (dom, rowElm, newSectionName) {\n      var tableElm = dom.getParent(rowElm, 'table');\n      var oldSectionElm = rowElm.parentNode;\n      var oldSectionName = getNodeName(oldSectionElm);\n      if (newSectionName !== oldSectionName) {\n        var sectionElm_1 = dom.select(newSectionName, tableElm)[0];\n        if (!sectionElm_1) {\n          sectionElm_1 = dom.create(newSectionName);\n          var firstTableChild_1 = tableElm.firstChild;\n          if (newSectionName === 'thead') {\n            last(children$2(SugarElement.fromDom(tableElm), 'caption,colgroup')).fold(function () {\n              return tableElm.insertBefore(sectionElm_1, firstTableChild_1);\n            }, function (c) {\n              return dom.insertAfter(sectionElm_1, c.dom);\n            });\n          } else {\n            tableElm.appendChild(sectionElm_1);\n          }\n        }\n        if (newSectionName === 'tbody' && oldSectionName === 'thead' && sectionElm_1.firstChild) {\n          sectionElm_1.insertBefore(rowElm, sectionElm_1.firstChild);\n        } else {\n          sectionElm_1.appendChild(rowElm);\n        }\n        if (!oldSectionElm.hasChildNodes()) {\n          dom.remove(oldSectionElm);\n        }\n      }\n    };\n    var renameCell = function (editor, cell, newCellType) {\n      if (isNonNullable(newCellType) && getNodeName(cell) !== newCellType) {\n        var newCellElm = editor.dom.rename(cell, newCellType);\n        fireNewCell(editor, newCellElm);\n        return newCellElm;\n      } else {\n        return cell;\n      }\n    };\n    var switchCellType = function (editor, cell, newCellType, scope) {\n      var dom = editor.dom;\n      var newCell = renameCell(editor, cell, newCellType);\n      if (!isUndefined(scope)) {\n        dom.setAttrib(newCell, 'scope', scope);\n      }\n      return newCell;\n    };\n    var switchCellsType = function (editor, cells, newCellType, scope) {\n      return each(cells, function (c) {\n        return switchCellType(editor, c, newCellType, scope);\n      });\n    };\n    var switchSectionType = function (editor, rowElm, newType) {\n      var determineHeaderRowType = function () {\n        var allTableRows = table(SugarElement.fromDom(rowElm.cells[0])).map(function (table) {\n          return rows(table);\n        }).getOr([]);\n        return findMap(allTableRows, function (row) {\n          return detectHeaderRow(editor, row.dom);\n        }).map(function (detectedType) {\n          if (detectedType.thead && detectedType.ths) {\n            return 'sectionCells';\n          } else {\n            return detectedType.thead ? 'section' : 'cells';\n          }\n        }).getOr('section');\n      };\n      var dom = editor.dom;\n      if (newType === 'header') {\n        var headerRowTypeSetting = getTableHeaderType(editor);\n        var headerRowType = headerRowTypeSetting === 'auto' ? determineHeaderRowType() : headerRowTypeSetting;\n        switchCellsType(editor, rowElm.cells, headerRowType === 'section' ? 'td' : 'th', 'col');\n        switchRowSection(dom, rowElm, headerRowType === 'cells' ? 'tbody' : 'thead');\n      } else {\n        switchCellsType(editor, rowElm.cells, 'td', null);\n        switchRowSection(dom, rowElm, newType === 'footer' ? 'tfoot' : 'tbody');\n      }\n    };\n\n    var getSelectionStartCellFallback = function (start) {\n      return table(start).bind(function (table) {\n        return retrieve$1(table, ephemera.firstSelectedSelector);\n      }).fold(function () {\n        return start;\n      }, function (cells) {\n        return cells[0];\n      });\n    };\n    var getSelectionStartFromSelector = function (selector) {\n      return function (start, isRoot) {\n        var startCellName = name(start);\n        var startCell = startCellName === 'col' || startCellName === 'colgroup' ? getSelectionStartCellFallback(start) : start;\n        return closest$1(startCell, selector, isRoot);\n      };\n    };\n    var getSelectionStartCell = getSelectionStartFromSelector('th,td');\n    var getSelectionStartCellOrCaption = getSelectionStartFromSelector('th,td,caption');\n    var getCellsFromSelection = function (start, selections, isRoot) {\n      return getSelectionStartCell(start, isRoot).map(function (_cell) {\n        return selection(selections);\n      }).getOr([]);\n    };\n    var getRowsFromSelection = function (start, selector) {\n      var cellOpt = getSelectionStartCell(start);\n      var rowsOpt = cellOpt.bind(function (cell) {\n        return table(cell);\n      }).map(function (table) {\n        return rows(table);\n      });\n      return lift2(cellOpt, rowsOpt, function (cell, rows) {\n        return filter(rows, function (row) {\n          return exists(fromDom$1(row.dom.cells), function (rowCell) {\n            return get$2(rowCell, selector) === '1' || eq$1(rowCell, cell);\n          });\n        });\n      }).getOr([]);\n    };\n\n    var TableActions = function (editor, lazyWire, selections) {\n      var isTableBody = function (editor) {\n        return name(getBody$1(editor)) === 'table';\n      };\n      var lastRowGuard = function (table) {\n        return isTableBody(editor) === false || getGridSize(table).rows > 1;\n      };\n      var lastColumnGuard = function (table) {\n        return isTableBody(editor) === false || getGridSize(table).columns > 1;\n      };\n      var cloneFormats = getCloneElements(editor);\n      var colMutationOp = isResizeTableColumnResizing(editor) ? noop : halve;\n      var execute = function (operation, guard, mutate, lazyWire, effect) {\n        return function (table, target) {\n          removeDataStyle(table);\n          var wire = lazyWire();\n          var doc = SugarElement.fromDom(editor.getDoc());\n          var generators = cellOperations(mutate, doc, cloneFormats);\n          var sizing = get$9(editor, table);\n          var resizeBehaviour = isResizeTableColumnResizing(editor) ? resizeTable() : preserveTable();\n          return guard(table) ? operation(wire, table, target, generators, sizing, resizeBehaviour).bind(function (result) {\n            each(result.newRows, function (row) {\n              fireNewRow(editor, row.dom);\n            });\n            each(result.newCells, function (cell) {\n              fireNewCell(editor, cell.dom);\n            });\n            return result.cursor.map(function (cell) {\n              var des = freefallRtl$2(cell);\n              var rng = editor.dom.createRng();\n              rng.setStart(des.element.dom, des.offset);\n              rng.setEnd(des.element.dom, des.offset);\n              return {\n                rng: rng,\n                effect: effect\n              };\n            });\n          }) : Optional.none();\n        };\n      };\n      var deleteRow = execute(eraseRows, lastRowGuard, noop, lazyWire, structureModified);\n      var deleteColumn = execute(eraseColumns, lastColumnGuard, noop, lazyWire, structureModified);\n      var insertRowsBefore$1 = execute(insertRowsBefore, always, noop, lazyWire, structureModified);\n      var insertRowsAfter$1 = execute(insertRowsAfter, always, noop, lazyWire, structureModified);\n      var insertColumnsBefore$1 = execute(insertColumnsBefore, always, colMutationOp, lazyWire, structureModified);\n      var insertColumnsAfter$1 = execute(insertColumnsAfter, always, colMutationOp, lazyWire, structureModified);\n      var mergeCells$1 = execute(mergeCells, always, noop, lazyWire, structureModified);\n      var unmergeCells$1 = execute(unmergeCells, always, noop, lazyWire, structureModified);\n      var pasteColsBefore$1 = execute(pasteColsBefore, always, noop, lazyWire, structureModified);\n      var pasteColsAfter$1 = execute(pasteColsAfter, always, noop, lazyWire, structureModified);\n      var pasteRowsBefore$1 = execute(pasteRowsBefore, always, noop, lazyWire, structureModified);\n      var pasteRowsAfter$1 = execute(pasteRowsAfter, always, noop, lazyWire, structureModified);\n      var pasteCells$1 = execute(pasteCells, always, noop, lazyWire, structureModified);\n      var extractType = function (args, validTypes) {\n        return get$1(args, 'type').filter(function (type) {\n          return contains(validTypes, type);\n        });\n      };\n      var setTableCellType = function (editor, args) {\n        return extractType(args, [\n          'td',\n          'th'\n        ]).each(function (type) {\n          var cells = map(getCellsFromSelection(getSelectionStart(editor), selections), function (c) {\n            return c.dom;\n          });\n          switchCellsType(editor, cells, type, null);\n        });\n      };\n      var setTableRowType = function (editor, args) {\n        return extractType(args, [\n          'header',\n          'body',\n          'footer'\n        ]).each(function (type) {\n          map(getRowsFromSelection(getSelectionStart(editor), ephemera.selected), function (row) {\n            return switchSectionType(editor, row.dom, type);\n          });\n        });\n      };\n      var makeColumnsHeader$1 = execute(makeColumnsHeader, always, noop, lazyWire, structureModified);\n      var unmakeColumnsHeader$1 = execute(unmakeColumnsHeader, always, noop, lazyWire, structureModified);\n      var getTableRowType = function (editor) {\n        var rows = getRowsFromSelection(getSelectionStart(editor), ephemera.selected);\n        if (rows.length > 0) {\n          var rowTypes = map(rows, function (r) {\n            return getRowType(editor, r.dom);\n          });\n          var hasHeader = contains(rowTypes, 'header');\n          var hasFooter = contains(rowTypes, 'footer');\n          if (!hasHeader && !hasFooter) {\n            return 'body';\n          } else {\n            var hasBody = contains(rowTypes, 'body');\n            if (hasHeader && !hasBody && !hasFooter) {\n              return 'header';\n            } else if (!hasHeader && !hasBody && hasFooter) {\n              return 'footer';\n            } else {\n              return '';\n            }\n          }\n        }\n      };\n      var getTableCellType = function (editor) {\n        return getCellsType(getCellsFromSelection(getSelectionStart(editor), selections), function (cell) {\n          return name(cell) === 'th';\n        }).getOr('');\n      };\n      var getTableColType = getColumnType;\n      return {\n        deleteRow: deleteRow,\n        deleteColumn: deleteColumn,\n        insertRowsBefore: insertRowsBefore$1,\n        insertRowsAfter: insertRowsAfter$1,\n        insertColumnsBefore: insertColumnsBefore$1,\n        insertColumnsAfter: insertColumnsAfter$1,\n        mergeCells: mergeCells$1,\n        unmergeCells: unmergeCells$1,\n        pasteColsBefore: pasteColsBefore$1,\n        pasteColsAfter: pasteColsAfter$1,\n        pasteRowsBefore: pasteRowsBefore$1,\n        pasteRowsAfter: pasteRowsAfter$1,\n        pasteCells: pasteCells$1,\n        setTableCellType: setTableCellType,\n        setTableRowType: setTableRowType,\n        makeColumnsHeader: makeColumnsHeader$1,\n        unmakeColumnsHeader: unmakeColumnsHeader$1,\n        getTableRowType: getTableRowType,\n        getTableCellType: getTableCellType,\n        getTableColType: getTableColType\n      };\n    };\n\n    var DefaultRenderOptions = {\n      styles: {\n        'border-collapse': 'collapse',\n        'width': '100%'\n      },\n      attributes: { border: '1' },\n      colGroups: false\n    };\n    var tableHeaderCell = function () {\n      return SugarElement.fromTag('th');\n    };\n    var tableCell = function () {\n      return SugarElement.fromTag('td');\n    };\n    var tableColumn = function () {\n      return SugarElement.fromTag('col');\n    };\n    var createRow = function (columns, rowHeaders, columnHeaders, rowIndex) {\n      var tr = SugarElement.fromTag('tr');\n      for (var j = 0; j < columns; j++) {\n        var td = rowIndex < rowHeaders || j < columnHeaders ? tableHeaderCell() : tableCell();\n        if (j < columnHeaders) {\n          set(td, 'scope', 'row');\n        }\n        if (rowIndex < rowHeaders) {\n          set(td, 'scope', 'col');\n        }\n        append(td, SugarElement.fromTag('br'));\n        append(tr, td);\n      }\n      return tr;\n    };\n    var createGroupRow = function (columns) {\n      var columnGroup = SugarElement.fromTag('colgroup');\n      range(columns, function () {\n        return append(columnGroup, tableColumn());\n      });\n      return columnGroup;\n    };\n    var createRows = function (rows, columns, rowHeaders, columnHeaders) {\n      return range(rows, function (r) {\n        return createRow(columns, rowHeaders, columnHeaders, r);\n      });\n    };\n    var render$1 = function (rows, columns, rowHeaders, columnHeaders, headerType, renderOpts) {\n      if (renderOpts === void 0) {\n        renderOpts = DefaultRenderOptions;\n      }\n      var table = SugarElement.fromTag('table');\n      var rowHeadersGoInThead = headerType !== 'cells';\n      setAll$1(table, renderOpts.styles);\n      setAll(table, renderOpts.attributes);\n      if (renderOpts.colGroups) {\n        append(table, createGroupRow(columns));\n      }\n      var actualRowHeaders = Math.min(rows, rowHeaders);\n      if (rowHeadersGoInThead && rowHeaders > 0) {\n        var thead = SugarElement.fromTag('thead');\n        append(table, thead);\n        var theadRowHeaders = headerType === 'sectionCells' ? actualRowHeaders : 0;\n        var theadRows = createRows(rowHeaders, columns, theadRowHeaders, columnHeaders);\n        append$1(thead, theadRows);\n      }\n      var tbody = SugarElement.fromTag('tbody');\n      append(table, tbody);\n      var numRows = rowHeadersGoInThead ? rows - actualRowHeaders : rows;\n      var numRowHeaders = rowHeadersGoInThead ? 0 : rowHeaders;\n      var tbodyRows = createRows(numRows, columns, numRowHeaders, columnHeaders);\n      append$1(tbody, tbodyRows);\n      return table;\n    };\n\n    var get$b = function (element) {\n      return element.dom.innerHTML;\n    };\n    var getOuter$2 = function (element) {\n      var container = SugarElement.fromTag('div');\n      var clone = SugarElement.fromDom(element.dom.cloneNode(true));\n      append(container, clone);\n      return get$b(container);\n    };\n\n    var placeCaretInCell = function (editor, cell) {\n      editor.selection.select(cell.dom, true);\n      editor.selection.collapse(true);\n    };\n    var selectFirstCellInTable = function (editor, tableElm) {\n      descendant$1(tableElm, 'td,th').each(curry(placeCaretInCell, editor));\n    };\n    var fireEvents = function (editor, table) {\n      each(descendants$1(table, 'tr'), function (row) {\n        fireNewRow(editor, row.dom);\n        each(descendants$1(row, 'th,td'), function (cell) {\n          fireNewCell(editor, cell.dom);\n        });\n      });\n    };\n    var isPercentage$1 = function (width) {\n      return isString(width) && width.indexOf('%') !== -1;\n    };\n    var insert$1 = function (editor, columns, rows, colHeaders, rowHeaders) {\n      var defaultStyles = getDefaultStyles(editor);\n      var options = {\n        styles: defaultStyles,\n        attributes: getDefaultAttributes(editor),\n        colGroups: useColumnGroup(editor)\n      };\n      editor.undoManager.ignore(function () {\n        var table = render$1(rows, columns, rowHeaders, colHeaders, getTableHeaderType(editor), options);\n        set(table, 'data-mce-id', '__mce');\n        var html = getOuter$2(table);\n        editor.insertContent(html);\n        editor.addVisual();\n      });\n      return descendant$1(getBody$1(editor), 'table[data-mce-id=\"__mce\"]').map(function (table) {\n        if (isPixelsForced(editor)) {\n          enforcePixels(editor, table);\n        } else if (isResponsiveForced(editor)) {\n          enforceNone(table);\n        } else if (isPercentagesForced(editor) || isPercentage$1(defaultStyles.width)) {\n          enforcePercentage(editor, table);\n        }\n        removeDataStyle(table);\n        remove(table, 'data-mce-id');\n        fireEvents(editor, table);\n        selectFirstCellInTable(editor, table);\n        return table.dom;\n      }).getOr(null);\n    };\n    var insertTableWithDataValidation = function (editor, rows, columns, options, errorMsg) {\n      if (options === void 0) {\n        options = {};\n      }\n      var checkInput = function (val) {\n        return isNumber(val) && val > 0;\n      };\n      if (checkInput(rows) && checkInput(columns)) {\n        var headerRows = options.headerRows || 0;\n        var headerColumns = options.headerColumns || 0;\n        return insert$1(editor, columns, rows, headerColumns, headerRows);\n      } else {\n        console.error(errorMsg);\n        return null;\n      }\n    };\n\n    var getClipboardElements = function (getClipboard) {\n      return function () {\n        return getClipboard().fold(function () {\n          return [];\n        }, function (elems) {\n          return map(elems, function (e) {\n            return e.dom;\n          });\n        });\n      };\n    };\n    var setClipboardElements = function (setClipboard) {\n      return function (elems) {\n        var elmsOpt = elems.length > 0 ? Optional.some(fromDom$1(elems)) : Optional.none();\n        setClipboard(elmsOpt);\n      };\n    };\n    var insertTable = function (editor) {\n      return function (columns, rows, options) {\n        if (options === void 0) {\n          options = {};\n        }\n        var table = insertTableWithDataValidation(editor, rows, columns, options, 'Invalid values for insertTable - rows and columns values are required to insert a table.');\n        editor.undoManager.add();\n        return table;\n      };\n    };\n    var getApi = function (editor, clipboard, resizeHandler, selectionTargets) {\n      return {\n        insertTable: insertTable(editor),\n        setClipboardRows: setClipboardElements(clipboard.setRows),\n        getClipboardRows: getClipboardElements(clipboard.getRows),\n        setClipboardCols: setClipboardElements(clipboard.setColumns),\n        getClipboardCols: getClipboardElements(clipboard.getColumns),\n        resizeHandler: resizeHandler,\n        selectionTargets: selectionTargets\n      };\n    };\n\n    var constrainSpan = function (element, property, value) {\n      var currentColspan = getAttrValue(element, property, 1);\n      if (value === 1 || currentColspan <= 1) {\n        remove(element, property);\n      } else {\n        set(element, property, Math.min(value, currentColspan));\n      }\n    };\n    var generateColGroup = function (house, minColRange, maxColRange) {\n      if (Warehouse.hasColumns(house)) {\n        var colsToCopy = filter(Warehouse.justColumns(house), function (col) {\n          return col.column >= minColRange && col.column < maxColRange;\n        });\n        var copiedCols = map(colsToCopy, function (c) {\n          var clonedCol = deep(c.element);\n          constrainSpan(clonedCol, 'span', maxColRange - minColRange);\n          return clonedCol;\n        });\n        var fakeColgroup = SugarElement.fromTag('colgroup');\n        append$1(fakeColgroup, copiedCols);\n        return [fakeColgroup];\n      } else {\n        return [];\n      }\n    };\n    var generateRows = function (house, minColRange, maxColRange) {\n      return map(house.all, function (row) {\n        var cellsToCopy = filter(row.cells, function (cell) {\n          return cell.column >= minColRange && cell.column < maxColRange;\n        });\n        var copiedCells = map(cellsToCopy, function (cell) {\n          var clonedCell = deep(cell.element);\n          constrainSpan(clonedCell, 'colspan', maxColRange - minColRange);\n          return clonedCell;\n        });\n        var fakeTR = SugarElement.fromTag('tr');\n        append$1(fakeTR, copiedCells);\n        return fakeTR;\n      });\n    };\n    var copyCols = function (table, target) {\n      var house = Warehouse.fromTable(table);\n      var details = onUnlockedCells(house, target);\n      return details.map(function (selectedCells) {\n        var lastSelectedCell = selectedCells[selectedCells.length - 1];\n        var minColRange = selectedCells[0].column;\n        var maxColRange = lastSelectedCell.column + lastSelectedCell.colspan;\n        var fakeColGroups = generateColGroup(house, minColRange, maxColRange);\n        var fakeRows = generateRows(house, minColRange, maxColRange);\n        return __spreadArrays(fakeColGroups, fakeRows);\n      });\n    };\n\n    var copyRows = function (table, target, generators) {\n      var warehouse = Warehouse.fromTable(table);\n      var details = onCells(warehouse, target);\n      return details.bind(function (selectedCells) {\n        var grid = toGrid(warehouse, generators, false);\n        var rows = extractGridDetails(grid).rows;\n        var slicedGrid = rows.slice(selectedCells[0].row, selectedCells[selectedCells.length - 1].row + selectedCells[selectedCells.length - 1].rowspan);\n        var filteredGrid = bind(slicedGrid, function (row) {\n          var newCells = filter(row.cells, function (cell) {\n            return !cell.isLocked;\n          });\n          return newCells.length > 0 ? [__assign(__assign({}, row), { cells: newCells })] : [];\n        });\n        var slicedDetails = toDetailList(filteredGrid, generators);\n        return someIf(slicedDetails.length > 0, slicedDetails);\n      }).map(function (slicedDetails) {\n        return copy$2(slicedDetails);\n      });\n    };\n\n    var global$1 = tinymce.util.Tools.resolve('tinymce.util.Tools');\n\n    var getTDTHOverallStyle = function (dom, elm, name) {\n      var cells = dom.select('td,th', elm);\n      var firstChildStyle;\n      var checkChildren = function (firstChildStyle, elms) {\n        for (var i = 0; i < elms.length; i++) {\n          var currentStyle = dom.getStyle(elms[i], name);\n          if (typeof firstChildStyle === 'undefined') {\n            firstChildStyle = currentStyle;\n          }\n          if (firstChildStyle !== currentStyle) {\n            return '';\n          }\n        }\n        return firstChildStyle;\n      };\n      return checkChildren(firstChildStyle, cells);\n    };\n    var applyAlign = function (editor, elm, name) {\n      if (name) {\n        editor.formatter.apply('align' + name, {}, elm);\n      }\n    };\n    var applyVAlign = function (editor, elm, name) {\n      if (name) {\n        editor.formatter.apply('valign' + name, {}, elm);\n      }\n    };\n    var unApplyAlign = function (editor, elm) {\n      global$1.each('left center right'.split(' '), function (name) {\n        editor.formatter.remove('align' + name, {}, elm);\n      });\n    };\n    var unApplyVAlign = function (editor, elm) {\n      global$1.each('top middle bottom'.split(' '), function (name) {\n        editor.formatter.remove('valign' + name, {}, elm);\n      });\n    };\n\n    var isListGroup = function (item) {\n      return hasNonNullableKey(item, 'menu');\n    };\n    var buildListItems = function (inputList, startItems) {\n      var appendItems = function (values, acc) {\n        return acc.concat(map(values, function (item) {\n          var text = item.text || item.title;\n          if (isListGroup(item)) {\n            return {\n              text: text,\n              items: buildListItems(item.menu)\n            };\n          } else {\n            return {\n              text: text,\n              value: item.value\n            };\n          }\n        }));\n      };\n      return appendItems(inputList, startItems || []);\n    };\n    var rgbToHex = function (dom) {\n      return function (value) {\n        return startsWith(value, 'rgb') ? dom.toHex(value) : value;\n      };\n    };\n    var extractAdvancedStyles = function (dom, elm) {\n      var element = SugarElement.fromDom(elm);\n      return {\n        borderwidth: getRaw(element, 'border-width').getOr(''),\n        borderstyle: getRaw(element, 'border-style').getOr(''),\n        bordercolor: getRaw(element, 'border-color').map(rgbToHex(dom)).getOr(''),\n        backgroundcolor: getRaw(element, 'background-color').map(rgbToHex(dom)).getOr('')\n      };\n    };\n    var getSharedValues = function (data) {\n      var baseData = data[0];\n      var comparisonData = data.slice(1);\n      each(comparisonData, function (items) {\n        each(keys(baseData), function (key) {\n          each$1(items, function (itemValue, itemKey) {\n            var comparisonValue = baseData[key];\n            if (comparisonValue !== '' && key === itemKey) {\n              if (comparisonValue !== itemValue) {\n                baseData[key] = '';\n              }\n            }\n          });\n        });\n      });\n      return baseData;\n    };\n    var getAdvancedTab = function (dialogName) {\n      var advTabItems = [\n        {\n          name: 'borderstyle',\n          type: 'listbox',\n          label: 'Border style',\n          items: [\n            {\n              text: 'Select...',\n              value: ''\n            },\n            {\n              text: 'Solid',\n              value: 'solid'\n            },\n            {\n              text: 'Dotted',\n              value: 'dotted'\n            },\n            {\n              text: 'Dashed',\n              value: 'dashed'\n            },\n            {\n              text: 'Double',\n              value: 'double'\n            },\n            {\n              text: 'Groove',\n              value: 'groove'\n            },\n            {\n              text: 'Ridge',\n              value: 'ridge'\n            },\n            {\n              text: 'Inset',\n              value: 'inset'\n            },\n            {\n              text: 'Outset',\n              value: 'outset'\n            },\n            {\n              text: 'None',\n              value: 'none'\n            },\n            {\n              text: 'Hidden',\n              value: 'hidden'\n            }\n          ]\n        },\n        {\n          name: 'bordercolor',\n          type: 'colorinput',\n          label: 'Border color'\n        },\n        {\n          name: 'backgroundcolor',\n          type: 'colorinput',\n          label: 'Background color'\n        }\n      ];\n      var borderWidth = {\n        name: 'borderwidth',\n        type: 'input',\n        label: 'Border width'\n      };\n      var items = dialogName === 'cell' ? [borderWidth].concat(advTabItems) : advTabItems;\n      return {\n        title: 'Advanced',\n        name: 'advanced',\n        items: items\n      };\n    };\n    var getAlignment = function (formats, formatName, editor, elm) {\n      return find(formats, function (name) {\n        return editor.formatter.matchNode(elm, formatName + name);\n      }).getOr('');\n    };\n    var getHAlignment = curry(getAlignment, [\n      'left',\n      'center',\n      'right'\n    ], 'align');\n    var getVAlignment = curry(getAlignment, [\n      'top',\n      'middle',\n      'bottom'\n    ], 'valign');\n    var extractDataFromSettings = function (editor, hasAdvTableTab) {\n      var style = getDefaultStyles(editor);\n      var attrs = getDefaultAttributes(editor);\n      var extractAdvancedStyleData = function (dom) {\n        return {\n          borderstyle: get$1(style, 'border-style').getOr(''),\n          bordercolor: rgbToHex(dom)(get$1(style, 'border-color').getOr('')),\n          backgroundcolor: rgbToHex(dom)(get$1(style, 'background-color').getOr(''))\n        };\n      };\n      var defaultData = {\n        height: '',\n        width: '100%',\n        cellspacing: '',\n        cellpadding: '',\n        caption: false,\n        class: '',\n        align: '',\n        border: ''\n      };\n      var getBorder = function () {\n        var borderWidth = style['border-width'];\n        if (shouldStyleWithCss(editor) && borderWidth) {\n          return { border: borderWidth };\n        }\n        return get$1(attrs, 'border').fold(function () {\n          return {};\n        }, function (border) {\n          return { border: border };\n        });\n      };\n      var advStyle = hasAdvTableTab ? extractAdvancedStyleData(editor.dom) : {};\n      var getCellPaddingCellSpacing = function () {\n        var spacing = get$1(style, 'border-spacing').or(get$1(attrs, 'cellspacing')).fold(function () {\n          return {};\n        }, function (cellspacing) {\n          return { cellspacing: cellspacing };\n        });\n        var padding = get$1(style, 'border-padding').or(get$1(attrs, 'cellpadding')).fold(function () {\n          return {};\n        }, function (cellpadding) {\n          return { cellpadding: cellpadding };\n        });\n        return __assign(__assign({}, spacing), padding);\n      };\n      var data = __assign(__assign(__assign(__assign(__assign(__assign({}, defaultData), style), attrs), advStyle), getBorder()), getCellPaddingCellSpacing());\n      return data;\n    };\n    var extractDataFromTableElement = function (editor, elm, hasAdvTableTab) {\n      var getBorder = function (dom, elm) {\n        var optBorderWidth = getRaw(SugarElement.fromDom(elm), 'border-width');\n        if (shouldStyleWithCss(editor) && optBorderWidth.isSome()) {\n          return optBorderWidth.getOr('');\n        }\n        return dom.getAttrib(elm, 'border') || getTDTHOverallStyle(editor.dom, elm, 'border-width') || getTDTHOverallStyle(editor.dom, elm, 'border');\n      };\n      var dom = editor.dom;\n      return __assign({\n        width: dom.getStyle(elm, 'width') || dom.getAttrib(elm, 'width'),\n        height: dom.getStyle(elm, 'height') || dom.getAttrib(elm, 'height'),\n        cellspacing: dom.getStyle(elm, 'border-spacing') || dom.getAttrib(elm, 'cellspacing'),\n        cellpadding: dom.getAttrib(elm, 'cellpadding') || getTDTHOverallStyle(editor.dom, elm, 'padding'),\n        border: getBorder(dom, elm),\n        caption: !!dom.select('caption', elm)[0],\n        class: dom.getAttrib(elm, 'class', ''),\n        align: getHAlignment(editor, elm)\n      }, hasAdvTableTab ? extractAdvancedStyles(dom, elm) : {});\n    };\n    var extractDataFromRowElement = function (editor, elm, hasAdvancedRowTab) {\n      var dom = editor.dom;\n      return __assign({\n        height: dom.getStyle(elm, 'height') || dom.getAttrib(elm, 'height'),\n        class: dom.getAttrib(elm, 'class', ''),\n        type: getRowType(editor, elm),\n        align: getHAlignment(editor, elm)\n      }, hasAdvancedRowTab ? extractAdvancedStyles(dom, elm) : {});\n    };\n    var extractDataFromCellElement = function (editor, cell, hasAdvancedCellTab, column) {\n      var dom = editor.dom;\n      var colElm = column.getOr(cell);\n      var getStyle = function (element, style) {\n        return dom.getStyle(element, style) || dom.getAttrib(element, style);\n      };\n      return __assign({\n        width: getStyle(colElm, 'width'),\n        height: getStyle(cell, 'height'),\n        scope: dom.getAttrib(cell, 'scope'),\n        celltype: getNodeName(cell),\n        class: dom.getAttrib(cell, 'class', ''),\n        halign: getHAlignment(editor, cell),\n        valign: getVAlignment(editor, cell)\n      }, hasAdvancedCellTab ? extractAdvancedStyles(dom, cell) : {});\n    };\n\n    var getClassList = function (editor) {\n      var classes = buildListItems(getCellClassList(editor));\n      if (classes.length > 0) {\n        return Optional.some({\n          name: 'class',\n          type: 'listbox',\n          label: 'Class',\n          items: classes\n        });\n      }\n      return Optional.none();\n    };\n    var children$3 = [\n      {\n        name: 'width',\n        type: 'input',\n        label: 'Width'\n      },\n      {\n        name: 'height',\n        type: 'input',\n        label: 'Height'\n      },\n      {\n        name: 'celltype',\n        type: 'listbox',\n        label: 'Cell type',\n        items: [\n          {\n            text: 'Cell',\n            value: 'td'\n          },\n          {\n            text: 'Header cell',\n            value: 'th'\n          }\n        ]\n      },\n      {\n        name: 'scope',\n        type: 'listbox',\n        label: 'Scope',\n        items: [\n          {\n            text: 'None',\n            value: ''\n          },\n          {\n            text: 'Row',\n            value: 'row'\n          },\n          {\n            text: 'Column',\n            value: 'col'\n          },\n          {\n            text: 'Row group',\n            value: 'rowgroup'\n          },\n          {\n            text: 'Column group',\n            value: 'colgroup'\n          }\n        ]\n      },\n      {\n        name: 'halign',\n        type: 'listbox',\n        label: 'Horizontal align',\n        items: [\n          {\n            text: 'None',\n            value: ''\n          },\n          {\n            text: 'Left',\n            value: 'left'\n          },\n          {\n            text: 'Center',\n            value: 'center'\n          },\n          {\n            text: 'Right',\n            value: 'right'\n          }\n        ]\n      },\n      {\n        name: 'valign',\n        type: 'listbox',\n        label: 'Vertical align',\n        items: [\n          {\n            text: 'None',\n            value: ''\n          },\n          {\n            text: 'Top',\n            value: 'top'\n          },\n          {\n            text: 'Middle',\n            value: 'middle'\n          },\n          {\n            text: 'Bottom',\n            value: 'bottom'\n          }\n        ]\n      }\n    ];\n    var getItems = function (editor) {\n      return children$3.concat(getClassList(editor).toArray());\n    };\n\n    var modifiers = function (testTruthy) {\n      return function (editor, node) {\n        var dom = editor.dom;\n        var setAttrib = function (attr, value) {\n          if (!testTruthy || value) {\n            dom.setAttrib(node, attr, value);\n          }\n        };\n        var setStyle = function (prop, value) {\n          if (!testTruthy || value) {\n            dom.setStyle(node, prop, value);\n          }\n        };\n        var setFormat = function (formatName, value) {\n          if (!testTruthy || value) {\n            if (value === '') {\n              editor.formatter.remove(formatName, { value: null }, node, true);\n            } else {\n              editor.formatter.apply(formatName, { value: value }, node);\n            }\n          }\n        };\n        return {\n          setAttrib: setAttrib,\n          setStyle: setStyle,\n          setFormat: setFormat\n        };\n      };\n    };\n    var DomModifier = {\n      normal: modifiers(false),\n      ifTruthy: modifiers(true)\n    };\n\n    var getSelectedCells = function (cells) {\n      return table(cells[0]).map(function (table) {\n        var warehouse = Warehouse.fromTable(table);\n        var allCells = Warehouse.justCells(warehouse);\n        var filtered = filter(allCells, function (cellA) {\n          return exists(cells, function (cellB) {\n            return eq$1(cellA.element, cellB);\n          });\n        });\n        return map(filtered, function (cell) {\n          return {\n            element: cell.element.dom,\n            column: Warehouse.getColumnAt(warehouse, cell.column).map(function (col) {\n              return col.element.dom;\n            })\n          };\n        });\n      });\n    };\n    var updateSimpleProps = function (modifier, colModifier, data) {\n      modifier.setAttrib('scope', data.scope);\n      modifier.setAttrib('class', data.class);\n      modifier.setStyle('height', addPxSuffix(data.height));\n      colModifier.setStyle('width', addPxSuffix(data.width));\n    };\n    var updateAdvancedProps = function (modifier, data) {\n      modifier.setFormat('tablecellbackgroundcolor', data.backgroundcolor);\n      modifier.setFormat('tablecellbordercolor', data.bordercolor);\n      modifier.setFormat('tablecellborderstyle', data.borderstyle);\n      modifier.setFormat('tablecellborderwidth', addPxSuffix(data.borderwidth));\n    };\n    var applyCellData = function (editor, cells, oldData, data) {\n      var isSingleCell = cells.length === 1;\n      var modifiedData = filter$1(data, function (value, key) {\n        return oldData[key] !== value;\n      });\n      if (size(modifiedData) > 0 && cells.length >= 1) {\n        var tableOpt = table(cells[0]);\n        getSelectedCells(cells).each(function (selectedCells) {\n          each(selectedCells, function (item) {\n            var cellElm = switchCellType(editor, item.element, data.celltype);\n            var modifier = isSingleCell ? DomModifier.normal(editor, cellElm) : DomModifier.ifTruthy(editor, cellElm);\n            var colModifier = item.column.map(function (col) {\n              return isSingleCell ? DomModifier.normal(editor, col) : DomModifier.ifTruthy(editor, col);\n            }).getOr(modifier);\n            updateSimpleProps(modifier, colModifier, data);\n            if (hasAdvancedCellTab(editor)) {\n              updateAdvancedProps(modifier, data);\n            }\n            if (isSingleCell) {\n              unApplyAlign(editor, cellElm);\n              unApplyVAlign(editor, cellElm);\n            }\n            if (data.halign) {\n              applyAlign(editor, cellElm, data.halign);\n            }\n            if (data.valign) {\n              applyVAlign(editor, cellElm, data.valign);\n            }\n          });\n        });\n        var styleModified_1 = size(filter$1(modifiedData, function (_value, key) {\n          return key !== 'scope' && key !== 'celltype';\n        })) > 0;\n        tableOpt.each(function (table) {\n          return fireTableModified(editor, table.dom, {\n            structure: has(modifiedData, 'celltype'),\n            style: styleModified_1\n          });\n        });\n      }\n    };\n    var onSubmitCellForm = function (editor, cells, oldData, api) {\n      var data = api.getData();\n      api.close();\n      editor.undoManager.transact(function () {\n        applyCellData(editor, cells, oldData, data);\n        editor.focus();\n      });\n    };\n    var getData = function (editor, cells) {\n      var cellsData = getSelectedCells(cells).map(function (selectedCells) {\n        return map(selectedCells, function (item) {\n          return extractDataFromCellElement(editor, item.element, hasAdvancedCellTab(editor), item.column);\n        });\n      });\n      return getSharedValues(cellsData.getOrDie());\n    };\n    var open = function (editor, selections) {\n      var cells = getCellsFromSelection(getSelectionStart(editor), selections);\n      if (cells.length === 0) {\n        return;\n      }\n      var data = getData(editor, cells);\n      var dialogTabPanel = {\n        type: 'tabpanel',\n        tabs: [\n          {\n            title: 'General',\n            name: 'general',\n            items: getItems(editor)\n          },\n          getAdvancedTab('cell')\n        ]\n      };\n      var dialogPanel = {\n        type: 'panel',\n        items: [{\n            type: 'grid',\n            columns: 2,\n            items: getItems(editor)\n          }]\n      };\n      editor.windowManager.open({\n        title: 'Cell Properties',\n        size: 'normal',\n        body: hasAdvancedCellTab(editor) ? dialogTabPanel : dialogPanel,\n        buttons: [\n          {\n            type: 'cancel',\n            name: 'cancel',\n            text: 'Cancel'\n          },\n          {\n            type: 'submit',\n            name: 'save',\n            text: 'Save',\n            primary: true\n          }\n        ],\n        initialData: data,\n        onSubmit: curry(onSubmitCellForm, editor, cells, data)\n      });\n    };\n\n    var getClassList$1 = function (editor) {\n      var classes = buildListItems(getRowClassList(editor));\n      if (classes.length > 0) {\n        return Optional.some({\n          name: 'class',\n          type: 'listbox',\n          label: 'Class',\n          items: classes\n        });\n      }\n      return Optional.none();\n    };\n    var formChildren = [\n      {\n        type: 'listbox',\n        name: 'type',\n        label: 'Row type',\n        items: [\n          {\n            text: 'Header',\n            value: 'header'\n          },\n          {\n            text: 'Body',\n            value: 'body'\n          },\n          {\n            text: 'Footer',\n            value: 'footer'\n          }\n        ]\n      },\n      {\n        type: 'listbox',\n        name: 'align',\n        label: 'Alignment',\n        items: [\n          {\n            text: 'None',\n            value: ''\n          },\n          {\n            text: 'Left',\n            value: 'left'\n          },\n          {\n            text: 'Center',\n            value: 'center'\n          },\n          {\n            text: 'Right',\n            value: 'right'\n          }\n        ]\n      },\n      {\n        label: 'Height',\n        name: 'height',\n        type: 'input'\n      }\n    ];\n    var getItems$1 = function (editor) {\n      return formChildren.concat(getClassList$1(editor).toArray());\n    };\n\n    var updateSimpleProps$1 = function (modifier, data) {\n      modifier.setAttrib('class', data.class);\n      modifier.setStyle('height', addPxSuffix(data.height));\n    };\n    var updateAdvancedProps$1 = function (modifier, data) {\n      modifier.setStyle('background-color', data.backgroundcolor);\n      modifier.setStyle('border-color', data.bordercolor);\n      modifier.setStyle('border-style', data.borderstyle);\n    };\n    var applyRowData = function (editor, rows, oldData, data) {\n      var isSingleRow = rows.length === 1;\n      var modifiedData = filter$1(data, function (value, key) {\n        return oldData[key] !== value;\n      });\n      if (size(modifiedData) > 0) {\n        each(rows, function (rowElm) {\n          if (data.type !== getNodeName(rowElm.parentNode)) {\n            switchSectionType(editor, rowElm, data.type);\n          }\n          var modifier = isSingleRow ? DomModifier.normal(editor, rowElm) : DomModifier.ifTruthy(editor, rowElm);\n          updateSimpleProps$1(modifier, data);\n          if (hasAdvancedRowTab(editor)) {\n            updateAdvancedProps$1(modifier, data);\n          }\n          if (data.align !== oldData.align) {\n            unApplyAlign(editor, rowElm);\n            applyAlign(editor, rowElm, data.align);\n          }\n        });\n        var typeModified_1 = has(modifiedData, 'type');\n        var styleModified_1 = typeModified_1 ? size(modifiedData) > 1 : true;\n        table(SugarElement.fromDom(rows[0])).each(function (table) {\n          return fireTableModified(editor, table.dom, {\n            structure: typeModified_1,\n            style: styleModified_1\n          });\n        });\n      }\n    };\n    var onSubmitRowForm = function (editor, rows, oldData, api) {\n      var data = api.getData();\n      api.close();\n      editor.undoManager.transact(function () {\n        applyRowData(editor, rows, oldData, data);\n        editor.focus();\n      });\n    };\n    var open$1 = function (editor) {\n      var rows = getRowsFromSelection(getSelectionStart(editor), ephemera.selected);\n      if (rows.length === 0) {\n        return;\n      }\n      var rowsData = map(rows, function (rowElm) {\n        return extractDataFromRowElement(editor, rowElm.dom, hasAdvancedRowTab(editor));\n      });\n      var data = getSharedValues(rowsData);\n      var dialogTabPanel = {\n        type: 'tabpanel',\n        tabs: [\n          {\n            title: 'General',\n            name: 'general',\n            items: getItems$1(editor)\n          },\n          getAdvancedTab('row')\n        ]\n      };\n      var dialogPanel = {\n        type: 'panel',\n        items: [{\n            type: 'grid',\n            columns: 2,\n            items: getItems$1(editor)\n          }]\n      };\n      editor.windowManager.open({\n        title: 'Row Properties',\n        size: 'normal',\n        body: hasAdvancedRowTab(editor) ? dialogTabPanel : dialogPanel,\n        buttons: [\n          {\n            type: 'cancel',\n            name: 'cancel',\n            text: 'Cancel'\n          },\n          {\n            type: 'submit',\n            name: 'save',\n            text: 'Save',\n            primary: true\n          }\n        ],\n        initialData: data,\n        onSubmit: curry(onSubmitRowForm, editor, map(rows, function (r) {\n          return r.dom;\n        }), data)\n      });\n    };\n\n    var global$2 = tinymce.util.Tools.resolve('tinymce.Env');\n\n    var getItems$2 = function (editor, classes, insertNewTable) {\n      var rowColCountItems = !insertNewTable ? [] : [\n        {\n          type: 'input',\n          name: 'cols',\n          label: 'Cols',\n          inputMode: 'numeric'\n        },\n        {\n          type: 'input',\n          name: 'rows',\n          label: 'Rows',\n          inputMode: 'numeric'\n        }\n      ];\n      var alwaysItems = [\n        {\n          type: 'input',\n          name: 'width',\n          label: 'Width'\n        },\n        {\n          type: 'input',\n          name: 'height',\n          label: 'Height'\n        }\n      ];\n      var appearanceItems = hasAppearanceOptions(editor) ? [\n        {\n          type: 'input',\n          name: 'cellspacing',\n          label: 'Cell spacing',\n          inputMode: 'numeric'\n        },\n        {\n          type: 'input',\n          name: 'cellpadding',\n          label: 'Cell padding',\n          inputMode: 'numeric'\n        },\n        {\n          type: 'input',\n          name: 'border',\n          label: 'Border width'\n        },\n        {\n          type: 'label',\n          label: 'Caption',\n          items: [{\n              type: 'checkbox',\n              name: 'caption',\n              label: 'Show caption'\n            }]\n        }\n      ] : [];\n      var alignmentItem = [{\n          type: 'listbox',\n          name: 'align',\n          label: 'Alignment',\n          items: [\n            {\n              text: 'None',\n              value: ''\n            },\n            {\n              text: 'Left',\n              value: 'left'\n            },\n            {\n              text: 'Center',\n              value: 'center'\n            },\n            {\n              text: 'Right',\n              value: 'right'\n            }\n          ]\n        }];\n      var classListItem = classes.length > 0 ? [{\n          type: 'listbox',\n          name: 'class',\n          label: 'Class',\n          items: classes\n        }] : [];\n      return rowColCountItems.concat(alwaysItems).concat(appearanceItems).concat(alignmentItem).concat(classListItem);\n    };\n\n    var styleTDTH = function (dom, elm, name, value) {\n      if (elm.tagName === 'TD' || elm.tagName === 'TH') {\n        if (isString(name)) {\n          dom.setStyle(elm, name, value);\n        } else {\n          dom.setStyle(elm, name);\n        }\n      } else {\n        if (elm.children) {\n          for (var i = 0; i < elm.children.length; i++) {\n            styleTDTH(dom, elm.children[i], name, value);\n          }\n        }\n      }\n    };\n    var applyDataToElement = function (editor, tableElm, data) {\n      var dom = editor.dom;\n      var attrs = {};\n      var styles = {};\n      attrs.class = data.class;\n      styles.height = addPxSuffix(data.height);\n      if (dom.getAttrib(tableElm, 'width') && !shouldStyleWithCss(editor)) {\n        attrs.width = removePxSuffix(data.width);\n      } else {\n        styles.width = addPxSuffix(data.width);\n      }\n      if (shouldStyleWithCss(editor)) {\n        styles['border-width'] = addPxSuffix(data.border);\n        styles['border-spacing'] = addPxSuffix(data.cellspacing);\n      } else {\n        attrs.border = data.border;\n        attrs.cellpadding = data.cellpadding;\n        attrs.cellspacing = data.cellspacing;\n      }\n      if (shouldStyleWithCss(editor) && tableElm.children) {\n        for (var i = 0; i < tableElm.children.length; i++) {\n          styleTDTH(dom, tableElm.children[i], {\n            'border-width': addPxSuffix(data.border),\n            'padding': addPxSuffix(data.cellpadding)\n          });\n          if (hasAdvancedTableTab(editor)) {\n            styleTDTH(dom, tableElm.children[i], { 'border-color': data.bordercolor });\n          }\n        }\n      }\n      if (hasAdvancedTableTab(editor)) {\n        styles['background-color'] = data.backgroundcolor;\n        styles['border-color'] = data.bordercolor;\n        styles['border-style'] = data.borderstyle;\n      }\n      attrs.style = dom.serializeStyle(__assign(__assign({}, getDefaultStyles(editor)), styles));\n      dom.setAttribs(tableElm, __assign(__assign({}, getDefaultAttributes(editor)), attrs));\n    };\n    var onSubmitTableForm = function (editor, tableElm, oldData, api) {\n      var dom = editor.dom;\n      var captionElm;\n      var data = api.getData();\n      var modifiedData = filter$1(data, function (value, key) {\n        return oldData[key] !== value;\n      });\n      api.close();\n      if (data.class === '') {\n        delete data.class;\n      }\n      editor.undoManager.transact(function () {\n        if (!tableElm) {\n          var cols = parseInt(data.cols, 10) || 1;\n          var rows = parseInt(data.rows, 10) || 1;\n          tableElm = insert$1(editor, cols, rows, 0, 0);\n        }\n        if (size(modifiedData) > 0) {\n          applyDataToElement(editor, tableElm, data);\n          captionElm = dom.select('caption', tableElm)[0];\n          if (captionElm && !data.caption) {\n            dom.remove(captionElm);\n          }\n          if (!captionElm && data.caption) {\n            captionElm = dom.create('caption');\n            captionElm.innerHTML = !global$2.ie ? '<br data-mce-bogus=\"1\"/>' : nbsp;\n            tableElm.insertBefore(captionElm, tableElm.firstChild);\n          }\n          if (data.align === '') {\n            unApplyAlign(editor, tableElm);\n          } else {\n            applyAlign(editor, tableElm, data.align);\n          }\n        }\n        editor.focus();\n        editor.addVisual();\n        if (size(modifiedData) > 0) {\n          var captionModified = has(modifiedData, 'caption');\n          var styleModified = captionModified ? size(modifiedData) > 1 : true;\n          fireTableModified(editor, tableElm, {\n            structure: captionModified,\n            style: styleModified\n          });\n        }\n      });\n    };\n    var open$2 = function (editor, insertNewTable) {\n      var dom = editor.dom;\n      var tableElm;\n      var data = extractDataFromSettings(editor, hasAdvancedTableTab(editor));\n      if (insertNewTable === false) {\n        tableElm = dom.getParent(editor.selection.getStart(), 'table', editor.getBody());\n        if (tableElm) {\n          data = extractDataFromTableElement(editor, tableElm, hasAdvancedTableTab(editor));\n        } else {\n          if (hasAdvancedTableTab(editor)) {\n            data.borderstyle = '';\n            data.bordercolor = '';\n            data.backgroundcolor = '';\n          }\n        }\n      } else {\n        data.cols = '1';\n        data.rows = '1';\n        if (hasAdvancedTableTab(editor)) {\n          data.borderstyle = '';\n          data.bordercolor = '';\n          data.backgroundcolor = '';\n        }\n      }\n      var classes = buildListItems(getTableClassList(editor));\n      if (classes.length > 0) {\n        if (data.class) {\n          data.class = data.class.replace(/\\s*mce\\-item\\-table\\s*/g, '');\n        }\n      }\n      var generalPanel = {\n        type: 'grid',\n        columns: 2,\n        items: getItems$2(editor, classes, insertNewTable)\n      };\n      var nonAdvancedForm = function () {\n        return {\n          type: 'panel',\n          items: [generalPanel]\n        };\n      };\n      var advancedForm = function () {\n        return {\n          type: 'tabpanel',\n          tabs: [\n            {\n              title: 'General',\n              name: 'general',\n              items: [generalPanel]\n            },\n            getAdvancedTab('table')\n          ]\n        };\n      };\n      var dialogBody = hasAdvancedTableTab(editor) ? advancedForm() : nonAdvancedForm();\n      editor.windowManager.open({\n        title: 'Table Properties',\n        size: 'normal',\n        body: dialogBody,\n        onSubmit: curry(onSubmitTableForm, editor, tableElm, data),\n        buttons: [\n          {\n            type: 'cancel',\n            name: 'cancel',\n            text: 'Cancel'\n          },\n          {\n            type: 'submit',\n            name: 'save',\n            text: 'Save',\n            primary: true\n          }\n        ],\n        initialData: data\n      });\n    };\n\n    var getSelectionStartCellOrCaption$1 = function (editor) {\n      return getSelectionStartCellOrCaption(getSelectionStart(editor), getIsRoot(editor));\n    };\n    var getSelectionStartCell$1 = function (editor) {\n      return getSelectionStartCell(getSelectionStart(editor), getIsRoot(editor));\n    };\n    var registerCommands = function (editor, actions, cellSelection, selections, clipboard) {\n      var isRoot = getIsRoot(editor);\n      var eraseTable = function () {\n        return getSelectionStartCellOrCaption$1(editor).each(function (cellOrCaption) {\n          table(cellOrCaption, isRoot).filter(not(isRoot)).each(function (table) {\n            var cursor = SugarElement.fromText('');\n            after(table, cursor);\n            remove$2(table);\n            if (editor.dom.isEmpty(editor.getBody())) {\n              editor.setContent('');\n              editor.selection.setCursorLocation();\n            } else {\n              var rng = editor.dom.createRng();\n              rng.setStart(cursor.dom, 0);\n              rng.setEnd(cursor.dom, 0);\n              editor.selection.setRng(rng);\n              editor.nodeChanged();\n            }\n          });\n        });\n      };\n      var setSizingMode = function (sizing) {\n        return getSelectionStartCellOrCaption$1(editor).each(function (cellOrCaption) {\n          var isForcedSizing = isResponsiveForced(editor) || isPixelsForced(editor) || isPercentagesForced(editor);\n          if (!isForcedSizing) {\n            table(cellOrCaption, isRoot).each(function (table) {\n              if (sizing === 'relative' && !isPercentSizing$1(table)) {\n                enforcePercentage(editor, table);\n              } else if (sizing === 'fixed' && !isPixelSizing$1(table)) {\n                enforcePixels(editor, table);\n              } else if (sizing === 'responsive' && !isNoneSizing$1(table)) {\n                enforceNone(table);\n              }\n              removeDataStyle(table);\n              fireTableModified(editor, table.dom, structureModified);\n            });\n          }\n        });\n      };\n      var getTableFromCell = function (cell) {\n        return table(cell, isRoot);\n      };\n      var postExecute = function (table) {\n        return function (data) {\n          editor.selection.setRng(data.rng);\n          editor.focus();\n          cellSelection.clear(table);\n          removeDataStyle(table);\n          fireTableModified(editor, table.dom, data.effect);\n        };\n      };\n      var actOnSelection = function (execute) {\n        return getSelectionStartCell$1(editor).each(function (cell) {\n          getTableFromCell(cell).each(function (table) {\n            var targets = forMenu(selections, table, cell);\n            execute(table, targets).each(postExecute(table));\n          });\n        });\n      };\n      var copyRowSelection = function () {\n        return getSelectionStartCell$1(editor).map(function (cell) {\n          return getTableFromCell(cell).bind(function (table) {\n            var targets = forMenu(selections, table, cell);\n            var generators = cellOperations(noop, SugarElement.fromDom(editor.getDoc()), Optional.none());\n            return copyRows(table, targets, generators);\n          });\n        });\n      };\n      var copyColSelection = function () {\n        return getSelectionStartCell$1(editor).map(function (cell) {\n          return getTableFromCell(cell).bind(function (table) {\n            var targets = forMenu(selections, table, cell);\n            return copyCols(table, targets);\n          });\n        });\n      };\n      var pasteOnSelection = function (execute, getRows) {\n        return getRows().each(function (rows) {\n          var clonedRows = map(rows, function (row) {\n            return deep(row);\n          });\n          getSelectionStartCell$1(editor).each(function (cell) {\n            return getTableFromCell(cell).each(function (table) {\n              var generators = paste(SugarElement.fromDom(editor.getDoc()));\n              var targets = pasteRows(selections, cell, clonedRows, generators);\n              execute(table, targets).each(postExecute(table));\n            });\n          });\n        });\n      };\n      each$1({\n        mceTableSplitCells: function () {\n          return actOnSelection(actions.unmergeCells);\n        },\n        mceTableMergeCells: function () {\n          return actOnSelection(actions.mergeCells);\n        },\n        mceTableInsertRowBefore: function () {\n          return actOnSelection(actions.insertRowsBefore);\n        },\n        mceTableInsertRowAfter: function () {\n          return actOnSelection(actions.insertRowsAfter);\n        },\n        mceTableInsertColBefore: function () {\n          return actOnSelection(actions.insertColumnsBefore);\n        },\n        mceTableInsertColAfter: function () {\n          return actOnSelection(actions.insertColumnsAfter);\n        },\n        mceTableDeleteCol: function () {\n          return actOnSelection(actions.deleteColumn);\n        },\n        mceTableDeleteRow: function () {\n          return actOnSelection(actions.deleteRow);\n        },\n        mceTableCutCol: function (_grid) {\n          return copyColSelection().each(function (selection) {\n            clipboard.setColumns(selection);\n            actOnSelection(actions.deleteColumn);\n          });\n        },\n        mceTableCutRow: function (_grid) {\n          return copyRowSelection().each(function (selection) {\n            clipboard.setRows(selection);\n            actOnSelection(actions.deleteRow);\n          });\n        },\n        mceTableCopyCol: function (_grid) {\n          return copyColSelection().each(function (selection) {\n            return clipboard.setColumns(selection);\n          });\n        },\n        mceTableCopyRow: function (_grid) {\n          return copyRowSelection().each(function (selection) {\n            return clipboard.setRows(selection);\n          });\n        },\n        mceTablePasteColBefore: function (_grid) {\n          return pasteOnSelection(actions.pasteColsBefore, clipboard.getColumns);\n        },\n        mceTablePasteColAfter: function (_grid) {\n          return pasteOnSelection(actions.pasteColsAfter, clipboard.getColumns);\n        },\n        mceTablePasteRowBefore: function (_grid) {\n          return pasteOnSelection(actions.pasteRowsBefore, clipboard.getRows);\n        },\n        mceTablePasteRowAfter: function (_grid) {\n          return pasteOnSelection(actions.pasteRowsAfter, clipboard.getRows);\n        },\n        mceTableDelete: eraseTable,\n        mceTableSizingMode: function (ui, sizing) {\n          return setSizingMode(sizing);\n        }\n      }, function (func, name) {\n        return editor.addCommand(name, func);\n      });\n      var fireTableModifiedForSelection = function (editor, tableOpt) {\n        tableOpt.each(function (table) {\n          fireTableModified(editor, table.dom, structureModified);\n        });\n      };\n      each$1({\n        mceTableCellType: function (_ui, args) {\n          var tableOpt = table(getSelectionStart(editor), isRoot);\n          actions.setTableCellType(editor, args);\n          fireTableModifiedForSelection(editor, tableOpt);\n        },\n        mceTableRowType: function (_ui, args) {\n          var tableOpt = table(getSelectionStart(editor), isRoot);\n          actions.setTableRowType(editor, args);\n          fireTableModifiedForSelection(editor, tableOpt);\n        }\n      }, function (func, name) {\n        return editor.addCommand(name, func);\n      });\n      editor.addCommand('mceTableColType', function (_ui, args) {\n        return get$1(args, 'type').each(function (type) {\n          return actOnSelection(type === 'th' ? actions.makeColumnsHeader : actions.unmakeColumnsHeader);\n        });\n      });\n      each$1({\n        mceTableProps: curry(open$2, editor, false),\n        mceTableRowProps: curry(open$1, editor),\n        mceTableCellProps: curry(open, editor, selections)\n      }, function (func, name) {\n        return editor.addCommand(name, function () {\n          return func();\n        });\n      });\n      editor.addCommand('mceInsertTable', function (_ui, args) {\n        if (isObject(args) && keys(args).length > 0) {\n          insertTableWithDataValidation(editor, args.rows, args.columns, args.options, 'Invalid values for mceInsertTable - rows and columns values are required to insert a table.');\n        } else {\n          open$2(editor, true);\n        }\n      });\n      editor.addCommand('mceTableApplyCellStyle', function (_ui, args) {\n        var getFormatName = function (style) {\n          return 'tablecell' + style.toLowerCase().replace('-', '');\n        };\n        if (!isObject(args)) {\n          return;\n        }\n        var cells = getCellsFromSelection(getSelectionStart(editor), selections, isRoot);\n        if (cells.length === 0) {\n          return;\n        }\n        var validArgs = filter$1(args, function (value, style) {\n          return editor.formatter.has(getFormatName(style)) && isString(value);\n        });\n        if (isEmpty(validArgs)) {\n          return;\n        }\n        each$1(validArgs, function (value, style) {\n          each(cells, function (cell) {\n            DomModifier.normal(editor, cell.dom).setFormat(getFormatName(style), value);\n          });\n        });\n        getTableFromCell(cells[0]).each(function (table) {\n          return fireTableModified(editor, table.dom, styleModified);\n        });\n      });\n    };\n\n    var registerQueryCommands = function (editor, actions, selections) {\n      var isRoot = getIsRoot(editor);\n      var getTableFromCell = function (cell) {\n        return table(cell, isRoot);\n      };\n      each$1({\n        mceTableRowType: function () {\n          return actions.getTableRowType(editor);\n        },\n        mceTableCellType: function () {\n          return actions.getTableCellType(editor);\n        },\n        mceTableColType: function () {\n          return getSelectionStartCell(getSelectionStart(editor)).bind(function (cell) {\n            return getTableFromCell(cell).map(function (table) {\n              var targets = forMenu(selections, table, cell);\n              return actions.getTableColType(table, targets);\n            });\n          }).getOr('');\n        }\n      }, function (func, name) {\n        return editor.addQueryValueHandler(name, func);\n      });\n    };\n\n    var Clipboard = function () {\n      var rows = Cell(Optional.none());\n      var cols = Cell(Optional.none());\n      var clearClipboard = function (clipboard) {\n        clipboard.set(Optional.none());\n      };\n      return {\n        getRows: rows.get,\n        setRows: function (r) {\n          rows.set(r);\n          clearClipboard(cols);\n        },\n        clearRows: function () {\n          return clearClipboard(rows);\n        },\n        getColumns: cols.get,\n        setColumns: function (c) {\n          cols.set(c);\n          clearClipboard(rows);\n        },\n        clearColumns: function () {\n          return clearClipboard(cols);\n        }\n      };\n    };\n\n    var cellFormats = {\n      tablecellbackgroundcolor: {\n        selector: 'td,th',\n        styles: { backgroundColor: '%value' },\n        remove_similar: true\n      },\n      tablecellbordercolor: {\n        selector: 'td,th',\n        styles: { borderColor: '%value' },\n        remove_similar: true\n      },\n      tablecellborderstyle: {\n        selector: 'td,th',\n        styles: { borderStyle: '%value' },\n        remove_similar: true\n      },\n      tablecellborderwidth: {\n        selector: 'td,th',\n        styles: { borderWidth: '%value' },\n        remove_similar: true\n      }\n    };\n    var registerFormats = function (editor) {\n      editor.formatter.register(cellFormats);\n    };\n\n    var adt$2 = Adt.generate([\n      { none: ['current'] },\n      { first: ['current'] },\n      {\n        middle: [\n          'current',\n          'target'\n        ]\n      },\n      { last: ['current'] }\n    ]);\n    var none$2 = function (current) {\n      if (current === void 0) {\n        current = undefined;\n      }\n      return adt$2.none(current);\n    };\n    var CellLocation = __assign(__assign({}, adt$2), { none: none$2 });\n\n    var detect$5 = function (current, isRoot) {\n      return table(current, isRoot).bind(function (table) {\n        var all = cells(table);\n        var index = findIndex(all, function (x) {\n          return eq$1(current, x);\n        });\n        return index.map(function (index) {\n          return {\n            index: index,\n            all: all\n          };\n        });\n      });\n    };\n    var next = function (current, isRoot) {\n      var detection = detect$5(current, isRoot);\n      return detection.fold(function () {\n        return CellLocation.none(current);\n      }, function (info) {\n        return info.index + 1 < info.all.length ? CellLocation.middle(current, info.all[info.index + 1]) : CellLocation.last(current);\n      });\n    };\n    var prev = function (current, isRoot) {\n      var detection = detect$5(current, isRoot);\n      return detection.fold(function () {\n        return CellLocation.none();\n      }, function (info) {\n        return info.index - 1 >= 0 ? CellLocation.middle(current, info.all[info.index - 1]) : CellLocation.first(current);\n      });\n    };\n\n    var create$2 = function (start, soffset, finish, foffset) {\n      return {\n        start: start,\n        soffset: soffset,\n        finish: finish,\n        foffset: foffset\n      };\n    };\n    var SimRange = { create: create$2 };\n\n    var adt$3 = Adt.generate([\n      { before: ['element'] },\n      {\n        on: [\n          'element',\n          'offset'\n        ]\n      },\n      { after: ['element'] }\n    ]);\n    var cata$1 = function (subject, onBefore, onOn, onAfter) {\n      return subject.fold(onBefore, onOn, onAfter);\n    };\n    var getStart = function (situ) {\n      return situ.fold(identity, identity, identity);\n    };\n    var before$2 = adt$3.before;\n    var on = adt$3.on;\n    var after$2 = adt$3.after;\n    var Situ = {\n      before: before$2,\n      on: on,\n      after: after$2,\n      cata: cata$1,\n      getStart: getStart\n    };\n\n    var adt$4 = Adt.generate([\n      { domRange: ['rng'] },\n      {\n        relative: [\n          'startSitu',\n          'finishSitu'\n        ]\n      },\n      {\n        exact: [\n          'start',\n          'soffset',\n          'finish',\n          'foffset'\n        ]\n      }\n    ]);\n    var exactFromRange = function (simRange) {\n      return adt$4.exact(simRange.start, simRange.soffset, simRange.finish, simRange.foffset);\n    };\n    var getStart$1 = function (selection) {\n      return selection.match({\n        domRange: function (rng) {\n          return SugarElement.fromDom(rng.startContainer);\n        },\n        relative: function (startSitu, _finishSitu) {\n          return Situ.getStart(startSitu);\n        },\n        exact: function (start, _soffset, _finish, _foffset) {\n          return start;\n        }\n      });\n    };\n    var domRange = adt$4.domRange;\n    var relative = adt$4.relative;\n    var exact = adt$4.exact;\n    var getWin = function (selection) {\n      var start = getStart$1(selection);\n      return defaultView(start);\n    };\n    var range$1 = SimRange.create;\n    var SimSelection = {\n      domRange: domRange,\n      relative: relative,\n      exact: exact,\n      exactFromRange: exactFromRange,\n      getWin: getWin,\n      range: range$1\n    };\n\n    var selectNodeContents = function (win, element) {\n      var rng = win.document.createRange();\n      selectNodeContentsUsing(rng, element);\n      return rng;\n    };\n    var selectNodeContentsUsing = function (rng, element) {\n      return rng.selectNodeContents(element.dom);\n    };\n    var setStart = function (rng, situ) {\n      situ.fold(function (e) {\n        rng.setStartBefore(e.dom);\n      }, function (e, o) {\n        rng.setStart(e.dom, o);\n      }, function (e) {\n        rng.setStartAfter(e.dom);\n      });\n    };\n    var setFinish = function (rng, situ) {\n      situ.fold(function (e) {\n        rng.setEndBefore(e.dom);\n      }, function (e, o) {\n        rng.setEnd(e.dom, o);\n      }, function (e) {\n        rng.setEndAfter(e.dom);\n      });\n    };\n    var relativeToNative = function (win, startSitu, finishSitu) {\n      var range = win.document.createRange();\n      setStart(range, startSitu);\n      setFinish(range, finishSitu);\n      return range;\n    };\n    var exactToNative = function (win, start, soffset, finish, foffset) {\n      var rng = win.document.createRange();\n      rng.setStart(start.dom, soffset);\n      rng.setEnd(finish.dom, foffset);\n      return rng;\n    };\n    var toRect = function (rect) {\n      return {\n        left: rect.left,\n        top: rect.top,\n        right: rect.right,\n        bottom: rect.bottom,\n        width: rect.width,\n        height: rect.height\n      };\n    };\n    var getFirstRect = function (rng) {\n      var rects = rng.getClientRects();\n      var rect = rects.length > 0 ? rects[0] : rng.getBoundingClientRect();\n      return rect.width > 0 || rect.height > 0 ? Optional.some(rect).map(toRect) : Optional.none();\n    };\n\n    var adt$5 = Adt.generate([\n      {\n        ltr: [\n          'start',\n          'soffset',\n          'finish',\n          'foffset'\n        ]\n      },\n      {\n        rtl: [\n          'start',\n          'soffset',\n          'finish',\n          'foffset'\n        ]\n      }\n    ]);\n    var fromRange = function (win, type, range) {\n      return type(SugarElement.fromDom(range.startContainer), range.startOffset, SugarElement.fromDom(range.endContainer), range.endOffset);\n    };\n    var getRanges = function (win, selection) {\n      return selection.match({\n        domRange: function (rng) {\n          return {\n            ltr: constant(rng),\n            rtl: Optional.none\n          };\n        },\n        relative: function (startSitu, finishSitu) {\n          return {\n            ltr: cached(function () {\n              return relativeToNative(win, startSitu, finishSitu);\n            }),\n            rtl: cached(function () {\n              return Optional.some(relativeToNative(win, finishSitu, startSitu));\n            })\n          };\n        },\n        exact: function (start, soffset, finish, foffset) {\n          return {\n            ltr: cached(function () {\n              return exactToNative(win, start, soffset, finish, foffset);\n            }),\n            rtl: cached(function () {\n              return Optional.some(exactToNative(win, finish, foffset, start, soffset));\n            })\n          };\n        }\n      });\n    };\n    var doDiagnose = function (win, ranges) {\n      var rng = ranges.ltr();\n      if (rng.collapsed) {\n        var reversed = ranges.rtl().filter(function (rev) {\n          return rev.collapsed === false;\n        });\n        return reversed.map(function (rev) {\n          return adt$5.rtl(SugarElement.fromDom(rev.endContainer), rev.endOffset, SugarElement.fromDom(rev.startContainer), rev.startOffset);\n        }).getOrThunk(function () {\n          return fromRange(win, adt$5.ltr, rng);\n        });\n      } else {\n        return fromRange(win, adt$5.ltr, rng);\n      }\n    };\n    var diagnose = function (win, selection) {\n      var ranges = getRanges(win, selection);\n      return doDiagnose(win, ranges);\n    };\n    var asLtrRange = function (win, selection) {\n      var diagnosis = diagnose(win, selection);\n      return diagnosis.match({\n        ltr: function (start, soffset, finish, foffset) {\n          var rng = win.document.createRange();\n          rng.setStart(start.dom, soffset);\n          rng.setEnd(finish.dom, foffset);\n          return rng;\n        },\n        rtl: function (start, soffset, finish, foffset) {\n          var rng = win.document.createRange();\n          rng.setStart(finish.dom, foffset);\n          rng.setEnd(start.dom, soffset);\n          return rng;\n        }\n      });\n    };\n    var ltr$1 = adt$5.ltr;\n    var rtl$1 = adt$5.rtl;\n\n    var searchForPoint = function (rectForOffset, x, y, maxX, length) {\n      if (length === 0) {\n        return 0;\n      } else if (x === maxX) {\n        return length - 1;\n      }\n      var xDelta = maxX;\n      for (var i = 1; i < length; i++) {\n        var rect = rectForOffset(i);\n        var curDeltaX = Math.abs(x - rect.left);\n        if (y <= rect.bottom) {\n          if (y < rect.top || curDeltaX > xDelta) {\n            return i - 1;\n          } else {\n            xDelta = curDeltaX;\n          }\n        }\n      }\n      return 0;\n    };\n    var inRect = function (rect, x, y) {\n      return x >= rect.left && x <= rect.right && y >= rect.top && y <= rect.bottom;\n    };\n\n    var locateOffset = function (doc, textnode, x, y, rect) {\n      var rangeForOffset = function (o) {\n        var r = doc.dom.createRange();\n        r.setStart(textnode.dom, o);\n        r.collapse(true);\n        return r;\n      };\n      var rectForOffset = function (o) {\n        var r = rangeForOffset(o);\n        return r.getBoundingClientRect();\n      };\n      var length = get$4(textnode).length;\n      var offset = searchForPoint(rectForOffset, x, y, rect.right, length);\n      return rangeForOffset(offset);\n    };\n    var locate = function (doc, node, x, y) {\n      var r = doc.dom.createRange();\n      r.selectNode(node.dom);\n      var rects = r.getClientRects();\n      var foundRect = findMap(rects, function (rect) {\n        return inRect(rect, x, y) ? Optional.some(rect) : Optional.none();\n      });\n      return foundRect.map(function (rect) {\n        return locateOffset(doc, node, x, y, rect);\n      });\n    };\n\n    var searchInChildren = function (doc, node, x, y) {\n      var r = doc.dom.createRange();\n      var nodes = children(node);\n      return findMap(nodes, function (n) {\n        r.selectNode(n.dom);\n        return inRect(r.getBoundingClientRect(), x, y) ? locateNode(doc, n, x, y) : Optional.none();\n      });\n    };\n    var locateNode = function (doc, node, x, y) {\n      return isText(node) ? locate(doc, node, x, y) : searchInChildren(doc, node, x, y);\n    };\n    var locate$1 = function (doc, node, x, y) {\n      var r = doc.dom.createRange();\n      r.selectNode(node.dom);\n      var rect = r.getBoundingClientRect();\n      var boundedX = Math.max(rect.left, Math.min(rect.right, x));\n      var boundedY = Math.max(rect.top, Math.min(rect.bottom, y));\n      return locateNode(doc, node, boundedX, boundedY);\n    };\n\n    var COLLAPSE_TO_LEFT = true;\n    var COLLAPSE_TO_RIGHT = false;\n    var getCollapseDirection = function (rect, x) {\n      return x - rect.left < rect.right - x ? COLLAPSE_TO_LEFT : COLLAPSE_TO_RIGHT;\n    };\n    var createCollapsedNode = function (doc, target, collapseDirection) {\n      var r = doc.dom.createRange();\n      r.selectNode(target.dom);\n      r.collapse(collapseDirection);\n      return r;\n    };\n    var locateInElement = function (doc, node, x) {\n      var cursorRange = doc.dom.createRange();\n      cursorRange.selectNode(node.dom);\n      var rect = cursorRange.getBoundingClientRect();\n      var collapseDirection = getCollapseDirection(rect, x);\n      var f = collapseDirection === COLLAPSE_TO_LEFT ? first : last$1;\n      return f(node).map(function (target) {\n        return createCollapsedNode(doc, target, collapseDirection);\n      });\n    };\n    var locateInEmpty = function (doc, node, x) {\n      var rect = node.dom.getBoundingClientRect();\n      var collapseDirection = getCollapseDirection(rect, x);\n      return Optional.some(createCollapsedNode(doc, node, collapseDirection));\n    };\n    var search = function (doc, node, x) {\n      var f = children(node).length === 0 ? locateInEmpty : locateInElement;\n      return f(doc, node, x);\n    };\n\n    var caretPositionFromPoint = function (doc, x, y) {\n      return Optional.from(doc.dom.caretPositionFromPoint(x, y)).bind(function (pos) {\n        if (pos.offsetNode === null) {\n          return Optional.none();\n        }\n        var r = doc.dom.createRange();\n        r.setStart(pos.offsetNode, pos.offset);\n        r.collapse();\n        return Optional.some(r);\n      });\n    };\n    var caretRangeFromPoint = function (doc, x, y) {\n      return Optional.from(doc.dom.caretRangeFromPoint(x, y));\n    };\n    var searchTextNodes = function (doc, node, x, y) {\n      var r = doc.dom.createRange();\n      r.selectNode(node.dom);\n      var rect = r.getBoundingClientRect();\n      var boundedX = Math.max(rect.left, Math.min(rect.right, x));\n      var boundedY = Math.max(rect.top, Math.min(rect.bottom, y));\n      return locate$1(doc, node, boundedX, boundedY);\n    };\n    var searchFromPoint = function (doc, x, y) {\n      return SugarElement.fromPoint(doc, x, y).bind(function (elem) {\n        var fallback = function () {\n          return search(doc, elem, x);\n        };\n        return children(elem).length === 0 ? fallback() : searchTextNodes(doc, elem, x, y).orThunk(fallback);\n      });\n    };\n    var availableSearch = function () {\n      if (document.caretPositionFromPoint) {\n        return caretPositionFromPoint;\n      } else if (document.caretRangeFromPoint) {\n        return caretRangeFromPoint;\n      } else {\n        return searchFromPoint;\n      }\n    }();\n    var fromPoint$1 = function (win, x, y) {\n      var doc = SugarElement.fromDom(win.document);\n      return availableSearch(doc, x, y).map(function (rng) {\n        return SimRange.create(SugarElement.fromDom(rng.startContainer), rng.startOffset, SugarElement.fromDom(rng.endContainer), rng.endOffset);\n      });\n    };\n\n    var beforeSpecial = function (element, offset) {\n      var name$1 = name(element);\n      if ('input' === name$1) {\n        return Situ.after(element);\n      } else if (!contains([\n          'br',\n          'img'\n        ], name$1)) {\n        return Situ.on(element, offset);\n      } else {\n        return offset === 0 ? Situ.before(element) : Situ.after(element);\n      }\n    };\n    var preprocessRelative = function (startSitu, finishSitu) {\n      var start = startSitu.fold(Situ.before, beforeSpecial, Situ.after);\n      var finish = finishSitu.fold(Situ.before, beforeSpecial, Situ.after);\n      return SimSelection.relative(start, finish);\n    };\n    var preprocessExact = function (start, soffset, finish, foffset) {\n      var startSitu = beforeSpecial(start, soffset);\n      var finishSitu = beforeSpecial(finish, foffset);\n      return SimSelection.relative(startSitu, finishSitu);\n    };\n    var preprocess = function (selection) {\n      return selection.match({\n        domRange: function (rng) {\n          var start = SugarElement.fromDom(rng.startContainer);\n          var finish = SugarElement.fromDom(rng.endContainer);\n          return preprocessExact(start, rng.startOffset, finish, rng.endOffset);\n        },\n        relative: preprocessRelative,\n        exact: preprocessExact\n      });\n    };\n\n    var makeRange = function (start, soffset, finish, foffset) {\n      var doc = owner(start);\n      var rng = doc.dom.createRange();\n      rng.setStart(start.dom, soffset);\n      rng.setEnd(finish.dom, foffset);\n      return rng;\n    };\n    var after$3 = function (start, soffset, finish, foffset) {\n      var r = makeRange(start, soffset, finish, foffset);\n      var same = eq$1(start, finish) && soffset === foffset;\n      return r.collapsed && !same;\n    };\n\n    var getNativeSelection = function (win) {\n      return Optional.from(win.getSelection());\n    };\n    var doSetNativeRange = function (win, rng) {\n      getNativeSelection(win).each(function (selection) {\n        selection.removeAllRanges();\n        selection.addRange(rng);\n      });\n    };\n    var doSetRange = function (win, start, soffset, finish, foffset) {\n      var rng = exactToNative(win, start, soffset, finish, foffset);\n      doSetNativeRange(win, rng);\n    };\n    var setLegacyRtlRange = function (win, selection, start, soffset, finish, foffset) {\n      selection.collapse(start.dom, soffset);\n      selection.extend(finish.dom, foffset);\n    };\n    var setRangeFromRelative = function (win, relative) {\n      return diagnose(win, relative).match({\n        ltr: function (start, soffset, finish, foffset) {\n          doSetRange(win, start, soffset, finish, foffset);\n        },\n        rtl: function (start, soffset, finish, foffset) {\n          getNativeSelection(win).each(function (selection) {\n            if (selection.setBaseAndExtent) {\n              selection.setBaseAndExtent(start.dom, soffset, finish.dom, foffset);\n            } else if (selection.extend) {\n              try {\n                setLegacyRtlRange(win, selection, start, soffset, finish, foffset);\n              } catch (e) {\n                doSetRange(win, finish, foffset, start, soffset);\n              }\n            } else {\n              doSetRange(win, finish, foffset, start, soffset);\n            }\n          });\n        }\n      });\n    };\n    var setExact = function (win, start, soffset, finish, foffset) {\n      var relative = preprocessExact(start, soffset, finish, foffset);\n      setRangeFromRelative(win, relative);\n    };\n    var setRelative = function (win, startSitu, finishSitu) {\n      var relative = preprocessRelative(startSitu, finishSitu);\n      setRangeFromRelative(win, relative);\n    };\n    var toNative = function (selection) {\n      var win = SimSelection.getWin(selection).dom;\n      var getDomRange = function (start, soffset, finish, foffset) {\n        return exactToNative(win, start, soffset, finish, foffset);\n      };\n      var filtered = preprocess(selection);\n      return diagnose(win, filtered).match({\n        ltr: getDomRange,\n        rtl: getDomRange\n      });\n    };\n    var readRange = function (selection) {\n      if (selection.rangeCount > 0) {\n        var firstRng = selection.getRangeAt(0);\n        var lastRng = selection.getRangeAt(selection.rangeCount - 1);\n        return Optional.some(SimRange.create(SugarElement.fromDom(firstRng.startContainer), firstRng.startOffset, SugarElement.fromDom(lastRng.endContainer), lastRng.endOffset));\n      } else {\n        return Optional.none();\n      }\n    };\n    var doGetExact = function (selection) {\n      if (selection.anchorNode === null || selection.focusNode === null) {\n        return readRange(selection);\n      } else {\n        var anchor = SugarElement.fromDom(selection.anchorNode);\n        var focus_1 = SugarElement.fromDom(selection.focusNode);\n        return after$3(anchor, selection.anchorOffset, focus_1, selection.focusOffset) ? Optional.some(SimRange.create(anchor, selection.anchorOffset, focus_1, selection.focusOffset)) : readRange(selection);\n      }\n    };\n    var setToElement = function (win, element) {\n      var rng = selectNodeContents(win, element);\n      doSetNativeRange(win, rng);\n    };\n    var getExact = function (win) {\n      return getNativeSelection(win).filter(function (sel) {\n        return sel.rangeCount > 0;\n      }).bind(doGetExact);\n    };\n    var get$c = function (win) {\n      return getExact(win).map(function (range) {\n        return SimSelection.exact(range.start, range.soffset, range.finish, range.foffset);\n      });\n    };\n    var getFirstRect$1 = function (win, selection) {\n      var rng = asLtrRange(win, selection);\n      return getFirstRect(rng);\n    };\n    var getAtPoint = function (win, x, y) {\n      return fromPoint$1(win, x, y);\n    };\n    var clear = function (win) {\n      getNativeSelection(win).each(function (selection) {\n        return selection.removeAllRanges();\n      });\n    };\n\n    var global$3 = tinymce.util.Tools.resolve('tinymce.util.VK');\n\n    var forward = function (editor, isRoot, cell) {\n      return go(editor, isRoot, next(cell));\n    };\n    var backward = function (editor, isRoot, cell) {\n      return go(editor, isRoot, prev(cell));\n    };\n    var getCellFirstCursorPosition = function (editor, cell) {\n      var selection = SimSelection.exact(cell, 0, cell, 0);\n      return toNative(selection);\n    };\n    var getNewRowCursorPosition = function (editor, table) {\n      var rows = descendants$1(table, 'tr');\n      return last(rows).bind(function (last) {\n        return descendant$1(last, 'td,th').map(function (first) {\n          return getCellFirstCursorPosition(editor, first);\n        });\n      });\n    };\n    var go = function (editor, isRoot, cell) {\n      return cell.fold(Optional.none, Optional.none, function (current, next) {\n        return first(next).map(function (cell) {\n          return getCellFirstCursorPosition(editor, cell);\n        });\n      }, function (current) {\n        return table(current, isRoot).bind(function (table) {\n          editor.execCommand('mceTableInsertRowAfter');\n          return getNewRowCursorPosition(editor, table);\n        });\n      });\n    };\n    var rootElements = [\n      'table',\n      'li',\n      'dl'\n    ];\n    var handle$1 = function (event, editor, cellSelection) {\n      if (event.keyCode === global$3.TAB) {\n        var body_1 = getBody$1(editor);\n        var isRoot_1 = function (element) {\n          var name$1 = name(element);\n          return eq$1(element, body_1) || contains(rootElements, name$1);\n        };\n        var rng = editor.selection.getRng();\n        var container = SugarElement.fromDom(event.shiftKey ? rng.startContainer : rng.endContainer);\n        cell(container, isRoot_1).each(function (cell) {\n          event.preventDefault();\n          table(cell, isRoot_1).each(cellSelection.clear);\n          editor.selection.collapse(event.shiftKey);\n          var navigation = event.shiftKey ? backward : forward;\n          var rng = navigation(editor, isRoot_1, cell);\n          rng.each(function (range) {\n            editor.selection.setRng(range);\n          });\n        });\n      }\n    };\n\n    var create$3 = function (selection, kill) {\n      return {\n        selection: selection,\n        kill: kill\n      };\n    };\n    var Response = { create: create$3 };\n\n    var create$4 = function (start, soffset, finish, foffset) {\n      return {\n        start: Situ.on(start, soffset),\n        finish: Situ.on(finish, foffset)\n      };\n    };\n    var Situs = { create: create$4 };\n\n    var convertToRange = function (win, selection) {\n      var rng = asLtrRange(win, selection);\n      return SimRange.create(SugarElement.fromDom(rng.startContainer), rng.startOffset, SugarElement.fromDom(rng.endContainer), rng.endOffset);\n    };\n    var makeSitus = Situs.create;\n\n    var sync = function (container, isRoot, start, soffset, finish, foffset, selectRange) {\n      if (!(eq$1(start, finish) && soffset === foffset)) {\n        return closest$1(start, 'td,th', isRoot).bind(function (s) {\n          return closest$1(finish, 'td,th', isRoot).bind(function (f) {\n            return detect$6(container, isRoot, s, f, selectRange);\n          });\n        });\n      } else {\n        return Optional.none();\n      }\n    };\n    var detect$6 = function (container, isRoot, start, finish, selectRange) {\n      if (!eq$1(start, finish)) {\n        return identify(start, finish, isRoot).bind(function (cellSel) {\n          var boxes = cellSel.boxes.getOr([]);\n          if (boxes.length > 0) {\n            selectRange(container, boxes, cellSel.start, cellSel.finish);\n            return Optional.some(Response.create(Optional.some(makeSitus(start, 0, start, getEnd(start))), true));\n          } else {\n            return Optional.none();\n          }\n        });\n      } else {\n        return Optional.none();\n      }\n    };\n    var update = function (rows, columns, container, selected, annotations) {\n      var updateSelection = function (newSels) {\n        annotations.clearBeforeUpdate(container);\n        annotations.selectRange(container, newSels.boxes, newSels.start, newSels.finish);\n        return newSels.boxes;\n      };\n      return shiftSelection(selected, rows, columns, annotations.firstSelectedSelector, annotations.lastSelectedSelector).map(updateSelection);\n    };\n\n    var traverse = function (item, mode) {\n      return {\n        item: item,\n        mode: mode\n      };\n    };\n    var backtrack = function (universe, item, _direction, transition) {\n      if (transition === void 0) {\n        transition = sidestep;\n      }\n      return universe.property().parent(item).map(function (p) {\n        return traverse(p, transition);\n      });\n    };\n    var sidestep = function (universe, item, direction, transition) {\n      if (transition === void 0) {\n        transition = advance;\n      }\n      return direction.sibling(universe, item).map(function (p) {\n        return traverse(p, transition);\n      });\n    };\n    var advance = function (universe, item, direction, transition) {\n      if (transition === void 0) {\n        transition = advance;\n      }\n      var children = universe.property().children(item);\n      var result = direction.first(children);\n      return result.map(function (r) {\n        return traverse(r, transition);\n      });\n    };\n    var successors = [\n      {\n        current: backtrack,\n        next: sidestep,\n        fallback: Optional.none()\n      },\n      {\n        current: sidestep,\n        next: advance,\n        fallback: Optional.some(backtrack)\n      },\n      {\n        current: advance,\n        next: advance,\n        fallback: Optional.some(sidestep)\n      }\n    ];\n    var go$1 = function (universe, item, mode, direction, rules) {\n      if (rules === void 0) {\n        rules = successors;\n      }\n      var ruleOpt = find(rules, function (succ) {\n        return succ.current === mode;\n      });\n      return ruleOpt.bind(function (rule) {\n        return rule.current(universe, item, direction, rule.next).orThunk(function () {\n          return rule.fallback.bind(function (fb) {\n            return go$1(universe, item, fb, direction);\n          });\n        });\n      });\n    };\n\n    var left = function () {\n      var sibling = function (universe, item) {\n        return universe.query().prevSibling(item);\n      };\n      var first = function (children) {\n        return children.length > 0 ? Optional.some(children[children.length - 1]) : Optional.none();\n      };\n      return {\n        sibling: sibling,\n        first: first\n      };\n    };\n    var right = function () {\n      var sibling = function (universe, item) {\n        return universe.query().nextSibling(item);\n      };\n      var first = function (children) {\n        return children.length > 0 ? Optional.some(children[0]) : Optional.none();\n      };\n      return {\n        sibling: sibling,\n        first: first\n      };\n    };\n    var Walkers = {\n      left: left,\n      right: right\n    };\n\n    var hone = function (universe, item, predicate, mode, direction, isRoot) {\n      var next = go$1(universe, item, mode, direction);\n      return next.bind(function (n) {\n        if (isRoot(n.item)) {\n          return Optional.none();\n        } else {\n          return predicate(n.item) ? Optional.some(n.item) : hone(universe, n.item, predicate, n.mode, direction, isRoot);\n        }\n      });\n    };\n    var left$1 = function (universe, item, predicate, isRoot) {\n      return hone(universe, item, predicate, sidestep, Walkers.left(), isRoot);\n    };\n    var right$1 = function (universe, item, predicate, isRoot) {\n      return hone(universe, item, predicate, sidestep, Walkers.right(), isRoot);\n    };\n\n    var isLeaf = function (universe) {\n      return function (element) {\n        return universe.property().children(element).length === 0;\n      };\n    };\n    var before$3 = function (universe, item, isRoot) {\n      return seekLeft(universe, item, isLeaf(universe), isRoot);\n    };\n    var after$4 = function (universe, item, isRoot) {\n      return seekRight(universe, item, isLeaf(universe), isRoot);\n    };\n    var seekLeft = left$1;\n    var seekRight = right$1;\n\n    var universe$3 = DomUniverse();\n    var before$4 = function (element, isRoot) {\n      return before$3(universe$3, element, isRoot);\n    };\n    var after$5 = function (element, isRoot) {\n      return after$4(universe$3, element, isRoot);\n    };\n    var seekLeft$1 = function (element, predicate, isRoot) {\n      return seekLeft(universe$3, element, predicate, isRoot);\n    };\n    var seekRight$1 = function (element, predicate, isRoot) {\n      return seekRight(universe$3, element, predicate, isRoot);\n    };\n\n    var ancestor$2 = function (scope, predicate, isRoot) {\n      return ancestor(scope, predicate, isRoot).isSome();\n    };\n\n    var adt$6 = Adt.generate([\n      { none: ['message'] },\n      { success: [] },\n      { failedUp: ['cell'] },\n      { failedDown: ['cell'] }\n    ]);\n    var isOverlapping = function (bridge, before, after) {\n      var beforeBounds = bridge.getRect(before);\n      var afterBounds = bridge.getRect(after);\n      return afterBounds.right > beforeBounds.left && afterBounds.left < beforeBounds.right;\n    };\n    var isRow = function (elem) {\n      return closest$1(elem, 'tr');\n    };\n    var verify = function (bridge, before, beforeOffset, after, afterOffset, failure, isRoot) {\n      return closest$1(after, 'td,th', isRoot).bind(function (afterCell) {\n        return closest$1(before, 'td,th', isRoot).map(function (beforeCell) {\n          if (!eq$1(afterCell, beforeCell)) {\n            return sharedOne$1(isRow, [\n              afterCell,\n              beforeCell\n            ]).fold(function () {\n              return isOverlapping(bridge, beforeCell, afterCell) ? adt$6.success() : failure(beforeCell);\n            }, function (_sharedRow) {\n              return failure(beforeCell);\n            });\n          } else {\n            return eq$1(after, afterCell) && getEnd(afterCell) === afterOffset ? failure(beforeCell) : adt$6.none('in same cell');\n          }\n        });\n      }).getOr(adt$6.none('default'));\n    };\n    var cata$2 = function (subject, onNone, onSuccess, onFailedUp, onFailedDown) {\n      return subject.fold(onNone, onSuccess, onFailedUp, onFailedDown);\n    };\n    var BeforeAfter = __assign(__assign({}, adt$6), {\n      verify: verify,\n      cata: cata$2\n    });\n\n    var inParent = function (parent, children, element, index) {\n      return {\n        parent: parent,\n        children: children,\n        element: element,\n        index: index\n      };\n    };\n    var indexInParent = function (element) {\n      return parent(element).bind(function (parent) {\n        var children$1 = children(parent);\n        return indexOf(children$1, element).map(function (index) {\n          return inParent(parent, children$1, element, index);\n        });\n      });\n    };\n    var indexOf = function (elements, element) {\n      return findIndex(elements, curry(eq$1, element));\n    };\n\n    var isBr = function (elem) {\n      return name(elem) === 'br';\n    };\n    var gatherer = function (cand, gather, isRoot) {\n      return gather(cand, isRoot).bind(function (target) {\n        return isText(target) && get$4(target).trim().length === 0 ? gatherer(target, gather, isRoot) : Optional.some(target);\n      });\n    };\n    var handleBr = function (isRoot, element, direction) {\n      return direction.traverse(element).orThunk(function () {\n        return gatherer(element, direction.gather, isRoot);\n      }).map(direction.relative);\n    };\n    var findBr = function (element, offset) {\n      return child(element, offset).filter(isBr).orThunk(function () {\n        return child(element, offset - 1).filter(isBr);\n      });\n    };\n    var handleParent = function (isRoot, element, offset, direction) {\n      return findBr(element, offset).bind(function (br) {\n        return direction.traverse(br).fold(function () {\n          return gatherer(br, direction.gather, isRoot).map(direction.relative);\n        }, function (adjacent) {\n          return indexInParent(adjacent).map(function (info) {\n            return Situ.on(info.parent, info.index);\n          });\n        });\n      });\n    };\n    var tryBr = function (isRoot, element, offset, direction) {\n      var target = isBr(element) ? handleBr(isRoot, element, direction) : handleParent(isRoot, element, offset, direction);\n      return target.map(function (tgt) {\n        return {\n          start: tgt,\n          finish: tgt\n        };\n      });\n    };\n    var process = function (analysis) {\n      return BeforeAfter.cata(analysis, function (_message) {\n        return Optional.none();\n      }, function () {\n        return Optional.none();\n      }, function (cell) {\n        return Optional.some(point(cell, 0));\n      }, function (cell) {\n        return Optional.some(point(cell, getEnd(cell)));\n      });\n    };\n\n    var moveDown = function (caret, amount) {\n      return {\n        left: caret.left,\n        top: caret.top + amount,\n        right: caret.right,\n        bottom: caret.bottom + amount\n      };\n    };\n    var moveUp = function (caret, amount) {\n      return {\n        left: caret.left,\n        top: caret.top - amount,\n        right: caret.right,\n        bottom: caret.bottom - amount\n      };\n    };\n    var translate = function (caret, xDelta, yDelta) {\n      return {\n        left: caret.left + xDelta,\n        top: caret.top + yDelta,\n        right: caret.right + xDelta,\n        bottom: caret.bottom + yDelta\n      };\n    };\n    var getTop$1 = function (caret) {\n      return caret.top;\n    };\n    var getBottom = function (caret) {\n      return caret.bottom;\n    };\n\n    var getPartialBox = function (bridge, element, offset) {\n      if (offset >= 0 && offset < getEnd(element)) {\n        return bridge.getRangedRect(element, offset, element, offset + 1);\n      } else if (offset > 0) {\n        return bridge.getRangedRect(element, offset - 1, element, offset);\n      }\n      return Optional.none();\n    };\n    var toCaret = function (rect) {\n      return {\n        left: rect.left,\n        top: rect.top,\n        right: rect.right,\n        bottom: rect.bottom\n      };\n    };\n    var getElemBox = function (bridge, element) {\n      return Optional.some(bridge.getRect(element));\n    };\n    var getBoxAt = function (bridge, element, offset) {\n      if (isElement(element)) {\n        return getElemBox(bridge, element).map(toCaret);\n      } else if (isText(element)) {\n        return getPartialBox(bridge, element, offset).map(toCaret);\n      } else {\n        return Optional.none();\n      }\n    };\n    var getEntireBox = function (bridge, element) {\n      if (isElement(element)) {\n        return getElemBox(bridge, element).map(toCaret);\n      } else if (isText(element)) {\n        return bridge.getRangedRect(element, 0, element, getEnd(element)).map(toCaret);\n      } else {\n        return Optional.none();\n      }\n    };\n\n    var JUMP_SIZE = 5;\n    var NUM_RETRIES = 100;\n    var adt$7 = Adt.generate([\n      { none: [] },\n      { retry: ['caret'] }\n    ]);\n    var isOutside = function (caret, box) {\n      return caret.left < box.left || Math.abs(box.right - caret.left) < 1 || caret.left > box.right;\n    };\n    var inOutsideBlock = function (bridge, element, caret) {\n      return closest(element, isBlock$1).fold(never, function (cell) {\n        return getEntireBox(bridge, cell).exists(function (box) {\n          return isOutside(caret, box);\n        });\n      });\n    };\n    var adjustDown = function (bridge, element, guessBox, original, caret) {\n      var lowerCaret = moveDown(caret, JUMP_SIZE);\n      if (Math.abs(guessBox.bottom - original.bottom) < 1) {\n        return adt$7.retry(lowerCaret);\n      } else if (guessBox.top > caret.bottom) {\n        return adt$7.retry(lowerCaret);\n      } else if (guessBox.top === caret.bottom) {\n        return adt$7.retry(moveDown(caret, 1));\n      } else {\n        return inOutsideBlock(bridge, element, caret) ? adt$7.retry(translate(lowerCaret, JUMP_SIZE, 0)) : adt$7.none();\n      }\n    };\n    var adjustUp = function (bridge, element, guessBox, original, caret) {\n      var higherCaret = moveUp(caret, JUMP_SIZE);\n      if (Math.abs(guessBox.top - original.top) < 1) {\n        return adt$7.retry(higherCaret);\n      } else if (guessBox.bottom < caret.top) {\n        return adt$7.retry(higherCaret);\n      } else if (guessBox.bottom === caret.top) {\n        return adt$7.retry(moveUp(caret, 1));\n      } else {\n        return inOutsideBlock(bridge, element, caret) ? adt$7.retry(translate(higherCaret, JUMP_SIZE, 0)) : adt$7.none();\n      }\n    };\n    var upMovement = {\n      point: getTop$1,\n      adjuster: adjustUp,\n      move: moveUp,\n      gather: before$4\n    };\n    var downMovement = {\n      point: getBottom,\n      adjuster: adjustDown,\n      move: moveDown,\n      gather: after$5\n    };\n    var isAtTable = function (bridge, x, y) {\n      return bridge.elementFromPoint(x, y).filter(function (elm) {\n        return name(elm) === 'table';\n      }).isSome();\n    };\n    var adjustForTable = function (bridge, movement, original, caret, numRetries) {\n      return adjustTil(bridge, movement, original, movement.move(caret, JUMP_SIZE), numRetries);\n    };\n    var adjustTil = function (bridge, movement, original, caret, numRetries) {\n      if (numRetries === 0) {\n        return Optional.some(caret);\n      }\n      if (isAtTable(bridge, caret.left, movement.point(caret))) {\n        return adjustForTable(bridge, movement, original, caret, numRetries - 1);\n      }\n      return bridge.situsFromPoint(caret.left, movement.point(caret)).bind(function (guess) {\n        return guess.start.fold(Optional.none, function (element) {\n          return getEntireBox(bridge, element).bind(function (guessBox) {\n            return movement.adjuster(bridge, element, guessBox, original, caret).fold(Optional.none, function (newCaret) {\n              return adjustTil(bridge, movement, original, newCaret, numRetries - 1);\n            });\n          }).orThunk(function () {\n            return Optional.some(caret);\n          });\n        }, Optional.none);\n      });\n    };\n    var ieTryDown = function (bridge, caret) {\n      return bridge.situsFromPoint(caret.left, caret.bottom + JUMP_SIZE);\n    };\n    var ieTryUp = function (bridge, caret) {\n      return bridge.situsFromPoint(caret.left, caret.top - JUMP_SIZE);\n    };\n    var checkScroll = function (movement, adjusted, bridge) {\n      if (movement.point(adjusted) > bridge.getInnerHeight()) {\n        return Optional.some(movement.point(adjusted) - bridge.getInnerHeight());\n      } else if (movement.point(adjusted) < 0) {\n        return Optional.some(-movement.point(adjusted));\n      } else {\n        return Optional.none();\n      }\n    };\n    var retry = function (movement, bridge, caret) {\n      var moved = movement.move(caret, JUMP_SIZE);\n      var adjusted = adjustTil(bridge, movement, caret, moved, NUM_RETRIES).getOr(moved);\n      return checkScroll(movement, adjusted, bridge).fold(function () {\n        return bridge.situsFromPoint(adjusted.left, movement.point(adjusted));\n      }, function (delta) {\n        bridge.scrollBy(0, delta);\n        return bridge.situsFromPoint(adjusted.left, movement.point(adjusted) - delta);\n      });\n    };\n    var Retries = {\n      tryUp: curry(retry, upMovement),\n      tryDown: curry(retry, downMovement),\n      ieTryUp: ieTryUp,\n      ieTryDown: ieTryDown,\n      getJumpSize: constant(JUMP_SIZE)\n    };\n\n    var MAX_RETRIES = 20;\n    var findSpot = function (bridge, isRoot, direction) {\n      return bridge.getSelection().bind(function (sel) {\n        return tryBr(isRoot, sel.finish, sel.foffset, direction).fold(function () {\n          return Optional.some(point(sel.finish, sel.foffset));\n        }, function (brNeighbour) {\n          var range = bridge.fromSitus(brNeighbour);\n          var analysis = BeforeAfter.verify(bridge, sel.finish, sel.foffset, range.finish, range.foffset, direction.failure, isRoot);\n          return process(analysis);\n        });\n      });\n    };\n    var scan$1 = function (bridge, isRoot, element, offset, direction, numRetries) {\n      if (numRetries === 0) {\n        return Optional.none();\n      }\n      return tryCursor(bridge, isRoot, element, offset, direction).bind(function (situs) {\n        var range = bridge.fromSitus(situs);\n        var analysis = BeforeAfter.verify(bridge, element, offset, range.finish, range.foffset, direction.failure, isRoot);\n        return BeforeAfter.cata(analysis, function () {\n          return Optional.none();\n        }, function () {\n          return Optional.some(situs);\n        }, function (cell) {\n          if (eq$1(element, cell) && offset === 0) {\n            return tryAgain(bridge, element, offset, moveUp, direction);\n          } else {\n            return scan$1(bridge, isRoot, cell, 0, direction, numRetries - 1);\n          }\n        }, function (cell) {\n          if (eq$1(element, cell) && offset === getEnd(cell)) {\n            return tryAgain(bridge, element, offset, moveDown, direction);\n          } else {\n            return scan$1(bridge, isRoot, cell, getEnd(cell), direction, numRetries - 1);\n          }\n        });\n      });\n    };\n    var tryAgain = function (bridge, element, offset, move, direction) {\n      return getBoxAt(bridge, element, offset).bind(function (box) {\n        return tryAt(bridge, direction, move(box, Retries.getJumpSize()));\n      });\n    };\n    var tryAt = function (bridge, direction, box) {\n      var browser = detect$3().browser;\n      if (browser.isChrome() || browser.isSafari() || browser.isFirefox() || browser.isEdge()) {\n        return direction.otherRetry(bridge, box);\n      } else if (browser.isIE()) {\n        return direction.ieRetry(bridge, box);\n      } else {\n        return Optional.none();\n      }\n    };\n    var tryCursor = function (bridge, isRoot, element, offset, direction) {\n      return getBoxAt(bridge, element, offset).bind(function (box) {\n        return tryAt(bridge, direction, box);\n      });\n    };\n    var handle$2 = function (bridge, isRoot, direction) {\n      return findSpot(bridge, isRoot, direction).bind(function (spot) {\n        return scan$1(bridge, isRoot, spot.element, spot.offset, direction, MAX_RETRIES).map(bridge.fromSitus);\n      });\n    };\n\n    var inSameTable = function (elem, table) {\n      return ancestor$2(elem, function (e) {\n        return parent(e).exists(function (p) {\n          return eq$1(p, table);\n        });\n      });\n    };\n    var simulate = function (bridge, isRoot, direction, initial, anchor) {\n      return closest$1(initial, 'td,th', isRoot).bind(function (start) {\n        return closest$1(start, 'table', isRoot).bind(function (table) {\n          if (!inSameTable(anchor, table)) {\n            return Optional.none();\n          }\n          return handle$2(bridge, isRoot, direction).bind(function (range) {\n            return closest$1(range.finish, 'td,th', isRoot).map(function (finish) {\n              return {\n                start: start,\n                finish: finish,\n                range: range\n              };\n            });\n          });\n        });\n      });\n    };\n    var navigate = function (bridge, isRoot, direction, initial, anchor, precheck) {\n      if (detect$3().browser.isIE()) {\n        return Optional.none();\n      } else {\n        return precheck(initial, isRoot).orThunk(function () {\n          return simulate(bridge, isRoot, direction, initial, anchor).map(function (info) {\n            var range = info.range;\n            return Response.create(Optional.some(makeSitus(range.start, range.soffset, range.finish, range.foffset)), true);\n          });\n        });\n      }\n    };\n    var firstUpCheck = function (initial, isRoot) {\n      return closest$1(initial, 'tr', isRoot).bind(function (startRow) {\n        return closest$1(startRow, 'table', isRoot).bind(function (table) {\n          var rows = descendants$1(table, 'tr');\n          if (eq$1(startRow, rows[0])) {\n            return seekLeft$1(table, function (element) {\n              return last$1(element).isSome();\n            }, isRoot).map(function (last) {\n              var lastOffset = getEnd(last);\n              return Response.create(Optional.some(makeSitus(last, lastOffset, last, lastOffset)), true);\n            });\n          } else {\n            return Optional.none();\n          }\n        });\n      });\n    };\n    var lastDownCheck = function (initial, isRoot) {\n      return closest$1(initial, 'tr', isRoot).bind(function (startRow) {\n        return closest$1(startRow, 'table', isRoot).bind(function (table) {\n          var rows = descendants$1(table, 'tr');\n          if (eq$1(startRow, rows[rows.length - 1])) {\n            return seekRight$1(table, function (element) {\n              return first(element).isSome();\n            }, isRoot).map(function (first) {\n              return Response.create(Optional.some(makeSitus(first, 0, first, 0)), true);\n            });\n          } else {\n            return Optional.none();\n          }\n        });\n      });\n    };\n    var select = function (bridge, container, isRoot, direction, initial, anchor, selectRange) {\n      return simulate(bridge, isRoot, direction, initial, anchor).bind(function (info) {\n        return detect$6(container, isRoot, info.start, info.finish, selectRange);\n      });\n    };\n\n    var value$1 = function () {\n      var subject = Cell(Optional.none());\n      var clear = function () {\n        return subject.set(Optional.none());\n      };\n      var set = function (s) {\n        return subject.set(Optional.some(s));\n      };\n      var isSet = function () {\n        return subject.get().isSome();\n      };\n      var on = function (f) {\n        return subject.get().each(f);\n      };\n      return {\n        clear: clear,\n        set: set,\n        isSet: isSet,\n        on: on\n      };\n    };\n\n    var findCell = function (target, isRoot) {\n      return closest$1(target, 'td,th', isRoot);\n    };\n    var MouseSelection = function (bridge, container, isRoot, annotations) {\n      var cursor = value$1();\n      var clearstate = cursor.clear;\n      var applySelection = function (event) {\n        cursor.on(function (start) {\n          annotations.clearBeforeUpdate(container);\n          findCell(event.target, isRoot).each(function (finish) {\n            identify(start, finish, isRoot).each(function (cellSel) {\n              var boxes = cellSel.boxes.getOr([]);\n              if (boxes.length > 1 || boxes.length === 1 && !eq$1(start, finish)) {\n                annotations.selectRange(container, boxes, cellSel.start, cellSel.finish);\n                bridge.selectContents(finish);\n              }\n            });\n          });\n        });\n      };\n      var mousedown = function (event) {\n        annotations.clear(container);\n        findCell(event.target, isRoot).each(cursor.set);\n      };\n      var mouseover = function (event) {\n        applySelection(event);\n      };\n      var mouseup = function (event) {\n        applySelection(event);\n        clearstate();\n      };\n      return {\n        clearstate: clearstate,\n        mousedown: mousedown,\n        mouseover: mouseover,\n        mouseup: mouseup\n      };\n    };\n\n    var down = {\n      traverse: nextSibling,\n      gather: after$5,\n      relative: Situ.before,\n      otherRetry: Retries.tryDown,\n      ieRetry: Retries.ieTryDown,\n      failure: BeforeAfter.failedDown\n    };\n    var up = {\n      traverse: prevSibling,\n      gather: before$4,\n      relative: Situ.before,\n      otherRetry: Retries.tryUp,\n      ieRetry: Retries.ieTryUp,\n      failure: BeforeAfter.failedUp\n    };\n\n    var isKey = function (key) {\n      return function (keycode) {\n        return keycode === key;\n      };\n    };\n    var isUp = isKey(38);\n    var isDown = isKey(40);\n    var isNavigation = function (keycode) {\n      return keycode >= 37 && keycode <= 40;\n    };\n    var ltr$2 = {\n      isBackward: isKey(37),\n      isForward: isKey(39)\n    };\n    var rtl$2 = {\n      isBackward: isKey(39),\n      isForward: isKey(37)\n    };\n\n    var get$d = function (_DOC) {\n      var doc = _DOC !== undefined ? _DOC.dom : document;\n      var x = doc.body.scrollLeft || doc.documentElement.scrollLeft;\n      var y = doc.body.scrollTop || doc.documentElement.scrollTop;\n      return SugarPosition(x, y);\n    };\n    var by = function (x, y, _DOC) {\n      var doc = _DOC !== undefined ? _DOC.dom : document;\n      var win = doc.defaultView;\n      if (win) {\n        win.scrollBy(x, y);\n      }\n    };\n\n    var WindowBridge = function (win) {\n      var elementFromPoint = function (x, y) {\n        return SugarElement.fromPoint(SugarElement.fromDom(win.document), x, y);\n      };\n      var getRect = function (element) {\n        return element.dom.getBoundingClientRect();\n      };\n      var getRangedRect = function (start, soffset, finish, foffset) {\n        var sel = SimSelection.exact(start, soffset, finish, foffset);\n        return getFirstRect$1(win, sel);\n      };\n      var getSelection = function () {\n        return get$c(win).map(function (exactAdt) {\n          return convertToRange(win, exactAdt);\n        });\n      };\n      var fromSitus = function (situs) {\n        var relative = SimSelection.relative(situs.start, situs.finish);\n        return convertToRange(win, relative);\n      };\n      var situsFromPoint = function (x, y) {\n        return getAtPoint(win, x, y).map(function (exact) {\n          return Situs.create(exact.start, exact.soffset, exact.finish, exact.foffset);\n        });\n      };\n      var clearSelection = function () {\n        clear(win);\n      };\n      var collapseSelection = function (toStart) {\n        if (toStart === void 0) {\n          toStart = false;\n        }\n        get$c(win).each(function (sel) {\n          return sel.fold(function (rng) {\n            return rng.collapse(toStart);\n          }, function (startSitu, finishSitu) {\n            var situ = toStart ? startSitu : finishSitu;\n            setRelative(win, situ, situ);\n          }, function (start, soffset, finish, foffset) {\n            var node = toStart ? start : finish;\n            var offset = toStart ? soffset : foffset;\n            setExact(win, node, offset, node, offset);\n          });\n        });\n      };\n      var selectContents = function (element) {\n        setToElement(win, element);\n      };\n      var setSelection = function (sel) {\n        setExact(win, sel.start, sel.soffset, sel.finish, sel.foffset);\n      };\n      var setRelativeSelection = function (start, finish) {\n        setRelative(win, start, finish);\n      };\n      var getInnerHeight = function () {\n        return win.innerHeight;\n      };\n      var getScrollY = function () {\n        var pos = get$d(SugarElement.fromDom(win.document));\n        return pos.top;\n      };\n      var scrollBy = function (x, y) {\n        by(x, y, SugarElement.fromDom(win.document));\n      };\n      return {\n        elementFromPoint: elementFromPoint,\n        getRect: getRect,\n        getRangedRect: getRangedRect,\n        getSelection: getSelection,\n        fromSitus: fromSitus,\n        situsFromPoint: situsFromPoint,\n        clearSelection: clearSelection,\n        collapseSelection: collapseSelection,\n        setSelection: setSelection,\n        setRelativeSelection: setRelativeSelection,\n        selectContents: selectContents,\n        getInnerHeight: getInnerHeight,\n        getScrollY: getScrollY,\n        scrollBy: scrollBy\n      };\n    };\n\n    var rc = function (rows, cols) {\n      return {\n        rows: rows,\n        cols: cols\n      };\n    };\n    var mouse = function (win, container, isRoot, annotations) {\n      var bridge = WindowBridge(win);\n      var handlers = MouseSelection(bridge, container, isRoot, annotations);\n      return {\n        clearstate: handlers.clearstate,\n        mousedown: handlers.mousedown,\n        mouseover: handlers.mouseover,\n        mouseup: handlers.mouseup\n      };\n    };\n    var keyboard = function (win, container, isRoot, annotations) {\n      var bridge = WindowBridge(win);\n      var clearToNavigate = function () {\n        annotations.clear(container);\n        return Optional.none();\n      };\n      var keydown = function (event, start, soffset, finish, foffset, direction) {\n        var realEvent = event.raw;\n        var keycode = realEvent.which;\n        var shiftKey = realEvent.shiftKey === true;\n        var handler = retrieve(container, annotations.selectedSelector).fold(function () {\n          if (isDown(keycode) && shiftKey) {\n            return curry(select, bridge, container, isRoot, down, finish, start, annotations.selectRange);\n          } else if (isUp(keycode) && shiftKey) {\n            return curry(select, bridge, container, isRoot, up, finish, start, annotations.selectRange);\n          } else if (isDown(keycode)) {\n            return curry(navigate, bridge, isRoot, down, finish, start, lastDownCheck);\n          } else if (isUp(keycode)) {\n            return curry(navigate, bridge, isRoot, up, finish, start, firstUpCheck);\n          } else {\n            return Optional.none;\n          }\n        }, function (selected) {\n          var update$1 = function (attempts) {\n            return function () {\n              var navigation = findMap(attempts, function (delta) {\n                return update(delta.rows, delta.cols, container, selected, annotations);\n              });\n              return navigation.fold(function () {\n                return getEdges(container, annotations.firstSelectedSelector, annotations.lastSelectedSelector).map(function (edges) {\n                  var relative = isDown(keycode) || direction.isForward(keycode) ? Situ.after : Situ.before;\n                  bridge.setRelativeSelection(Situ.on(edges.first, 0), relative(edges.table));\n                  annotations.clear(container);\n                  return Response.create(Optional.none(), true);\n                });\n              }, function (_) {\n                return Optional.some(Response.create(Optional.none(), true));\n              });\n            };\n          };\n          if (isDown(keycode) && shiftKey) {\n            return update$1([rc(+1, 0)]);\n          } else if (isUp(keycode) && shiftKey) {\n            return update$1([rc(-1, 0)]);\n          } else if (direction.isBackward(keycode) && shiftKey) {\n            return update$1([\n              rc(0, -1),\n              rc(-1, 0)\n            ]);\n          } else if (direction.isForward(keycode) && shiftKey) {\n            return update$1([\n              rc(0, +1),\n              rc(+1, 0)\n            ]);\n          } else if (isNavigation(keycode) && shiftKey === false) {\n            return clearToNavigate;\n          } else {\n            return Optional.none;\n          }\n        });\n        return handler();\n      };\n      var keyup = function (event, start, soffset, finish, foffset) {\n        return retrieve(container, annotations.selectedSelector).fold(function () {\n          var realEvent = event.raw;\n          var keycode = realEvent.which;\n          var shiftKey = realEvent.shiftKey === true;\n          if (shiftKey === false) {\n            return Optional.none();\n          }\n          if (isNavigation(keycode)) {\n            return sync(container, isRoot, start, soffset, finish, foffset, annotations.selectRange);\n          } else {\n            return Optional.none();\n          }\n        }, Optional.none);\n      };\n      return {\n        keydown: keydown,\n        keyup: keyup\n      };\n    };\n    var external = function (win, container, isRoot, annotations) {\n      var bridge = WindowBridge(win);\n      return function (start, finish) {\n        annotations.clearBeforeUpdate(container);\n        identify(start, finish, isRoot).each(function (cellSel) {\n          var boxes = cellSel.boxes.getOr([]);\n          annotations.selectRange(container, boxes, cellSel.start, cellSel.finish);\n          bridge.selectContents(finish);\n          bridge.collapseSelection();\n        });\n      };\n    };\n\n    var remove$7 = function (element, classes) {\n      each(classes, function (x) {\n        remove$5(element, x);\n      });\n    };\n\n    var addClass = function (clazz) {\n      return function (element) {\n        add$3(element, clazz);\n      };\n    };\n    var removeClasses = function (classes) {\n      return function (element) {\n        remove$7(element, classes);\n      };\n    };\n\n    var byClass = function (ephemera) {\n      var addSelectionClass = addClass(ephemera.selected);\n      var removeSelectionClasses = removeClasses([\n        ephemera.selected,\n        ephemera.lastSelected,\n        ephemera.firstSelected\n      ]);\n      var clear = function (container) {\n        var sels = descendants$1(container, ephemera.selectedSelector);\n        each(sels, removeSelectionClasses);\n      };\n      var selectRange = function (container, cells, start, finish) {\n        clear(container);\n        each(cells, addSelectionClass);\n        add$3(start, ephemera.firstSelected);\n        add$3(finish, ephemera.lastSelected);\n      };\n      return {\n        clearBeforeUpdate: clear,\n        clear: clear,\n        selectRange: selectRange,\n        selectedSelector: ephemera.selectedSelector,\n        firstSelectedSelector: ephemera.firstSelectedSelector,\n        lastSelectedSelector: ephemera.lastSelectedSelector\n      };\n    };\n    var byAttr = function (ephemera, onSelection, onClear) {\n      var removeSelectionAttributes = function (element) {\n        remove(element, ephemera.selected);\n        remove(element, ephemera.firstSelected);\n        remove(element, ephemera.lastSelected);\n      };\n      var addSelectionAttribute = function (element) {\n        set(element, ephemera.selected, '1');\n      };\n      var clear = function (container) {\n        clearBeforeUpdate(container);\n        onClear();\n      };\n      var clearBeforeUpdate = function (container) {\n        var sels = descendants$1(container, ephemera.selectedSelector);\n        each(sels, removeSelectionAttributes);\n      };\n      var selectRange = function (container, cells, start, finish) {\n        clear(container);\n        each(cells, addSelectionAttribute);\n        set(start, ephemera.firstSelected, '1');\n        set(finish, ephemera.lastSelected, '1');\n        onSelection(cells, start, finish);\n      };\n      return {\n        clearBeforeUpdate: clearBeforeUpdate,\n        clear: clear,\n        selectRange: selectRange,\n        selectedSelector: ephemera.selectedSelector,\n        firstSelectedSelector: ephemera.firstSelectedSelector,\n        lastSelectedSelector: ephemera.lastSelectedSelector\n      };\n    };\n    var SelectionAnnotation = {\n      byClass: byClass,\n      byAttr: byAttr\n    };\n\n    var getUpOrLeftCells = function (grid, selectedCells, generators) {\n      var upGrid = grid.slice(0, selectedCells[selectedCells.length - 1].row + 1);\n      var upDetails = toDetailList(upGrid, generators);\n      return bind(upDetails, function (detail) {\n        var slicedCells = detail.cells.slice(0, selectedCells[selectedCells.length - 1].column + 1);\n        return map(slicedCells, function (cell) {\n          return cell.element;\n        });\n      });\n    };\n    var getDownOrRightCells = function (grid, selectedCells, generators) {\n      var downGrid = grid.slice(selectedCells[0].row + selectedCells[0].rowspan - 1, grid.length);\n      var downDetails = toDetailList(downGrid, generators);\n      return bind(downDetails, function (detail) {\n        var slicedCells = detail.cells.slice(selectedCells[0].column + selectedCells[0].colspan - 1, detail.cells.length);\n        return map(slicedCells, function (cell) {\n          return cell.element;\n        });\n      });\n    };\n    var getOtherCells = function (table, target, generators) {\n      var warehouse = Warehouse.fromTable(table);\n      var details = onCells(warehouse, target);\n      return details.map(function (selectedCells) {\n        var grid = toGrid(warehouse, generators, false);\n        var upOrLeftCells = getUpOrLeftCells(grid, selectedCells, generators);\n        var downOrRightCells = getDownOrRightCells(grid, selectedCells, generators);\n        return {\n          upOrLeftCells: upOrLeftCells,\n          downOrRightCells: downOrRightCells\n        };\n      });\n    };\n\n    var hasInternalTarget = function (e) {\n      return has$1(SugarElement.fromDom(e.target), 'ephox-snooker-resizer-bar') === false;\n    };\n    function CellSelection (editor, lazyResize, selectionTargets) {\n      var onSelection = function (cells, start, finish) {\n        selectionTargets.targets().each(function (targets) {\n          var tableOpt = table(start);\n          tableOpt.each(function (table) {\n            var cloneFormats = getCloneElements(editor);\n            var generators = cellOperations(noop, SugarElement.fromDom(editor.getDoc()), cloneFormats);\n            var otherCells = getOtherCells(table, targets, generators);\n            fireTableSelectionChange(editor, cells, start, finish, otherCells);\n          });\n        });\n      };\n      var onClear = function () {\n        return fireTableSelectionClear(editor);\n      };\n      var annotations = SelectionAnnotation.byAttr(ephemera, onSelection, onClear);\n      editor.on('init', function (_e) {\n        var win = editor.getWin();\n        var body = getBody$1(editor);\n        var isRoot = getIsRoot(editor);\n        var syncSelection = function () {\n          var sel = editor.selection;\n          var start = SugarElement.fromDom(sel.getStart());\n          var end = SugarElement.fromDom(sel.getEnd());\n          var shared = sharedOne$1(table, [\n            start,\n            end\n          ]);\n          shared.fold(function () {\n            return annotations.clear(body);\n          }, noop);\n        };\n        var mouseHandlers = mouse(win, body, isRoot, annotations);\n        var keyHandlers = keyboard(win, body, isRoot, annotations);\n        var external$1 = external(win, body, isRoot, annotations);\n        var hasShiftKey = function (event) {\n          return event.raw.shiftKey === true;\n        };\n        editor.on('TableSelectorChange', function (e) {\n          return external$1(e.start, e.finish);\n        });\n        var handleResponse = function (event, response) {\n          if (!hasShiftKey(event)) {\n            return;\n          }\n          if (response.kill) {\n            event.kill();\n          }\n          response.selection.each(function (ns) {\n            var relative = SimSelection.relative(ns.start, ns.finish);\n            var rng = asLtrRange(win, relative);\n            editor.selection.setRng(rng);\n          });\n        };\n        var keyup = function (event) {\n          var wrappedEvent = fromRawEvent$1(event);\n          if (wrappedEvent.raw.shiftKey && isNavigation(wrappedEvent.raw.which)) {\n            var rng = editor.selection.getRng();\n            var start = SugarElement.fromDom(rng.startContainer);\n            var end = SugarElement.fromDom(rng.endContainer);\n            keyHandlers.keyup(wrappedEvent, start, rng.startOffset, end, rng.endOffset).each(function (response) {\n              handleResponse(wrappedEvent, response);\n            });\n          }\n        };\n        var keydown = function (event) {\n          var wrappedEvent = fromRawEvent$1(event);\n          lazyResize().each(function (resize) {\n            return resize.hideBars();\n          });\n          var rng = editor.selection.getRng();\n          var start = SugarElement.fromDom(rng.startContainer);\n          var end = SugarElement.fromDom(rng.endContainer);\n          var direction = onDirection(ltr$2, rtl$2)(SugarElement.fromDom(editor.selection.getStart()));\n          keyHandlers.keydown(wrappedEvent, start, rng.startOffset, end, rng.endOffset, direction).each(function (response) {\n            handleResponse(wrappedEvent, response);\n          });\n          lazyResize().each(function (resize) {\n            return resize.showBars();\n          });\n        };\n        var isLeftMouse = function (raw) {\n          return raw.button === 0;\n        };\n        var isLeftButtonPressed = function (raw) {\n          if (raw.buttons === undefined) {\n            return true;\n          }\n          if (global$2.browser.isEdge() && raw.buttons === 0) {\n            return true;\n          }\n          return (raw.buttons & 1) !== 0;\n        };\n        var dragStart = function (_e) {\n          mouseHandlers.clearstate();\n        };\n        var mouseDown = function (e) {\n          if (isLeftMouse(e) && hasInternalTarget(e)) {\n            mouseHandlers.mousedown(fromRawEvent$1(e));\n          }\n        };\n        var mouseOver = function (e) {\n          if (isLeftButtonPressed(e) && hasInternalTarget(e)) {\n            mouseHandlers.mouseover(fromRawEvent$1(e));\n          }\n        };\n        var mouseUp = function (e) {\n          if (isLeftMouse(e) && hasInternalTarget(e)) {\n            mouseHandlers.mouseup(fromRawEvent$1(e));\n          }\n        };\n        var getDoubleTap = function () {\n          var lastTarget = Cell(SugarElement.fromDom(body));\n          var lastTimeStamp = Cell(0);\n          var touchEnd = function (t) {\n            var target = SugarElement.fromDom(t.target);\n            if (name(target) === 'td' || name(target) === 'th') {\n              var lT = lastTarget.get();\n              var lTS = lastTimeStamp.get();\n              if (eq$1(lT, target) && t.timeStamp - lTS < 300) {\n                t.preventDefault();\n                external$1(target, target);\n              }\n            }\n            lastTarget.set(target);\n            lastTimeStamp.set(t.timeStamp);\n          };\n          return { touchEnd: touchEnd };\n        };\n        var doubleTap = getDoubleTap();\n        editor.on('dragstart', dragStart);\n        editor.on('mousedown', mouseDown);\n        editor.on('mouseover', mouseOver);\n        editor.on('mouseup', mouseUp);\n        editor.on('touchend', doubleTap.touchEnd);\n        editor.on('keyup', keyup);\n        editor.on('keydown', keydown);\n        editor.on('NodeChange', syncSelection);\n      });\n      return { clear: annotations.clear };\n    }\n\n    var getSelectionTargets = function (editor, selections) {\n      var targets = Cell(Optional.none());\n      var changeHandlers = Cell([]);\n      var selectionDetails = Optional.none();\n      var isCaption = isTag('caption');\n      var isDisabledForSelection = function (key) {\n        return selectionDetails.forall(function (details) {\n          return !details[key];\n        });\n      };\n      var findTargets = function () {\n        return getSelectionStartCellOrCaption(getSelectionStart(editor), getIsRoot(editor)).bind(function (cellOrCaption) {\n          var table$1 = table(cellOrCaption);\n          return table$1.map(function (table) {\n            if (isCaption(cellOrCaption)) {\n              return noMenu(cellOrCaption);\n            } else {\n              return forMenu(selections, table, cellOrCaption);\n            }\n          });\n        });\n      };\n      var getExtractedDetails = function (targets) {\n        var tableOpt = table(targets.element);\n        return tableOpt.map(function (table) {\n          var warehouse = Warehouse.fromTable(table);\n          var selectedCells = onCells(warehouse, targets).getOr([]);\n          var locked = foldl(selectedCells, function (acc, cell) {\n            if (cell.isLocked) {\n              acc.onAny = true;\n              if (cell.column === 0) {\n                acc.onFirst = true;\n              } else if (cell.column + cell.colspan >= warehouse.grid.columns) {\n                acc.onLast = true;\n              }\n            }\n            return acc;\n          }, {\n            onAny: false,\n            onFirst: false,\n            onLast: false\n          });\n          return {\n            mergeable: onUnlockedMergable(warehouse, targets).isSome(),\n            unmergeable: onUnlockedUnmergable(warehouse, targets).isSome(),\n            locked: locked\n          };\n        });\n      };\n      var resetTargets = function () {\n        targets.set(cached(findTargets)());\n        selectionDetails = targets.get().bind(getExtractedDetails);\n        each(changeHandlers.get(), function (handler) {\n          return handler();\n        });\n      };\n      var onSetup = function (api, isDisabled) {\n        var handler = function () {\n          return targets.get().fold(function () {\n            api.setDisabled(true);\n          }, function (targets) {\n            api.setDisabled(isDisabled(targets));\n          });\n        };\n        handler();\n        changeHandlers.set(changeHandlers.get().concat([handler]));\n        return function () {\n          changeHandlers.set(filter(changeHandlers.get(), function (h) {\n            return h !== handler;\n          }));\n        };\n      };\n      var isDisabledFromLocked = function (lockedDisable) {\n        return selectionDetails.exists(function (details) {\n          return details.locked[lockedDisable];\n        });\n      };\n      var onSetupTable = function (api) {\n        return onSetup(api, function (_) {\n          return false;\n        });\n      };\n      var onSetupCellOrRow = function (api) {\n        return onSetup(api, function (targets) {\n          return isCaption(targets.element);\n        });\n      };\n      var onSetupColumn = function (lockedDisable) {\n        return function (api) {\n          return onSetup(api, function (targets) {\n            return isCaption(targets.element) || isDisabledFromLocked(lockedDisable);\n          });\n        };\n      };\n      var onSetupPasteable = function (getClipboardData) {\n        return function (api) {\n          return onSetup(api, function (targets) {\n            return isCaption(targets.element) || getClipboardData().isNone();\n          });\n        };\n      };\n      var onSetupPasteableColumn = function (getClipboardData, lockedDisable) {\n        return function (api) {\n          return onSetup(api, function (targets) {\n            return isCaption(targets.element) || getClipboardData().isNone() || isDisabledFromLocked(lockedDisable);\n          });\n        };\n      };\n      var onSetupMergeable = function (api) {\n        return onSetup(api, function (_targets) {\n          return isDisabledForSelection('mergeable');\n        });\n      };\n      var onSetupUnmergeable = function (api) {\n        return onSetup(api, function (_targets) {\n          return isDisabledForSelection('unmergeable');\n        });\n      };\n      editor.on('NodeChange ExecCommand TableSelectorChange', resetTargets);\n      return {\n        onSetupTable: onSetupTable,\n        onSetupCellOrRow: onSetupCellOrRow,\n        onSetupColumn: onSetupColumn,\n        onSetupPasteable: onSetupPasteable,\n        onSetupPasteableColumn: onSetupPasteableColumn,\n        onSetupMergeable: onSetupMergeable,\n        onSetupUnmergeable: onSetupUnmergeable,\n        resetTargets: resetTargets,\n        targets: function () {\n          return targets.get();\n        }\n      };\n    };\n\n    var addButtons = function (editor, selectionTargets, clipboard) {\n      editor.ui.registry.addMenuButton('table', {\n        tooltip: 'Table',\n        icon: 'table',\n        fetch: function (callback) {\n          return callback('inserttable | cell row column | advtablesort | tableprops deletetable');\n        }\n      });\n      var cmd = function (command) {\n        return function () {\n          return editor.execCommand(command);\n        };\n      };\n      editor.ui.registry.addButton('tableprops', {\n        tooltip: 'Table properties',\n        onAction: cmd('mceTableProps'),\n        icon: 'table',\n        onSetup: selectionTargets.onSetupTable\n      });\n      editor.ui.registry.addButton('tabledelete', {\n        tooltip: 'Delete table',\n        onAction: cmd('mceTableDelete'),\n        icon: 'table-delete-table',\n        onSetup: selectionTargets.onSetupTable\n      });\n      editor.ui.registry.addButton('tablecellprops', {\n        tooltip: 'Cell properties',\n        onAction: cmd('mceTableCellProps'),\n        icon: 'table-cell-properties',\n        onSetup: selectionTargets.onSetupCellOrRow\n      });\n      editor.ui.registry.addButton('tablemergecells', {\n        tooltip: 'Merge cells',\n        onAction: cmd('mceTableMergeCells'),\n        icon: 'table-merge-cells',\n        onSetup: selectionTargets.onSetupMergeable\n      });\n      editor.ui.registry.addButton('tablesplitcells', {\n        tooltip: 'Split cell',\n        onAction: cmd('mceTableSplitCells'),\n        icon: 'table-split-cells',\n        onSetup: selectionTargets.onSetupUnmergeable\n      });\n      editor.ui.registry.addButton('tableinsertrowbefore', {\n        tooltip: 'Insert row before',\n        onAction: cmd('mceTableInsertRowBefore'),\n        icon: 'table-insert-row-above',\n        onSetup: selectionTargets.onSetupCellOrRow\n      });\n      editor.ui.registry.addButton('tableinsertrowafter', {\n        tooltip: 'Insert row after',\n        onAction: cmd('mceTableInsertRowAfter'),\n        icon: 'table-insert-row-after',\n        onSetup: selectionTargets.onSetupCellOrRow\n      });\n      editor.ui.registry.addButton('tabledeleterow', {\n        tooltip: 'Delete row',\n        onAction: cmd('mceTableDeleteRow'),\n        icon: 'table-delete-row',\n        onSetup: selectionTargets.onSetupCellOrRow\n      });\n      editor.ui.registry.addButton('tablerowprops', {\n        tooltip: 'Row properties',\n        onAction: cmd('mceTableRowProps'),\n        icon: 'table-row-properties',\n        onSetup: selectionTargets.onSetupCellOrRow\n      });\n      editor.ui.registry.addButton('tableinsertcolbefore', {\n        tooltip: 'Insert column before',\n        onAction: cmd('mceTableInsertColBefore'),\n        icon: 'table-insert-column-before',\n        onSetup: selectionTargets.onSetupColumn('onFirst')\n      });\n      editor.ui.registry.addButton('tableinsertcolafter', {\n        tooltip: 'Insert column after',\n        onAction: cmd('mceTableInsertColAfter'),\n        icon: 'table-insert-column-after',\n        onSetup: selectionTargets.onSetupColumn('onLast')\n      });\n      editor.ui.registry.addButton('tabledeletecol', {\n        tooltip: 'Delete column',\n        onAction: cmd('mceTableDeleteCol'),\n        icon: 'table-delete-column',\n        onSetup: selectionTargets.onSetupColumn('onAny')\n      });\n      editor.ui.registry.addButton('tablecutrow', {\n        tooltip: 'Cut row',\n        icon: 'cut-row',\n        onAction: cmd('mceTableCutRow'),\n        onSetup: selectionTargets.onSetupCellOrRow\n      });\n      editor.ui.registry.addButton('tablecopyrow', {\n        tooltip: 'Copy row',\n        icon: 'duplicate-row',\n        onAction: cmd('mceTableCopyRow'),\n        onSetup: selectionTargets.onSetupCellOrRow\n      });\n      editor.ui.registry.addButton('tablepasterowbefore', {\n        tooltip: 'Paste row before',\n        icon: 'paste-row-before',\n        onAction: cmd('mceTablePasteRowBefore'),\n        onSetup: selectionTargets.onSetupPasteable(clipboard.getRows)\n      });\n      editor.ui.registry.addButton('tablepasterowafter', {\n        tooltip: 'Paste row after',\n        icon: 'paste-row-after',\n        onAction: cmd('mceTablePasteRowAfter'),\n        onSetup: selectionTargets.onSetupPasteable(clipboard.getRows)\n      });\n      editor.ui.registry.addButton('tablecutcol', {\n        tooltip: 'Cut column',\n        icon: 'cut-column',\n        onAction: cmd('mceTableCutCol'),\n        onSetup: selectionTargets.onSetupColumn('onAny')\n      });\n      editor.ui.registry.addButton('tablecopycol', {\n        tooltip: 'Copy column',\n        icon: 'duplicate-column',\n        onAction: cmd('mceTableCopyCol'),\n        onSetup: selectionTargets.onSetupColumn('onAny')\n      });\n      editor.ui.registry.addButton('tablepastecolbefore', {\n        tooltip: 'Paste column before',\n        icon: 'paste-column-before',\n        onAction: cmd('mceTablePasteColBefore'),\n        onSetup: selectionTargets.onSetupPasteableColumn(clipboard.getColumns, 'onFirst')\n      });\n      editor.ui.registry.addButton('tablepastecolafter', {\n        tooltip: 'Paste column after',\n        icon: 'paste-column-after',\n        onAction: cmd('mceTablePasteColAfter'),\n        onSetup: selectionTargets.onSetupPasteableColumn(clipboard.getColumns, 'onLast')\n      });\n      editor.ui.registry.addButton('tableinsertdialog', {\n        tooltip: 'Insert table',\n        onAction: cmd('mceInsertTable'),\n        icon: 'table'\n      });\n    };\n    var addToolbars = function (editor) {\n      var isTable = function (table) {\n        return editor.dom.is(table, 'table') && editor.getBody().contains(table);\n      };\n      var toolbar = getToolbar(editor);\n      if (toolbar.length > 0) {\n        editor.ui.registry.addContextToolbar('table', {\n          predicate: isTable,\n          items: toolbar,\n          scope: 'node',\n          position: 'node'\n        });\n      }\n    };\n\n    var addMenuItems = function (editor, selectionTargets, clipboard) {\n      var cmd = function (command) {\n        return function () {\n          return editor.execCommand(command);\n        };\n      };\n      var insertTableAction = function (data) {\n        editor.execCommand('mceInsertTable', false, {\n          rows: data.numRows,\n          columns: data.numColumns\n        });\n      };\n      var tableProperties = {\n        text: 'Table properties',\n        onSetup: selectionTargets.onSetupTable,\n        onAction: cmd('mceTableProps')\n      };\n      var deleteTable = {\n        text: 'Delete table',\n        icon: 'table-delete-table',\n        onSetup: selectionTargets.onSetupTable,\n        onAction: cmd('mceTableDelete')\n      };\n      editor.ui.registry.addMenuItem('tableinsertrowbefore', {\n        text: 'Insert row before',\n        icon: 'table-insert-row-above',\n        onAction: cmd('mceTableInsertRowBefore'),\n        onSetup: selectionTargets.onSetupCellOrRow\n      });\n      editor.ui.registry.addMenuItem('tableinsertrowafter', {\n        text: 'Insert row after',\n        icon: 'table-insert-row-after',\n        onAction: cmd('mceTableInsertRowAfter'),\n        onSetup: selectionTargets.onSetupCellOrRow\n      });\n      editor.ui.registry.addMenuItem('tabledeleterow', {\n        text: 'Delete row',\n        icon: 'table-delete-row',\n        onAction: cmd('mceTableDeleteRow'),\n        onSetup: selectionTargets.onSetupCellOrRow\n      });\n      editor.ui.registry.addMenuItem('tablerowprops', {\n        text: 'Row properties',\n        icon: 'table-row-properties',\n        onAction: cmd('mceTableRowProps'),\n        onSetup: selectionTargets.onSetupCellOrRow\n      });\n      editor.ui.registry.addMenuItem('tablecutrow', {\n        text: 'Cut row',\n        icon: 'cut-row',\n        onAction: cmd('mceTableCutRow'),\n        onSetup: selectionTargets.onSetupCellOrRow\n      });\n      editor.ui.registry.addMenuItem('tablecopyrow', {\n        text: 'Copy row',\n        icon: 'duplicate-row',\n        onAction: cmd('mceTableCopyRow'),\n        onSetup: selectionTargets.onSetupCellOrRow\n      });\n      editor.ui.registry.addMenuItem('tablepasterowbefore', {\n        text: 'Paste row before',\n        icon: 'paste-row-before',\n        onAction: cmd('mceTablePasteRowBefore'),\n        onSetup: selectionTargets.onSetupPasteable(clipboard.getRows)\n      });\n      editor.ui.registry.addMenuItem('tablepasterowafter', {\n        text: 'Paste row after',\n        icon: 'paste-row-after',\n        onAction: cmd('mceTablePasteRowAfter'),\n        onSetup: selectionTargets.onSetupPasteable(clipboard.getRows)\n      });\n      var row = {\n        type: 'nestedmenuitem',\n        text: 'Row',\n        getSubmenuItems: function () {\n          return 'tableinsertrowbefore tableinsertrowafter tabledeleterow tablerowprops | tablecutrow tablecopyrow tablepasterowbefore tablepasterowafter';\n        }\n      };\n      editor.ui.registry.addMenuItem('tableinsertcolumnbefore', {\n        text: 'Insert column before',\n        icon: 'table-insert-column-before',\n        onAction: cmd('mceTableInsertColBefore'),\n        onSetup: selectionTargets.onSetupColumn('onFirst')\n      });\n      editor.ui.registry.addMenuItem('tableinsertcolumnafter', {\n        text: 'Insert column after',\n        icon: 'table-insert-column-after',\n        onAction: cmd('mceTableInsertColAfter'),\n        onSetup: selectionTargets.onSetupColumn('onLast')\n      });\n      editor.ui.registry.addMenuItem('tabledeletecolumn', {\n        text: 'Delete column',\n        icon: 'table-delete-column',\n        onAction: cmd('mceTableDeleteCol'),\n        onSetup: selectionTargets.onSetupColumn('onAny')\n      });\n      editor.ui.registry.addMenuItem('tablecutcolumn', {\n        text: 'Cut column',\n        icon: 'cut-column',\n        onAction: cmd('mceTableCutCol'),\n        onSetup: selectionTargets.onSetupColumn('onAny')\n      });\n      editor.ui.registry.addMenuItem('tablecopycolumn', {\n        text: 'Copy column',\n        icon: 'duplicate-column',\n        onAction: cmd('mceTableCopyCol'),\n        onSetup: selectionTargets.onSetupColumn('onAny')\n      });\n      editor.ui.registry.addMenuItem('tablepastecolumnbefore', {\n        text: 'Paste column before',\n        icon: 'paste-column-before',\n        onAction: cmd('mceTablePasteColBefore'),\n        onSetup: selectionTargets.onSetupPasteableColumn(clipboard.getColumns, 'onFirst')\n      });\n      editor.ui.registry.addMenuItem('tablepastecolumnafter', {\n        text: 'Paste column after',\n        icon: 'paste-column-after',\n        onAction: cmd('mceTablePasteColAfter'),\n        onSetup: selectionTargets.onSetupPasteableColumn(clipboard.getColumns, 'onLast')\n      });\n      var column = {\n        type: 'nestedmenuitem',\n        text: 'Column',\n        getSubmenuItems: function () {\n          return 'tableinsertcolumnbefore tableinsertcolumnafter tabledeletecolumn | tablecutcolumn tablecopycolumn tablepastecolumnbefore tablepastecolumnafter';\n        }\n      };\n      editor.ui.registry.addMenuItem('tablecellprops', {\n        text: 'Cell properties',\n        icon: 'table-cell-properties',\n        onAction: cmd('mceTableCellProps'),\n        onSetup: selectionTargets.onSetupCellOrRow\n      });\n      editor.ui.registry.addMenuItem('tablemergecells', {\n        text: 'Merge cells',\n        icon: 'table-merge-cells',\n        onAction: cmd('mceTableMergeCells'),\n        onSetup: selectionTargets.onSetupMergeable\n      });\n      editor.ui.registry.addMenuItem('tablesplitcells', {\n        text: 'Split cell',\n        icon: 'table-split-cells',\n        onAction: cmd('mceTableSplitCells'),\n        onSetup: selectionTargets.onSetupUnmergeable\n      });\n      var cell = {\n        type: 'nestedmenuitem',\n        text: 'Cell',\n        getSubmenuItems: function () {\n          return 'tablecellprops tablemergecells tablesplitcells';\n        }\n      };\n      if (hasTableGrid(editor) === false) {\n        editor.ui.registry.addMenuItem('inserttable', {\n          text: 'Table',\n          icon: 'table',\n          onAction: cmd('mceInsertTable')\n        });\n      } else {\n        editor.ui.registry.addNestedMenuItem('inserttable', {\n          text: 'Table',\n          icon: 'table',\n          getSubmenuItems: function () {\n            return [{\n                type: 'fancymenuitem',\n                fancytype: 'inserttable',\n                onAction: insertTableAction\n              }];\n          }\n        });\n      }\n      editor.ui.registry.addMenuItem('inserttabledialog', {\n        text: 'Insert table',\n        icon: 'table',\n        onAction: cmd('mceInsertTable')\n      });\n      editor.ui.registry.addMenuItem('tableprops', tableProperties);\n      editor.ui.registry.addMenuItem('deletetable', deleteTable);\n      editor.ui.registry.addNestedMenuItem('row', row);\n      editor.ui.registry.addNestedMenuItem('column', column);\n      editor.ui.registry.addNestedMenuItem('cell', cell);\n      editor.ui.registry.addContextMenu('table', {\n        update: function () {\n          selectionTargets.resetTargets();\n          return selectionTargets.targets().fold(function () {\n            return '';\n          }, function (targets) {\n            if (name(targets.element) === 'caption') {\n              return 'tableprops deletetable';\n            } else {\n              return 'cell row column | advtablesort | tableprops deletetable';\n            }\n          });\n        }\n      });\n    };\n\n    var Plugin = function (editor) {\n      var selections = Selections(function () {\n        return getBody$1(editor);\n      }, function () {\n        return getSelectionStartCellOrCaption(getSelectionStart(editor));\n      }, ephemera.selectedSelector);\n      var selectionTargets = getSelectionTargets(editor, selections);\n      var resizeHandler = getResizeHandler(editor);\n      var cellSelection = CellSelection(editor, resizeHandler.lazyResize, selectionTargets);\n      var actions = TableActions(editor, resizeHandler.lazyWire, selections);\n      var clipboard = Clipboard();\n      registerCommands(editor, actions, cellSelection, selections, clipboard);\n      registerQueryCommands(editor, actions, selections);\n      registerEvents(editor, selections, actions, cellSelection);\n      addMenuItems(editor, selectionTargets, clipboard);\n      addButtons(editor, selectionTargets, clipboard);\n      addToolbars(editor);\n      editor.on('PreInit', function () {\n        editor.serializer.addTempAttr(ephemera.firstSelected);\n        editor.serializer.addTempAttr(ephemera.lastSelected);\n        registerFormats(editor);\n      });\n      if (hasTabNavigation(editor)) {\n        editor.on('keydown', function (e) {\n          handle$1(e, editor, cellSelection);\n        });\n      }\n      editor.on('remove', function () {\n        resizeHandler.destroy();\n      });\n      return getApi(editor, clipboard, resizeHandler, selectionTargets);\n    };\n    function Plugin$1 () {\n      global.add('table', Plugin);\n    }\n\n    Plugin$1();\n\n}());\n"]}